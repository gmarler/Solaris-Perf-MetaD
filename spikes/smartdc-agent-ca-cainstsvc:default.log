[ Jun 12 23:51:10 Enabled. ]
[ Jun 12 23:51:10 Rereading configuration. ]
[ Jun 12 23:51:10 Executing start method ("/opt/smartdc/agents/lib/node_modules/cabase/smf/method/canodesvc"). ]
DTRACE_LIBPATH=/opt/smartdc/agents/lib/node_modules/cabase/lib
ignoring amqp-config key amqp_login
ignoring amqp-config key amqp_password
AMQP_HOST=10.99.99.20
AMQP_PORT=5672
NODE_PATH=:/opt/smartdc/agents/lib/node_modules/cabase/node_modules:/opt/smartdc/agents/lib/node_modules/cabase/node_modules/connect/lib:/opt/smartdc/agents/lib/node_modules/cabase/lib/ca:/opt/smartdc/agents/lib/node_modules/cabase/lib/tst
[ Jun 12 23:51:11 Method "start" exited with status 0. ]
The "sys" module is now called "util". It should have a similar interface.
using backends kstat,dtrace,zfs,cainstr,proc
[2015-06-12 23:51:11.414 UTC] INFO   Logging AMQP message to "/opt/smartdc/agents/log/ca/cainstsvc/amqp-2015-06-12.23:51:10.5259"
[2015-06-12 23:51:11.416 UTC] INFO   Instrumenter starting up (instsvc/0.0)
[2015-06-12 23:51:11.416 UTC] INFO   Hostname:    headnode
[2015-06-12 23:51:11.416 UTC] INFO   AMQP broker: {"host":"10.99.99.20","port":"5672"}
[2015-06-12 23:51:11.417 UTC] INFO   Routing key: ca.instrumenter.headnode
[2015-06-12 23:51:11.420 UTC] DBG    loaded metadata file "metadata/profile/operator.json"
[2015-06-12 23:51:11.421 UTC] DBG    loaded metadata file "metadata/metric/metrics.json"
[2015-06-12 23:51:11.422 UTC] DBG    loaded metadata file "metadata/profile/customer.json"
[2015-06-12 23:51:11.437 UTC] INFO   loading modules.
[2015-06-12 23:51:11.453 UTC] INFO   module "kstat" registered cpu.cpus
[2015-06-12 23:51:11.453 UTC] INFO   module "kstat" registered cpu.usage
[2015-06-12 23:51:11.454 UTC] INFO   module "kstat" registered cpu.waittime
[2015-06-12 23:51:11.454 UTC] INFO   module "kstat" registered cpu.loadavg1
[2015-06-12 23:51:11.454 UTC] INFO   module "kstat" registered nic.nics
[2015-06-12 23:51:11.454 UTC] INFO   module "kstat" registered nic.bytes
[2015-06-12 23:51:11.455 UTC] INFO   module "kstat" registered nic.packets
[2015-06-12 23:51:11.455 UTC] INFO   module "kstat" registered nic.vnic_bytes
[2015-06-12 23:51:11.455 UTC] INFO   module "kstat" registered nic.vnic_packets
[2015-06-12 23:51:11.455 UTC] INFO   module "kstat" registered disk.disks
[2015-06-12 23:51:11.456 UTC] INFO   module "kstat" registered disk.physio_ops
[2015-06-12 23:51:11.456 UTC] INFO   module "kstat" registered disk.physio_bytes
[2015-06-12 23:51:11.456 UTC] INFO   module "kstat" registered tcp.segments
[2015-06-12 23:51:11.456 UTC] INFO   module "kstat" registered tcp.errors
[2015-06-12 23:51:11.457 UTC] INFO   module "kstat" registered fs.logical_rwops
[2015-06-12 23:51:11.457 UTC] INFO   module "kstat" registered fs.logical_rwbytes
[2015-06-12 23:51:11.457 UTC] INFO   module "kstat" registered memory.rss
[2015-06-12 23:51:11.457 UTC] INFO   module "kstat" registered memory.rss_limit
[2015-06-12 23:51:11.458 UTC] INFO   module "kstat" registered memory.swap
[2015-06-12 23:51:11.458 UTC] INFO   module "kstat" registered memory.swap_limit
[2015-06-12 23:51:11.459 UTC] INFO   module "kstat" registered memory.reclaimed_bytes
[2015-06-12 23:51:11.459 UTC] INFO   module "kstat" registered memory.pageins
[2015-06-12 23:51:11.459 UTC] INFO   module "kstat" registered vm.exits
[2015-06-12 23:51:11.459 UTC] INFO   module "kstat" registered zfs.arc_ops
[2015-06-12 23:51:11.459 UTC] INFO   loaded module "kstat".
[2015-06-12 23:51:11.522 UTC] INFO   module "dtrace" registered apache.httpd_ops
[2015-06-12 23:51:11.523 UTC] INFO   module "dtrace" registered cpu.thread_executions
[2015-06-12 23:51:11.525 UTC] INFO   module "dtrace" registered cpu.thread_samples
[2015-06-12 23:51:11.527 UTC] INFO   module "dtrace" registered disk.physio_ops
[2015-06-12 23:51:11.530 UTC] INFO   module "dtrace" registered fs.logical_ops
[2015-06-12 23:51:11.533 UTC] INFO   module "dtrace" registered fs.logical_rwops
[2015-06-12 23:51:11.534 UTC] INFO   module "dtrace" registered ldapjs.connections
[2015-06-12 23:51:11.538 UTC] INFO   module "dtrace" registered ldapjs.ops
[2015-06-12 23:51:11.539 UTC] INFO   module "dtrace" registered ldapjs.search_ops
[2015-06-12 23:51:11.540 UTC] INFO   module "dtrace" registered mantaop.jobs_assigned
[2015-06-12 23:51:11.543 UTC] INFO   module "dtrace" registered mantaop.supervisor_auths
[2015-06-12 23:51:11.545 UTC] INFO   module "dtrace" registered mantaop.supervisor_deletes
[2015-06-12 23:51:11.547 UTC] INFO   module "dtrace" registered mantaop.supervisor_errors
[2015-06-12 23:51:11.548 UTC] INFO   module "dtrace" registered mantaop.supervisor_locates
[2015-06-12 23:51:11.549 UTC] INFO   module "dtrace" registered mantaop.tasks_committed
[2015-06-12 23:51:11.551 UTC] INFO   module "dtrace" registered mantaop.tasks_dispatched
[2015-06-12 23:51:11.552 UTC] INFO   module "dtrace" registered mantaop.tasks_executed
[2015-06-12 23:51:11.553 UTC] INFO   module "dtrace" registered mantaop.tasks_killed
[2015-06-12 23:51:11.554 UTC] INFO   module "dtrace" registered mantaop.zone_resets
[2015-06-12 23:51:11.556 UTC] INFO   module "dtrace" registered moray.ops
[2015-06-12 23:51:11.558 UTC] INFO   module "dtrace" registered moray.queries
[2015-06-12 23:51:11.559 UTC] INFO   module "dtrace" registered mysql.commands
[2015-06-12 23:51:11.560 UTC] INFO   module "dtrace" registered mysql.connections
[2015-06-12 23:51:11.562 UTC] INFO   module "dtrace" registered mysql.filesort
[2015-06-12 23:51:11.564 UTC] INFO   module "dtrace" registered mysql.queries
[2015-06-12 23:51:11.566 UTC] INFO   module "dtrace" registered mysql.statements
[2015-06-12 23:51:11.568 UTC] INFO   module "dtrace" registered node.gc_ops
[2015-06-12 23:51:11.571 UTC] INFO   module "dtrace" registered node.httpc_ops
[2015-06-12 23:51:11.575 UTC] INFO   module "dtrace" registered node.httpd_ops
[2015-06-12 23:51:11.579 UTC] INFO   module "dtrace" registered node.socket_ops
[2015-06-12 23:51:11.581 UTC] INFO   module "dtrace" registered postgres.queries
[2015-06-12 23:51:11.582 UTC] INFO   module "dtrace" registered unix.proc_execs
[2015-06-12 23:51:11.584 UTC] INFO   module "dtrace" registered unix.proc_exits
[2015-06-12 23:51:11.585 UTC] INFO   module "dtrace" registered unix.proc_forks
[2015-06-12 23:51:11.588 UTC] INFO   module "dtrace" registered restify.handler_ops
[2015-06-12 23:51:11.590 UTC] INFO   module "dtrace" registered restify.server_ops
[2015-06-12 23:51:11.592 UTC] INFO   module "dtrace" registered syscall.syscalls
[2015-06-12 23:51:11.594 UTC] INFO   module "dtrace" registered tcp.accepts
[2015-06-12 23:51:11.595 UTC] INFO   module "dtrace" registered tcp.connects
[2015-06-12 23:51:11.597 UTC] INFO   module "dtrace" registered unix.thr_creates
[2015-06-12 23:51:11.598 UTC] INFO   module "dtrace" registered vm.irqs
[2015-06-12 23:51:11.599 UTC] INFO   module "dtrace" registered vm.physio_bytes
[2015-06-12 23:51:11.601 UTC] INFO   module "dtrace" registered vm.physio_ops
[2015-06-12 23:51:11.602 UTC] INFO   module "dtrace" registered vm.thread_samples
[2015-06-12 23:51:11.604 UTC] INFO   module "dtrace" registered zfs.arc_ops
[2015-06-12 23:51:11.604 UTC] INFO   loaded module "dtrace".
[2015-06-12 23:51:11.613 UTC] INFO   module "zfs" registered zfs.dataset_unused_quota
[2015-06-12 23:51:11.613 UTC] INFO   module "zfs" registered zfs.dataset_used
[2015-06-12 23:51:11.613 UTC] INFO   module "zfs" registered zfs.dataset_quota
[2015-06-12 23:51:11.613 UTC] INFO   module "zfs" registered zfs.pool_free
[2015-06-12 23:51:11.613 UTC] INFO   module "zfs" registered zfs.pool_used
[2015-06-12 23:51:11.613 UTC] INFO   module "zfs" registered zfs.pool_total
[2015-06-12 23:51:11.614 UTC] INFO   loaded module "zfs".
[2015-06-12 23:51:11.616 UTC] INFO   module "cainstr" registered ca.instr_ticks
[2015-06-12 23:51:11.616 UTC] INFO   module "cainstr" registered ca.instr_beops
[2015-06-12 23:51:11.616 UTC] INFO   module "cainstr" registered ca.instr_enables
[2015-06-12 23:51:11.616 UTC] INFO   module "cainstr" registered ca.instr_disables
[2015-06-12 23:51:11.616 UTC] INFO   loaded module "cainstr".
[2015-06-12 23:51:11.710 UTC] INFO   module "proc" registered unix.processes
[2015-06-12 23:51:11.710 UTC] INFO   loaded module "proc".
[2015-06-12 23:51:11.710 UTC] INFO   finished loading modules.
[2015-06-12 23:54:22.860 UTC] ERROR  ca-amqp: received connection error: EXCEPTION: Error: Error: connect ETIMEDOUT
    at errnoException (net.js:646:11)
    at Object.afterConnect [as oncomplete] (net.js:637:18)
[2015-06-12 23:54:23.040 UTC] WARN   EXCEPTION: caError: amqp error "ETIMEDOUT": connect ETIMEDOUT
    at capAmqpCap.error (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp-cap.js:390:9)
    at caAmqp.<anonymous> (native)
    at caAmqp.emit (events.js:67:17)
    at caAmqp.connError (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp.js:307:7)
    at Connection.<anonymous> (native)
    at Connection.emit (events.js:67:17)
    at Array.0 (net.js:319:25)
    at EventEmitter._tickCallback (node.js:192:40)
[2015-06-12 23:54:23.041 UTC] DBG    ca-amqp: received close event
[2015-06-12 23:54:23.100 UTC] WARN   ca-amqp: connection closing
[2015-06-12 23:54:23.100 UTC] INFO   ca-amqp: trying to reconnect (attempt 1)
[2015-06-12 23:57:39.352 UTC] ERROR  ca-amqp: received connection error: EXCEPTION: Error: Error: connect ETIMEDOUT
    at errnoException (net.js:646:11)
    at Object.afterConnect [as oncomplete] (net.js:637:18)
[2015-06-12 23:57:39.354 UTC] WARN   EXCEPTION: caError: amqp error "ETIMEDOUT": connect ETIMEDOUT
    at capAmqpCap.error (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp-cap.js:390:9)
    at caAmqp.<anonymous> (native)
    at caAmqp.emit (events.js:67:17)
    at caAmqp.connError (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp.js:307:7)
    at Connection.<anonymous> (native)
    at Connection.emit (events.js:67:17)
    at Array.0 (net.js:319:25)
    at EventEmitter._tickCallback (node.js:192:40)
[2015-06-12 23:57:39.355 UTC] DBG    ca-amqp: received close event
[2015-06-12 23:57:39.356 UTC] WARN   ca-amqp: connection closing
[2015-06-12 23:57:39.356 UTC] INFO   ca-amqp: trying to reconnect (attempt 2)
[2015-06-13 00:00:58.222 UTC] ERROR  ca-amqp: received connection error: EXCEPTION: Error: Error: connect ETIMEDOUT
    at errnoException (net.js:646:11)
    at Object.afterConnect [as oncomplete] (net.js:637:18)
[2015-06-13 00:00:58.609 UTC] WARN   EXCEPTION: caError: amqp error "ETIMEDOUT": connect ETIMEDOUT
    at capAmqpCap.error (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp-cap.js:390:9)
    at caAmqp.<anonymous> (native)
    at caAmqp.emit (events.js:67:17)
    at caAmqp.connError (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp.js:307:7)
    at Connection.<anonymous> (native)
    at Connection.emit (events.js:67:17)
    at Array.0 (net.js:319:25)
    at EventEmitter._tickCallback (node.js:192:40)
[2015-06-13 00:00:58.757 UTC] DBG    ca-amqp: received close event
[2015-06-13 00:00:58.757 UTC] WARN   ca-amqp: connection closing
[2015-06-13 00:00:58.757 UTC] INFO   ca-amqp: trying to reconnect (attempt 3)
[2015-06-13 00:04:17.964 UTC] ERROR  ca-amqp: received connection error: EXCEPTION: Error: Error: connect ETIMEDOUT
    at errnoException (net.js:646:11)
    at Object.afterConnect [as oncomplete] (net.js:637:18)
[2015-06-13 00:04:17.970 UTC] WARN   EXCEPTION: caError: amqp error "ETIMEDOUT": connect ETIMEDOUT
    at capAmqpCap.error (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp-cap.js:390:9)
    at caAmqp.<anonymous> (native)
    at caAmqp.emit (events.js:67:17)
    at caAmqp.connError (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp.js:307:7)
    at Connection.<anonymous> (native)
    at Connection.emit (events.js:67:17)
    at Array.0 (net.js:319:25)
    at EventEmitter._tickCallback (node.js:192:40)
[2015-06-13 00:04:17.970 UTC] DBG    ca-amqp: received close event
[2015-06-13 00:04:17.971 UTC] WARN   ca-amqp: connection closing
[2015-06-13 00:04:17.971 UTC] INFO   ca-amqp: trying to reconnect (attempt 4)
[2015-06-13 00:07:34.462 UTC] ERROR  ca-amqp: received connection error: EXCEPTION: Error: Error: connect ETIMEDOUT
    at errnoException (net.js:646:11)
    at Object.afterConnect [as oncomplete] (net.js:637:18)
[2015-06-13 00:07:34.465 UTC] WARN   EXCEPTION: caError: amqp error "ETIMEDOUT": connect ETIMEDOUT
    at capAmqpCap.error (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp-cap.js:390:9)
    at caAmqp.<anonymous> (native)
    at caAmqp.emit (events.js:67:17)
    at caAmqp.connError (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp.js:307:7)
    at Connection.<anonymous> (native)
    at Connection.emit (events.js:67:17)
    at Array.0 (net.js:319:25)
    at EventEmitter._tickCallback (node.js:192:40)
[2015-06-13 00:07:34.466 UTC] DBG    ca-amqp: received close event
[2015-06-13 00:07:34.466 UTC] WARN   ca-amqp: connection closing
[2015-06-13 00:07:34.466 UTC] INFO   ca-amqp: trying to reconnect (attempt 5)
[2015-06-13 00:10:50.493 UTC] ERROR  ca-amqp: received connection error: EXCEPTION: Error: Error: connect ETIMEDOUT
    at errnoException (net.js:646:11)
    at Object.afterConnect [as oncomplete] (net.js:637:18)
[2015-06-13 00:10:50.515 UTC] WARN   EXCEPTION: caError: amqp error "ETIMEDOUT": connect ETIMEDOUT
    at capAmqpCap.error (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp-cap.js:390:9)
    at caAmqp.<anonymous> (native)
    at caAmqp.emit (events.js:67:17)
    at caAmqp.connError (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp.js:307:7)
    at Connection.<anonymous> (native)
    at Connection.emit (events.js:67:17)
    at Array.0 (net.js:319:25)
    at EventEmitter._tickCallback (node.js:192:40)
[2015-06-13 00:10:50.515 UTC] DBG    ca-amqp: received close event
[2015-06-13 00:10:50.515 UTC] WARN   ca-amqp: connection closing
[2015-06-13 00:10:50.515 UTC] INFO   ca-amqp: trying to reconnect (attempt 6)
[2015-06-13 00:10:55.660 UTC] DBG    binding to ca.instrumenter.headnode
[2015-06-13 00:10:55.661 UTC] DBG    binding to ca.broadcast
[2015-06-13 00:10:55.663 UTC] DBG    bind to ca.instrumenter.headnode complete
[2015-06-13 00:10:55.663 UTC] DBG    bind to ca.broadcast complete
[2015-06-13 00:10:55.664 UTC] INFO   AMQP broker connected.
[2015-06-13 00:13:32.343 UTC] INFO   config service restarted
[2015-06-13 00:47:38.211 UTC] DBG    
----------------------------------------
this int state;

sched:::on-cpu
/((curthread->t_pri != -1))/{
	self->runtime0 = timestamp;
}

sched:::off-cpu
/((((((self->runtime0) != NULL)))) && (((((this->state = curlwpsinfo->pr_state) != NULL || 1)))) && (curthread->t_pri != -1))/{
	@[(execname)] = llquantize((timestamp - self->runtime0), 10, 3, 11, 100);
}

sched:::off-cpu
/((curthread->t_pri != -1))/{
	(self->runtime0) = 0;
}

----------------------------------------
[2015-06-13 00:47:41.474 UTC] INFO   instrumented global;1 (cpu.thread_executions)
[2015-06-13 00:48:57.368 UTC] DBG    
----------------------------------------
this string fstype;

fbt::fop_read:entry,
fbt::fop_write:entry,
fbt::fop_ioctl:entry,
fbt::fop_access:entry,
fbt::fop_getattr:entry,
fbt::fop_setattr:entry,
fbt::fop_lookup:entry,
fbt::fop_create:entry,
fbt::fop_remove:entry,
fbt::fop_link:entry,
fbt::fop_rename:entry,
fbt::fop_mkdir:entry,
fbt::fop_rmdir:entry,
fbt::fop_readdir:entry,
fbt::fop_symlink:entry,
fbt::fop_readlink:entry,
fbt::fop_fsync:entry,
fbt::fop_getpage:entry,
fbt::fop_putpage:entry,
fbt::fop_map:entry,
fbt::fop_open:entry
/((self->vnode0 == NULL))/{
	self->vnode0 = arg0;
	self->depth0 = stackdepth;
}

fbt::fop_open:return
/((((((self->vnode0) != NULL)))) && (((((self->depth0) != NULL)))) && (((((this->fstype = stringof((*((vnode_t**)self->vnode0))->v_op->vnop_name)) != NULL || 1)))) && (self->depth0 == stackdepth && self->vnode0 != NULL && (this->fstype == "ufs" || this->fstype == "zfs" || this->fstype == "dev" || this->fstype == "dev fs" || this->fstype == "proc" || this->fstype == "lofs" || this->fstype == "tmpfs" || this->fstype == "nfs")))/{
	@ = count();
}

fbt::fop_read:return,
fbt::fop_write:return,
fbt::fop_ioctl:return,
fbt::fop_access:return,
fbt::fop_getattr:return,
fbt::fop_setattr:return,
fbt::fop_lookup:return,
fbt::fop_create:return,
fbt::fop_remove:return,
fbt::fop_link:return,
fbt::fop_rename:return,
fbt::fop_mkdir:return,
fbt::fop_rmdir:return,
fbt::fop_readdir:return,
fbt::fop_symlink:return,
fbt::fop_readlink:return,
fbt::fop_fsync:return,
fbt::fop_getpage:return,
fbt::fop_putpage:return,
fbt::fop_map:return
/((((((self->vnode0) != NULL)))) && (((((self->depth0) != NULL)))) && (((((this->fstype = stringof(((vnode_t*)self->vnode0)->v_op->vnop_name)) != NULL || 1)))) && (self->depth0 == stackdepth && self->vnode0 != NULL && (this->fstype == "ufs" || this->fstype == "zfs" || this->fstype == "dev" || this->fstype == "dev fs" || this->fstype == "proc" || this->fstype == "lofs" || this->fstype == "tmpfs" || this->fstype == "nfs")))/{
	@ = count();
}

fbt::fop_read:return,
fbt::fop_write:return,
fbt::fop_ioctl:return,
fbt::fop_access:return,
fbt::fop_getattr:return,
fbt::fop_setattr:return,
fbt::fop_lookup:return,
fbt::fop_create:return,
fbt::fop_remove:return,
fbt::fop_link:return,
fbt::fop_rename:return,
fbt::fop_mkdir:return,
fbt::fop_rmdir:return,
fbt::fop_readdir:return,
fbt::fop_symlink:return,
fbt::fop_readlink:return,
fbt::fop_fsync:return,
fbt::fop_getpage:return,
fbt::fop_putpage:return,
fbt::fop_map:return,
fbt::fop_open:entry
/((self->depth0 == stackdepth))/{
	(self->vnode0) = 0;
	(self->depth0) = 0;
}

----------------------------------------
[2015-06-13 00:49:00.405 UTC] INFO   instrumented global;2 (fs.logical_ops)
[2015-06-13 00:49:43.870 UTC] DBG    
----------------------------------------
this string fstype;

fbt::fop_read:entry,
fbt::fop_write:entry,
fbt::fop_ioctl:entry,
fbt::fop_access:entry,
fbt::fop_getattr:entry,
fbt::fop_setattr:entry,
fbt::fop_lookup:entry,
fbt::fop_create:entry,
fbt::fop_remove:entry,
fbt::fop_link:entry,
fbt::fop_rename:entry,
fbt::fop_mkdir:entry,
fbt::fop_rmdir:entry,
fbt::fop_readdir:entry,
fbt::fop_symlink:entry,
fbt::fop_readlink:entry,
fbt::fop_fsync:entry,
fbt::fop_getpage:entry,
fbt::fop_putpage:entry,
fbt::fop_map:entry,
fbt::fop_open:entry
/((self->vnode0 == NULL))/{
	self->vnode0 = arg0;
	self->depth0 = stackdepth;
	self->latency0 = timestamp;
}

fbt::fop_open:return
/((((((self->vnode0) != NULL)))) && (((((self->depth0) != NULL)))) && (((((self->latency0) != NULL)))) && (((((this->fstype = stringof((*((vnode_t**)self->vnode0))->v_op->vnop_name)) != NULL || 1)))) && (self->depth0 == stackdepth && self->vnode0 != NULL && (this->fstype == "ufs" || this->fstype == "zfs" || this->fstype == "dev" || this->fstype == "dev fs" || this->fstype == "proc" || this->fstype == "lofs" || this->fstype == "tmpfs" || this->fstype == "nfs")))/{
	@[((probefunc + 4))] = llquantize((timestamp - self->latency0), 10, 3, 11, 100);
}

fbt::fop_read:return,
fbt::fop_write:return,
fbt::fop_ioctl:return,
fbt::fop_access:return,
fbt::fop_getattr:return,
fbt::fop_setattr:return,
fbt::fop_lookup:return,
fbt::fop_create:return,
fbt::fop_remove:return,
fbt::fop_link:return,
fbt::fop_rename:return,
fbt::fop_mkdir:return,
fbt::fop_rmdir:return,
fbt::fop_readdir:return,
fbt::fop_symlink:return,
fbt::fop_readlink:return,
fbt::fop_fsync:return,
fbt::fop_getpage:return,
fbt::fop_putpage:return,
fbt::fop_map:return
/((((((self->vnode0) != NULL)))) && (((((self->depth0) != NULL)))) && (((((self->latency0) != NULL)))) && (((((this->fstype = stringof(((vnode_t*)self->vnode0)->v_op->vnop_name)) != NULL || 1)))) && (self->depth0 == stackdepth && self->vnode0 != NULL && (this->fstype == "ufs" || this->fstype == "zfs" || this->fstype == "dev" || this->fstype == "dev fs" || this->fstype == "proc" || this->fstype == "lofs" || this->fstype == "tmpfs" || this->fstype == "nfs")))/{
	@[((probefunc + 4))] = llquantize((timestamp - self->latency0), 10, 3, 11, 100);
}

fbt::fop_read:return,
fbt::fop_write:return,
fbt::fop_ioctl:return,
fbt::fop_access:return,
fbt::fop_getattr:return,
fbt::fop_setattr:return,
fbt::fop_lookup:return,
fbt::fop_create:return,
fbt::fop_remove:return,
fbt::fop_link:return,
fbt::fop_rename:return,
fbt::fop_mkdir:return,
fbt::fop_rmdir:return,
fbt::fop_readdir:return,
fbt::fop_symlink:return,
fbt::fop_readlink:return,
fbt::fop_fsync:return,
fbt::fop_getpage:return,
fbt::fop_putpage:return,
fbt::fop_map:return,
fbt::fop_open:entry
/((self->depth0 == stackdepth))/{
	(self->vnode0) = 0;
	(self->depth0) = 0;
	(self->latency0) = 0;
}

----------------------------------------
[2015-06-13 00:49:46.309 UTC] INFO   instrumented global;3 (fs.logical_ops)
[2015-06-13 00:49:46.316 UTC] INFO   deinstrumented global;2
[2015-06-13 00:52:37.306 UTC] INFO   deinstrumented global;3
[2015-06-13 00:52:42.236 UTC] INFO   deinstrumented global;1
[2015-06-13 01:17:40.763 UTC] INFO   config service restarted
[2015-06-13 01:21:24.715 UTC] DBG    
----------------------------------------
this string fstype;

fbt::fop_read:entry,
fbt::fop_write:entry,
fbt::fop_ioctl:entry,
fbt::fop_access:entry,
fbt::fop_getattr:entry,
fbt::fop_setattr:entry,
fbt::fop_lookup:entry,
fbt::fop_create:entry,
fbt::fop_remove:entry,
fbt::fop_link:entry,
fbt::fop_rename:entry,
fbt::fop_mkdir:entry,
fbt::fop_rmdir:entry,
fbt::fop_readdir:entry,
fbt::fop_symlink:entry,
fbt::fop_readlink:entry,
fbt::fop_fsync:entry,
fbt::fop_getpage:entry,
fbt::fop_putpage:entry,
fbt::fop_map:entry,
fbt::fop_open:entry
/((self->vnode0 == NULL))/{
	self->vnode0 = arg0;
	self->depth0 = stackdepth;
	self->latency0 = timestamp;
}

fbt::fop_open:return
/((((((self->vnode0) != NULL)))) && (((((self->depth0) != NULL)))) && (((((self->latency0) != NULL)))) && (((((this->fstype = stringof((*((vnode_t**)self->vnode0))->v_op->vnop_name)) != NULL || 1)))) && (self->depth0 == stackdepth && self->vnode0 != NULL && (this->fstype == "ufs" || this->fstype == "zfs" || this->fstype == "dev" || this->fstype == "dev fs" || this->fstype == "proc" || this->fstype == "lofs" || this->fstype == "tmpfs" || this->fstype == "nfs")))/{
	@[((probefunc + 4))] = llquantize((timestamp - self->latency0), 10, 3, 11, 100);
}

fbt::fop_read:return,
fbt::fop_write:return,
fbt::fop_ioctl:return,
fbt::fop_access:return,
fbt::fop_getattr:return,
fbt::fop_setattr:return,
fbt::fop_lookup:return,
fbt::fop_create:return,
fbt::fop_remove:return,
fbt::fop_link:return,
fbt::fop_rename:return,
fbt::fop_mkdir:return,
fbt::fop_rmdir:return,
fbt::fop_readdir:return,
fbt::fop_symlink:return,
fbt::fop_readlink:return,
fbt::fop_fsync:return,
fbt::fop_getpage:return,
fbt::fop_putpage:return,
fbt::fop_map:return
/((((((self->vnode0) != NULL)))) && (((((self->depth0) != NULL)))) && (((((self->latency0) != NULL)))) && (((((this->fstype = stringof(((vnode_t*)self->vnode0)->v_op->vnop_name)) != NULL || 1)))) && (self->depth0 == stackdepth && self->vnode0 != NULL && (this->fstype == "ufs" || this->fstype == "zfs" || this->fstype == "dev" || this->fstype == "dev fs" || this->fstype == "proc" || this->fstype == "lofs" || this->fstype == "tmpfs" || this->fstype == "nfs")))/{
	@[((probefunc + 4))] = llquantize((timestamp - self->latency0), 10, 3, 11, 100);
}

fbt::fop_read:return,
fbt::fop_write:return,
fbt::fop_ioctl:return,
fbt::fop_access:return,
fbt::fop_getattr:return,
fbt::fop_setattr:return,
fbt::fop_lookup:return,
fbt::fop_create:return,
fbt::fop_remove:return,
fbt::fop_link:return,
fbt::fop_rename:return,
fbt::fop_mkdir:return,
fbt::fop_rmdir:return,
fbt::fop_readdir:return,
fbt::fop_symlink:return,
fbt::fop_readlink:return,
fbt::fop_fsync:return,
fbt::fop_getpage:return,
fbt::fop_putpage:return,
fbt::fop_map:return,
fbt::fop_open:entry
/((self->depth0 == stackdepth))/{
	(self->vnode0) = 0;
	(self->depth0) = 0;
	(self->latency0) = 0;
}

----------------------------------------
[2015-06-13 01:21:27.191 UTC] INFO   instrumented global;1 (fs.logical_ops)
[2015-06-13 01:23:24.207 UTC] INFO   kstat: { module: 'memory_cap' }
decomps: [ 'hostname' ]
predicate: {}
[2015-06-13 01:23:24.208 UTC] INFO   instrumented global;2 (memory.rss)
[2015-06-13 01:24:10.736 UTC] DBG    
----------------------------------------
this int state;

sched:::on-cpu
/((curthread->t_pri != -1))/{
	self->runtime0 = timestamp;
}

sched:::off-cpu
/((((((self->runtime0) != NULL)))) && (((((this->state = curlwpsinfo->pr_state) != NULL || 1)))) && (curthread->t_pri != -1))/{
	@[((this->state == SRUN ? "runnable" : this->state == SZOMB ? "exited" : this->state == SSTOP ? "stopped" : this->state == SIDL ? "in proc creation" : this->state == SONPROC ? "on-cpu" : this->state == SWAIT ? "waiting to be runnable" :this->state == SSLEEP ? "sleeping" : "unknown"))] = llquantize((timestamp - self->runtime0), 10, 3, 11, 100);
}

sched:::off-cpu
/((curthread->t_pri != -1))/{
	(self->runtime0) = 0;
}

----------------------------------------
[2015-06-13 01:24:11.928 UTC] INFO   instrumented global;3 (cpu.thread_executions)
[2015-06-13 01:25:14.166 UTC] INFO   deinstrumented global;2
[2015-06-13 01:30:36.874 UTC] INFO   config service restarted
[2015-06-13 01:31:26.630 UTC] DBG    
----------------------------------------
this int state;

sched:::on-cpu
/((curthread->t_pri != -1))/{
	self->runtime0 = timestamp;
}

sched:::off-cpu
/((((((self->runtime0) != NULL)))) && (((((this->state = curlwpsinfo->pr_state) != NULL || 1)))) && (curthread->t_pri != -1))/{
	@[(execname)] = llquantize((timestamp - self->runtime0), 10, 3, 11, 100);
}

sched:::off-cpu
/((curthread->t_pri != -1))/{
	(self->runtime0) = 0;
}

----------------------------------------
[2015-06-13 01:31:27.871 UTC] INFO   instrumented global;4 (cpu.thread_executions)
[2015-06-13 01:31:46.987 UTC] DBG    
----------------------------------------
this string fstype;

fbt::fop_read:entry,
fbt::fop_write:entry,
fbt::fop_ioctl:entry,
fbt::fop_access:entry,
fbt::fop_getattr:entry,
fbt::fop_setattr:entry,
fbt::fop_lookup:entry,
fbt::fop_create:entry,
fbt::fop_remove:entry,
fbt::fop_link:entry,
fbt::fop_rename:entry,
fbt::fop_mkdir:entry,
fbt::fop_rmdir:entry,
fbt::fop_readdir:entry,
fbt::fop_symlink:entry,
fbt::fop_readlink:entry,
fbt::fop_fsync:entry,
fbt::fop_getpage:entry,
fbt::fop_putpage:entry,
fbt::fop_map:entry,
fbt::fop_open:entry
/((self->vnode0 == NULL))/{
	self->vnode0 = arg0;
	self->depth0 = stackdepth;
	self->latency0 = timestamp;
}

fbt::fop_open:return
/((((((self->vnode0) != NULL)))) && (((((self->depth0) != NULL)))) && (((((self->latency0) != NULL)))) && (((((this->fstype = stringof((*((vnode_t**)self->vnode0))->v_op->vnop_name)) != NULL || 1)))) && (self->depth0 == stackdepth && self->vnode0 != NULL && (this->fstype == "ufs" || this->fstype == "zfs" || this->fstype == "dev" || this->fstype == "dev fs" || this->fstype == "proc" || this->fstype == "lofs" || this->fstype == "tmpfs" || this->fstype == "nfs")))/{
	@[((probefunc + 4))] = llquantize((timestamp - self->latency0), 10, 3, 11, 100);
}

fbt::fop_read:return,
fbt::fop_write:return,
fbt::fop_ioctl:return,
fbt::fop_access:return,
fbt::fop_getattr:return,
fbt::fop_setattr:return,
fbt::fop_lookup:return,
fbt::fop_create:return,
fbt::fop_remove:return,
fbt::fop_link:return,
fbt::fop_rename:return,
fbt::fop_mkdir:return,
fbt::fop_rmdir:return,
fbt::fop_readdir:return,
fbt::fop_symlink:return,
fbt::fop_readlink:return,
fbt::fop_fsync:return,
fbt::fop_getpage:return,
fbt::fop_putpage:return,
fbt::fop_map:return
/((((((self->vnode0) != NULL)))) && (((((self->depth0) != NULL)))) && (((((self->latency0) != NULL)))) && (((((this->fstype = stringof(((vnode_t*)self->vnode0)->v_op->vnop_name)) != NULL || 1)))) && (self->depth0 == stackdepth && self->vnode0 != NULL && (this->fstype == "ufs" || this->fstype == "zfs" || this->fstype == "dev" || this->fstype == "dev fs" || this->fstype == "proc" || this->fstype == "lofs" || this->fstype == "tmpfs" || this->fstype == "nfs")))/{
	@[((probefunc + 4))] = llquantize((timestamp - self->latency0), 10, 3, 11, 100);
}

fbt::fop_read:return,
fbt::fop_write:return,
fbt::fop_ioctl:return,
fbt::fop_access:return,
fbt::fop_getattr:return,
fbt::fop_setattr:return,
fbt::fop_lookup:return,
fbt::fop_create:return,
fbt::fop_remove:return,
fbt::fop_link:return,
fbt::fop_rename:return,
fbt::fop_mkdir:return,
fbt::fop_rmdir:return,
fbt::fop_readdir:return,
fbt::fop_symlink:return,
fbt::fop_readlink:return,
fbt::fop_fsync:return,
fbt::fop_getpage:return,
fbt::fop_putpage:return,
fbt::fop_map:return,
fbt::fop_open:entry
/((self->depth0 == stackdepth))/{
	(self->vnode0) = 0;
	(self->depth0) = 0;
	(self->latency0) = 0;
}

----------------------------------------
[2015-06-13 01:31:49.170 UTC] INFO   instrumented global;5 (fs.logical_ops)
[2015-06-13 01:32:20.516 UTC] DBG    ca-amqp: received close event
[2015-06-13 01:32:20.517 UTC] WARN   ca-amqp: connection closing
[2015-06-13 01:32:20.517 UTC] INFO   ca-amqp: trying to reconnect (attempt 1)
[ Jun 13 13:34:55 Enabled. ]
[ Jun 13 13:34:55 Rereading configuration. ]
[ Jun 13 13:35:00 Executing start method ("/opt/smartdc/agents/lib/node_modules/cabase/smf/method/canodesvc"). ]
DTRACE_LIBPATH=/opt/smartdc/agents/lib/node_modules/cabase/lib
ignoring amqp-config key amqp_login
ignoring amqp-config key amqp_password
AMQP_HOST=10.99.99.20
AMQP_PORT=5672
NODE_PATH=:/opt/smartdc/agents/lib/node_modules/cabase/node_modules:/opt/smartdc/agents/lib/node_modules/cabase/node_modules/connect/lib:/opt/smartdc/agents/lib/node_modules/cabase/lib/ca:/opt/smartdc/agents/lib/node_modules/cabase/lib/tst
[ Jun 13 13:35:02 Method "start" exited with status 0. ]
The "sys" module is now called "util". It should have a similar interface.
using backends kstat,dtrace,zfs,cainstr,proc
[2015-06-13 13:35:05.941 UTC] INFO   Logging AMQP message to "/opt/smartdc/agents/log/ca/cainstsvc/amqp-2015-06-13.13:35:00.2801"
[2015-06-13 13:35:05.943 UTC] INFO   Instrumenter starting up (instsvc/0.0)
[2015-06-13 13:35:05.943 UTC] INFO   Hostname:    headnode
[2015-06-13 13:35:05.943 UTC] INFO   AMQP broker: {"host":"10.99.99.20","port":"5672"}
[2015-06-13 13:35:05.943 UTC] INFO   Routing key: ca.instrumenter.headnode
[2015-06-13 13:35:06.034 UTC] DBG    loaded metadata file "metadata/profile/customer.json"
[2015-06-13 13:35:06.035 UTC] DBG    loaded metadata file "metadata/profile/operator.json"
[2015-06-13 13:35:06.046 UTC] DBG    loaded metadata file "metadata/metric/metrics.json"
[2015-06-13 13:35:06.059 UTC] INFO   loading modules.
[2015-06-13 13:35:06.163 UTC] INFO   module "kstat" registered cpu.cpus
[2015-06-13 13:35:06.163 UTC] INFO   module "kstat" registered cpu.usage
[2015-06-13 13:35:06.164 UTC] INFO   module "kstat" registered cpu.waittime
[2015-06-13 13:35:06.164 UTC] INFO   module "kstat" registered cpu.loadavg1
[2015-06-13 13:35:06.164 UTC] INFO   module "kstat" registered nic.nics
[2015-06-13 13:35:06.164 UTC] INFO   module "kstat" registered nic.bytes
[2015-06-13 13:35:06.165 UTC] INFO   module "kstat" registered nic.packets
[2015-06-13 13:35:06.165 UTC] INFO   module "kstat" registered nic.vnic_bytes
[2015-06-13 13:35:06.165 UTC] INFO   module "kstat" registered nic.vnic_packets
[2015-06-13 13:35:06.165 UTC] INFO   module "kstat" registered disk.disks
[2015-06-13 13:35:06.166 UTC] INFO   module "kstat" registered disk.physio_ops
[2015-06-13 13:35:06.166 UTC] INFO   module "kstat" registered disk.physio_bytes
[2015-06-13 13:35:06.166 UTC] INFO   module "kstat" registered tcp.segments
[2015-06-13 13:35:06.166 UTC] INFO   module "kstat" registered tcp.errors
[2015-06-13 13:35:06.166 UTC] INFO   module "kstat" registered fs.logical_rwops
[2015-06-13 13:35:06.166 UTC] INFO   module "kstat" registered fs.logical_rwbytes
[2015-06-13 13:35:06.167 UTC] INFO   module "kstat" registered memory.rss
[2015-06-13 13:35:06.167 UTC] INFO   module "kstat" registered memory.rss_limit
[2015-06-13 13:35:06.167 UTC] INFO   module "kstat" registered memory.swap
[2015-06-13 13:35:06.167 UTC] INFO   module "kstat" registered memory.swap_limit
[2015-06-13 13:35:06.167 UTC] INFO   module "kstat" registered memory.reclaimed_bytes
[2015-06-13 13:35:06.168 UTC] INFO   module "kstat" registered memory.pageins
[2015-06-13 13:35:06.168 UTC] INFO   module "kstat" registered vm.exits
[2015-06-13 13:35:06.168 UTC] INFO   module "kstat" registered zfs.arc_ops
[2015-06-13 13:35:06.168 UTC] INFO   loaded module "kstat".
[2015-06-13 13:35:06.394 UTC] INFO   module "dtrace" registered apache.httpd_ops
[2015-06-13 13:35:06.418 UTC] INFO   module "dtrace" registered cpu.thread_executions
[2015-06-13 13:35:06.419 UTC] INFO   module "dtrace" registered cpu.thread_samples
[2015-06-13 13:35:06.421 UTC] INFO   module "dtrace" registered disk.physio_ops
[2015-06-13 13:35:06.424 UTC] INFO   module "dtrace" registered fs.logical_ops
[2015-06-13 13:35:06.426 UTC] INFO   module "dtrace" registered fs.logical_rwops
[2015-06-13 13:35:06.427 UTC] INFO   module "dtrace" registered ldapjs.connections
[2015-06-13 13:35:06.431 UTC] INFO   module "dtrace" registered ldapjs.ops
[2015-06-13 13:35:06.432 UTC] INFO   module "dtrace" registered ldapjs.search_ops
[2015-06-13 13:35:06.433 UTC] INFO   module "dtrace" registered mantaop.jobs_assigned
[2015-06-13 13:35:06.434 UTC] INFO   module "dtrace" registered mantaop.supervisor_auths
[2015-06-13 13:35:06.437 UTC] INFO   module "dtrace" registered mantaop.supervisor_deletes
[2015-06-13 13:35:06.440 UTC] INFO   module "dtrace" registered mantaop.supervisor_errors
[2015-06-13 13:35:06.441 UTC] INFO   module "dtrace" registered mantaop.supervisor_locates
[2015-06-13 13:35:06.442 UTC] INFO   module "dtrace" registered mantaop.tasks_committed
[2015-06-13 13:35:06.443 UTC] INFO   module "dtrace" registered mantaop.tasks_dispatched
[2015-06-13 13:35:06.444 UTC] INFO   module "dtrace" registered mantaop.tasks_executed
[2015-06-13 13:35:06.446 UTC] INFO   module "dtrace" registered mantaop.tasks_killed
[2015-06-13 13:35:06.448 UTC] INFO   module "dtrace" registered mantaop.zone_resets
[2015-06-13 13:35:06.452 UTC] INFO   module "dtrace" registered moray.ops
[2015-06-13 13:35:06.453 UTC] INFO   module "dtrace" registered moray.queries
[2015-06-13 13:35:06.455 UTC] INFO   module "dtrace" registered mysql.commands
[2015-06-13 13:35:06.456 UTC] INFO   module "dtrace" registered mysql.connections
[2015-06-13 13:35:06.457 UTC] INFO   module "dtrace" registered mysql.filesort
[2015-06-13 13:35:06.460 UTC] INFO   module "dtrace" registered mysql.queries
[2015-06-13 13:35:06.461 UTC] INFO   module "dtrace" registered mysql.statements
[2015-06-13 13:35:06.463 UTC] INFO   module "dtrace" registered node.gc_ops
[2015-06-13 13:35:06.465 UTC] INFO   module "dtrace" registered node.httpc_ops
[2015-06-13 13:35:06.467 UTC] INFO   module "dtrace" registered node.httpd_ops
[2015-06-13 13:35:06.468 UTC] INFO   module "dtrace" registered node.socket_ops
[2015-06-13 13:35:06.471 UTC] INFO   module "dtrace" registered postgres.queries
[2015-06-13 13:35:06.472 UTC] INFO   module "dtrace" registered unix.proc_execs
[2015-06-13 13:35:06.474 UTC] INFO   module "dtrace" registered unix.proc_exits
[2015-06-13 13:35:06.475 UTC] INFO   module "dtrace" registered unix.proc_forks
[2015-06-13 13:35:06.477 UTC] INFO   module "dtrace" registered restify.handler_ops
[2015-06-13 13:35:06.479 UTC] INFO   module "dtrace" registered restify.server_ops
[2015-06-13 13:35:06.481 UTC] INFO   module "dtrace" registered syscall.syscalls
[2015-06-13 13:35:06.483 UTC] INFO   module "dtrace" registered tcp.accepts
[2015-06-13 13:35:06.485 UTC] INFO   module "dtrace" registered tcp.connects
[2015-06-13 13:35:06.486 UTC] INFO   module "dtrace" registered unix.thr_creates
[2015-06-13 13:35:06.487 UTC] INFO   module "dtrace" registered vm.irqs
[2015-06-13 13:35:06.489 UTC] INFO   module "dtrace" registered vm.physio_bytes
[2015-06-13 13:35:06.490 UTC] INFO   module "dtrace" registered vm.physio_ops
[2015-06-13 13:35:06.492 UTC] INFO   module "dtrace" registered vm.thread_samples
[2015-06-13 13:35:06.493 UTC] INFO   module "dtrace" registered zfs.arc_ops
[2015-06-13 13:35:06.493 UTC] INFO   loaded module "dtrace".
[2015-06-13 13:35:06.501 UTC] INFO   module "zfs" registered zfs.dataset_unused_quota
[2015-06-13 13:35:06.501 UTC] INFO   module "zfs" registered zfs.dataset_used
[2015-06-13 13:35:06.502 UTC] INFO   module "zfs" registered zfs.dataset_quota
[2015-06-13 13:35:06.502 UTC] INFO   module "zfs" registered zfs.pool_free
[2015-06-13 13:35:06.502 UTC] INFO   module "zfs" registered zfs.pool_used
[2015-06-13 13:35:06.502 UTC] INFO   module "zfs" registered zfs.pool_total
[2015-06-13 13:35:06.502 UTC] INFO   loaded module "zfs".
[2015-06-13 13:35:06.504 UTC] INFO   module "cainstr" registered ca.instr_ticks
[2015-06-13 13:35:06.504 UTC] INFO   module "cainstr" registered ca.instr_beops
[2015-06-13 13:35:06.504 UTC] INFO   module "cainstr" registered ca.instr_enables
[2015-06-13 13:35:06.504 UTC] INFO   module "cainstr" registered ca.instr_disables
[2015-06-13 13:35:06.504 UTC] INFO   loaded module "cainstr".
[2015-06-13 13:35:07.151 UTC] INFO   module "proc" registered unix.processes
[2015-06-13 13:35:07.151 UTC] INFO   loaded module "proc".
[2015-06-13 13:35:07.152 UTC] INFO   finished loading modules.
[2015-06-13 13:38:18.189 UTC] ERROR  ca-amqp: received connection error: EXCEPTION: Error: Error: connect ETIMEDOUT
    at errnoException (net.js:646:11)
    at Object.afterConnect [as oncomplete] (net.js:637:18)
[2015-06-13 13:38:18.191 UTC] WARN   EXCEPTION: caError: amqp error "ETIMEDOUT": connect ETIMEDOUT
    at capAmqpCap.error (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp-cap.js:390:9)
    at caAmqp.<anonymous> (native)
    at caAmqp.emit (events.js:67:17)
    at caAmqp.connError (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp.js:307:7)
    at Connection.<anonymous> (native)
    at Connection.emit (events.js:67:17)
    at Array.0 (net.js:319:25)
    at EventEmitter._tickCallback (node.js:192:40)
[2015-06-13 13:38:18.192 UTC] DBG    ca-amqp: received close event
[2015-06-13 13:38:18.192 UTC] WARN   ca-amqp: connection closing
[2015-06-13 13:38:18.192 UTC] INFO   ca-amqp: trying to reconnect (attempt 1)
[2015-06-13 13:38:58.171 UTC] ERROR  ca-amqp: received connection error: EXCEPTION: Error: Error: connect ECONNREFUSED
    at errnoException (net.js:646:11)
    at Object.afterConnect [as oncomplete] (net.js:637:18)
[2015-06-13 13:38:58.173 UTC] WARN   EXCEPTION: caError: amqp error "ECONNREFUSED": connect ECONNREFUSED
    at capAmqpCap.error (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp-cap.js:390:9)
    at caAmqp.<anonymous> (native)
    at caAmqp.emit (events.js:67:17)
    at caAmqp.connError (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp.js:307:7)
    at Connection.<anonymous> (native)
    at Connection.emit (events.js:67:17)
    at Array.0 (net.js:319:25)
    at EventEmitter._tickCallback (node.js:192:40)
[2015-06-13 13:38:58.173 UTC] DBG    ca-amqp: received close event
[2015-06-13 13:38:58.173 UTC] WARN   ca-amqp: connection closing
[2015-06-13 13:38:58.174 UTC] INFO   ca-amqp: trying to reconnect (attempt 2)
[2015-06-13 13:39:03.211 UTC] ERROR  ca-amqp: received connection error: EXCEPTION: Error: Error: connect ECONNREFUSED
    at errnoException (net.js:646:11)
    at Object.afterConnect [as oncomplete] (net.js:637:18)
[2015-06-13 13:39:03.215 UTC] WARN   EXCEPTION: caError: amqp error "ECONNREFUSED": connect ECONNREFUSED
    at capAmqpCap.error (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp-cap.js:390:9)
    at caAmqp.<anonymous> (native)
    at caAmqp.emit (events.js:67:17)
    at caAmqp.connError (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp.js:307:7)
    at Connection.<anonymous> (native)
    at Connection.emit (events.js:67:17)
    at Array.0 (net.js:319:25)
    at EventEmitter._tickCallback (node.js:192:40)
[2015-06-13 13:39:03.216 UTC] DBG    ca-amqp: received close event
[2015-06-13 13:39:03.216 UTC] WARN   ca-amqp: connection closing
[2015-06-13 13:39:03.216 UTC] INFO   ca-amqp: trying to reconnect (attempt 3)
[2015-06-13 13:39:08.269 UTC] ERROR  ca-amqp: received connection error: EXCEPTION: Error: Error: connect ECONNREFUSED
    at errnoException (net.js:646:11)
    at Object.afterConnect [as oncomplete] (net.js:637:18)
[2015-06-13 13:39:08.271 UTC] WARN   EXCEPTION: caError: amqp error "ECONNREFUSED": connect ECONNREFUSED
    at capAmqpCap.error (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp-cap.js:390:9)
    at caAmqp.<anonymous> (native)
    at caAmqp.emit (events.js:67:17)
    at caAmqp.connError (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp.js:307:7)
    at Connection.<anonymous> (native)
    at Connection.emit (events.js:67:17)
    at Array.0 (net.js:319:25)
    at EventEmitter._tickCallback (node.js:192:40)
[2015-06-13 13:39:08.271 UTC] DBG    ca-amqp: received close event
[2015-06-13 13:39:08.271 UTC] WARN   ca-amqp: connection closing
[2015-06-13 13:39:08.272 UTC] INFO   ca-amqp: trying to reconnect (attempt 4)
[2015-06-13 13:39:13.300 UTC] ERROR  ca-amqp: received connection error: EXCEPTION: Error: Error: connect ECONNREFUSED
    at errnoException (net.js:646:11)
    at Object.afterConnect [as oncomplete] (net.js:637:18)
[2015-06-13 13:39:13.302 UTC] WARN   EXCEPTION: caError: amqp error "ECONNREFUSED": connect ECONNREFUSED
    at capAmqpCap.error (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp-cap.js:390:9)
    at caAmqp.<anonymous> (native)
    at caAmqp.emit (events.js:67:17)
    at caAmqp.connError (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp.js:307:7)
    at Connection.<anonymous> (native)
    at Connection.emit (events.js:67:17)
    at Array.0 (net.js:319:25)
    at EventEmitter._tickCallback (node.js:192:40)
[2015-06-13 13:39:13.303 UTC] DBG    ca-amqp: received close event
[2015-06-13 13:39:13.303 UTC] WARN   ca-amqp: connection closing
[2015-06-13 13:39:13.303 UTC] INFO   ca-amqp: trying to reconnect (attempt 5)
[2015-06-13 13:39:18.335 UTC] ERROR  ca-amqp: received connection error: EXCEPTION: Error: Error: connect ECONNREFUSED
    at errnoException (net.js:646:11)
    at Object.afterConnect [as oncomplete] (net.js:637:18)
[2015-06-13 13:39:18.337 UTC] WARN   EXCEPTION: caError: amqp error "ECONNREFUSED": connect ECONNREFUSED
    at capAmqpCap.error (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp-cap.js:390:9)
    at caAmqp.<anonymous> (native)
    at caAmqp.emit (events.js:67:17)
    at caAmqp.connError (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp.js:307:7)
    at Connection.<anonymous> (native)
    at Connection.emit (events.js:67:17)
    at Array.0 (net.js:319:25)
    at EventEmitter._tickCallback (node.js:192:40)
[2015-06-13 13:39:18.337 UTC] DBG    ca-amqp: received close event
[2015-06-13 13:39:18.337 UTC] WARN   ca-amqp: connection closing
[2015-06-13 13:39:18.337 UTC] INFO   ca-amqp: trying to reconnect (attempt 6)
[2015-06-13 13:39:23.375 UTC] ERROR  ca-amqp: received connection error: EXCEPTION: Error: Error: connect ECONNREFUSED
    at errnoException (net.js:646:11)
    at Object.afterConnect [as oncomplete] (net.js:637:18)
[2015-06-13 13:39:23.377 UTC] WARN   EXCEPTION: caError: amqp error "ECONNREFUSED": connect ECONNREFUSED
    at capAmqpCap.error (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp-cap.js:390:9)
    at caAmqp.<anonymous> (native)
    at caAmqp.emit (events.js:67:17)
    at caAmqp.connError (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp.js:307:7)
    at Connection.<anonymous> (native)
    at Connection.emit (events.js:67:17)
    at Array.0 (net.js:319:25)
    at EventEmitter._tickCallback (node.js:192:40)
[2015-06-13 13:39:23.378 UTC] DBG    ca-amqp: received close event
[2015-06-13 13:39:23.379 UTC] WARN   ca-amqp: connection closing
[2015-06-13 13:39:23.379 UTC] INFO   ca-amqp: trying to reconnect (attempt 7)
[2015-06-13 13:39:28.410 UTC] ERROR  ca-amqp: received connection error: EXCEPTION: Error: Error: connect ECONNREFUSED
    at errnoException (net.js:646:11)
    at Object.afterConnect [as oncomplete] (net.js:637:18)
[2015-06-13 13:39:28.411 UTC] WARN   EXCEPTION: caError: amqp error "ECONNREFUSED": connect ECONNREFUSED
    at capAmqpCap.error (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp-cap.js:390:9)
    at caAmqp.<anonymous> (native)
    at caAmqp.emit (events.js:67:17)
    at caAmqp.connError (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp.js:307:7)
    at Connection.<anonymous> (native)
    at Connection.emit (events.js:67:17)
    at Array.0 (net.js:319:25)
    at EventEmitter._tickCallback (node.js:192:40)
[2015-06-13 13:39:28.412 UTC] DBG    ca-amqp: received close event
[2015-06-13 13:39:28.412 UTC] WARN   ca-amqp: connection closing
[2015-06-13 13:39:28.412 UTC] INFO   ca-amqp: trying to reconnect (attempt 8)
[2015-06-13 13:39:33.412 UTC] ERROR  ca-amqp: received connection error: EXCEPTION: Error: Error: connect ECONNREFUSED
    at errnoException (net.js:646:11)
    at Object.afterConnect [as oncomplete] (net.js:637:18)
[2015-06-13 13:39:33.414 UTC] WARN   EXCEPTION: caError: amqp error "ECONNREFUSED": connect ECONNREFUSED
    at capAmqpCap.error (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp-cap.js:390:9)
    at caAmqp.<anonymous> (native)
    at caAmqp.emit (events.js:67:17)
    at caAmqp.connError (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp.js:307:7)
    at Connection.<anonymous> (native)
    at Connection.emit (events.js:67:17)
    at Array.0 (net.js:319:25)
    at EventEmitter._tickCallback (node.js:192:40)
[2015-06-13 13:39:33.414 UTC] DBG    ca-amqp: received close event
[2015-06-13 13:39:33.414 UTC] WARN   ca-amqp: connection closing
[2015-06-13 13:39:33.414 UTC] INFO   ca-amqp: trying to reconnect (attempt 9)
[2015-06-13 13:39:38.418 UTC] ERROR  ca-amqp: received connection error: EXCEPTION: Error: Error: connect ECONNREFUSED
    at errnoException (net.js:646:11)
    at Object.afterConnect [as oncomplete] (net.js:637:18)
[2015-06-13 13:39:38.419 UTC] WARN   EXCEPTION: caError: amqp error "ECONNREFUSED": connect ECONNREFUSED
    at capAmqpCap.error (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp-cap.js:390:9)
    at caAmqp.<anonymous> (native)
    at caAmqp.emit (events.js:67:17)
    at caAmqp.connError (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp.js:307:7)
    at Connection.<anonymous> (native)
    at Connection.emit (events.js:67:17)
    at Array.0 (net.js:319:25)
    at EventEmitter._tickCallback (node.js:192:40)
[2015-06-13 13:39:38.420 UTC] DBG    ca-amqp: received close event
[2015-06-13 13:39:38.420 UTC] WARN   ca-amqp: connection closing
[2015-06-13 13:39:38.420 UTC] INFO   ca-amqp: trying to reconnect (attempt 10)
[2015-06-13 13:39:43.442 UTC] ERROR  ca-amqp: received connection error: EXCEPTION: Error: Error: connect ECONNREFUSED
    at errnoException (net.js:646:11)
    at Object.afterConnect [as oncomplete] (net.js:637:18)
[2015-06-13 13:39:43.444 UTC] WARN   EXCEPTION: caError: amqp error "ECONNREFUSED": connect ECONNREFUSED
    at capAmqpCap.error (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp-cap.js:390:9)
    at caAmqp.<anonymous> (native)
    at caAmqp.emit (events.js:67:17)
    at caAmqp.connError (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp.js:307:7)
    at Connection.<anonymous> (native)
    at Connection.emit (events.js:67:17)
    at Array.0 (net.js:319:25)
    at EventEmitter._tickCallback (node.js:192:40)
[2015-06-13 13:39:43.444 UTC] DBG    ca-amqp: received close event
[2015-06-13 13:39:43.444 UTC] WARN   ca-amqp: connection closing
[2015-06-13 13:39:43.444 UTC] INFO   ca-amqp: trying to reconnect (attempt 11)
[2015-06-13 13:39:48.480 UTC] ERROR  ca-amqp: received connection error: EXCEPTION: Error: Error: connect ECONNREFUSED
    at errnoException (net.js:646:11)
    at Object.afterConnect [as oncomplete] (net.js:637:18)
[2015-06-13 13:39:48.481 UTC] WARN   EXCEPTION: caError: amqp error "ECONNREFUSED": connect ECONNREFUSED
    at capAmqpCap.error (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp-cap.js:390:9)
    at caAmqp.<anonymous> (native)
    at caAmqp.emit (events.js:67:17)
    at caAmqp.connError (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp.js:307:7)
    at Connection.<anonymous> (native)
    at Connection.emit (events.js:67:17)
    at Array.0 (net.js:319:25)
    at EventEmitter._tickCallback (node.js:192:40)
[2015-06-13 13:39:48.481 UTC] DBG    ca-amqp: received close event
[2015-06-13 13:39:48.481 UTC] WARN   ca-amqp: connection closing
[2015-06-13 13:39:48.481 UTC] INFO   ca-amqp: trying to reconnect (attempt 12)
[2015-06-13 13:39:53.504 UTC] ERROR  ca-amqp: received connection error: EXCEPTION: Error: Error: connect ECONNREFUSED
    at errnoException (net.js:646:11)
    at Object.afterConnect [as oncomplete] (net.js:637:18)
[2015-06-13 13:39:53.505 UTC] WARN   EXCEPTION: caError: amqp error "ECONNREFUSED": connect ECONNREFUSED
    at capAmqpCap.error (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp-cap.js:390:9)
    at caAmqp.<anonymous> (native)
    at caAmqp.emit (events.js:67:17)
    at caAmqp.connError (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp.js:307:7)
    at Connection.<anonymous> (native)
    at Connection.emit (events.js:67:17)
    at Array.0 (net.js:319:25)
    at EventEmitter._tickCallback (node.js:192:40)
[2015-06-13 13:39:53.506 UTC] DBG    ca-amqp: received close event
[2015-06-13 13:39:53.506 UTC] WARN   ca-amqp: connection closing
[2015-06-13 13:39:53.506 UTC] INFO   ca-amqp: trying to reconnect (attempt 13)
[2015-06-13 13:39:58.530 UTC] ERROR  ca-amqp: received connection error: EXCEPTION: Error: Error: connect ECONNREFUSED
    at errnoException (net.js:646:11)
    at Object.afterConnect [as oncomplete] (net.js:637:18)
[2015-06-13 13:39:58.531 UTC] WARN   EXCEPTION: caError: amqp error "ECONNREFUSED": connect ECONNREFUSED
    at capAmqpCap.error (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp-cap.js:390:9)
    at caAmqp.<anonymous> (native)
    at caAmqp.emit (events.js:67:17)
    at caAmqp.connError (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp.js:307:7)
    at Connection.<anonymous> (native)
    at Connection.emit (events.js:67:17)
    at Array.0 (net.js:319:25)
    at EventEmitter._tickCallback (node.js:192:40)
[2015-06-13 13:39:58.533 UTC] DBG    ca-amqp: received close event
[2015-06-13 13:39:58.534 UTC] WARN   ca-amqp: connection closing
[2015-06-13 13:39:58.534 UTC] INFO   ca-amqp: trying to reconnect (attempt 14)
[2015-06-13 13:40:03.565 UTC] ERROR  ca-amqp: received connection error: EXCEPTION: Error: Error: connect ECONNREFUSED
    at errnoException (net.js:646:11)
    at Object.afterConnect [as oncomplete] (net.js:637:18)
[2015-06-13 13:40:03.567 UTC] WARN   EXCEPTION: caError: amqp error "ECONNREFUSED": connect ECONNREFUSED
    at capAmqpCap.error (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp-cap.js:390:9)
    at caAmqp.<anonymous> (native)
    at caAmqp.emit (events.js:67:17)
    at caAmqp.connError (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp.js:307:7)
    at Connection.<anonymous> (native)
    at Connection.emit (events.js:67:17)
    at Array.0 (net.js:319:25)
    at EventEmitter._tickCallback (node.js:192:40)
[2015-06-13 13:40:03.568 UTC] DBG    ca-amqp: received close event
[2015-06-13 13:40:03.568 UTC] WARN   ca-amqp: connection closing
[2015-06-13 13:40:03.568 UTC] INFO   ca-amqp: trying to reconnect (attempt 15)
[2015-06-13 13:40:08.597 UTC] ERROR  ca-amqp: received connection error: EXCEPTION: Error: Error: connect ECONNREFUSED
    at errnoException (net.js:646:11)
    at Object.afterConnect [as oncomplete] (net.js:637:18)
[2015-06-13 13:40:08.600 UTC] WARN   EXCEPTION: caError: amqp error "ECONNREFUSED": connect ECONNREFUSED
    at capAmqpCap.error (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp-cap.js:390:9)
    at caAmqp.<anonymous> (native)
    at caAmqp.emit (events.js:67:17)
    at caAmqp.connError (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp.js:307:7)
    at Connection.<anonymous> (native)
    at Connection.emit (events.js:67:17)
    at Array.0 (net.js:319:25)
    at EventEmitter._tickCallback (node.js:192:40)
[2015-06-13 13:40:08.600 UTC] DBG    ca-amqp: received close event
[2015-06-13 13:40:08.600 UTC] WARN   ca-amqp: connection closing
[2015-06-13 13:40:08.600 UTC] INFO   ca-amqp: trying to reconnect (attempt 16)
[2015-06-13 13:40:13.637 UTC] ERROR  ca-amqp: received connection error: EXCEPTION: Error: Error: connect ECONNREFUSED
    at errnoException (net.js:646:11)
    at Object.afterConnect [as oncomplete] (net.js:637:18)
[2015-06-13 13:40:13.641 UTC] WARN   EXCEPTION: caError: amqp error "ECONNREFUSED": connect ECONNREFUSED
    at capAmqpCap.error (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp-cap.js:390:9)
    at caAmqp.<anonymous> (native)
    at caAmqp.emit (events.js:67:17)
    at caAmqp.connError (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp.js:307:7)
    at Connection.<anonymous> (native)
    at Connection.emit (events.js:67:17)
    at Array.0 (net.js:319:25)
    at EventEmitter._tickCallback (node.js:192:40)
[2015-06-13 13:40:13.642 UTC] DBG    ca-amqp: received close event
[2015-06-13 13:40:13.642 UTC] WARN   ca-amqp: connection closing
[2015-06-13 13:40:13.642 UTC] INFO   ca-amqp: trying to reconnect (attempt 17)
[2015-06-13 13:40:18.674 UTC] ERROR  ca-amqp: received connection error: EXCEPTION: Error: Error: connect ECONNREFUSED
    at errnoException (net.js:646:11)
    at Object.afterConnect [as oncomplete] (net.js:637:18)
[2015-06-13 13:40:18.675 UTC] WARN   EXCEPTION: caError: amqp error "ECONNREFUSED": connect ECONNREFUSED
    at capAmqpCap.error (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp-cap.js:390:9)
    at caAmqp.<anonymous> (native)
    at caAmqp.emit (events.js:67:17)
    at caAmqp.connError (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp.js:307:7)
    at Connection.<anonymous> (native)
    at Connection.emit (events.js:67:17)
    at Array.0 (net.js:319:25)
    at EventEmitter._tickCallback (node.js:192:40)
[2015-06-13 13:40:18.676 UTC] DBG    ca-amqp: received close event
[2015-06-13 13:40:18.676 UTC] WARN   ca-amqp: connection closing
[2015-06-13 13:40:18.676 UTC] INFO   ca-amqp: trying to reconnect (attempt 18)
[2015-06-13 13:40:23.677 UTC] ERROR  ca-amqp: received connection error: EXCEPTION: Error: Error: connect ECONNREFUSED
    at errnoException (net.js:646:11)
    at Object.afterConnect [as oncomplete] (net.js:637:18)
[2015-06-13 13:40:23.678 UTC] WARN   EXCEPTION: caError: amqp error "ECONNREFUSED": connect ECONNREFUSED
    at capAmqpCap.error (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp-cap.js:390:9)
    at caAmqp.<anonymous> (native)
    at caAmqp.emit (events.js:67:17)
    at caAmqp.connError (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp.js:307:7)
    at Connection.<anonymous> (native)
    at Connection.emit (events.js:67:17)
    at Array.0 (net.js:319:25)
    at EventEmitter._tickCallback (node.js:192:40)
[2015-06-13 13:40:23.679 UTC] DBG    ca-amqp: received close event
[2015-06-13 13:40:23.679 UTC] WARN   ca-amqp: connection closing
[2015-06-13 13:40:23.679 UTC] INFO   ca-amqp: trying to reconnect (attempt 19)
[2015-06-13 13:40:28.680 UTC] ERROR  ca-amqp: received connection error: EXCEPTION: Error: Error: connect ECONNREFUSED
    at errnoException (net.js:646:11)
    at Object.afterConnect [as oncomplete] (net.js:637:18)
[2015-06-13 13:40:28.682 UTC] WARN   EXCEPTION: caError: amqp error "ECONNREFUSED": connect ECONNREFUSED
    at capAmqpCap.error (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp-cap.js:390:9)
    at caAmqp.<anonymous> (native)
    at caAmqp.emit (events.js:67:17)
    at caAmqp.connError (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp.js:307:7)
    at Connection.<anonymous> (native)
    at Connection.emit (events.js:67:17)
    at Array.0 (net.js:319:25)
    at EventEmitter._tickCallback (node.js:192:40)
[2015-06-13 13:40:28.686 UTC] DBG    ca-amqp: received close event
[2015-06-13 13:40:28.686 UTC] WARN   ca-amqp: connection closing
[2015-06-13 13:40:28.686 UTC] INFO   ca-amqp: trying to reconnect (attempt 20)
[2015-06-13 13:40:33.707 UTC] ERROR  ca-amqp: received connection error: EXCEPTION: Error: Error: connect ECONNREFUSED
    at errnoException (net.js:646:11)
    at Object.afterConnect [as oncomplete] (net.js:637:18)
[2015-06-13 13:40:33.708 UTC] WARN   EXCEPTION: caError: amqp error "ECONNREFUSED": connect ECONNREFUSED
    at capAmqpCap.error (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp-cap.js:390:9)
    at caAmqp.<anonymous> (native)
    at caAmqp.emit (events.js:67:17)
    at caAmqp.connError (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp.js:307:7)
    at Connection.<anonymous> (native)
    at Connection.emit (events.js:67:17)
    at Array.0 (net.js:319:25)
    at EventEmitter._tickCallback (node.js:192:40)
[2015-06-13 13:40:33.709 UTC] DBG    ca-amqp: received close event
[2015-06-13 13:40:33.709 UTC] WARN   ca-amqp: connection closing
[2015-06-13 13:40:33.709 UTC] INFO   ca-amqp: trying to reconnect (attempt 21)
[2015-06-13 13:40:38.754 UTC] ERROR  ca-amqp: received connection error: EXCEPTION: Error: Error: connect ECONNREFUSED
    at errnoException (net.js:646:11)
    at Object.afterConnect [as oncomplete] (net.js:637:18)
[2015-06-13 13:40:38.756 UTC] WARN   EXCEPTION: caError: amqp error "ECONNREFUSED": connect ECONNREFUSED
    at capAmqpCap.error (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp-cap.js:390:9)
    at caAmqp.<anonymous> (native)
    at caAmqp.emit (events.js:67:17)
    at caAmqp.connError (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp.js:307:7)
    at Connection.<anonymous> (native)
    at Connection.emit (events.js:67:17)
    at Array.0 (net.js:319:25)
    at EventEmitter._tickCallback (node.js:192:40)
[2015-06-13 13:40:38.757 UTC] DBG    ca-amqp: received close event
[2015-06-13 13:40:38.757 UTC] WARN   ca-amqp: connection closing
[2015-06-13 13:40:38.757 UTC] INFO   ca-amqp: trying to reconnect (attempt 22)
[2015-06-13 13:40:43.782 UTC] ERROR  ca-amqp: received connection error: EXCEPTION: Error: Error: connect ECONNREFUSED
    at errnoException (net.js:646:11)
    at Object.afterConnect [as oncomplete] (net.js:637:18)
[2015-06-13 13:40:43.784 UTC] WARN   EXCEPTION: caError: amqp error "ECONNREFUSED": connect ECONNREFUSED
    at capAmqpCap.error (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp-cap.js:390:9)
    at caAmqp.<anonymous> (native)
    at caAmqp.emit (events.js:67:17)
    at caAmqp.connError (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp.js:307:7)
    at Connection.<anonymous> (native)
    at Connection.emit (events.js:67:17)
    at Array.0 (net.js:319:25)
    at EventEmitter._tickCallback (node.js:192:40)
[2015-06-13 13:40:43.784 UTC] DBG    ca-amqp: received close event
[2015-06-13 13:40:43.784 UTC] WARN   ca-amqp: connection closing
[2015-06-13 13:40:43.784 UTC] INFO   ca-amqp: trying to reconnect (attempt 23)
[2015-06-13 13:40:48.817 UTC] ERROR  ca-amqp: received connection error: EXCEPTION: Error: Error: connect ECONNREFUSED
    at errnoException (net.js:646:11)
    at Object.afterConnect [as oncomplete] (net.js:637:18)
[2015-06-13 13:40:48.819 UTC] WARN   EXCEPTION: caError: amqp error "ECONNREFUSED": connect ECONNREFUSED
    at capAmqpCap.error (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp-cap.js:390:9)
    at caAmqp.<anonymous> (native)
    at caAmqp.emit (events.js:67:17)
    at caAmqp.connError (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp.js:307:7)
    at Connection.<anonymous> (native)
    at Connection.emit (events.js:67:17)
    at Array.0 (net.js:319:25)
    at EventEmitter._tickCallback (node.js:192:40)
[2015-06-13 13:40:48.819 UTC] DBG    ca-amqp: received close event
[2015-06-13 13:40:48.820 UTC] WARN   ca-amqp: connection closing
[2015-06-13 13:40:48.820 UTC] INFO   ca-amqp: trying to reconnect (attempt 24)
[2015-06-13 13:40:53.845 UTC] ERROR  ca-amqp: received connection error: EXCEPTION: Error: Error: connect ECONNREFUSED
    at errnoException (net.js:646:11)
    at Object.afterConnect [as oncomplete] (net.js:637:18)
[2015-06-13 13:40:53.847 UTC] WARN   EXCEPTION: caError: amqp error "ECONNREFUSED": connect ECONNREFUSED
    at capAmqpCap.error (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp-cap.js:390:9)
    at caAmqp.<anonymous> (native)
    at caAmqp.emit (events.js:67:17)
    at caAmqp.connError (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp.js:307:7)
    at Connection.<anonymous> (native)
    at Connection.emit (events.js:67:17)
    at Array.0 (net.js:319:25)
    at EventEmitter._tickCallback (node.js:192:40)
[2015-06-13 13:40:53.847 UTC] DBG    ca-amqp: received close event
[2015-06-13 13:40:53.848 UTC] WARN   ca-amqp: connection closing
[2015-06-13 13:40:53.848 UTC] INFO   ca-amqp: trying to reconnect (attempt 25)
[2015-06-13 13:40:58.867 UTC] ERROR  ca-amqp: received connection error: EXCEPTION: Error: Error: connect ECONNREFUSED
    at errnoException (net.js:646:11)
    at Object.afterConnect [as oncomplete] (net.js:637:18)
[2015-06-13 13:40:58.868 UTC] WARN   EXCEPTION: caError: amqp error "ECONNREFUSED": connect ECONNREFUSED
    at capAmqpCap.error (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp-cap.js:390:9)
    at caAmqp.<anonymous> (native)
    at caAmqp.emit (events.js:67:17)
    at caAmqp.connError (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp.js:307:7)
    at Connection.<anonymous> (native)
    at Connection.emit (events.js:67:17)
    at Array.0 (net.js:319:25)
    at EventEmitter._tickCallback (node.js:192:40)
[2015-06-13 13:40:58.869 UTC] DBG    ca-amqp: received close event
[2015-06-13 13:40:58.869 UTC] WARN   ca-amqp: connection closing
[2015-06-13 13:40:58.869 UTC] INFO   ca-amqp: trying to reconnect (attempt 26)
[2015-06-13 13:41:03.873 UTC] ERROR  ca-amqp: received connection error: EXCEPTION: Error: Error: connect ECONNREFUSED
    at errnoException (net.js:646:11)
    at Object.afterConnect [as oncomplete] (net.js:637:18)
[2015-06-13 13:41:03.875 UTC] WARN   EXCEPTION: caError: amqp error "ECONNREFUSED": connect ECONNREFUSED
    at capAmqpCap.error (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp-cap.js:390:9)
    at caAmqp.<anonymous> (native)
    at caAmqp.emit (events.js:67:17)
    at caAmqp.connError (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp.js:307:7)
    at Connection.<anonymous> (native)
    at Connection.emit (events.js:67:17)
    at Array.0 (net.js:319:25)
    at EventEmitter._tickCallback (node.js:192:40)
[2015-06-13 13:41:03.875 UTC] DBG    ca-amqp: received close event
[2015-06-13 13:41:03.875 UTC] WARN   ca-amqp: connection closing
[2015-06-13 13:41:03.875 UTC] INFO   ca-amqp: trying to reconnect (attempt 27)
[2015-06-13 13:41:08.878 UTC] ERROR  ca-amqp: received connection error: EXCEPTION: Error: Error: connect ECONNREFUSED
    at errnoException (net.js:646:11)
    at Object.afterConnect [as oncomplete] (net.js:637:18)
[2015-06-13 13:41:08.880 UTC] WARN   EXCEPTION: caError: amqp error "ECONNREFUSED": connect ECONNREFUSED
    at capAmqpCap.error (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp-cap.js:390:9)
    at caAmqp.<anonymous> (native)
    at caAmqp.emit (events.js:67:17)
    at caAmqp.connError (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp.js:307:7)
    at Connection.<anonymous> (native)
    at Connection.emit (events.js:67:17)
    at Array.0 (net.js:319:25)
    at EventEmitter._tickCallback (node.js:192:40)
[2015-06-13 13:41:08.880 UTC] DBG    ca-amqp: received close event
[2015-06-13 13:41:08.880 UTC] WARN   ca-amqp: connection closing
[2015-06-13 13:41:08.880 UTC] INFO   ca-amqp: trying to reconnect (attempt 28)
[2015-06-13 13:41:13.880 UTC] ERROR  ca-amqp: received connection error: EXCEPTION: Error: Error: connect ECONNREFUSED
    at errnoException (net.js:646:11)
    at Object.afterConnect [as oncomplete] (net.js:637:18)
[2015-06-13 13:41:13.881 UTC] WARN   EXCEPTION: caError: amqp error "ECONNREFUSED": connect ECONNREFUSED
    at capAmqpCap.error (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp-cap.js:390:9)
    at caAmqp.<anonymous> (native)
    at caAmqp.emit (events.js:67:17)
    at caAmqp.connError (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp.js:307:7)
    at Connection.<anonymous> (native)
    at Connection.emit (events.js:67:17)
    at Array.0 (net.js:319:25)
    at EventEmitter._tickCallback (node.js:192:40)
[2015-06-13 13:41:13.882 UTC] DBG    ca-amqp: received close event
[2015-06-13 13:41:13.882 UTC] WARN   ca-amqp: connection closing
[2015-06-13 13:41:13.882 UTC] INFO   ca-amqp: trying to reconnect (attempt 29)
[2015-06-13 13:41:18.882 UTC] ERROR  ca-amqp: received connection error: EXCEPTION: Error: Error: connect ECONNREFUSED
    at errnoException (net.js:646:11)
    at Object.afterConnect [as oncomplete] (net.js:637:18)
[2015-06-13 13:41:18.883 UTC] WARN   EXCEPTION: caError: amqp error "ECONNREFUSED": connect ECONNREFUSED
    at capAmqpCap.error (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp-cap.js:390:9)
    at caAmqp.<anonymous> (native)
    at caAmqp.emit (events.js:67:17)
    at caAmqp.connError (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp.js:307:7)
    at Connection.<anonymous> (native)
    at Connection.emit (events.js:67:17)
    at Array.0 (net.js:319:25)
    at EventEmitter._tickCallback (node.js:192:40)
[2015-06-13 13:41:18.884 UTC] DBG    ca-amqp: received close event
[2015-06-13 13:41:18.884 UTC] WARN   ca-amqp: connection closing
[2015-06-13 13:41:18.884 UTC] INFO   ca-amqp: trying to reconnect (attempt 30)
[2015-06-13 13:41:23.884 UTC] ERROR  ca-amqp: received connection error: EXCEPTION: Error: Error: connect ECONNREFUSED
    at errnoException (net.js:646:11)
    at Object.afterConnect [as oncomplete] (net.js:637:18)
[2015-06-13 13:41:23.889 UTC] WARN   EXCEPTION: caError: amqp error "ECONNREFUSED": connect ECONNREFUSED
    at capAmqpCap.error (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp-cap.js:390:9)
    at caAmqp.<anonymous> (native)
    at caAmqp.emit (events.js:67:17)
    at caAmqp.connError (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp.js:307:7)
    at Connection.<anonymous> (native)
    at Connection.emit (events.js:67:17)
    at Array.0 (net.js:319:25)
    at EventEmitter._tickCallback (node.js:192:40)
[2015-06-13 13:41:23.889 UTC] DBG    ca-amqp: received close event
[2015-06-13 13:41:23.890 UTC] WARN   ca-amqp: connection closing
[2015-06-13 13:41:23.890 UTC] INFO   ca-amqp: trying to reconnect (attempt 31)
[2015-06-13 13:41:28.893 UTC] ERROR  ca-amqp: received connection error: EXCEPTION: Error: Error: connect ECONNREFUSED
    at errnoException (net.js:646:11)
    at Object.afterConnect [as oncomplete] (net.js:637:18)
[2015-06-13 13:41:28.894 UTC] WARN   EXCEPTION: caError: amqp error "ECONNREFUSED": connect ECONNREFUSED
    at capAmqpCap.error (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp-cap.js:390:9)
    at caAmqp.<anonymous> (native)
    at caAmqp.emit (events.js:67:17)
    at caAmqp.connError (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp.js:307:7)
    at Connection.<anonymous> (native)
    at Connection.emit (events.js:67:17)
    at Array.0 (net.js:319:25)
    at EventEmitter._tickCallback (node.js:192:40)
[2015-06-13 13:41:28.894 UTC] DBG    ca-amqp: received close event
[2015-06-13 13:41:28.894 UTC] WARN   ca-amqp: connection closing
[2015-06-13 13:41:28.894 UTC] INFO   ca-amqp: trying to reconnect (attempt 32)
[2015-06-13 13:41:33.894 UTC] ERROR  ca-amqp: received connection error: EXCEPTION: Error: Error: connect ECONNREFUSED
    at errnoException (net.js:646:11)
    at Object.afterConnect [as oncomplete] (net.js:637:18)
[2015-06-13 13:41:33.896 UTC] WARN   EXCEPTION: caError: amqp error "ECONNREFUSED": connect ECONNREFUSED
    at capAmqpCap.error (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp-cap.js:390:9)
    at caAmqp.<anonymous> (native)
    at caAmqp.emit (events.js:67:17)
    at caAmqp.connError (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp.js:307:7)
    at Connection.<anonymous> (native)
    at Connection.emit (events.js:67:17)
    at Array.0 (net.js:319:25)
    at EventEmitter._tickCallback (node.js:192:40)
[2015-06-13 13:41:33.896 UTC] DBG    ca-amqp: received close event
[2015-06-13 13:41:33.896 UTC] WARN   ca-amqp: connection closing
[2015-06-13 13:41:33.896 UTC] INFO   ca-amqp: trying to reconnect (attempt 33)
[2015-06-13 13:41:39.056 UTC] DBG    binding to ca.instrumenter.headnode
[2015-06-13 13:41:39.057 UTC] DBG    binding to ca.broadcast
[2015-06-13 13:41:39.061 UTC] DBG    bind to ca.instrumenter.headnode complete
[2015-06-13 13:41:39.061 UTC] DBG    bind to ca.broadcast complete
[2015-06-13 13:41:39.061 UTC] INFO   AMQP broker connected.
[2015-06-13 13:43:13.674 UTC] INFO   config service restarted
[2015-06-13 13:43:13.985 UTC] DBG    
----------------------------------------
this string fstype;

fbt::fop_read:entry,
fbt::fop_write:entry,
fbt::fop_ioctl:entry,
fbt::fop_access:entry,
fbt::fop_getattr:entry,
fbt::fop_setattr:entry,
fbt::fop_lookup:entry,
fbt::fop_create:entry,
fbt::fop_remove:entry,
fbt::fop_link:entry,
fbt::fop_rename:entry,
fbt::fop_mkdir:entry,
fbt::fop_rmdir:entry,
fbt::fop_readdir:entry,
fbt::fop_symlink:entry,
fbt::fop_readlink:entry,
fbt::fop_fsync:entry,
fbt::fop_getpage:entry,
fbt::fop_putpage:entry,
fbt::fop_map:entry,
fbt::fop_open:entry
/((self->vnode0 == NULL))/{
	self->vnode0 = arg0;
	self->depth0 = stackdepth;
	self->latency0 = timestamp;
}

fbt::fop_open:return
/((((((self->vnode0) != NULL)))) && (((((self->depth0) != NULL)))) && (((((self->latency0) != NULL)))) && (((((this->fstype = stringof((*((vnode_t**)self->vnode0))->v_op->vnop_name)) != NULL || 1)))) && (self->depth0 == stackdepth && self->vnode0 != NULL && (this->fstype == "ufs" || this->fstype == "zfs" || this->fstype == "dev" || this->fstype == "dev fs" || this->fstype == "proc" || this->fstype == "lofs" || this->fstype == "tmpfs" || this->fstype == "nfs")))/{
	@[((probefunc + 4))] = llquantize((timestamp - self->latency0), 10, 3, 11, 100);
}

fbt::fop_read:return,
fbt::fop_write:return,
fbt::fop_ioctl:return,
fbt::fop_access:return,
fbt::fop_getattr:return,
fbt::fop_setattr:return,
fbt::fop_lookup:return,
fbt::fop_create:return,
fbt::fop_remove:return,
fbt::fop_link:return,
fbt::fop_rename:return,
fbt::fop_mkdir:return,
fbt::fop_rmdir:return,
fbt::fop_readdir:return,
fbt::fop_symlink:return,
fbt::fop_readlink:return,
fbt::fop_fsync:return,
fbt::fop_getpage:return,
fbt::fop_putpage:return,
fbt::fop_map:return
/((((((self->vnode0) != NULL)))) && (((((self->depth0) != NULL)))) && (((((self->latency0) != NULL)))) && (((((this->fstype = stringof(((vnode_t*)self->vnode0)->v_op->vnop_name)) != NULL || 1)))) && (self->depth0 == stackdepth && self->vnode0 != NULL && (this->fstype == "ufs" || this->fstype == "zfs" || this->fstype == "dev" || this->fstype == "dev fs" || this->fstype == "proc" || this->fstype == "lofs" || this->fstype == "tmpfs" || this->fstype == "nfs")))/{
	@[((probefunc + 4))] = llquantize((timestamp - self->latency0), 10, 3, 11, 100);
}

fbt::fop_read:return,
fbt::fop_write:return,
fbt::fop_ioctl:return,
fbt::fop_access:return,
fbt::fop_getattr:return,
fbt::fop_setattr:return,
fbt::fop_lookup:return,
fbt::fop_create:return,
fbt::fop_remove:return,
fbt::fop_link:return,
fbt::fop_rename:return,
fbt::fop_mkdir:return,
fbt::fop_rmdir:return,
fbt::fop_readdir:return,
fbt::fop_symlink:return,
fbt::fop_readlink:return,
fbt::fop_fsync:return,
fbt::fop_getpage:return,
fbt::fop_putpage:return,
fbt::fop_map:return,
fbt::fop_open:entry
/((self->depth0 == stackdepth))/{
	(self->vnode0) = 0;
	(self->depth0) = 0;
	(self->latency0) = 0;
}

----------------------------------------
[2015-06-13 13:43:16.455 UTC] INFO   instrumented global;5 (fs.logical_ops)
[2015-06-13 13:43:16.460 UTC] DBG    
----------------------------------------
this string fstype;

fbt::fop_read:entry,
fbt::fop_write:entry,
fbt::fop_ioctl:entry,
fbt::fop_access:entry,
fbt::fop_getattr:entry,
fbt::fop_setattr:entry,
fbt::fop_lookup:entry,
fbt::fop_create:entry,
fbt::fop_remove:entry,
fbt::fop_link:entry,
fbt::fop_rename:entry,
fbt::fop_mkdir:entry,
fbt::fop_rmdir:entry,
fbt::fop_readdir:entry,
fbt::fop_symlink:entry,
fbt::fop_readlink:entry,
fbt::fop_fsync:entry,
fbt::fop_getpage:entry,
fbt::fop_putpage:entry,
fbt::fop_map:entry,
fbt::fop_open:entry
/((self->vnode0 == NULL))/{
	self->vnode0 = arg0;
	self->depth0 = stackdepth;
	self->latency0 = timestamp;
}

fbt::fop_open:return
/((((((self->vnode0) != NULL)))) && (((((self->depth0) != NULL)))) && (((((self->latency0) != NULL)))) && (((((this->fstype = stringof((*((vnode_t**)self->vnode0))->v_op->vnop_name)) != NULL || 1)))) && (self->depth0 == stackdepth && self->vnode0 != NULL && (this->fstype == "ufs" || this->fstype == "zfs" || this->fstype == "dev" || this->fstype == "dev fs" || this->fstype == "proc" || this->fstype == "lofs" || this->fstype == "tmpfs" || this->fstype == "nfs")))/{
	@[((probefunc + 4))] = llquantize((timestamp - self->latency0), 10, 3, 11, 100);
}

fbt::fop_read:return,
fbt::fop_write:return,
fbt::fop_ioctl:return,
fbt::fop_access:return,
fbt::fop_getattr:return,
fbt::fop_setattr:return,
fbt::fop_lookup:return,
fbt::fop_create:return,
fbt::fop_remove:return,
fbt::fop_link:return,
fbt::fop_rename:return,
fbt::fop_mkdir:return,
fbt::fop_rmdir:return,
fbt::fop_readdir:return,
fbt::fop_symlink:return,
fbt::fop_readlink:return,
fbt::fop_fsync:return,
fbt::fop_getpage:return,
fbt::fop_putpage:return,
fbt::fop_map:return
/((((((self->vnode0) != NULL)))) && (((((self->depth0) != NULL)))) && (((((self->latency0) != NULL)))) && (((((this->fstype = stringof(((vnode_t*)self->vnode0)->v_op->vnop_name)) != NULL || 1)))) && (self->depth0 == stackdepth && self->vnode0 != NULL && (this->fstype == "ufs" || this->fstype == "zfs" || this->fstype == "dev" || this->fstype == "dev fs" || this->fstype == "proc" || this->fstype == "lofs" || this->fstype == "tmpfs" || this->fstype == "nfs")))/{
	@[((probefunc + 4))] = llquantize((timestamp - self->latency0), 10, 3, 11, 100);
}

fbt::fop_read:return,
fbt::fop_write:return,
fbt::fop_ioctl:return,
fbt::fop_access:return,
fbt::fop_getattr:return,
fbt::fop_setattr:return,
fbt::fop_lookup:return,
fbt::fop_create:return,
fbt::fop_remove:return,
fbt::fop_link:return,
fbt::fop_rename:return,
fbt::fop_mkdir:return,
fbt::fop_rmdir:return,
fbt::fop_readdir:return,
fbt::fop_symlink:return,
fbt::fop_readlink:return,
fbt::fop_fsync:return,
fbt::fop_getpage:return,
fbt::fop_putpage:return,
fbt::fop_map:return,
fbt::fop_open:entry
/((self->depth0 == stackdepth))/{
	(self->vnode0) = 0;
	(self->depth0) = 0;
	(self->latency0) = 0;
}

----------------------------------------
[2015-06-13 13:43:18.535 UTC] INFO   instrumented global;1 (fs.logical_ops)
[2015-06-13 13:43:18.539 UTC] DBG    
----------------------------------------
this int state;

sched:::on-cpu
/((curthread->t_pri != -1))/{
	self->runtime0 = timestamp;
}

sched:::off-cpu
/((((((self->runtime0) != NULL)))) && (((((this->state = curlwpsinfo->pr_state) != NULL || 1)))) && (curthread->t_pri != -1))/{
	@[((this->state == SRUN ? "runnable" : this->state == SZOMB ? "exited" : this->state == SSTOP ? "stopped" : this->state == SIDL ? "in proc creation" : this->state == SONPROC ? "on-cpu" : this->state == SWAIT ? "waiting to be runnable" :this->state == SSLEEP ? "sleeping" : "unknown"))] = llquantize((timestamp - self->runtime0), 10, 3, 11, 100);
}

sched:::off-cpu
/((curthread->t_pri != -1))/{
	(self->runtime0) = 0;
}

----------------------------------------
[2015-06-13 13:43:19.806 UTC] INFO   instrumented global;3 (cpu.thread_executions)
[2015-06-13 13:43:19.808 UTC] DBG    
----------------------------------------
this int state;

sched:::on-cpu
/((curthread->t_pri != -1))/{
	self->runtime0 = timestamp;
}

sched:::off-cpu
/((((((self->runtime0) != NULL)))) && (((((this->state = curlwpsinfo->pr_state) != NULL || 1)))) && (curthread->t_pri != -1))/{
	@[(execname)] = llquantize((timestamp - self->runtime0), 10, 3, 11, 100);
}

sched:::off-cpu
/((curthread->t_pri != -1))/{
	(self->runtime0) = 0;
}

----------------------------------------
[2015-06-13 13:43:20.960 UTC] INFO   instrumented global;4 (cpu.thread_executions)
[2015-06-13 13:52:11.310 UTC] DBG    
----------------------------------------
this string fstype;

fbt::fop_read:entry,
fbt::fop_write:entry,
fbt::fop_ioctl:entry,
fbt::fop_access:entry,
fbt::fop_getattr:entry,
fbt::fop_setattr:entry,
fbt::fop_lookup:entry,
fbt::fop_create:entry,
fbt::fop_remove:entry,
fbt::fop_link:entry,
fbt::fop_rename:entry,
fbt::fop_mkdir:entry,
fbt::fop_rmdir:entry,
fbt::fop_readdir:entry,
fbt::fop_symlink:entry,
fbt::fop_readlink:entry,
fbt::fop_fsync:entry,
fbt::fop_getpage:entry,
fbt::fop_putpage:entry,
fbt::fop_map:entry,
fbt::fop_open:entry
/((self->vnode0 == NULL))/{
	self->vnode0 = arg0;
	self->depth0 = stackdepth;
	self->latency0 = timestamp;
}

fbt::fop_open:return
/((((((self->vnode0) != NULL)))) && (((((self->depth0) != NULL)))) && (((((self->latency0) != NULL)))) && (((((this->fstype = stringof((*((vnode_t**)self->vnode0))->v_op->vnop_name)) != NULL || 1)))) && (self->depth0 == stackdepth && self->vnode0 != NULL && (this->fstype == "ufs" || this->fstype == "zfs" || this->fstype == "dev" || this->fstype == "dev fs" || this->fstype == "proc" || this->fstype == "lofs" || this->fstype == "tmpfs" || this->fstype == "nfs")))/{
	@[((probefunc + 4))] = llquantize((timestamp - self->latency0), 10, 3, 11, 100);
}

fbt::fop_read:return,
fbt::fop_write:return,
fbt::fop_ioctl:return,
fbt::fop_access:return,
fbt::fop_getattr:return,
fbt::fop_setattr:return,
fbt::fop_lookup:return,
fbt::fop_create:return,
fbt::fop_remove:return,
fbt::fop_link:return,
fbt::fop_rename:return,
fbt::fop_mkdir:return,
fbt::fop_rmdir:return,
fbt::fop_readdir:return,
fbt::fop_symlink:return,
fbt::fop_readlink:return,
fbt::fop_fsync:return,
fbt::fop_getpage:return,
fbt::fop_putpage:return,
fbt::fop_map:return
/((((((self->vnode0) != NULL)))) && (((((self->depth0) != NULL)))) && (((((self->latency0) != NULL)))) && (((((this->fstype = stringof(((vnode_t*)self->vnode0)->v_op->vnop_name)) != NULL || 1)))) && (self->depth0 == stackdepth && self->vnode0 != NULL && (this->fstype == "ufs" || this->fstype == "zfs" || this->fstype == "dev" || this->fstype == "dev fs" || this->fstype == "proc" || this->fstype == "lofs" || this->fstype == "tmpfs" || this->fstype == "nfs")))/{
	@[((probefunc + 4))] = llquantize((timestamp - self->latency0), 10, 3, 11, 100);
}

fbt::fop_read:return,
fbt::fop_write:return,
fbt::fop_ioctl:return,
fbt::fop_access:return,
fbt::fop_getattr:return,
fbt::fop_setattr:return,
fbt::fop_lookup:return,
fbt::fop_create:return,
fbt::fop_remove:return,
fbt::fop_link:return,
fbt::fop_rename:return,
fbt::fop_mkdir:return,
fbt::fop_rmdir:return,
fbt::fop_readdir:return,
fbt::fop_symlink:return,
fbt::fop_readlink:return,
fbt::fop_fsync:return,
fbt::fop_getpage:return,
fbt::fop_putpage:return,
fbt::fop_map:return,
fbt::fop_open:entry
/((self->depth0 == stackdepth))/{
	(self->vnode0) = 0;
	(self->depth0) = 0;
	(self->latency0) = 0;
}

----------------------------------------
[2015-06-13 13:52:14.968 UTC] INFO   instrumented global;6 (fs.logical_ops)
[2015-06-13 14:43:19.275 UTC] INFO   deinstrumented global;5
[2015-06-13 14:43:19.311 UTC] INFO   deinstrumented global;4
[2015-06-13 14:43:19.312 UTC] INFO   deinstrumented global;3
[2015-06-13 14:43:19.845 UTC] INFO   deinstrumented global;1
[2015-06-13 14:51:27.227 UTC] DBG    ca-amqp: received close event
[2015-06-13 14:51:27.427 UTC] WARN   ca-amqp: connection closing
[2015-06-13 14:51:27.427 UTC] INFO   ca-amqp: trying to reconnect (attempt 1)
[ Jun 13 15:00:47 Enabled. ]
[ Jun 13 15:00:47 Rereading configuration. ]
[ Jun 13 15:00:53 Executing start method ("/opt/smartdc/agents/lib/node_modules/cabase/smf/method/canodesvc"). ]
DTRACE_LIBPATH=/opt/smartdc/agents/lib/node_modules/cabase/lib
ignoring amqp-config key amqp_login
ignoring amqp-config key amqp_password
AMQP_HOST=10.99.99.20
AMQP_PORT=5672
NODE_PATH=:/opt/smartdc/agents/lib/node_modules/cabase/node_modules:/opt/smartdc/agents/lib/node_modules/cabase/node_modules/connect/lib:/opt/smartdc/agents/lib/node_modules/cabase/lib/ca:/opt/smartdc/agents/lib/node_modules/cabase/lib/tst
[ Jun 13 15:00:56 Method "start" exited with status 0. ]
The "sys" module is now called "util". It should have a similar interface.
using backends kstat,dtrace,zfs,cainstr,proc
[2015-06-13 15:01:01.545 UTC] INFO   Logging AMQP message to "/opt/smartdc/agents/log/ca/cainstsvc/amqp-2015-06-13.15:00:53.2782"
[2015-06-13 15:01:01.547 UTC] INFO   Instrumenter starting up (instsvc/0.0)
[2015-06-13 15:01:01.547 UTC] INFO   Hostname:    headnode
[2015-06-13 15:01:01.547 UTC] INFO   AMQP broker: {"host":"10.99.99.20","port":"5672"}
[2015-06-13 15:01:01.547 UTC] INFO   Routing key: ca.instrumenter.headnode
[2015-06-13 15:01:01.586 UTC] DBG    loaded metadata file "metadata/profile/customer.json"
[2015-06-13 15:01:01.587 UTC] DBG    loaded metadata file "metadata/profile/operator.json"
[2015-06-13 15:01:01.588 UTC] DBG    loaded metadata file "metadata/metric/metrics.json"
[2015-06-13 15:01:01.604 UTC] INFO   loading modules.
[2015-06-13 15:01:01.706 UTC] INFO   module "kstat" registered cpu.cpus
[2015-06-13 15:01:01.707 UTC] INFO   module "kstat" registered cpu.usage
[2015-06-13 15:01:01.707 UTC] INFO   module "kstat" registered cpu.waittime
[2015-06-13 15:01:01.707 UTC] INFO   module "kstat" registered cpu.loadavg1
[2015-06-13 15:01:01.708 UTC] INFO   module "kstat" registered nic.nics
[2015-06-13 15:01:01.708 UTC] INFO   module "kstat" registered nic.bytes
[2015-06-13 15:01:01.708 UTC] INFO   module "kstat" registered nic.packets
[2015-06-13 15:01:01.708 UTC] INFO   module "kstat" registered nic.vnic_bytes
[2015-06-13 15:01:01.709 UTC] INFO   module "kstat" registered nic.vnic_packets
[2015-06-13 15:01:01.709 UTC] INFO   module "kstat" registered disk.disks
[2015-06-13 15:01:01.709 UTC] INFO   module "kstat" registered disk.physio_ops
[2015-06-13 15:01:01.710 UTC] INFO   module "kstat" registered disk.physio_bytes
[2015-06-13 15:01:01.710 UTC] INFO   module "kstat" registered tcp.segments
[2015-06-13 15:01:01.712 UTC] INFO   module "kstat" registered tcp.errors
[2015-06-13 15:01:01.713 UTC] INFO   module "kstat" registered fs.logical_rwops
[2015-06-13 15:01:01.714 UTC] INFO   module "kstat" registered fs.logical_rwbytes
[2015-06-13 15:01:01.715 UTC] INFO   module "kstat" registered memory.rss
[2015-06-13 15:01:01.715 UTC] INFO   module "kstat" registered memory.rss_limit
[2015-06-13 15:01:01.715 UTC] INFO   module "kstat" registered memory.swap
[2015-06-13 15:01:01.716 UTC] INFO   module "kstat" registered memory.swap_limit
[2015-06-13 15:01:01.716 UTC] INFO   module "kstat" registered memory.reclaimed_bytes
[2015-06-13 15:01:01.717 UTC] INFO   module "kstat" registered memory.pageins
[2015-06-13 15:01:01.718 UTC] INFO   module "kstat" registered vm.exits
[2015-06-13 15:01:01.718 UTC] INFO   module "kstat" registered zfs.arc_ops
[2015-06-13 15:01:01.719 UTC] INFO   loaded module "kstat".
[2015-06-13 15:01:02.117 UTC] INFO   module "dtrace" registered apache.httpd_ops
[2015-06-13 15:01:02.121 UTC] INFO   module "dtrace" registered cpu.thread_executions
[2015-06-13 15:01:02.123 UTC] INFO   module "dtrace" registered cpu.thread_samples
[2015-06-13 15:01:02.127 UTC] INFO   module "dtrace" registered disk.physio_ops
[2015-06-13 15:01:02.129 UTC] INFO   module "dtrace" registered fs.logical_ops
[2015-06-13 15:01:02.131 UTC] INFO   module "dtrace" registered fs.logical_rwops
[2015-06-13 15:01:02.133 UTC] INFO   module "dtrace" registered ldapjs.connections
[2015-06-13 15:01:02.138 UTC] INFO   module "dtrace" registered ldapjs.ops
[2015-06-13 15:01:02.140 UTC] INFO   module "dtrace" registered ldapjs.search_ops
[2015-06-13 15:01:02.146 UTC] INFO   module "dtrace" registered mantaop.jobs_assigned
[2015-06-13 15:01:02.149 UTC] INFO   module "dtrace" registered mantaop.supervisor_auths
[2015-06-13 15:01:02.151 UTC] INFO   module "dtrace" registered mantaop.supervisor_deletes
[2015-06-13 15:01:02.153 UTC] INFO   module "dtrace" registered mantaop.supervisor_errors
[2015-06-13 15:01:02.155 UTC] INFO   module "dtrace" registered mantaop.supervisor_locates
[2015-06-13 15:01:02.156 UTC] INFO   module "dtrace" registered mantaop.tasks_committed
[2015-06-13 15:01:02.157 UTC] INFO   module "dtrace" registered mantaop.tasks_dispatched
[2015-06-13 15:01:02.160 UTC] INFO   module "dtrace" registered mantaop.tasks_executed
[2015-06-13 15:01:02.161 UTC] INFO   module "dtrace" registered mantaop.tasks_killed
[2015-06-13 15:01:02.162 UTC] INFO   module "dtrace" registered mantaop.zone_resets
[2015-06-13 15:01:02.164 UTC] INFO   module "dtrace" registered moray.ops
[2015-06-13 15:01:02.165 UTC] INFO   module "dtrace" registered moray.queries
[2015-06-13 15:01:02.167 UTC] INFO   module "dtrace" registered mysql.commands
[2015-06-13 15:01:02.168 UTC] INFO   module "dtrace" registered mysql.connections
[2015-06-13 15:01:02.169 UTC] INFO   module "dtrace" registered mysql.filesort
[2015-06-13 15:01:02.171 UTC] INFO   module "dtrace" registered mysql.queries
[2015-06-13 15:01:02.173 UTC] INFO   module "dtrace" registered mysql.statements
[2015-06-13 15:01:02.175 UTC] INFO   module "dtrace" registered node.gc_ops
[2015-06-13 15:01:02.179 UTC] INFO   module "dtrace" registered node.httpc_ops
[2015-06-13 15:01:02.183 UTC] INFO   module "dtrace" registered node.httpd_ops
[2015-06-13 15:01:02.185 UTC] INFO   module "dtrace" registered node.socket_ops
[2015-06-13 15:01:02.187 UTC] INFO   module "dtrace" registered postgres.queries
[2015-06-13 15:01:02.189 UTC] INFO   module "dtrace" registered unix.proc_execs
[2015-06-13 15:01:02.191 UTC] INFO   module "dtrace" registered unix.proc_exits
[2015-06-13 15:01:02.194 UTC] INFO   module "dtrace" registered unix.proc_forks
[2015-06-13 15:01:02.196 UTC] INFO   module "dtrace" registered restify.handler_ops
[2015-06-13 15:01:02.198 UTC] INFO   module "dtrace" registered restify.server_ops
[2015-06-13 15:01:02.200 UTC] INFO   module "dtrace" registered syscall.syscalls
[2015-06-13 15:01:02.202 UTC] INFO   module "dtrace" registered tcp.accepts
[2015-06-13 15:01:02.204 UTC] INFO   module "dtrace" registered tcp.connects
[2015-06-13 15:01:02.205 UTC] INFO   module "dtrace" registered unix.thr_creates
[2015-06-13 15:01:02.207 UTC] INFO   module "dtrace" registered vm.irqs
[2015-06-13 15:01:02.208 UTC] INFO   module "dtrace" registered vm.physio_bytes
[2015-06-13 15:01:02.215 UTC] INFO   module "dtrace" registered vm.physio_ops
[2015-06-13 15:01:02.218 UTC] INFO   module "dtrace" registered vm.thread_samples
[2015-06-13 15:01:02.220 UTC] INFO   module "dtrace" registered zfs.arc_ops
[2015-06-13 15:01:02.220 UTC] INFO   loaded module "dtrace".
[2015-06-13 15:01:02.232 UTC] INFO   module "zfs" registered zfs.dataset_unused_quota
[2015-06-13 15:01:02.232 UTC] INFO   module "zfs" registered zfs.dataset_used
[2015-06-13 15:01:02.233 UTC] INFO   module "zfs" registered zfs.dataset_quota
[2015-06-13 15:01:02.233 UTC] INFO   module "zfs" registered zfs.pool_free
[2015-06-13 15:01:02.233 UTC] INFO   module "zfs" registered zfs.pool_used
[2015-06-13 15:01:02.233 UTC] INFO   module "zfs" registered zfs.pool_total
[2015-06-13 15:01:02.233 UTC] INFO   loaded module "zfs".
[2015-06-13 15:01:02.236 UTC] INFO   module "cainstr" registered ca.instr_ticks
[2015-06-13 15:01:02.236 UTC] INFO   module "cainstr" registered ca.instr_beops
[2015-06-13 15:01:02.236 UTC] INFO   module "cainstr" registered ca.instr_enables
[2015-06-13 15:01:02.236 UTC] INFO   module "cainstr" registered ca.instr_disables
[2015-06-13 15:01:02.236 UTC] INFO   loaded module "cainstr".
[2015-06-13 15:01:02.598 UTC] INFO   module "proc" registered unix.processes
[2015-06-13 15:01:02.598 UTC] INFO   loaded module "proc".
[2015-06-13 15:01:02.598 UTC] INFO   finished loading modules.
[2015-06-13 15:04:13.642 UTC] ERROR  ca-amqp: received connection error: EXCEPTION: Error: Error: connect ETIMEDOUT
    at errnoException (net.js:646:11)
    at Object.afterConnect [as oncomplete] (net.js:637:18)
[2015-06-13 15:04:13.644 UTC] WARN   EXCEPTION: caError: amqp error "ETIMEDOUT": connect ETIMEDOUT
    at capAmqpCap.error (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp-cap.js:390:9)
    at caAmqp.<anonymous> (native)
    at caAmqp.emit (events.js:67:17)
    at caAmqp.connError (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp.js:307:7)
    at Connection.<anonymous> (native)
    at Connection.emit (events.js:67:17)
    at Array.0 (net.js:319:25)
    at EventEmitter._tickCallback (node.js:192:40)
[2015-06-13 15:04:13.645 UTC] DBG    ca-amqp: received close event
[2015-06-13 15:04:13.645 UTC] WARN   ca-amqp: connection closing
[2015-06-13 15:04:13.645 UTC] INFO   ca-amqp: trying to reconnect (attempt 1)
[2015-06-13 15:05:29.650 UTC] ERROR  ca-amqp: received connection error: EXCEPTION: Error: Error: connect ECONNREFUSED
    at errnoException (net.js:646:11)
    at Object.afterConnect [as oncomplete] (net.js:637:18)
[2015-06-13 15:05:29.652 UTC] WARN   EXCEPTION: caError: amqp error "ECONNREFUSED": connect ECONNREFUSED
    at capAmqpCap.error (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp-cap.js:390:9)
    at caAmqp.<anonymous> (native)
    at caAmqp.emit (events.js:67:17)
    at caAmqp.connError (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp.js:307:7)
    at Connection.<anonymous> (native)
    at Connection.emit (events.js:67:17)
    at Array.0 (net.js:319:25)
    at EventEmitter._tickCallback (node.js:192:40)
[2015-06-13 15:05:29.653 UTC] DBG    ca-amqp: received close event
[2015-06-13 15:05:29.653 UTC] WARN   ca-amqp: connection closing
[2015-06-13 15:05:29.653 UTC] INFO   ca-amqp: trying to reconnect (attempt 2)
[2015-06-13 15:05:34.680 UTC] ERROR  ca-amqp: received connection error: EXCEPTION: Error: Error: connect ECONNREFUSED
    at errnoException (net.js:646:11)
    at Object.afterConnect [as oncomplete] (net.js:637:18)
[2015-06-13 15:05:34.682 UTC] WARN   EXCEPTION: caError: amqp error "ECONNREFUSED": connect ECONNREFUSED
    at capAmqpCap.error (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp-cap.js:390:9)
    at caAmqp.<anonymous> (native)
    at caAmqp.emit (events.js:67:17)
    at caAmqp.connError (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp.js:307:7)
    at Connection.<anonymous> (native)
    at Connection.emit (events.js:67:17)
    at Array.0 (net.js:319:25)
    at EventEmitter._tickCallback (node.js:192:40)
[2015-06-13 15:05:34.682 UTC] DBG    ca-amqp: received close event
[2015-06-13 15:05:34.683 UTC] WARN   ca-amqp: connection closing
[2015-06-13 15:05:34.683 UTC] INFO   ca-amqp: trying to reconnect (attempt 3)
[2015-06-13 15:05:39.707 UTC] ERROR  ca-amqp: received connection error: EXCEPTION: Error: Error: connect ECONNREFUSED
    at errnoException (net.js:646:11)
    at Object.afterConnect [as oncomplete] (net.js:637:18)
[2015-06-13 15:05:39.709 UTC] WARN   EXCEPTION: caError: amqp error "ECONNREFUSED": connect ECONNREFUSED
    at capAmqpCap.error (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp-cap.js:390:9)
    at caAmqp.<anonymous> (native)
    at caAmqp.emit (events.js:67:17)
    at caAmqp.connError (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp.js:307:7)
    at Connection.<anonymous> (native)
    at Connection.emit (events.js:67:17)
    at Array.0 (net.js:319:25)
    at EventEmitter._tickCallback (node.js:192:40)
[2015-06-13 15:05:39.709 UTC] DBG    ca-amqp: received close event
[2015-06-13 15:05:39.709 UTC] WARN   ca-amqp: connection closing
[2015-06-13 15:05:39.709 UTC] INFO   ca-amqp: trying to reconnect (attempt 4)
[2015-06-13 15:05:44.709 UTC] ERROR  ca-amqp: received connection error: EXCEPTION: Error: Error: connect ECONNREFUSED
    at errnoException (net.js:646:11)
    at Object.afterConnect [as oncomplete] (net.js:637:18)
[2015-06-13 15:05:44.710 UTC] WARN   EXCEPTION: caError: amqp error "ECONNREFUSED": connect ECONNREFUSED
    at capAmqpCap.error (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp-cap.js:390:9)
    at caAmqp.<anonymous> (native)
    at caAmqp.emit (events.js:67:17)
    at caAmqp.connError (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp.js:307:7)
    at Connection.<anonymous> (native)
    at Connection.emit (events.js:67:17)
    at Array.0 (net.js:319:25)
    at EventEmitter._tickCallback (node.js:192:40)
[2015-06-13 15:05:44.710 UTC] DBG    ca-amqp: received close event
[2015-06-13 15:05:44.710 UTC] WARN   ca-amqp: connection closing
[2015-06-13 15:05:44.710 UTC] INFO   ca-amqp: trying to reconnect (attempt 5)
[2015-06-13 15:05:49.711 UTC] ERROR  ca-amqp: received connection error: EXCEPTION: Error: Error: connect ECONNREFUSED
    at errnoException (net.js:646:11)
    at Object.afterConnect [as oncomplete] (net.js:637:18)
[2015-06-13 15:05:49.712 UTC] WARN   EXCEPTION: caError: amqp error "ECONNREFUSED": connect ECONNREFUSED
    at capAmqpCap.error (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp-cap.js:390:9)
    at caAmqp.<anonymous> (native)
    at caAmqp.emit (events.js:67:17)
    at caAmqp.connError (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp.js:307:7)
    at Connection.<anonymous> (native)
    at Connection.emit (events.js:67:17)
    at Array.0 (net.js:319:25)
    at EventEmitter._tickCallback (node.js:192:40)
[2015-06-13 15:05:49.713 UTC] DBG    ca-amqp: received close event
[2015-06-13 15:05:49.713 UTC] WARN   ca-amqp: connection closing
[2015-06-13 15:05:49.713 UTC] INFO   ca-amqp: trying to reconnect (attempt 6)
[2015-06-13 15:05:54.749 UTC] ERROR  ca-amqp: received connection error: EXCEPTION: Error: Error: connect ECONNREFUSED
    at errnoException (net.js:646:11)
    at Object.afterConnect [as oncomplete] (net.js:637:18)
[2015-06-13 15:05:54.751 UTC] WARN   EXCEPTION: caError: amqp error "ECONNREFUSED": connect ECONNREFUSED
    at capAmqpCap.error (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp-cap.js:390:9)
    at caAmqp.<anonymous> (native)
    at caAmqp.emit (events.js:67:17)
    at caAmqp.connError (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp.js:307:7)
    at Connection.<anonymous> (native)
    at Connection.emit (events.js:67:17)
    at Array.0 (net.js:319:25)
    at EventEmitter._tickCallback (node.js:192:40)
[2015-06-13 15:05:54.752 UTC] DBG    ca-amqp: received close event
[2015-06-13 15:05:54.752 UTC] WARN   ca-amqp: connection closing
[2015-06-13 15:05:54.752 UTC] INFO   ca-amqp: trying to reconnect (attempt 7)
[2015-06-13 15:05:59.761 UTC] ERROR  ca-amqp: received connection error: EXCEPTION: Error: Error: connect ECONNREFUSED
    at errnoException (net.js:646:11)
    at Object.afterConnect [as oncomplete] (net.js:637:18)
[2015-06-13 15:05:59.762 UTC] WARN   EXCEPTION: caError: amqp error "ECONNREFUSED": connect ECONNREFUSED
    at capAmqpCap.error (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp-cap.js:390:9)
    at caAmqp.<anonymous> (native)
    at caAmqp.emit (events.js:67:17)
    at caAmqp.connError (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp.js:307:7)
    at Connection.<anonymous> (native)
    at Connection.emit (events.js:67:17)
    at Array.0 (net.js:319:25)
    at EventEmitter._tickCallback (node.js:192:40)
[2015-06-13 15:05:59.763 UTC] DBG    ca-amqp: received close event
[2015-06-13 15:05:59.763 UTC] WARN   ca-amqp: connection closing
[2015-06-13 15:05:59.763 UTC] INFO   ca-amqp: trying to reconnect (attempt 8)
[2015-06-13 15:06:04.766 UTC] ERROR  ca-amqp: received connection error: EXCEPTION: Error: Error: connect ECONNREFUSED
    at errnoException (net.js:646:11)
    at Object.afterConnect [as oncomplete] (net.js:637:18)
[2015-06-13 15:06:04.767 UTC] WARN   EXCEPTION: caError: amqp error "ECONNREFUSED": connect ECONNREFUSED
    at capAmqpCap.error (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp-cap.js:390:9)
    at caAmqp.<anonymous> (native)
    at caAmqp.emit (events.js:67:17)
    at caAmqp.connError (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp.js:307:7)
    at Connection.<anonymous> (native)
    at Connection.emit (events.js:67:17)
    at Array.0 (net.js:319:25)
    at EventEmitter._tickCallback (node.js:192:40)
[2015-06-13 15:06:04.767 UTC] DBG    ca-amqp: received close event
[2015-06-13 15:06:04.767 UTC] WARN   ca-amqp: connection closing
[2015-06-13 15:06:04.767 UTC] INFO   ca-amqp: trying to reconnect (attempt 9)
[2015-06-13 15:06:09.771 UTC] ERROR  ca-amqp: received connection error: EXCEPTION: Error: Error: connect ECONNREFUSED
    at errnoException (net.js:646:11)
    at Object.afterConnect [as oncomplete] (net.js:637:18)
[2015-06-13 15:06:09.772 UTC] WARN   EXCEPTION: caError: amqp error "ECONNREFUSED": connect ECONNREFUSED
    at capAmqpCap.error (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp-cap.js:390:9)
    at caAmqp.<anonymous> (native)
    at caAmqp.emit (events.js:67:17)
    at caAmqp.connError (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp.js:307:7)
    at Connection.<anonymous> (native)
    at Connection.emit (events.js:67:17)
    at Array.0 (net.js:319:25)
    at EventEmitter._tickCallback (node.js:192:40)
[2015-06-13 15:06:09.773 UTC] DBG    ca-amqp: received close event
[2015-06-13 15:06:09.773 UTC] WARN   ca-amqp: connection closing
[2015-06-13 15:06:09.773 UTC] INFO   ca-amqp: trying to reconnect (attempt 10)
[2015-06-13 15:06:14.773 UTC] ERROR  ca-amqp: received connection error: EXCEPTION: Error: Error: connect ECONNREFUSED
    at errnoException (net.js:646:11)
    at Object.afterConnect [as oncomplete] (net.js:637:18)
[2015-06-13 15:06:14.774 UTC] WARN   EXCEPTION: caError: amqp error "ECONNREFUSED": connect ECONNREFUSED
    at capAmqpCap.error (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp-cap.js:390:9)
    at caAmqp.<anonymous> (native)
    at caAmqp.emit (events.js:67:17)
    at caAmqp.connError (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp.js:307:7)
    at Connection.<anonymous> (native)
    at Connection.emit (events.js:67:17)
    at Array.0 (net.js:319:25)
    at EventEmitter._tickCallback (node.js:192:40)
[2015-06-13 15:06:14.774 UTC] DBG    ca-amqp: received close event
[2015-06-13 15:06:14.774 UTC] WARN   ca-amqp: connection closing
[2015-06-13 15:06:14.775 UTC] INFO   ca-amqp: trying to reconnect (attempt 11)
[2015-06-13 15:06:19.774 UTC] ERROR  ca-amqp: received connection error: EXCEPTION: Error: Error: connect ECONNREFUSED
    at errnoException (net.js:646:11)
    at Object.afterConnect [as oncomplete] (net.js:637:18)
[2015-06-13 15:06:19.775 UTC] WARN   EXCEPTION: caError: amqp error "ECONNREFUSED": connect ECONNREFUSED
    at capAmqpCap.error (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp-cap.js:390:9)
    at caAmqp.<anonymous> (native)
    at caAmqp.emit (events.js:67:17)
    at caAmqp.connError (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp.js:307:7)
    at Connection.<anonymous> (native)
    at Connection.emit (events.js:67:17)
    at Array.0 (net.js:319:25)
    at EventEmitter._tickCallback (node.js:192:40)
[2015-06-13 15:06:19.776 UTC] DBG    ca-amqp: received close event
[2015-06-13 15:06:19.776 UTC] WARN   ca-amqp: connection closing
[2015-06-13 15:06:19.776 UTC] INFO   ca-amqp: trying to reconnect (attempt 12)
[2015-06-13 15:06:24.777 UTC] ERROR  ca-amqp: received connection error: EXCEPTION: Error: Error: connect ECONNREFUSED
    at errnoException (net.js:646:11)
    at Object.afterConnect [as oncomplete] (net.js:637:18)
[2015-06-13 15:06:24.778 UTC] WARN   EXCEPTION: caError: amqp error "ECONNREFUSED": connect ECONNREFUSED
    at capAmqpCap.error (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp-cap.js:390:9)
    at caAmqp.<anonymous> (native)
    at caAmqp.emit (events.js:67:17)
    at caAmqp.connError (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp.js:307:7)
    at Connection.<anonymous> (native)
    at Connection.emit (events.js:67:17)
    at Array.0 (net.js:319:25)
    at EventEmitter._tickCallback (node.js:192:40)
[2015-06-13 15:06:24.778 UTC] DBG    ca-amqp: received close event
[2015-06-13 15:06:24.779 UTC] WARN   ca-amqp: connection closing
[2015-06-13 15:06:24.779 UTC] INFO   ca-amqp: trying to reconnect (attempt 13)
[2015-06-13 15:06:29.781 UTC] ERROR  ca-amqp: received connection error: EXCEPTION: Error: Error: connect ECONNREFUSED
    at errnoException (net.js:646:11)
    at Object.afterConnect [as oncomplete] (net.js:637:18)
[2015-06-13 15:06:29.786 UTC] WARN   EXCEPTION: caError: amqp error "ECONNREFUSED": connect ECONNREFUSED
    at capAmqpCap.error (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp-cap.js:390:9)
    at caAmqp.<anonymous> (native)
    at caAmqp.emit (events.js:67:17)
    at caAmqp.connError (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp.js:307:7)
    at Connection.<anonymous> (native)
    at Connection.emit (events.js:67:17)
    at Array.0 (net.js:319:25)
    at EventEmitter._tickCallback (node.js:192:40)
[2015-06-13 15:06:29.786 UTC] DBG    ca-amqp: received close event
[2015-06-13 15:06:29.786 UTC] WARN   ca-amqp: connection closing
[2015-06-13 15:06:29.786 UTC] INFO   ca-amqp: trying to reconnect (attempt 14)
[2015-06-13 15:06:34.789 UTC] ERROR  ca-amqp: received connection error: EXCEPTION: Error: Error: connect ECONNREFUSED
    at errnoException (net.js:646:11)
    at Object.afterConnect [as oncomplete] (net.js:637:18)
[2015-06-13 15:06:34.790 UTC] WARN   EXCEPTION: caError: amqp error "ECONNREFUSED": connect ECONNREFUSED
    at capAmqpCap.error (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp-cap.js:390:9)
    at caAmqp.<anonymous> (native)
    at caAmqp.emit (events.js:67:17)
    at caAmqp.connError (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp.js:307:7)
    at Connection.<anonymous> (native)
    at Connection.emit (events.js:67:17)
    at Array.0 (net.js:319:25)
    at EventEmitter._tickCallback (node.js:192:40)
[2015-06-13 15:06:34.790 UTC] DBG    ca-amqp: received close event
[2015-06-13 15:06:34.791 UTC] WARN   ca-amqp: connection closing
[2015-06-13 15:06:34.791 UTC] INFO   ca-amqp: trying to reconnect (attempt 15)
[2015-06-13 15:06:39.791 UTC] ERROR  ca-amqp: received connection error: EXCEPTION: Error: Error: connect ECONNREFUSED
    at errnoException (net.js:646:11)
    at Object.afterConnect [as oncomplete] (net.js:637:18)
[2015-06-13 15:06:39.792 UTC] WARN   EXCEPTION: caError: amqp error "ECONNREFUSED": connect ECONNREFUSED
    at capAmqpCap.error (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp-cap.js:390:9)
    at caAmqp.<anonymous> (native)
    at caAmqp.emit (events.js:67:17)
    at caAmqp.connError (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp.js:307:7)
    at Connection.<anonymous> (native)
    at Connection.emit (events.js:67:17)
    at Array.0 (net.js:319:25)
    at EventEmitter._tickCallback (node.js:192:40)
[2015-06-13 15:06:39.793 UTC] DBG    ca-amqp: received close event
[2015-06-13 15:06:39.793 UTC] WARN   ca-amqp: connection closing
[2015-06-13 15:06:39.793 UTC] INFO   ca-amqp: trying to reconnect (attempt 16)
[2015-06-13 15:06:44.792 UTC] ERROR  ca-amqp: received connection error: EXCEPTION: Error: Error: connect ECONNREFUSED
    at errnoException (net.js:646:11)
    at Object.afterConnect [as oncomplete] (net.js:637:18)
[2015-06-13 15:06:44.794 UTC] WARN   EXCEPTION: caError: amqp error "ECONNREFUSED": connect ECONNREFUSED
    at capAmqpCap.error (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp-cap.js:390:9)
    at caAmqp.<anonymous> (native)
    at caAmqp.emit (events.js:67:17)
    at caAmqp.connError (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp.js:307:7)
    at Connection.<anonymous> (native)
    at Connection.emit (events.js:67:17)
    at Array.0 (net.js:319:25)
    at EventEmitter._tickCallback (node.js:192:40)
[2015-06-13 15:06:44.795 UTC] DBG    ca-amqp: received close event
[2015-06-13 15:06:44.795 UTC] WARN   ca-amqp: connection closing
[2015-06-13 15:06:44.795 UTC] INFO   ca-amqp: trying to reconnect (attempt 17)
[2015-06-13 15:06:49.798 UTC] ERROR  ca-amqp: received connection error: EXCEPTION: Error: Error: connect ECONNREFUSED
    at errnoException (net.js:646:11)
    at Object.afterConnect [as oncomplete] (net.js:637:18)
[2015-06-13 15:06:49.800 UTC] WARN   EXCEPTION: caError: amqp error "ECONNREFUSED": connect ECONNREFUSED
    at capAmqpCap.error (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp-cap.js:390:9)
    at caAmqp.<anonymous> (native)
    at caAmqp.emit (events.js:67:17)
    at caAmqp.connError (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp.js:307:7)
    at Connection.<anonymous> (native)
    at Connection.emit (events.js:67:17)
    at Array.0 (net.js:319:25)
    at EventEmitter._tickCallback (node.js:192:40)
[2015-06-13 15:06:49.800 UTC] DBG    ca-amqp: received close event
[2015-06-13 15:06:49.800 UTC] WARN   ca-amqp: connection closing
[2015-06-13 15:06:49.800 UTC] INFO   ca-amqp: trying to reconnect (attempt 18)
[2015-06-13 15:06:54.801 UTC] ERROR  ca-amqp: received connection error: EXCEPTION: Error: Error: connect ECONNREFUSED
    at errnoException (net.js:646:11)
    at Object.afterConnect [as oncomplete] (net.js:637:18)
[2015-06-13 15:06:54.802 UTC] WARN   EXCEPTION: caError: amqp error "ECONNREFUSED": connect ECONNREFUSED
    at capAmqpCap.error (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp-cap.js:390:9)
    at caAmqp.<anonymous> (native)
    at caAmqp.emit (events.js:67:17)
    at caAmqp.connError (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp.js:307:7)
    at Connection.<anonymous> (native)
    at Connection.emit (events.js:67:17)
    at Array.0 (net.js:319:25)
    at EventEmitter._tickCallback (node.js:192:40)
[2015-06-13 15:06:54.802 UTC] DBG    ca-amqp: received close event
[2015-06-13 15:06:54.802 UTC] WARN   ca-amqp: connection closing
[2015-06-13 15:06:54.803 UTC] INFO   ca-amqp: trying to reconnect (attempt 19)
[2015-06-13 15:06:59.803 UTC] ERROR  ca-amqp: received connection error: EXCEPTION: Error: Error: connect ECONNREFUSED
    at errnoException (net.js:646:11)
    at Object.afterConnect [as oncomplete] (net.js:637:18)
[2015-06-13 15:06:59.804 UTC] WARN   EXCEPTION: caError: amqp error "ECONNREFUSED": connect ECONNREFUSED
    at capAmqpCap.error (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp-cap.js:390:9)
    at caAmqp.<anonymous> (native)
    at caAmqp.emit (events.js:67:17)
    at caAmqp.connError (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp.js:307:7)
    at Connection.<anonymous> (native)
    at Connection.emit (events.js:67:17)
    at Array.0 (net.js:319:25)
    at EventEmitter._tickCallback (node.js:192:40)
[2015-06-13 15:06:59.804 UTC] DBG    ca-amqp: received close event
[2015-06-13 15:06:59.804 UTC] WARN   ca-amqp: connection closing
[2015-06-13 15:06:59.804 UTC] INFO   ca-amqp: trying to reconnect (attempt 20)
[2015-06-13 15:07:04.808 UTC] ERROR  ca-amqp: received connection error: EXCEPTION: Error: Error: connect ECONNREFUSED
    at errnoException (net.js:646:11)
    at Object.afterConnect [as oncomplete] (net.js:637:18)
[2015-06-13 15:07:04.810 UTC] WARN   EXCEPTION: caError: amqp error "ECONNREFUSED": connect ECONNREFUSED
    at capAmqpCap.error (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp-cap.js:390:9)
    at caAmqp.<anonymous> (native)
    at caAmqp.emit (events.js:67:17)
    at caAmqp.connError (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp.js:307:7)
    at Connection.<anonymous> (native)
    at Connection.emit (events.js:67:17)
    at Array.0 (net.js:319:25)
    at EventEmitter._tickCallback (node.js:192:40)
[2015-06-13 15:07:04.810 UTC] DBG    ca-amqp: received close event
[2015-06-13 15:07:04.810 UTC] WARN   ca-amqp: connection closing
[2015-06-13 15:07:04.810 UTC] INFO   ca-amqp: trying to reconnect (attempt 21)
[2015-06-13 15:07:09.810 UTC] ERROR  ca-amqp: received connection error: EXCEPTION: Error: Error: connect ECONNREFUSED
    at errnoException (net.js:646:11)
    at Object.afterConnect [as oncomplete] (net.js:637:18)
[2015-06-13 15:07:09.811 UTC] WARN   EXCEPTION: caError: amqp error "ECONNREFUSED": connect ECONNREFUSED
    at capAmqpCap.error (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp-cap.js:390:9)
    at caAmqp.<anonymous> (native)
    at caAmqp.emit (events.js:67:17)
    at caAmqp.connError (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp.js:307:7)
    at Connection.<anonymous> (native)
    at Connection.emit (events.js:67:17)
    at Array.0 (net.js:319:25)
    at EventEmitter._tickCallback (node.js:192:40)
[2015-06-13 15:07:09.811 UTC] DBG    ca-amqp: received close event
[2015-06-13 15:07:09.812 UTC] WARN   ca-amqp: connection closing
[2015-06-13 15:07:09.812 UTC] INFO   ca-amqp: trying to reconnect (attempt 22)
[2015-06-13 15:07:14.991 UTC] ERROR  ca-amqp: received connection error: EXCEPTION: Error: Error: connect ECONNREFUSED
    at errnoException (net.js:646:11)
    at Object.afterConnect [as oncomplete] (net.js:637:18)
[2015-06-13 15:07:14.993 UTC] WARN   EXCEPTION: caError: amqp error "ECONNREFUSED": connect ECONNREFUSED
    at capAmqpCap.error (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp-cap.js:390:9)
    at caAmqp.<anonymous> (native)
    at caAmqp.emit (events.js:67:17)
    at caAmqp.connError (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp.js:307:7)
    at Connection.<anonymous> (native)
    at Connection.emit (events.js:67:17)
    at Array.0 (net.js:319:25)
    at EventEmitter._tickCallback (node.js:192:40)
[2015-06-13 15:07:14.993 UTC] DBG    ca-amqp: received close event
[2015-06-13 15:07:14.993 UTC] WARN   ca-amqp: connection closing
[2015-06-13 15:07:14.993 UTC] INFO   ca-amqp: trying to reconnect (attempt 23)
[2015-06-13 15:07:19.997 UTC] ERROR  ca-amqp: received connection error: EXCEPTION: Error: Error: connect ECONNREFUSED
    at errnoException (net.js:646:11)
    at Object.afterConnect [as oncomplete] (net.js:637:18)
[2015-06-13 15:07:20.000 UTC] WARN   EXCEPTION: caError: amqp error "ECONNREFUSED": connect ECONNREFUSED
    at capAmqpCap.error (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp-cap.js:390:9)
    at caAmqp.<anonymous> (native)
    at caAmqp.emit (events.js:67:17)
    at caAmqp.connError (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp.js:307:7)
    at Connection.<anonymous> (native)
    at Connection.emit (events.js:67:17)
    at Array.0 (net.js:319:25)
    at EventEmitter._tickCallback (node.js:192:40)
[2015-06-13 15:07:20.000 UTC] DBG    ca-amqp: received close event
[2015-06-13 15:07:20.000 UTC] WARN   ca-amqp: connection closing
[2015-06-13 15:07:20.000 UTC] INFO   ca-amqp: trying to reconnect (attempt 24)
[2015-06-13 15:07:25.003 UTC] ERROR  ca-amqp: received connection error: EXCEPTION: Error: Error: connect ECONNREFUSED
    at errnoException (net.js:646:11)
    at Object.afterConnect [as oncomplete] (net.js:637:18)
[2015-06-13 15:07:25.004 UTC] WARN   EXCEPTION: caError: amqp error "ECONNREFUSED": connect ECONNREFUSED
    at capAmqpCap.error (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp-cap.js:390:9)
    at caAmqp.<anonymous> (native)
    at caAmqp.emit (events.js:67:17)
    at caAmqp.connError (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp.js:307:7)
    at Connection.<anonymous> (native)
    at Connection.emit (events.js:67:17)
    at Array.0 (net.js:319:25)
    at EventEmitter._tickCallback (node.js:192:40)
[2015-06-13 15:07:25.005 UTC] DBG    ca-amqp: received close event
[2015-06-13 15:07:25.005 UTC] WARN   ca-amqp: connection closing
[2015-06-13 15:07:25.006 UTC] INFO   ca-amqp: trying to reconnect (attempt 25)
[2015-06-13 15:07:30.008 UTC] ERROR  ca-amqp: received connection error: EXCEPTION: Error: Error: connect ECONNREFUSED
    at errnoException (net.js:646:11)
    at Object.afterConnect [as oncomplete] (net.js:637:18)
[2015-06-13 15:07:30.009 UTC] WARN   EXCEPTION: caError: amqp error "ECONNREFUSED": connect ECONNREFUSED
    at capAmqpCap.error (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp-cap.js:390:9)
    at caAmqp.<anonymous> (native)
    at caAmqp.emit (events.js:67:17)
    at caAmqp.connError (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp.js:307:7)
    at Connection.<anonymous> (native)
    at Connection.emit (events.js:67:17)
    at Array.0 (net.js:319:25)
    at EventEmitter._tickCallback (node.js:192:40)
[2015-06-13 15:07:30.010 UTC] DBG    ca-amqp: received close event
[2015-06-13 15:07:30.010 UTC] WARN   ca-amqp: connection closing
[2015-06-13 15:07:30.010 UTC] INFO   ca-amqp: trying to reconnect (attempt 26)
[2015-06-13 15:07:35.010 UTC] ERROR  ca-amqp: received connection error: EXCEPTION: Error: Error: connect ECONNREFUSED
    at errnoException (net.js:646:11)
    at Object.afterConnect [as oncomplete] (net.js:637:18)
[2015-06-13 15:07:35.012 UTC] WARN   EXCEPTION: caError: amqp error "ECONNREFUSED": connect ECONNREFUSED
    at capAmqpCap.error (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp-cap.js:390:9)
    at caAmqp.<anonymous> (native)
    at caAmqp.emit (events.js:67:17)
    at caAmqp.connError (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp.js:307:7)
    at Connection.<anonymous> (native)
    at Connection.emit (events.js:67:17)
    at Array.0 (net.js:319:25)
    at EventEmitter._tickCallback (node.js:192:40)
[2015-06-13 15:07:35.012 UTC] DBG    ca-amqp: received close event
[2015-06-13 15:07:35.012 UTC] WARN   ca-amqp: connection closing
[2015-06-13 15:07:35.012 UTC] INFO   ca-amqp: trying to reconnect (attempt 27)
[2015-06-13 15:07:40.012 UTC] ERROR  ca-amqp: received connection error: EXCEPTION: Error: Error: connect ECONNREFUSED
    at errnoException (net.js:646:11)
    at Object.afterConnect [as oncomplete] (net.js:637:18)
[2015-06-13 15:07:40.015 UTC] WARN   EXCEPTION: caError: amqp error "ECONNREFUSED": connect ECONNREFUSED
    at capAmqpCap.error (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp-cap.js:390:9)
    at caAmqp.<anonymous> (native)
    at caAmqp.emit (events.js:67:17)
    at caAmqp.connError (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp.js:307:7)
    at Connection.<anonymous> (native)
    at Connection.emit (events.js:67:17)
    at Array.0 (net.js:319:25)
    at EventEmitter._tickCallback (node.js:192:40)
[2015-06-13 15:07:40.015 UTC] DBG    ca-amqp: received close event
[2015-06-13 15:07:40.015 UTC] WARN   ca-amqp: connection closing
[2015-06-13 15:07:40.016 UTC] INFO   ca-amqp: trying to reconnect (attempt 28)
[2015-06-13 15:07:45.018 UTC] ERROR  ca-amqp: received connection error: EXCEPTION: Error: Error: connect ECONNREFUSED
    at errnoException (net.js:646:11)
    at Object.afterConnect [as oncomplete] (net.js:637:18)
[2015-06-13 15:07:45.019 UTC] WARN   EXCEPTION: caError: amqp error "ECONNREFUSED": connect ECONNREFUSED
    at capAmqpCap.error (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp-cap.js:390:9)
    at caAmqp.<anonymous> (native)
    at caAmqp.emit (events.js:67:17)
    at caAmqp.connError (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp.js:307:7)
    at Connection.<anonymous> (native)
    at Connection.emit (events.js:67:17)
    at Array.0 (net.js:319:25)
    at EventEmitter._tickCallback (node.js:192:40)
[2015-06-13 15:07:45.019 UTC] DBG    ca-amqp: received close event
[2015-06-13 15:07:45.020 UTC] WARN   ca-amqp: connection closing
[2015-06-13 15:07:45.020 UTC] INFO   ca-amqp: trying to reconnect (attempt 29)
[2015-06-13 15:07:50.022 UTC] ERROR  ca-amqp: received connection error: EXCEPTION: Error: Error: connect ECONNREFUSED
    at errnoException (net.js:646:11)
    at Object.afterConnect [as oncomplete] (net.js:637:18)
[2015-06-13 15:07:50.024 UTC] WARN   EXCEPTION: caError: amqp error "ECONNREFUSED": connect ECONNREFUSED
    at capAmqpCap.error (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp-cap.js:390:9)
    at caAmqp.<anonymous> (native)
    at caAmqp.emit (events.js:67:17)
    at caAmqp.connError (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp.js:307:7)
    at Connection.<anonymous> (native)
    at Connection.emit (events.js:67:17)
    at Array.0 (net.js:319:25)
    at EventEmitter._tickCallback (node.js:192:40)
[2015-06-13 15:07:50.025 UTC] DBG    ca-amqp: received close event
[2015-06-13 15:07:50.025 UTC] WARN   ca-amqp: connection closing
[2015-06-13 15:07:50.025 UTC] INFO   ca-amqp: trying to reconnect (attempt 30)
[2015-06-13 15:07:55.049 UTC] ERROR  ca-amqp: received connection error: EXCEPTION: Error: Error: connect ECONNREFUSED
    at errnoException (net.js:646:11)
    at Object.afterConnect [as oncomplete] (net.js:637:18)
[2015-06-13 15:07:55.051 UTC] WARN   EXCEPTION: caError: amqp error "ECONNREFUSED": connect ECONNREFUSED
    at capAmqpCap.error (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp-cap.js:390:9)
    at caAmqp.<anonymous> (native)
    at caAmqp.emit (events.js:67:17)
    at caAmqp.connError (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp.js:307:7)
    at Connection.<anonymous> (native)
    at Connection.emit (events.js:67:17)
    at Array.0 (net.js:319:25)
    at EventEmitter._tickCallback (node.js:192:40)
[2015-06-13 15:07:55.055 UTC] DBG    ca-amqp: received close event
[2015-06-13 15:07:55.055 UTC] WARN   ca-amqp: connection closing
[2015-06-13 15:07:55.055 UTC] INFO   ca-amqp: trying to reconnect (attempt 31)
[2015-06-13 15:08:00.233 UTC] DBG    binding to ca.instrumenter.headnode
[2015-06-13 15:08:00.235 UTC] DBG    binding to ca.broadcast
[2015-06-13 15:08:00.238 UTC] DBG    bind to ca.instrumenter.headnode complete
[2015-06-13 15:08:00.238 UTC] DBG    bind to ca.broadcast complete
[2015-06-13 15:08:00.239 UTC] INFO   AMQP broker connected.
[2015-06-13 15:09:44.939 UTC] INFO   config service restarted
[2015-06-13 15:10:05.506 UTC] CRIT   CA PANIC: panic due to uncaught exception: EXCEPTION: TypeError: TypeError: Object #<Object> has no method 'appendFile'
    at Object.mdGenerateDScript (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-metad.js:859:4)
    at Object.impl (/opt/smartdc/agents/lib/node_modules/cabase/cmd/cainst/modules/dtrace.js:38:28)
    at caInstrService.amqpEnableInstn (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-svc-instr.js:439:22)
    at capAmqpCap.<anonymous> (native)
    at capAmqpCap.emit (events.js:88:20)
    at Object.capDispatch (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp-cap.js:203:14)
    at capAmqpCap.receive (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp-cap.js:502:31)
    at caAmqp.<anonymous> (native)
    at caAmqp.emit (events.js:67:17)
    at caAmqp.receive (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp.js:367:7)
[2015-06-13 15:10:05.507 UTC] CRIT   writing core dump to /opt/smartdc/agents/lib/node_modules/cabase/cacore.3124
[2015-06-13 15:10:05.621 UTC] CRIT   finished writing core dump
[ Jun 13 15:10:05 Stopping because all processes in service exited. ]
[ Jun 13 15:10:05 Executing stop method (:kill). ]
[ Jun 13 15:10:05 Executing start method ("/opt/smartdc/agents/lib/node_modules/cabase/smf/method/canodesvc"). ]
DTRACE_LIBPATH=/opt/smartdc/agents/lib/node_modules/cabase/lib
ignoring amqp-config key amqp_login
ignoring amqp-config key amqp_password
AMQP_HOST=10.99.99.20
AMQP_PORT=5672
NODE_PATH=:/opt/smartdc/agents/lib/node_modules/cabase/node_modules:/opt/smartdc/agents/lib/node_modules/cabase/node_modules/connect/lib:/opt/smartdc/agents/lib/node_modules/cabase/lib/ca:/opt/smartdc/agents/lib/node_modules/cabase/lib/tst
[ Jun 13 15:10:08 Method "start" exited with status 0. ]
The "sys" module is now called "util". It should have a similar interface.
using backends kstat,dtrace,zfs,cainstr,proc
[2015-06-13 15:10:11.808 UTC] INFO   Logging AMQP message to "/opt/smartdc/agents/log/ca/cainstsvc/amqp-2015-06-13.15:10:06.16601"
[2015-06-13 15:10:11.810 UTC] INFO   Instrumenter starting up (instsvc/0.0)
[2015-06-13 15:10:11.810 UTC] INFO   Hostname:    headnode
[2015-06-13 15:10:11.811 UTC] INFO   AMQP broker: {"host":"10.99.99.20","port":"5672"}
[2015-06-13 15:10:11.811 UTC] INFO   Routing key: ca.instrumenter.headnode
[2015-06-13 15:10:11.859 UTC] DBG    loaded metadata file "metadata/profile/operator.json"
[2015-06-13 15:10:11.860 UTC] DBG    loaded metadata file "metadata/profile/customer.json"
[2015-06-13 15:10:11.881 UTC] DBG    loaded metadata file "metadata/metric/metrics.json"
[2015-06-13 15:10:11.902 UTC] INFO   loading modules.
[2015-06-13 15:10:12.065 UTC] INFO   module "kstat" registered cpu.cpus
[2015-06-13 15:10:12.065 UTC] INFO   module "kstat" registered cpu.usage
[2015-06-13 15:10:12.066 UTC] INFO   module "kstat" registered cpu.waittime
[2015-06-13 15:10:12.066 UTC] INFO   module "kstat" registered cpu.loadavg1
[2015-06-13 15:10:12.066 UTC] INFO   module "kstat" registered nic.nics
[2015-06-13 15:10:12.067 UTC] INFO   module "kstat" registered nic.bytes
[2015-06-13 15:10:12.067 UTC] INFO   module "kstat" registered nic.packets
[2015-06-13 15:10:12.067 UTC] INFO   module "kstat" registered nic.vnic_bytes
[2015-06-13 15:10:12.068 UTC] INFO   module "kstat" registered nic.vnic_packets
[2015-06-13 15:10:12.068 UTC] INFO   module "kstat" registered disk.disks
[2015-06-13 15:10:12.068 UTC] INFO   module "kstat" registered disk.physio_ops
[2015-06-13 15:10:12.069 UTC] INFO   module "kstat" registered disk.physio_bytes
[2015-06-13 15:10:12.069 UTC] INFO   module "kstat" registered tcp.segments
[2015-06-13 15:10:12.069 UTC] INFO   module "kstat" registered tcp.errors
[2015-06-13 15:10:12.069 UTC] INFO   module "kstat" registered fs.logical_rwops
[2015-06-13 15:10:12.070 UTC] INFO   module "kstat" registered fs.logical_rwbytes
[2015-06-13 15:10:12.070 UTC] INFO   module "kstat" registered memory.rss
[2015-06-13 15:10:12.070 UTC] INFO   module "kstat" registered memory.rss_limit
[2015-06-13 15:10:12.070 UTC] INFO   module "kstat" registered memory.swap
[2015-06-13 15:10:12.071 UTC] INFO   module "kstat" registered memory.swap_limit
[2015-06-13 15:10:12.072 UTC] INFO   module "kstat" registered memory.reclaimed_bytes
[2015-06-13 15:10:12.073 UTC] INFO   module "kstat" registered memory.pageins
[2015-06-13 15:10:12.074 UTC] INFO   module "kstat" registered vm.exits
[2015-06-13 15:10:12.074 UTC] INFO   module "kstat" registered zfs.arc_ops
[2015-06-13 15:10:12.074 UTC] INFO   loaded module "kstat".
[2015-06-13 15:10:12.482 UTC] INFO   module "dtrace" registered apache.httpd_ops
[2015-06-13 15:10:12.486 UTC] INFO   module "dtrace" registered cpu.thread_executions
[2015-06-13 15:10:12.487 UTC] INFO   module "dtrace" registered cpu.thread_samples
[2015-06-13 15:10:12.489 UTC] INFO   module "dtrace" registered disk.physio_ops
[2015-06-13 15:10:12.493 UTC] INFO   module "dtrace" registered fs.logical_ops
[2015-06-13 15:10:12.498 UTC] INFO   module "dtrace" registered fs.logical_rwops
[2015-06-13 15:10:12.501 UTC] INFO   module "dtrace" registered ldapjs.connections
[2015-06-13 15:10:12.505 UTC] INFO   module "dtrace" registered ldapjs.ops
[2015-06-13 15:10:12.508 UTC] INFO   module "dtrace" registered ldapjs.search_ops
[2015-06-13 15:10:12.509 UTC] INFO   module "dtrace" registered mantaop.jobs_assigned
[2015-06-13 15:10:12.512 UTC] INFO   module "dtrace" registered mantaop.supervisor_auths
[2015-06-13 15:10:12.514 UTC] INFO   module "dtrace" registered mantaop.supervisor_deletes
[2015-06-13 15:10:12.515 UTC] INFO   module "dtrace" registered mantaop.supervisor_errors
[2015-06-13 15:10:12.517 UTC] INFO   module "dtrace" registered mantaop.supervisor_locates
[2015-06-13 15:10:12.518 UTC] INFO   module "dtrace" registered mantaop.tasks_committed
[2015-06-13 15:10:12.520 UTC] INFO   module "dtrace" registered mantaop.tasks_dispatched
[2015-06-13 15:10:12.521 UTC] INFO   module "dtrace" registered mantaop.tasks_executed
[2015-06-13 15:10:12.522 UTC] INFO   module "dtrace" registered mantaop.tasks_killed
[2015-06-13 15:10:12.523 UTC] INFO   module "dtrace" registered mantaop.zone_resets
[2015-06-13 15:10:12.525 UTC] INFO   module "dtrace" registered moray.ops
[2015-06-13 15:10:12.526 UTC] INFO   module "dtrace" registered moray.queries
[2015-06-13 15:10:12.528 UTC] INFO   module "dtrace" registered mysql.commands
[2015-06-13 15:10:12.529 UTC] INFO   module "dtrace" registered mysql.connections
[2015-06-13 15:10:12.531 UTC] INFO   module "dtrace" registered mysql.filesort
[2015-06-13 15:10:12.534 UTC] INFO   module "dtrace" registered mysql.queries
[2015-06-13 15:10:12.536 UTC] INFO   module "dtrace" registered mysql.statements
[2015-06-13 15:10:12.537 UTC] INFO   module "dtrace" registered node.gc_ops
[2015-06-13 15:10:12.539 UTC] INFO   module "dtrace" registered node.httpc_ops
[2015-06-13 15:10:12.542 UTC] INFO   module "dtrace" registered node.httpd_ops
[2015-06-13 15:10:12.544 UTC] INFO   module "dtrace" registered node.socket_ops
[2015-06-13 15:10:12.545 UTC] INFO   module "dtrace" registered postgres.queries
[2015-06-13 15:10:12.547 UTC] INFO   module "dtrace" registered unix.proc_execs
[2015-06-13 15:10:12.548 UTC] INFO   module "dtrace" registered unix.proc_exits
[2015-06-13 15:10:12.550 UTC] INFO   module "dtrace" registered unix.proc_forks
[2015-06-13 15:10:12.552 UTC] INFO   module "dtrace" registered restify.handler_ops
[2015-06-13 15:10:12.554 UTC] INFO   module "dtrace" registered restify.server_ops
[2015-06-13 15:10:12.555 UTC] INFO   module "dtrace" registered syscall.syscalls
[2015-06-13 15:10:12.557 UTC] INFO   module "dtrace" registered tcp.accepts
[2015-06-13 15:10:12.559 UTC] INFO   module "dtrace" registered tcp.connects
[2015-06-13 15:10:12.560 UTC] INFO   module "dtrace" registered unix.thr_creates
[2015-06-13 15:10:12.562 UTC] INFO   module "dtrace" registered vm.irqs
[2015-06-13 15:10:12.563 UTC] INFO   module "dtrace" registered vm.physio_bytes
[2015-06-13 15:10:12.565 UTC] INFO   module "dtrace" registered vm.physio_ops
[2015-06-13 15:10:12.567 UTC] INFO   module "dtrace" registered vm.thread_samples
[2015-06-13 15:10:12.569 UTC] INFO   module "dtrace" registered zfs.arc_ops
[2015-06-13 15:10:12.569 UTC] INFO   loaded module "dtrace".
[2015-06-13 15:10:12.581 UTC] INFO   module "zfs" registered zfs.dataset_unused_quota
[2015-06-13 15:10:12.581 UTC] INFO   module "zfs" registered zfs.dataset_used
[2015-06-13 15:10:12.581 UTC] INFO   module "zfs" registered zfs.dataset_quota
[2015-06-13 15:10:12.581 UTC] INFO   module "zfs" registered zfs.pool_free
[2015-06-13 15:10:12.581 UTC] INFO   module "zfs" registered zfs.pool_used
[2015-06-13 15:10:12.582 UTC] INFO   module "zfs" registered zfs.pool_total
[2015-06-13 15:10:12.582 UTC] INFO   loaded module "zfs".
[2015-06-13 15:10:12.605 UTC] INFO   module "cainstr" registered ca.instr_ticks
[2015-06-13 15:10:12.605 UTC] INFO   module "cainstr" registered ca.instr_beops
[2015-06-13 15:10:12.605 UTC] INFO   module "cainstr" registered ca.instr_enables
[2015-06-13 15:10:12.606 UTC] INFO   module "cainstr" registered ca.instr_disables
[2015-06-13 15:10:12.606 UTC] INFO   loaded module "cainstr".
[2015-06-13 15:10:13.208 UTC] INFO   module "proc" registered unix.processes
[2015-06-13 15:10:13.208 UTC] INFO   loaded module "proc".
[2015-06-13 15:10:13.208 UTC] INFO   finished loading modules.
[2015-06-13 15:10:13.348 UTC] DBG    binding to ca.instrumenter.headnode
[2015-06-13 15:10:13.349 UTC] DBG    binding to ca.broadcast
[2015-06-13 15:10:13.351 UTC] DBG    bind to ca.instrumenter.headnode complete
[2015-06-13 15:10:13.351 UTC] DBG    bind to ca.broadcast complete
[2015-06-13 15:10:13.351 UTC] INFO   AMQP broker connected.
[2015-06-13 15:10:15.643 UTC] CRIT   CA PANIC: panic due to uncaught exception: EXCEPTION: TypeError: TypeError: Object #<Object> has no method 'appendFile'
    at Object.mdGenerateDScript (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-metad.js:859:4)
    at Object.impl (/opt/smartdc/agents/lib/node_modules/cabase/cmd/cainst/modules/dtrace.js:38:28)
    at caInstrService.amqpEnableInstn (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-svc-instr.js:439:22)
    at capAmqpCap.<anonymous> (native)
    at capAmqpCap.emit (events.js:88:20)
    at Object.capDispatch (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp-cap.js:203:14)
    at capAmqpCap.receive (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp-cap.js:502:31)
    at caAmqp.<anonymous> (native)
    at caAmqp.emit (events.js:67:17)
    at caAmqp.receive (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp.js:367:7)
[2015-06-13 15:10:15.644 UTC] CRIT   writing core dump to /opt/smartdc/agents/lib/node_modules/cabase/cacore.16643
[2015-06-13 15:10:15.710 UTC] CRIT   finished writing core dump
[ Jun 13 15:10:15 Stopping because all processes in service exited. ]
[ Jun 13 15:10:15 Executing stop method (:kill). ]
[ Jun 13 15:10:15 Executing start method ("/opt/smartdc/agents/lib/node_modules/cabase/smf/method/canodesvc"). ]
DTRACE_LIBPATH=/opt/smartdc/agents/lib/node_modules/cabase/lib
ignoring amqp-config key amqp_login
ignoring amqp-config key amqp_password
AMQP_HOST=10.99.99.20
AMQP_PORT=5672
NODE_PATH=:/opt/smartdc/agents/lib/node_modules/cabase/node_modules:/opt/smartdc/agents/lib/node_modules/cabase/node_modules/connect/lib:/opt/smartdc/agents/lib/node_modules/cabase/lib/ca:/opt/smartdc/agents/lib/node_modules/cabase/lib/tst
[ Jun 13 15:10:16 Method "start" exited with status 0. ]
The "sys" module is now called "util". It should have a similar interface.
using backends kstat,dtrace,zfs,cainstr,proc
[2015-06-13 15:10:16.534 UTC] INFO   Logging AMQP message to "/opt/smartdc/agents/log/ca/cainstsvc/amqp-2015-06-13.15:10:16.16717"
[2015-06-13 15:10:16.535 UTC] INFO   Instrumenter starting up (instsvc/0.0)
[2015-06-13 15:10:16.535 UTC] INFO   Hostname:    headnode
[2015-06-13 15:10:16.536 UTC] INFO   AMQP broker: {"host":"10.99.99.20","port":"5672"}
[2015-06-13 15:10:16.536 UTC] INFO   Routing key: ca.instrumenter.headnode
[2015-06-13 15:10:16.543 UTC] DBG    loaded metadata file "metadata/profile/operator.json"
[2015-06-13 15:10:16.544 UTC] DBG    loaded metadata file "metadata/profile/customer.json"
[2015-06-13 15:10:16.546 UTC] DBG    loaded metadata file "metadata/metric/metrics.json"
[2015-06-13 15:10:16.560 UTC] INFO   loading modules.
[2015-06-13 15:10:16.570 UTC] INFO   module "kstat" registered cpu.cpus
[2015-06-13 15:10:16.570 UTC] INFO   module "kstat" registered cpu.usage
[2015-06-13 15:10:16.570 UTC] INFO   module "kstat" registered cpu.waittime
[2015-06-13 15:10:16.571 UTC] INFO   module "kstat" registered cpu.loadavg1
[2015-06-13 15:10:16.571 UTC] INFO   module "kstat" registered nic.nics
[2015-06-13 15:10:16.571 UTC] INFO   module "kstat" registered nic.bytes
[2015-06-13 15:10:16.571 UTC] INFO   module "kstat" registered nic.packets
[2015-06-13 15:10:16.571 UTC] INFO   module "kstat" registered nic.vnic_bytes
[2015-06-13 15:10:16.571 UTC] INFO   module "kstat" registered nic.vnic_packets
[2015-06-13 15:10:16.572 UTC] INFO   module "kstat" registered disk.disks
[2015-06-13 15:10:16.572 UTC] INFO   module "kstat" registered disk.physio_ops
[2015-06-13 15:10:16.572 UTC] INFO   module "kstat" registered disk.physio_bytes
[2015-06-13 15:10:16.572 UTC] INFO   module "kstat" registered tcp.segments
[2015-06-13 15:10:16.572 UTC] INFO   module "kstat" registered tcp.errors
[2015-06-13 15:10:16.572 UTC] INFO   module "kstat" registered fs.logical_rwops
[2015-06-13 15:10:16.573 UTC] INFO   module "kstat" registered fs.logical_rwbytes
[2015-06-13 15:10:16.573 UTC] INFO   module "kstat" registered memory.rss
[2015-06-13 15:10:16.573 UTC] INFO   module "kstat" registered memory.rss_limit
[2015-06-13 15:10:16.573 UTC] INFO   module "kstat" registered memory.swap
[2015-06-13 15:10:16.573 UTC] INFO   module "kstat" registered memory.swap_limit
[2015-06-13 15:10:16.573 UTC] INFO   module "kstat" registered memory.reclaimed_bytes
[2015-06-13 15:10:16.573 UTC] INFO   module "kstat" registered memory.pageins
[2015-06-13 15:10:16.574 UTC] INFO   module "kstat" registered vm.exits
[2015-06-13 15:10:16.574 UTC] INFO   module "kstat" registered zfs.arc_ops
[2015-06-13 15:10:16.574 UTC] INFO   loaded module "kstat".
[2015-06-13 15:10:16.604 UTC] INFO   module "dtrace" registered apache.httpd_ops
[2015-06-13 15:10:16.607 UTC] INFO   module "dtrace" registered cpu.thread_executions
[2015-06-13 15:10:16.612 UTC] INFO   module "dtrace" registered cpu.thread_samples
[2015-06-13 15:10:16.614 UTC] INFO   module "dtrace" registered disk.physio_ops
[2015-06-13 15:10:16.619 UTC] INFO   module "dtrace" registered fs.logical_ops
[2015-06-13 15:10:16.623 UTC] INFO   module "dtrace" registered fs.logical_rwops
[2015-06-13 15:10:16.624 UTC] INFO   module "dtrace" registered ldapjs.connections
[2015-06-13 15:10:16.626 UTC] INFO   module "dtrace" registered ldapjs.ops
[2015-06-13 15:10:16.627 UTC] INFO   module "dtrace" registered ldapjs.search_ops
[2015-06-13 15:10:16.628 UTC] INFO   module "dtrace" registered mantaop.jobs_assigned
[2015-06-13 15:10:16.629 UTC] INFO   module "dtrace" registered mantaop.supervisor_auths
[2015-06-13 15:10:16.630 UTC] INFO   module "dtrace" registered mantaop.supervisor_deletes
[2015-06-13 15:10:16.630 UTC] INFO   module "dtrace" registered mantaop.supervisor_errors
[2015-06-13 15:10:16.631 UTC] INFO   module "dtrace" registered mantaop.supervisor_locates
[2015-06-13 15:10:16.631 UTC] INFO   module "dtrace" registered mantaop.tasks_committed
[2015-06-13 15:10:16.632 UTC] INFO   module "dtrace" registered mantaop.tasks_dispatched
[2015-06-13 15:10:16.633 UTC] INFO   module "dtrace" registered mantaop.tasks_executed
[2015-06-13 15:10:16.633 UTC] INFO   module "dtrace" registered mantaop.tasks_killed
[2015-06-13 15:10:16.634 UTC] INFO   module "dtrace" registered mantaop.zone_resets
[2015-06-13 15:10:16.635 UTC] INFO   module "dtrace" registered moray.ops
[2015-06-13 15:10:16.636 UTC] INFO   module "dtrace" registered moray.queries
[2015-06-13 15:10:16.637 UTC] INFO   module "dtrace" registered mysql.commands
[2015-06-13 15:10:16.638 UTC] INFO   module "dtrace" registered mysql.connections
[2015-06-13 15:10:16.639 UTC] INFO   module "dtrace" registered mysql.filesort
[2015-06-13 15:10:16.641 UTC] INFO   module "dtrace" registered mysql.queries
[2015-06-13 15:10:16.643 UTC] INFO   module "dtrace" registered mysql.statements
[2015-06-13 15:10:16.644 UTC] INFO   module "dtrace" registered node.gc_ops
[2015-06-13 15:10:16.645 UTC] INFO   module "dtrace" registered node.httpc_ops
[2015-06-13 15:10:16.647 UTC] INFO   module "dtrace" registered node.httpd_ops
[2015-06-13 15:10:16.648 UTC] INFO   module "dtrace" registered node.socket_ops
[2015-06-13 15:10:16.649 UTC] INFO   module "dtrace" registered postgres.queries
[2015-06-13 15:10:16.650 UTC] INFO   module "dtrace" registered unix.proc_execs
[2015-06-13 15:10:16.651 UTC] INFO   module "dtrace" registered unix.proc_exits
[2015-06-13 15:10:16.652 UTC] INFO   module "dtrace" registered unix.proc_forks
[2015-06-13 15:10:16.653 UTC] INFO   module "dtrace" registered restify.handler_ops
[2015-06-13 15:10:16.654 UTC] INFO   module "dtrace" registered restify.server_ops
[2015-06-13 15:10:16.655 UTC] INFO   module "dtrace" registered syscall.syscalls
[2015-06-13 15:10:16.657 UTC] INFO   module "dtrace" registered tcp.accepts
[2015-06-13 15:10:16.658 UTC] INFO   module "dtrace" registered tcp.connects
[2015-06-13 15:10:16.658 UTC] INFO   module "dtrace" registered unix.thr_creates
[2015-06-13 15:10:16.659 UTC] INFO   module "dtrace" registered vm.irqs
[2015-06-13 15:10:16.660 UTC] INFO   module "dtrace" registered vm.physio_bytes
[2015-06-13 15:10:16.661 UTC] INFO   module "dtrace" registered vm.physio_ops
[2015-06-13 15:10:16.662 UTC] INFO   module "dtrace" registered vm.thread_samples
[2015-06-13 15:10:16.663 UTC] INFO   module "dtrace" registered zfs.arc_ops
[2015-06-13 15:10:16.663 UTC] INFO   loaded module "dtrace".
[2015-06-13 15:10:16.670 UTC] INFO   module "zfs" registered zfs.dataset_unused_quota
[2015-06-13 15:10:16.670 UTC] INFO   module "zfs" registered zfs.dataset_used
[2015-06-13 15:10:16.670 UTC] INFO   module "zfs" registered zfs.dataset_quota
[2015-06-13 15:10:16.670 UTC] INFO   module "zfs" registered zfs.pool_free
[2015-06-13 15:10:16.670 UTC] INFO   module "zfs" registered zfs.pool_used
[2015-06-13 15:10:16.671 UTC] INFO   module "zfs" registered zfs.pool_total
[2015-06-13 15:10:16.671 UTC] INFO   loaded module "zfs".
[2015-06-13 15:10:16.672 UTC] INFO   module "cainstr" registered ca.instr_ticks
[2015-06-13 15:10:16.672 UTC] INFO   module "cainstr" registered ca.instr_beops
[2015-06-13 15:10:16.672 UTC] INFO   module "cainstr" registered ca.instr_enables
[2015-06-13 15:10:16.672 UTC] INFO   module "cainstr" registered ca.instr_disables
[2015-06-13 15:10:16.672 UTC] INFO   loaded module "cainstr".
[2015-06-13 15:10:16.713 UTC] INFO   module "proc" registered unix.processes
[2015-06-13 15:10:16.713 UTC] INFO   loaded module "proc".
[2015-06-13 15:10:16.713 UTC] INFO   finished loading modules.
[2015-06-13 15:10:16.856 UTC] DBG    binding to ca.instrumenter.headnode
[2015-06-13 15:10:16.856 UTC] DBG    binding to ca.broadcast
[2015-06-13 15:10:16.858 UTC] DBG    bind to ca.instrumenter.headnode complete
[2015-06-13 15:10:16.858 UTC] DBG    bind to ca.broadcast complete
[2015-06-13 15:10:16.859 UTC] INFO   AMQP broker connected.
[2015-06-13 15:10:25.661 UTC] CRIT   CA PANIC: panic due to uncaught exception: EXCEPTION: TypeError: TypeError: Object #<Object> has no method 'appendFile'
    at Object.mdGenerateDScript (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-metad.js:859:4)
    at Object.impl (/opt/smartdc/agents/lib/node_modules/cabase/cmd/cainst/modules/dtrace.js:38:28)
    at caInstrService.amqpEnableInstn (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-svc-instr.js:439:22)
    at capAmqpCap.<anonymous> (native)
    at capAmqpCap.emit (events.js:88:20)
    at Object.capDispatch (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp-cap.js:203:14)
    at capAmqpCap.receive (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp-cap.js:502:31)
    at caAmqp.<anonymous> (native)
    at caAmqp.emit (events.js:67:17)
    at caAmqp.receive (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp.js:367:7)
[2015-06-13 15:10:25.662 UTC] CRIT   writing core dump to /opt/smartdc/agents/lib/node_modules/cabase/cacore.16745
[2015-06-13 15:10:25.730 UTC] CRIT   finished writing core dump
[ Jun 13 15:10:25 Stopping because all processes in service exited. ]
[ Jun 13 15:10:25 Executing stop method (:kill). ]
[ Jun 13 15:10:25 Executing start method ("/opt/smartdc/agents/lib/node_modules/cabase/smf/method/canodesvc"). ]
DTRACE_LIBPATH=/opt/smartdc/agents/lib/node_modules/cabase/lib
ignoring amqp-config key amqp_login
ignoring amqp-config key amqp_password
AMQP_HOST=10.99.99.20
AMQP_PORT=5672
NODE_PATH=:/opt/smartdc/agents/lib/node_modules/cabase/node_modules:/opt/smartdc/agents/lib/node_modules/cabase/node_modules/connect/lib:/opt/smartdc/agents/lib/node_modules/cabase/lib/ca:/opt/smartdc/agents/lib/node_modules/cabase/lib/tst
[ Jun 13 15:10:26 Method "start" exited with status 0. ]
The "sys" module is now called "util". It should have a similar interface.
using backends kstat,dtrace,zfs,cainstr,proc
[2015-06-13 15:10:26.252 UTC] INFO   Logging AMQP message to "/opt/smartdc/agents/log/ca/cainstsvc/amqp-2015-06-13.15:10:25.16821"
[2015-06-13 15:10:26.253 UTC] INFO   Instrumenter starting up (instsvc/0.0)
[2015-06-13 15:10:26.253 UTC] INFO   Hostname:    headnode
[2015-06-13 15:10:26.254 UTC] INFO   AMQP broker: {"host":"10.99.99.20","port":"5672"}
[2015-06-13 15:10:26.254 UTC] INFO   Routing key: ca.instrumenter.headnode
[2015-06-13 15:10:26.258 UTC] DBG    loaded metadata file "metadata/profile/operator.json"
[2015-06-13 15:10:26.258 UTC] DBG    loaded metadata file "metadata/profile/customer.json"
[2015-06-13 15:10:26.259 UTC] DBG    loaded metadata file "metadata/metric/metrics.json"
[2015-06-13 15:10:26.269 UTC] INFO   loading modules.
[2015-06-13 15:10:26.279 UTC] INFO   module "kstat" registered cpu.cpus
[2015-06-13 15:10:26.280 UTC] INFO   module "kstat" registered cpu.usage
[2015-06-13 15:10:26.280 UTC] INFO   module "kstat" registered cpu.waittime
[2015-06-13 15:10:26.280 UTC] INFO   module "kstat" registered cpu.loadavg1
[2015-06-13 15:10:26.281 UTC] INFO   module "kstat" registered nic.nics
[2015-06-13 15:10:26.281 UTC] INFO   module "kstat" registered nic.bytes
[2015-06-13 15:10:26.281 UTC] INFO   module "kstat" registered nic.packets
[2015-06-13 15:10:26.281 UTC] INFO   module "kstat" registered nic.vnic_bytes
[2015-06-13 15:10:26.281 UTC] INFO   module "kstat" registered nic.vnic_packets
[2015-06-13 15:10:26.281 UTC] INFO   module "kstat" registered disk.disks
[2015-06-13 15:10:26.282 UTC] INFO   module "kstat" registered disk.physio_ops
[2015-06-13 15:10:26.282 UTC] INFO   module "kstat" registered disk.physio_bytes
[2015-06-13 15:10:26.282 UTC] INFO   module "kstat" registered tcp.segments
[2015-06-13 15:10:26.282 UTC] INFO   module "kstat" registered tcp.errors
[2015-06-13 15:10:26.282 UTC] INFO   module "kstat" registered fs.logical_rwops
[2015-06-13 15:10:26.282 UTC] INFO   module "kstat" registered fs.logical_rwbytes
[2015-06-13 15:10:26.282 UTC] INFO   module "kstat" registered memory.rss
[2015-06-13 15:10:26.283 UTC] INFO   module "kstat" registered memory.rss_limit
[2015-06-13 15:10:26.283 UTC] INFO   module "kstat" registered memory.swap
[2015-06-13 15:10:26.283 UTC] INFO   module "kstat" registered memory.swap_limit
[2015-06-13 15:10:26.283 UTC] INFO   module "kstat" registered memory.reclaimed_bytes
[2015-06-13 15:10:26.283 UTC] INFO   module "kstat" registered memory.pageins
[2015-06-13 15:10:26.283 UTC] INFO   module "kstat" registered vm.exits
[2015-06-13 15:10:26.284 UTC] INFO   module "kstat" registered zfs.arc_ops
[2015-06-13 15:10:26.284 UTC] INFO   loaded module "kstat".
[2015-06-13 15:10:26.314 UTC] INFO   module "dtrace" registered apache.httpd_ops
[2015-06-13 15:10:26.316 UTC] INFO   module "dtrace" registered cpu.thread_executions
[2015-06-13 15:10:26.317 UTC] INFO   module "dtrace" registered cpu.thread_samples
[2015-06-13 15:10:26.320 UTC] INFO   module "dtrace" registered disk.physio_ops
[2015-06-13 15:10:26.323 UTC] INFO   module "dtrace" registered fs.logical_ops
[2015-06-13 15:10:26.327 UTC] INFO   module "dtrace" registered fs.logical_rwops
[2015-06-13 15:10:26.329 UTC] INFO   module "dtrace" registered ldapjs.connections
[2015-06-13 15:10:26.334 UTC] INFO   module "dtrace" registered ldapjs.ops
[2015-06-13 15:10:26.336 UTC] INFO   module "dtrace" registered ldapjs.search_ops
[2015-06-13 15:10:26.337 UTC] INFO   module "dtrace" registered mantaop.jobs_assigned
[2015-06-13 15:10:26.337 UTC] INFO   module "dtrace" registered mantaop.supervisor_auths
[2015-06-13 15:10:26.338 UTC] INFO   module "dtrace" registered mantaop.supervisor_deletes
[2015-06-13 15:10:26.340 UTC] INFO   module "dtrace" registered mantaop.supervisor_errors
[2015-06-13 15:10:26.340 UTC] INFO   module "dtrace" registered mantaop.supervisor_locates
[2015-06-13 15:10:26.341 UTC] INFO   module "dtrace" registered mantaop.tasks_committed
[2015-06-13 15:10:26.342 UTC] INFO   module "dtrace" registered mantaop.tasks_dispatched
[2015-06-13 15:10:26.343 UTC] INFO   module "dtrace" registered mantaop.tasks_executed
[2015-06-13 15:10:26.343 UTC] INFO   module "dtrace" registered mantaop.tasks_killed
[2015-06-13 15:10:26.344 UTC] INFO   module "dtrace" registered mantaop.zone_resets
[2015-06-13 15:10:26.345 UTC] INFO   module "dtrace" registered moray.ops
[2015-06-13 15:10:26.346 UTC] INFO   module "dtrace" registered moray.queries
[2015-06-13 15:10:26.347 UTC] INFO   module "dtrace" registered mysql.commands
[2015-06-13 15:10:26.348 UTC] INFO   module "dtrace" registered mysql.connections
[2015-06-13 15:10:26.349 UTC] INFO   module "dtrace" registered mysql.filesort
[2015-06-13 15:10:26.351 UTC] INFO   module "dtrace" registered mysql.queries
[2015-06-13 15:10:26.352 UTC] INFO   module "dtrace" registered mysql.statements
[2015-06-13 15:10:26.353 UTC] INFO   module "dtrace" registered node.gc_ops
[2015-06-13 15:10:26.354 UTC] INFO   module "dtrace" registered node.httpc_ops
[2015-06-13 15:10:26.356 UTC] INFO   module "dtrace" registered node.httpd_ops
[2015-06-13 15:10:26.357 UTC] INFO   module "dtrace" registered node.socket_ops
[2015-06-13 15:10:26.360 UTC] INFO   module "dtrace" registered postgres.queries
[2015-06-13 15:10:26.361 UTC] INFO   module "dtrace" registered unix.proc_execs
[2015-06-13 15:10:26.362 UTC] INFO   module "dtrace" registered unix.proc_exits
[2015-06-13 15:10:26.363 UTC] INFO   module "dtrace" registered unix.proc_forks
[2015-06-13 15:10:26.364 UTC] INFO   module "dtrace" registered restify.handler_ops
[2015-06-13 15:10:26.366 UTC] INFO   module "dtrace" registered restify.server_ops
[2015-06-13 15:10:26.367 UTC] INFO   module "dtrace" registered syscall.syscalls
[2015-06-13 15:10:26.368 UTC] INFO   module "dtrace" registered tcp.accepts
[2015-06-13 15:10:26.370 UTC] INFO   module "dtrace" registered tcp.connects
[2015-06-13 15:10:26.371 UTC] INFO   module "dtrace" registered unix.thr_creates
[2015-06-13 15:10:26.372 UTC] INFO   module "dtrace" registered vm.irqs
[2015-06-13 15:10:26.373 UTC] INFO   module "dtrace" registered vm.physio_bytes
[2015-06-13 15:10:26.374 UTC] INFO   module "dtrace" registered vm.physio_ops
[2015-06-13 15:10:26.375 UTC] INFO   module "dtrace" registered vm.thread_samples
[2015-06-13 15:10:26.376 UTC] INFO   module "dtrace" registered zfs.arc_ops
[2015-06-13 15:10:26.376 UTC] INFO   loaded module "dtrace".
[2015-06-13 15:10:26.384 UTC] INFO   module "zfs" registered zfs.dataset_unused_quota
[2015-06-13 15:10:26.384 UTC] INFO   module "zfs" registered zfs.dataset_used
[2015-06-13 15:10:26.384 UTC] INFO   module "zfs" registered zfs.dataset_quota
[2015-06-13 15:10:26.384 UTC] INFO   module "zfs" registered zfs.pool_free
[2015-06-13 15:10:26.385 UTC] INFO   module "zfs" registered zfs.pool_used
[2015-06-13 15:10:26.385 UTC] INFO   module "zfs" registered zfs.pool_total
[2015-06-13 15:10:26.385 UTC] INFO   loaded module "zfs".
[2015-06-13 15:10:26.386 UTC] INFO   module "cainstr" registered ca.instr_ticks
[2015-06-13 15:10:26.386 UTC] INFO   module "cainstr" registered ca.instr_beops
[2015-06-13 15:10:26.386 UTC] INFO   module "cainstr" registered ca.instr_enables
[2015-06-13 15:10:26.387 UTC] INFO   module "cainstr" registered ca.instr_disables
[2015-06-13 15:10:26.387 UTC] INFO   loaded module "cainstr".
[2015-06-13 15:10:26.422 UTC] INFO   module "proc" registered unix.processes
[2015-06-13 15:10:26.422 UTC] INFO   loaded module "proc".
[2015-06-13 15:10:26.422 UTC] INFO   finished loading modules.
[2015-06-13 15:10:26.555 UTC] DBG    binding to ca.instrumenter.headnode
[2015-06-13 15:10:26.557 UTC] DBG    binding to ca.broadcast
[2015-06-13 15:10:26.560 UTC] DBG    bind to ca.instrumenter.headnode complete
[2015-06-13 15:10:26.561 UTC] DBG    bind to ca.broadcast complete
[2015-06-13 15:10:26.561 UTC] INFO   AMQP broker connected.
[2015-06-13 15:10:35.658 UTC] CRIT   CA PANIC: panic due to uncaught exception: EXCEPTION: TypeError: TypeError: Object #<Object> has no method 'appendFile'
    at Object.mdGenerateDScript (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-metad.js:859:4)
    at Object.impl (/opt/smartdc/agents/lib/node_modules/cabase/cmd/cainst/modules/dtrace.js:38:28)
    at caInstrService.amqpEnableInstn (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-svc-instr.js:439:22)
    at capAmqpCap.<anonymous> (native)
    at capAmqpCap.emit (events.js:88:20)
    at Object.capDispatch (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp-cap.js:203:14)
    at capAmqpCap.receive (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp-cap.js:502:31)
    at caAmqp.<anonymous> (native)
    at caAmqp.emit (events.js:67:17)
    at caAmqp.receive (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp.js:367:7)
[2015-06-13 15:10:35.658 UTC] CRIT   writing core dump to /opt/smartdc/agents/lib/node_modules/cabase/cacore.16849
[2015-06-13 15:10:35.723 UTC] CRIT   finished writing core dump
[ Jun 13 15:10:35 Stopping because all processes in service exited. ]
[ Jun 13 15:10:35 Executing stop method (:kill). ]
[ Jun 13 15:10:35 Executing start method ("/opt/smartdc/agents/lib/node_modules/cabase/smf/method/canodesvc"). ]
DTRACE_LIBPATH=/opt/smartdc/agents/lib/node_modules/cabase/lib
ignoring amqp-config key amqp_login
ignoring amqp-config key amqp_password
AMQP_HOST=10.99.99.20
AMQP_PORT=5672
NODE_PATH=:/opt/smartdc/agents/lib/node_modules/cabase/node_modules:/opt/smartdc/agents/lib/node_modules/cabase/node_modules/connect/lib:/opt/smartdc/agents/lib/node_modules/cabase/lib/ca:/opt/smartdc/agents/lib/node_modules/cabase/lib/tst
[ Jun 13 15:10:36 Method "start" exited with status 0. ]
The "sys" module is now called "util". It should have a similar interface.
using backends kstat,dtrace,zfs,cainstr,proc
[2015-06-13 15:10:36.266 UTC] INFO   Logging AMQP message to "/opt/smartdc/agents/log/ca/cainstsvc/amqp-2015-06-13.15:10:35.16864"
[2015-06-13 15:10:36.267 UTC] INFO   Instrumenter starting up (instsvc/0.0)
[2015-06-13 15:10:36.267 UTC] INFO   Hostname:    headnode
[2015-06-13 15:10:36.267 UTC] INFO   AMQP broker: {"host":"10.99.99.20","port":"5672"}
[2015-06-13 15:10:36.267 UTC] INFO   Routing key: ca.instrumenter.headnode
[2015-06-13 15:10:36.271 UTC] DBG    loaded metadata file "metadata/profile/operator.json"
[2015-06-13 15:10:36.272 UTC] DBG    loaded metadata file "metadata/profile/customer.json"
[2015-06-13 15:10:36.273 UTC] DBG    loaded metadata file "metadata/metric/metrics.json"
[2015-06-13 15:10:36.287 UTC] INFO   loading modules.
[2015-06-13 15:10:36.298 UTC] INFO   module "kstat" registered cpu.cpus
[2015-06-13 15:10:36.299 UTC] INFO   module "kstat" registered cpu.usage
[2015-06-13 15:10:36.299 UTC] INFO   module "kstat" registered cpu.waittime
[2015-06-13 15:10:36.299 UTC] INFO   module "kstat" registered cpu.loadavg1
[2015-06-13 15:10:36.300 UTC] INFO   module "kstat" registered nic.nics
[2015-06-13 15:10:36.300 UTC] INFO   module "kstat" registered nic.bytes
[2015-06-13 15:10:36.300 UTC] INFO   module "kstat" registered nic.packets
[2015-06-13 15:10:36.300 UTC] INFO   module "kstat" registered nic.vnic_bytes
[2015-06-13 15:10:36.300 UTC] INFO   module "kstat" registered nic.vnic_packets
[2015-06-13 15:10:36.300 UTC] INFO   module "kstat" registered disk.disks
[2015-06-13 15:10:36.301 UTC] INFO   module "kstat" registered disk.physio_ops
[2015-06-13 15:10:36.301 UTC] INFO   module "kstat" registered disk.physio_bytes
[2015-06-13 15:10:36.301 UTC] INFO   module "kstat" registered tcp.segments
[2015-06-13 15:10:36.301 UTC] INFO   module "kstat" registered tcp.errors
[2015-06-13 15:10:36.301 UTC] INFO   module "kstat" registered fs.logical_rwops
[2015-06-13 15:10:36.301 UTC] INFO   module "kstat" registered fs.logical_rwbytes
[2015-06-13 15:10:36.302 UTC] INFO   module "kstat" registered memory.rss
[2015-06-13 15:10:36.302 UTC] INFO   module "kstat" registered memory.rss_limit
[2015-06-13 15:10:36.302 UTC] INFO   module "kstat" registered memory.swap
[2015-06-13 15:10:36.302 UTC] INFO   module "kstat" registered memory.swap_limit
[2015-06-13 15:10:36.302 UTC] INFO   module "kstat" registered memory.reclaimed_bytes
[2015-06-13 15:10:36.302 UTC] INFO   module "kstat" registered memory.pageins
[2015-06-13 15:10:36.302 UTC] INFO   module "kstat" registered vm.exits
[2015-06-13 15:10:36.302 UTC] INFO   module "kstat" registered zfs.arc_ops
[2015-06-13 15:10:36.303 UTC] INFO   loaded module "kstat".
[2015-06-13 15:10:36.329 UTC] INFO   module "dtrace" registered apache.httpd_ops
[2015-06-13 15:10:36.331 UTC] INFO   module "dtrace" registered cpu.thread_executions
[2015-06-13 15:10:36.332 UTC] INFO   module "dtrace" registered cpu.thread_samples
[2015-06-13 15:10:36.332 UTC] INFO   module "dtrace" registered disk.physio_ops
[2015-06-13 15:10:36.334 UTC] INFO   module "dtrace" registered fs.logical_ops
[2015-06-13 15:10:36.336 UTC] INFO   module "dtrace" registered fs.logical_rwops
[2015-06-13 15:10:36.338 UTC] INFO   module "dtrace" registered ldapjs.connections
[2015-06-13 15:10:36.340 UTC] INFO   module "dtrace" registered ldapjs.ops
[2015-06-13 15:10:36.341 UTC] INFO   module "dtrace" registered ldapjs.search_ops
[2015-06-13 15:10:36.342 UTC] INFO   module "dtrace" registered mantaop.jobs_assigned
[2015-06-13 15:10:36.343 UTC] INFO   module "dtrace" registered mantaop.supervisor_auths
[2015-06-13 15:10:36.344 UTC] INFO   module "dtrace" registered mantaop.supervisor_deletes
[2015-06-13 15:10:36.344 UTC] INFO   module "dtrace" registered mantaop.supervisor_errors
[2015-06-13 15:10:36.346 UTC] INFO   module "dtrace" registered mantaop.supervisor_locates
[2015-06-13 15:10:36.347 UTC] INFO   module "dtrace" registered mantaop.tasks_committed
[2015-06-13 15:10:36.348 UTC] INFO   module "dtrace" registered mantaop.tasks_dispatched
[2015-06-13 15:10:36.348 UTC] INFO   module "dtrace" registered mantaop.tasks_executed
[2015-06-13 15:10:36.350 UTC] INFO   module "dtrace" registered mantaop.tasks_killed
[2015-06-13 15:10:36.351 UTC] INFO   module "dtrace" registered mantaop.zone_resets
[2015-06-13 15:10:36.353 UTC] INFO   module "dtrace" registered moray.ops
[2015-06-13 15:10:36.354 UTC] INFO   module "dtrace" registered moray.queries
[2015-06-13 15:10:36.355 UTC] INFO   module "dtrace" registered mysql.commands
[2015-06-13 15:10:36.355 UTC] INFO   module "dtrace" registered mysql.connections
[2015-06-13 15:10:36.356 UTC] INFO   module "dtrace" registered mysql.filesort
[2015-06-13 15:10:36.358 UTC] INFO   module "dtrace" registered mysql.queries
[2015-06-13 15:10:36.360 UTC] INFO   module "dtrace" registered mysql.statements
[2015-06-13 15:10:36.361 UTC] INFO   module "dtrace" registered node.gc_ops
[2015-06-13 15:10:36.362 UTC] INFO   module "dtrace" registered node.httpc_ops
[2015-06-13 15:10:36.365 UTC] INFO   module "dtrace" registered node.httpd_ops
[2015-06-13 15:10:36.366 UTC] INFO   module "dtrace" registered node.socket_ops
[2015-06-13 15:10:36.368 UTC] INFO   module "dtrace" registered postgres.queries
[2015-06-13 15:10:36.369 UTC] INFO   module "dtrace" registered unix.proc_execs
[2015-06-13 15:10:36.370 UTC] INFO   module "dtrace" registered unix.proc_exits
[2015-06-13 15:10:36.370 UTC] INFO   module "dtrace" registered unix.proc_forks
[2015-06-13 15:10:36.371 UTC] INFO   module "dtrace" registered restify.handler_ops
[2015-06-13 15:10:36.372 UTC] INFO   module "dtrace" registered restify.server_ops
[2015-06-13 15:10:36.373 UTC] INFO   module "dtrace" registered syscall.syscalls
[2015-06-13 15:10:36.375 UTC] INFO   module "dtrace" registered tcp.accepts
[2015-06-13 15:10:36.376 UTC] INFO   module "dtrace" registered tcp.connects
[2015-06-13 15:10:36.377 UTC] INFO   module "dtrace" registered unix.thr_creates
[2015-06-13 15:10:36.378 UTC] INFO   module "dtrace" registered vm.irqs
[2015-06-13 15:10:36.379 UTC] INFO   module "dtrace" registered vm.physio_bytes
[2015-06-13 15:10:36.380 UTC] INFO   module "dtrace" registered vm.physio_ops
[2015-06-13 15:10:36.380 UTC] INFO   module "dtrace" registered vm.thread_samples
[2015-06-13 15:10:36.381 UTC] INFO   module "dtrace" registered zfs.arc_ops
[2015-06-13 15:10:36.381 UTC] INFO   loaded module "dtrace".
[2015-06-13 15:10:36.389 UTC] INFO   module "zfs" registered zfs.dataset_unused_quota
[2015-06-13 15:10:36.389 UTC] INFO   module "zfs" registered zfs.dataset_used
[2015-06-13 15:10:36.389 UTC] INFO   module "zfs" registered zfs.dataset_quota
[2015-06-13 15:10:36.389 UTC] INFO   module "zfs" registered zfs.pool_free
[2015-06-13 15:10:36.389 UTC] INFO   module "zfs" registered zfs.pool_used
[2015-06-13 15:10:36.389 UTC] INFO   module "zfs" registered zfs.pool_total
[2015-06-13 15:10:36.389 UTC] INFO   loaded module "zfs".
[2015-06-13 15:10:36.391 UTC] INFO   module "cainstr" registered ca.instr_ticks
[2015-06-13 15:10:36.391 UTC] INFO   module "cainstr" registered ca.instr_beops
[2015-06-13 15:10:36.391 UTC] INFO   module "cainstr" registered ca.instr_enables
[2015-06-13 15:10:36.391 UTC] INFO   module "cainstr" registered ca.instr_disables
[2015-06-13 15:10:36.391 UTC] INFO   loaded module "cainstr".
[2015-06-13 15:10:36.431 UTC] INFO   module "proc" registered unix.processes
[2015-06-13 15:10:36.431 UTC] INFO   loaded module "proc".
[2015-06-13 15:10:36.432 UTC] INFO   finished loading modules.
[2015-06-13 15:10:36.572 UTC] DBG    binding to ca.instrumenter.headnode
[2015-06-13 15:10:36.573 UTC] DBG    binding to ca.broadcast
[2015-06-13 15:10:36.577 UTC] DBG    bind to ca.instrumenter.headnode complete
[2015-06-13 15:10:36.577 UTC] DBG    bind to ca.broadcast complete
[2015-06-13 15:10:36.578 UTC] INFO   AMQP broker connected.
[2015-06-13 15:10:45.672 UTC] CRIT   CA PANIC: panic due to uncaught exception: EXCEPTION: TypeError: TypeError: Object #<Object> has no method 'appendFile'
    at Object.mdGenerateDScript (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-metad.js:859:4)
    at Object.impl (/opt/smartdc/agents/lib/node_modules/cabase/cmd/cainst/modules/dtrace.js:38:28)
    at caInstrService.amqpEnableInstn (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-svc-instr.js:439:22)
    at capAmqpCap.<anonymous> (native)
    at capAmqpCap.emit (events.js:88:20)
    at Object.capDispatch (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp-cap.js:203:14)
    at capAmqpCap.receive (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp-cap.js:502:31)
    at caAmqp.<anonymous> (native)
    at caAmqp.emit (events.js:67:17)
    at caAmqp.receive (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp.js:367:7)
[2015-06-13 15:10:45.673 UTC] CRIT   writing core dump to /opt/smartdc/agents/lib/node_modules/cabase/cacore.16892
[2015-06-13 15:10:45.759 UTC] CRIT   finished writing core dump
[ Jun 13 15:10:45 Stopping because all processes in service exited. ]
[ Jun 13 15:10:45 Executing stop method (:kill). ]
[ Jun 13 15:10:45 Executing start method ("/opt/smartdc/agents/lib/node_modules/cabase/smf/method/canodesvc"). ]
DTRACE_LIBPATH=/opt/smartdc/agents/lib/node_modules/cabase/lib
ignoring amqp-config key amqp_login
ignoring amqp-config key amqp_password
AMQP_HOST=10.99.99.20
AMQP_PORT=5672
NODE_PATH=:/opt/smartdc/agents/lib/node_modules/cabase/node_modules:/opt/smartdc/agents/lib/node_modules/cabase/node_modules/connect/lib:/opt/smartdc/agents/lib/node_modules/cabase/lib/ca:/opt/smartdc/agents/lib/node_modules/cabase/lib/tst
[ Jun 13 15:10:46 Method "start" exited with status 0. ]
The "sys" module is now called "util". It should have a similar interface.
using backends kstat,dtrace,zfs,cainstr,proc
[2015-06-13 15:10:46.466 UTC] INFO   Logging AMQP message to "/opt/smartdc/agents/log/ca/cainstsvc/amqp-2015-06-13.15:10:45.17021"
[2015-06-13 15:10:46.468 UTC] INFO   Instrumenter starting up (instsvc/0.0)
[2015-06-13 15:10:46.468 UTC] INFO   Hostname:    headnode
[2015-06-13 15:10:46.468 UTC] INFO   AMQP broker: {"host":"10.99.99.20","port":"5672"}
[2015-06-13 15:10:46.468 UTC] INFO   Routing key: ca.instrumenter.headnode
[2015-06-13 15:10:46.471 UTC] DBG    loaded metadata file "metadata/profile/operator.json"
[2015-06-13 15:10:46.472 UTC] DBG    loaded metadata file "metadata/profile/customer.json"
[2015-06-13 15:10:46.474 UTC] DBG    loaded metadata file "metadata/metric/metrics.json"
[2015-06-13 15:10:46.493 UTC] INFO   loading modules.
[2015-06-13 15:10:46.510 UTC] INFO   module "kstat" registered cpu.cpus
[2015-06-13 15:10:46.511 UTC] INFO   module "kstat" registered cpu.usage
[2015-06-13 15:10:46.511 UTC] INFO   module "kstat" registered cpu.waittime
[2015-06-13 15:10:46.511 UTC] INFO   module "kstat" registered cpu.loadavg1
[2015-06-13 15:10:46.512 UTC] INFO   module "kstat" registered nic.nics
[2015-06-13 15:10:46.512 UTC] INFO   module "kstat" registered nic.bytes
[2015-06-13 15:10:46.512 UTC] INFO   module "kstat" registered nic.packets
[2015-06-13 15:10:46.513 UTC] INFO   module "kstat" registered nic.vnic_bytes
[2015-06-13 15:10:46.513 UTC] INFO   module "kstat" registered nic.vnic_packets
[2015-06-13 15:10:46.514 UTC] INFO   module "kstat" registered disk.disks
[2015-06-13 15:10:46.515 UTC] INFO   module "kstat" registered disk.physio_ops
[2015-06-13 15:10:46.515 UTC] INFO   module "kstat" registered disk.physio_bytes
[2015-06-13 15:10:46.515 UTC] INFO   module "kstat" registered tcp.segments
[2015-06-13 15:10:46.515 UTC] INFO   module "kstat" registered tcp.errors
[2015-06-13 15:10:46.516 UTC] INFO   module "kstat" registered fs.logical_rwops
[2015-06-13 15:10:46.516 UTC] INFO   module "kstat" registered fs.logical_rwbytes
[2015-06-13 15:10:46.516 UTC] INFO   module "kstat" registered memory.rss
[2015-06-13 15:10:46.517 UTC] INFO   module "kstat" registered memory.rss_limit
[2015-06-13 15:10:46.517 UTC] INFO   module "kstat" registered memory.swap
[2015-06-13 15:10:46.517 UTC] INFO   module "kstat" registered memory.swap_limit
[2015-06-13 15:10:46.517 UTC] INFO   module "kstat" registered memory.reclaimed_bytes
[2015-06-13 15:10:46.518 UTC] INFO   module "kstat" registered memory.pageins
[2015-06-13 15:10:46.518 UTC] INFO   module "kstat" registered vm.exits
[2015-06-13 15:10:46.518 UTC] INFO   module "kstat" registered zfs.arc_ops
[2015-06-13 15:10:46.518 UTC] INFO   loaded module "kstat".
[2015-06-13 15:10:46.558 UTC] INFO   module "dtrace" registered apache.httpd_ops
[2015-06-13 15:10:46.559 UTC] INFO   module "dtrace" registered cpu.thread_executions
[2015-06-13 15:10:46.561 UTC] INFO   module "dtrace" registered cpu.thread_samples
[2015-06-13 15:10:46.562 UTC] INFO   module "dtrace" registered disk.physio_ops
[2015-06-13 15:10:46.564 UTC] INFO   module "dtrace" registered fs.logical_ops
[2015-06-13 15:10:46.565 UTC] INFO   module "dtrace" registered fs.logical_rwops
[2015-06-13 15:10:46.567 UTC] INFO   module "dtrace" registered ldapjs.connections
[2015-06-13 15:10:46.571 UTC] INFO   module "dtrace" registered ldapjs.ops
[2015-06-13 15:10:46.572 UTC] INFO   module "dtrace" registered ldapjs.search_ops
[2015-06-13 15:10:46.573 UTC] INFO   module "dtrace" registered mantaop.jobs_assigned
[2015-06-13 15:10:46.575 UTC] INFO   module "dtrace" registered mantaop.supervisor_auths
[2015-06-13 15:10:46.577 UTC] INFO   module "dtrace" registered mantaop.supervisor_deletes
[2015-06-13 15:10:46.578 UTC] INFO   module "dtrace" registered mantaop.supervisor_errors
[2015-06-13 15:10:46.580 UTC] INFO   module "dtrace" registered mantaop.supervisor_locates
[2015-06-13 15:10:46.581 UTC] INFO   module "dtrace" registered mantaop.tasks_committed
[2015-06-13 15:10:46.585 UTC] INFO   module "dtrace" registered mantaop.tasks_dispatched
[2015-06-13 15:10:46.586 UTC] INFO   module "dtrace" registered mantaop.tasks_executed
[2015-06-13 15:10:46.587 UTC] INFO   module "dtrace" registered mantaop.tasks_killed
[2015-06-13 15:10:46.588 UTC] INFO   module "dtrace" registered mantaop.zone_resets
[2015-06-13 15:10:46.590 UTC] INFO   module "dtrace" registered moray.ops
[2015-06-13 15:10:46.591 UTC] INFO   module "dtrace" registered moray.queries
[2015-06-13 15:10:46.592 UTC] INFO   module "dtrace" registered mysql.commands
[2015-06-13 15:10:46.593 UTC] INFO   module "dtrace" registered mysql.connections
[2015-06-13 15:10:46.595 UTC] INFO   module "dtrace" registered mysql.filesort
[2015-06-13 15:10:46.597 UTC] INFO   module "dtrace" registered mysql.queries
[2015-06-13 15:10:46.600 UTC] INFO   module "dtrace" registered mysql.statements
[2015-06-13 15:10:46.603 UTC] INFO   module "dtrace" registered node.gc_ops
[2015-06-13 15:10:46.605 UTC] INFO   module "dtrace" registered node.httpc_ops
[2015-06-13 15:10:46.608 UTC] INFO   module "dtrace" registered node.httpd_ops
[2015-06-13 15:10:46.609 UTC] INFO   module "dtrace" registered node.socket_ops
[2015-06-13 15:10:46.610 UTC] INFO   module "dtrace" registered postgres.queries
[2015-06-13 15:10:46.612 UTC] INFO   module "dtrace" registered unix.proc_execs
[2015-06-13 15:10:46.613 UTC] INFO   module "dtrace" registered unix.proc_exits
[2015-06-13 15:10:46.614 UTC] INFO   module "dtrace" registered unix.proc_forks
[2015-06-13 15:10:46.615 UTC] INFO   module "dtrace" registered restify.handler_ops
[2015-06-13 15:10:46.617 UTC] INFO   module "dtrace" registered restify.server_ops
[2015-06-13 15:10:46.618 UTC] INFO   module "dtrace" registered syscall.syscalls
[2015-06-13 15:10:46.620 UTC] INFO   module "dtrace" registered tcp.accepts
[2015-06-13 15:10:46.621 UTC] INFO   module "dtrace" registered tcp.connects
[2015-06-13 15:10:46.622 UTC] INFO   module "dtrace" registered unix.thr_creates
[2015-06-13 15:10:46.623 UTC] INFO   module "dtrace" registered vm.irqs
[2015-06-13 15:10:46.623 UTC] INFO   module "dtrace" registered vm.physio_bytes
[2015-06-13 15:10:46.624 UTC] INFO   module "dtrace" registered vm.physio_ops
[2015-06-13 15:10:46.626 UTC] INFO   module "dtrace" registered vm.thread_samples
[2015-06-13 15:10:46.629 UTC] INFO   module "dtrace" registered zfs.arc_ops
[2015-06-13 15:10:46.629 UTC] INFO   loaded module "dtrace".
[2015-06-13 15:10:46.640 UTC] INFO   module "zfs" registered zfs.dataset_unused_quota
[2015-06-13 15:10:46.640 UTC] INFO   module "zfs" registered zfs.dataset_used
[2015-06-13 15:10:46.640 UTC] INFO   module "zfs" registered zfs.dataset_quota
[2015-06-13 15:10:46.640 UTC] INFO   module "zfs" registered zfs.pool_free
[2015-06-13 15:10:46.640 UTC] INFO   module "zfs" registered zfs.pool_used
[2015-06-13 15:10:46.641 UTC] INFO   module "zfs" registered zfs.pool_total
[2015-06-13 15:10:46.641 UTC] INFO   loaded module "zfs".
[2015-06-13 15:10:46.642 UTC] INFO   module "cainstr" registered ca.instr_ticks
[2015-06-13 15:10:46.642 UTC] INFO   module "cainstr" registered ca.instr_beops
[2015-06-13 15:10:46.643 UTC] INFO   module "cainstr" registered ca.instr_enables
[2015-06-13 15:10:46.643 UTC] INFO   module "cainstr" registered ca.instr_disables
[2015-06-13 15:10:46.643 UTC] INFO   loaded module "cainstr".
[2015-06-13 15:10:46.682 UTC] INFO   module "proc" registered unix.processes
[2015-06-13 15:10:46.682 UTC] INFO   loaded module "proc".
[2015-06-13 15:10:46.682 UTC] INFO   finished loading modules.
[2015-06-13 15:10:46.850 UTC] DBG    binding to ca.instrumenter.headnode
[2015-06-13 15:10:46.852 UTC] DBG    binding to ca.broadcast
[2015-06-13 15:10:46.857 UTC] DBG    bind to ca.instrumenter.headnode complete
[2015-06-13 15:10:46.858 UTC] DBG    bind to ca.broadcast complete
[2015-06-13 15:10:46.858 UTC] INFO   AMQP broker connected.
[2015-06-13 15:10:55.671 UTC] CRIT   CA PANIC: panic due to uncaught exception: EXCEPTION: TypeError: TypeError: Object #<Object> has no method 'appendFile'
    at Object.mdGenerateDScript (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-metad.js:859:4)
    at Object.impl (/opt/smartdc/agents/lib/node_modules/cabase/cmd/cainst/modules/dtrace.js:38:28)
    at caInstrService.amqpEnableInstn (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-svc-instr.js:439:22)
    at capAmqpCap.<anonymous> (native)
    at capAmqpCap.emit (events.js:88:20)
    at Object.capDispatch (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp-cap.js:203:14)
    at capAmqpCap.receive (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp-cap.js:502:31)
    at caAmqp.<anonymous> (native)
    at caAmqp.emit (events.js:67:17)
    at caAmqp.receive (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp.js:367:7)
[2015-06-13 15:10:55.671 UTC] CRIT   writing core dump to /opt/smartdc/agents/lib/node_modules/cabase/cacore.17056
[2015-06-13 15:10:55.737 UTC] CRIT   finished writing core dump
[ Jun 13 15:10:55 Stopping because all processes in service exited. ]
[ Jun 13 15:10:55 Executing stop method (:kill). ]
[ Jun 13 15:10:55 Executing start method ("/opt/smartdc/agents/lib/node_modules/cabase/smf/method/canodesvc"). ]
DTRACE_LIBPATH=/opt/smartdc/agents/lib/node_modules/cabase/lib
ignoring amqp-config key amqp_login
ignoring amqp-config key amqp_password
AMQP_HOST=10.99.99.20
AMQP_PORT=5672
NODE_PATH=:/opt/smartdc/agents/lib/node_modules/cabase/node_modules:/opt/smartdc/agents/lib/node_modules/cabase/node_modules/connect/lib:/opt/smartdc/agents/lib/node_modules/cabase/lib/ca:/opt/smartdc/agents/lib/node_modules/cabase/lib/tst
[ Jun 13 15:10:56 Method "start" exited with status 0. ]
The "sys" module is now called "util". It should have a similar interface.
using backends kstat,dtrace,zfs,cainstr,proc
[2015-06-13 15:10:56.290 UTC] INFO   Logging AMQP message to "/opt/smartdc/agents/log/ca/cainstsvc/amqp-2015-06-13.15:10:55.17191"
[2015-06-13 15:10:56.291 UTC] INFO   Instrumenter starting up (instsvc/0.0)
[2015-06-13 15:10:56.291 UTC] INFO   Hostname:    headnode
[2015-06-13 15:10:56.292 UTC] INFO   AMQP broker: {"host":"10.99.99.20","port":"5672"}
[2015-06-13 15:10:56.292 UTC] INFO   Routing key: ca.instrumenter.headnode
[2015-06-13 15:10:56.300 UTC] DBG    loaded metadata file "metadata/metric/metrics.json"
[2015-06-13 15:10:56.302 UTC] DBG    loaded metadata file "metadata/profile/operator.json"
[2015-06-13 15:10:56.303 UTC] DBG    loaded metadata file "metadata/profile/customer.json"
[2015-06-13 15:10:56.317 UTC] INFO   loading modules.
[2015-06-13 15:10:56.328 UTC] INFO   module "kstat" registered cpu.cpus
[2015-06-13 15:10:56.328 UTC] INFO   module "kstat" registered cpu.usage
[2015-06-13 15:10:56.328 UTC] INFO   module "kstat" registered cpu.waittime
[2015-06-13 15:10:56.329 UTC] INFO   module "kstat" registered cpu.loadavg1
[2015-06-13 15:10:56.329 UTC] INFO   module "kstat" registered nic.nics
[2015-06-13 15:10:56.329 UTC] INFO   module "kstat" registered nic.bytes
[2015-06-13 15:10:56.329 UTC] INFO   module "kstat" registered nic.packets
[2015-06-13 15:10:56.329 UTC] INFO   module "kstat" registered nic.vnic_bytes
[2015-06-13 15:10:56.329 UTC] INFO   module "kstat" registered nic.vnic_packets
[2015-06-13 15:10:56.330 UTC] INFO   module "kstat" registered disk.disks
[2015-06-13 15:10:56.330 UTC] INFO   module "kstat" registered disk.physio_ops
[2015-06-13 15:10:56.330 UTC] INFO   module "kstat" registered disk.physio_bytes
[2015-06-13 15:10:56.330 UTC] INFO   module "kstat" registered tcp.segments
[2015-06-13 15:10:56.330 UTC] INFO   module "kstat" registered tcp.errors
[2015-06-13 15:10:56.330 UTC] INFO   module "kstat" registered fs.logical_rwops
[2015-06-13 15:10:56.331 UTC] INFO   module "kstat" registered fs.logical_rwbytes
[2015-06-13 15:10:56.331 UTC] INFO   module "kstat" registered memory.rss
[2015-06-13 15:10:56.331 UTC] INFO   module "kstat" registered memory.rss_limit
[2015-06-13 15:10:56.331 UTC] INFO   module "kstat" registered memory.swap
[2015-06-13 15:10:56.331 UTC] INFO   module "kstat" registered memory.swap_limit
[2015-06-13 15:10:56.332 UTC] INFO   module "kstat" registered memory.reclaimed_bytes
[2015-06-13 15:10:56.332 UTC] INFO   module "kstat" registered memory.pageins
[2015-06-13 15:10:56.332 UTC] INFO   module "kstat" registered vm.exits
[2015-06-13 15:10:56.332 UTC] INFO   module "kstat" registered zfs.arc_ops
[2015-06-13 15:10:56.332 UTC] INFO   loaded module "kstat".
[2015-06-13 15:10:56.358 UTC] INFO   module "dtrace" registered apache.httpd_ops
[2015-06-13 15:10:56.359 UTC] INFO   module "dtrace" registered cpu.thread_executions
[2015-06-13 15:10:56.360 UTC] INFO   module "dtrace" registered cpu.thread_samples
[2015-06-13 15:10:56.361 UTC] INFO   module "dtrace" registered disk.physio_ops
[2015-06-13 15:10:56.363 UTC] INFO   module "dtrace" registered fs.logical_ops
[2015-06-13 15:10:56.365 UTC] INFO   module "dtrace" registered fs.logical_rwops
[2015-06-13 15:10:56.367 UTC] INFO   module "dtrace" registered ldapjs.connections
[2015-06-13 15:10:56.373 UTC] INFO   module "dtrace" registered ldapjs.ops
[2015-06-13 15:10:56.376 UTC] INFO   module "dtrace" registered ldapjs.search_ops
[2015-06-13 15:10:56.377 UTC] INFO   module "dtrace" registered mantaop.jobs_assigned
[2015-06-13 15:10:56.380 UTC] INFO   module "dtrace" registered mantaop.supervisor_auths
[2015-06-13 15:10:56.383 UTC] INFO   module "dtrace" registered mantaop.supervisor_deletes
[2015-06-13 15:10:56.385 UTC] INFO   module "dtrace" registered mantaop.supervisor_errors
[2015-06-13 15:10:56.389 UTC] INFO   module "dtrace" registered mantaop.supervisor_locates
[2015-06-13 15:10:56.391 UTC] INFO   module "dtrace" registered mantaop.tasks_committed
[2015-06-13 15:10:56.393 UTC] INFO   module "dtrace" registered mantaop.tasks_dispatched
[2015-06-13 15:10:56.394 UTC] INFO   module "dtrace" registered mantaop.tasks_executed
[2015-06-13 15:10:56.396 UTC] INFO   module "dtrace" registered mantaop.tasks_killed
[2015-06-13 15:10:56.398 UTC] INFO   module "dtrace" registered mantaop.zone_resets
[2015-06-13 15:10:56.400 UTC] INFO   module "dtrace" registered moray.ops
[2015-06-13 15:10:56.403 UTC] INFO   module "dtrace" registered moray.queries
[2015-06-13 15:10:56.406 UTC] INFO   module "dtrace" registered mysql.commands
[2015-06-13 15:10:56.410 UTC] INFO   module "dtrace" registered mysql.connections
[2015-06-13 15:10:56.411 UTC] INFO   module "dtrace" registered mysql.filesort
[2015-06-13 15:10:56.416 UTC] INFO   module "dtrace" registered mysql.queries
[2015-06-13 15:10:56.420 UTC] INFO   module "dtrace" registered mysql.statements
[2015-06-13 15:10:56.422 UTC] INFO   module "dtrace" registered node.gc_ops
[2015-06-13 15:10:56.424 UTC] INFO   module "dtrace" registered node.httpc_ops
[2015-06-13 15:10:56.426 UTC] INFO   module "dtrace" registered node.httpd_ops
[2015-06-13 15:10:56.427 UTC] INFO   module "dtrace" registered node.socket_ops
[2015-06-13 15:10:56.428 UTC] INFO   module "dtrace" registered postgres.queries
[2015-06-13 15:10:56.429 UTC] INFO   module "dtrace" registered unix.proc_execs
[2015-06-13 15:10:56.430 UTC] INFO   module "dtrace" registered unix.proc_exits
[2015-06-13 15:10:56.431 UTC] INFO   module "dtrace" registered unix.proc_forks
[2015-06-13 15:10:56.432 UTC] INFO   module "dtrace" registered restify.handler_ops
[2015-06-13 15:10:56.433 UTC] INFO   module "dtrace" registered restify.server_ops
[2015-06-13 15:10:56.435 UTC] INFO   module "dtrace" registered syscall.syscalls
[2015-06-13 15:10:56.437 UTC] INFO   module "dtrace" registered tcp.accepts
[2015-06-13 15:10:56.438 UTC] INFO   module "dtrace" registered tcp.connects
[2015-06-13 15:10:56.439 UTC] INFO   module "dtrace" registered unix.thr_creates
[2015-06-13 15:10:56.440 UTC] INFO   module "dtrace" registered vm.irqs
[2015-06-13 15:10:56.441 UTC] INFO   module "dtrace" registered vm.physio_bytes
[2015-06-13 15:10:56.442 UTC] INFO   module "dtrace" registered vm.physio_ops
[2015-06-13 15:10:56.443 UTC] INFO   module "dtrace" registered vm.thread_samples
[2015-06-13 15:10:56.444 UTC] INFO   module "dtrace" registered zfs.arc_ops
[2015-06-13 15:10:56.444 UTC] INFO   loaded module "dtrace".
[2015-06-13 15:10:56.453 UTC] INFO   module "zfs" registered zfs.dataset_unused_quota
[2015-06-13 15:10:56.453 UTC] INFO   module "zfs" registered zfs.dataset_used
[2015-06-13 15:10:56.453 UTC] INFO   module "zfs" registered zfs.dataset_quota
[2015-06-13 15:10:56.453 UTC] INFO   module "zfs" registered zfs.pool_free
[2015-06-13 15:10:56.453 UTC] INFO   module "zfs" registered zfs.pool_used
[2015-06-13 15:10:56.453 UTC] INFO   module "zfs" registered zfs.pool_total
[2015-06-13 15:10:56.453 UTC] INFO   loaded module "zfs".
[2015-06-13 15:10:56.455 UTC] INFO   module "cainstr" registered ca.instr_ticks
[2015-06-13 15:10:56.455 UTC] INFO   module "cainstr" registered ca.instr_beops
[2015-06-13 15:10:56.455 UTC] INFO   module "cainstr" registered ca.instr_enables
[2015-06-13 15:10:56.455 UTC] INFO   module "cainstr" registered ca.instr_disables
[2015-06-13 15:10:56.455 UTC] INFO   loaded module "cainstr".
[2015-06-13 15:10:56.511 UTC] INFO   module "proc" registered unix.processes
[2015-06-13 15:10:56.511 UTC] INFO   loaded module "proc".
[2015-06-13 15:10:56.511 UTC] INFO   finished loading modules.
[2015-06-13 15:10:56.645 UTC] DBG    binding to ca.instrumenter.headnode
[2015-06-13 15:10:56.647 UTC] DBG    binding to ca.broadcast
[2015-06-13 15:10:56.653 UTC] DBG    bind to ca.instrumenter.headnode complete
[2015-06-13 15:10:56.653 UTC] DBG    bind to ca.broadcast complete
[2015-06-13 15:10:56.657 UTC] INFO   AMQP broker connected.
[2015-06-13 15:11:05.669 UTC] CRIT   CA PANIC: panic due to uncaught exception: EXCEPTION: TypeError: TypeError: Object #<Object> has no method 'appendFile'
    at Object.mdGenerateDScript (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-metad.js:859:4)
    at Object.impl (/opt/smartdc/agents/lib/node_modules/cabase/cmd/cainst/modules/dtrace.js:38:28)
    at caInstrService.amqpEnableInstn (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-svc-instr.js:439:22)
    at capAmqpCap.<anonymous> (native)
    at capAmqpCap.emit (events.js:88:20)
    at Object.capDispatch (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp-cap.js:203:14)
    at capAmqpCap.receive (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp-cap.js:502:31)
    at caAmqp.<anonymous> (native)
    at caAmqp.emit (events.js:67:17)
    at caAmqp.receive (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp.js:367:7)
[2015-06-13 15:11:05.670 UTC] CRIT   writing core dump to /opt/smartdc/agents/lib/node_modules/cabase/cacore.17220
[2015-06-13 15:11:05.739 UTC] CRIT   finished writing core dump
[ Jun 13 15:11:05 Stopping because all processes in service exited. ]
[ Jun 13 15:11:05 Executing stop method (:kill). ]
[ Jun 13 15:11:05 Executing start method ("/opt/smartdc/agents/lib/node_modules/cabase/smf/method/canodesvc"). ]
DTRACE_LIBPATH=/opt/smartdc/agents/lib/node_modules/cabase/lib
ignoring amqp-config key amqp_login
ignoring amqp-config key amqp_password
AMQP_HOST=10.99.99.20
AMQP_PORT=5672
NODE_PATH=:/opt/smartdc/agents/lib/node_modules/cabase/node_modules:/opt/smartdc/agents/lib/node_modules/cabase/node_modules/connect/lib:/opt/smartdc/agents/lib/node_modules/cabase/lib/ca:/opt/smartdc/agents/lib/node_modules/cabase/lib/tst
[ Jun 13 15:11:06 Method "start" exited with status 0. ]
The "sys" module is now called "util". It should have a similar interface.
using backends kstat,dtrace,zfs,cainstr,proc
[2015-06-13 15:11:06.403 UTC] INFO   Logging AMQP message to "/opt/smartdc/agents/log/ca/cainstsvc/amqp-2015-06-13.15:11:05.17242"
[2015-06-13 15:11:06.404 UTC] INFO   Instrumenter starting up (instsvc/0.0)
[2015-06-13 15:11:06.404 UTC] INFO   Hostname:    headnode
[2015-06-13 15:11:06.405 UTC] INFO   AMQP broker: {"host":"10.99.99.20","port":"5672"}
[2015-06-13 15:11:06.405 UTC] INFO   Routing key: ca.instrumenter.headnode
[2015-06-13 15:11:06.411 UTC] DBG    loaded metadata file "metadata/profile/operator.json"
[2015-06-13 15:11:06.412 UTC] DBG    loaded metadata file "metadata/metric/metrics.json"
[2015-06-13 15:11:06.413 UTC] DBG    loaded metadata file "metadata/profile/customer.json"
[2015-06-13 15:11:06.425 UTC] INFO   loading modules.
[2015-06-13 15:11:06.439 UTC] INFO   module "kstat" registered cpu.cpus
[2015-06-13 15:11:06.440 UTC] INFO   module "kstat" registered cpu.usage
[2015-06-13 15:11:06.440 UTC] INFO   module "kstat" registered cpu.waittime
[2015-06-13 15:11:06.440 UTC] INFO   module "kstat" registered cpu.loadavg1
[2015-06-13 15:11:06.441 UTC] INFO   module "kstat" registered nic.nics
[2015-06-13 15:11:06.441 UTC] INFO   module "kstat" registered nic.bytes
[2015-06-13 15:11:06.441 UTC] INFO   module "kstat" registered nic.packets
[2015-06-13 15:11:06.441 UTC] INFO   module "kstat" registered nic.vnic_bytes
[2015-06-13 15:11:06.441 UTC] INFO   module "kstat" registered nic.vnic_packets
[2015-06-13 15:11:06.442 UTC] INFO   module "kstat" registered disk.disks
[2015-06-13 15:11:06.442 UTC] INFO   module "kstat" registered disk.physio_ops
[2015-06-13 15:11:06.442 UTC] INFO   module "kstat" registered disk.physio_bytes
[2015-06-13 15:11:06.442 UTC] INFO   module "kstat" registered tcp.segments
[2015-06-13 15:11:06.442 UTC] INFO   module "kstat" registered tcp.errors
[2015-06-13 15:11:06.443 UTC] INFO   module "kstat" registered fs.logical_rwops
[2015-06-13 15:11:06.443 UTC] INFO   module "kstat" registered fs.logical_rwbytes
[2015-06-13 15:11:06.443 UTC] INFO   module "kstat" registered memory.rss
[2015-06-13 15:11:06.443 UTC] INFO   module "kstat" registered memory.rss_limit
[2015-06-13 15:11:06.443 UTC] INFO   module "kstat" registered memory.swap
[2015-06-13 15:11:06.443 UTC] INFO   module "kstat" registered memory.swap_limit
[2015-06-13 15:11:06.443 UTC] INFO   module "kstat" registered memory.reclaimed_bytes
[2015-06-13 15:11:06.444 UTC] INFO   module "kstat" registered memory.pageins
[2015-06-13 15:11:06.444 UTC] INFO   module "kstat" registered vm.exits
[2015-06-13 15:11:06.444 UTC] INFO   module "kstat" registered zfs.arc_ops
[2015-06-13 15:11:06.444 UTC] INFO   loaded module "kstat".
[2015-06-13 15:11:06.474 UTC] INFO   module "dtrace" registered apache.httpd_ops
[2015-06-13 15:11:06.476 UTC] INFO   module "dtrace" registered cpu.thread_executions
[2015-06-13 15:11:06.477 UTC] INFO   module "dtrace" registered cpu.thread_samples
[2015-06-13 15:11:06.478 UTC] INFO   module "dtrace" registered disk.physio_ops
[2015-06-13 15:11:06.481 UTC] INFO   module "dtrace" registered fs.logical_ops
[2015-06-13 15:11:06.482 UTC] INFO   module "dtrace" registered fs.logical_rwops
[2015-06-13 15:11:06.483 UTC] INFO   module "dtrace" registered ldapjs.connections
[2015-06-13 15:11:06.487 UTC] INFO   module "dtrace" registered ldapjs.ops
[2015-06-13 15:11:06.488 UTC] INFO   module "dtrace" registered ldapjs.search_ops
[2015-06-13 15:11:06.489 UTC] INFO   module "dtrace" registered mantaop.jobs_assigned
[2015-06-13 15:11:06.490 UTC] INFO   module "dtrace" registered mantaop.supervisor_auths
[2015-06-13 15:11:06.492 UTC] INFO   module "dtrace" registered mantaop.supervisor_deletes
[2015-06-13 15:11:06.493 UTC] INFO   module "dtrace" registered mantaop.supervisor_errors
[2015-06-13 15:11:06.494 UTC] INFO   module "dtrace" registered mantaop.supervisor_locates
[2015-06-13 15:11:06.495 UTC] INFO   module "dtrace" registered mantaop.tasks_committed
[2015-06-13 15:11:06.496 UTC] INFO   module "dtrace" registered mantaop.tasks_dispatched
[2015-06-13 15:11:06.497 UTC] INFO   module "dtrace" registered mantaop.tasks_executed
[2015-06-13 15:11:06.497 UTC] INFO   module "dtrace" registered mantaop.tasks_killed
[2015-06-13 15:11:06.498 UTC] INFO   module "dtrace" registered mantaop.zone_resets
[2015-06-13 15:11:06.500 UTC] INFO   module "dtrace" registered moray.ops
[2015-06-13 15:11:06.501 UTC] INFO   module "dtrace" registered moray.queries
[2015-06-13 15:11:06.502 UTC] INFO   module "dtrace" registered mysql.commands
[2015-06-13 15:11:06.503 UTC] INFO   module "dtrace" registered mysql.connections
[2015-06-13 15:11:06.504 UTC] INFO   module "dtrace" registered mysql.filesort
[2015-06-13 15:11:06.506 UTC] INFO   module "dtrace" registered mysql.queries
[2015-06-13 15:11:06.509 UTC] INFO   module "dtrace" registered mysql.statements
[2015-06-13 15:11:06.512 UTC] INFO   module "dtrace" registered node.gc_ops
[2015-06-13 15:11:06.514 UTC] INFO   module "dtrace" registered node.httpc_ops
[2015-06-13 15:11:06.516 UTC] INFO   module "dtrace" registered node.httpd_ops
[2015-06-13 15:11:06.518 UTC] INFO   module "dtrace" registered node.socket_ops
[2015-06-13 15:11:06.520 UTC] INFO   module "dtrace" registered postgres.queries
[2015-06-13 15:11:06.521 UTC] INFO   module "dtrace" registered unix.proc_execs
[2015-06-13 15:11:06.522 UTC] INFO   module "dtrace" registered unix.proc_exits
[2015-06-13 15:11:06.523 UTC] INFO   module "dtrace" registered unix.proc_forks
[2015-06-13 15:11:06.524 UTC] INFO   module "dtrace" registered restify.handler_ops
[2015-06-13 15:11:06.525 UTC] INFO   module "dtrace" registered restify.server_ops
[2015-06-13 15:11:06.527 UTC] INFO   module "dtrace" registered syscall.syscalls
[2015-06-13 15:11:06.528 UTC] INFO   module "dtrace" registered tcp.accepts
[2015-06-13 15:11:06.530 UTC] INFO   module "dtrace" registered tcp.connects
[2015-06-13 15:11:06.532 UTC] INFO   module "dtrace" registered unix.thr_creates
[2015-06-13 15:11:06.533 UTC] INFO   module "dtrace" registered vm.irqs
[2015-06-13 15:11:06.537 UTC] INFO   module "dtrace" registered vm.physio_bytes
[2015-06-13 15:11:06.538 UTC] INFO   module "dtrace" registered vm.physio_ops
[2015-06-13 15:11:06.539 UTC] INFO   module "dtrace" registered vm.thread_samples
[2015-06-13 15:11:06.541 UTC] INFO   module "dtrace" registered zfs.arc_ops
[2015-06-13 15:11:06.541 UTC] INFO   loaded module "dtrace".
[2015-06-13 15:11:06.551 UTC] INFO   module "zfs" registered zfs.dataset_unused_quota
[2015-06-13 15:11:06.551 UTC] INFO   module "zfs" registered zfs.dataset_used
[2015-06-13 15:11:06.552 UTC] INFO   module "zfs" registered zfs.dataset_quota
[2015-06-13 15:11:06.552 UTC] INFO   module "zfs" registered zfs.pool_free
[2015-06-13 15:11:06.552 UTC] INFO   module "zfs" registered zfs.pool_used
[2015-06-13 15:11:06.552 UTC] INFO   module "zfs" registered zfs.pool_total
[2015-06-13 15:11:06.552 UTC] INFO   loaded module "zfs".
[2015-06-13 15:11:06.554 UTC] INFO   module "cainstr" registered ca.instr_ticks
[2015-06-13 15:11:06.554 UTC] INFO   module "cainstr" registered ca.instr_beops
[2015-06-13 15:11:06.554 UTC] INFO   module "cainstr" registered ca.instr_enables
[2015-06-13 15:11:06.554 UTC] INFO   module "cainstr" registered ca.instr_disables
[2015-06-13 15:11:06.555 UTC] INFO   loaded module "cainstr".
[2015-06-13 15:11:06.599 UTC] INFO   module "proc" registered unix.processes
[2015-06-13 15:11:06.599 UTC] INFO   loaded module "proc".
[2015-06-13 15:11:06.599 UTC] INFO   finished loading modules.
[2015-06-13 15:11:06.750 UTC] DBG    binding to ca.instrumenter.headnode
[2015-06-13 15:11:06.751 UTC] DBG    binding to ca.broadcast
[2015-06-13 15:11:06.756 UTC] DBG    bind to ca.instrumenter.headnode complete
[2015-06-13 15:11:06.756 UTC] DBG    bind to ca.broadcast complete
[2015-06-13 15:11:06.756 UTC] INFO   AMQP broker connected.
[2015-06-13 15:11:15.679 UTC] CRIT   CA PANIC: panic due to uncaught exception: EXCEPTION: TypeError: TypeError: Object #<Object> has no method 'appendFile'
    at Object.mdGenerateDScript (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-metad.js:859:4)
    at Object.impl (/opt/smartdc/agents/lib/node_modules/cabase/cmd/cainst/modules/dtrace.js:38:28)
    at caInstrService.amqpEnableInstn (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-svc-instr.js:439:22)
    at capAmqpCap.<anonymous> (native)
    at capAmqpCap.emit (events.js:88:20)
    at Object.capDispatch (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp-cap.js:203:14)
    at capAmqpCap.receive (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp-cap.js:502:31)
    at caAmqp.<anonymous> (native)
    at caAmqp.emit (events.js:67:17)
    at caAmqp.receive (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp.js:367:7)
[2015-06-13 15:11:15.679 UTC] CRIT   writing core dump to /opt/smartdc/agents/lib/node_modules/cabase/cacore.17270
[2015-06-13 15:11:15.749 UTC] CRIT   finished writing core dump
[ Jun 13 15:11:15 Stopping because all processes in service exited. ]
[ Jun 13 15:11:15 Executing stop method (:kill). ]
[ Jun 13 15:11:15 Executing start method ("/opt/smartdc/agents/lib/node_modules/cabase/smf/method/canodesvc"). ]
DTRACE_LIBPATH=/opt/smartdc/agents/lib/node_modules/cabase/lib
ignoring amqp-config key amqp_login
ignoring amqp-config key amqp_password
AMQP_HOST=10.99.99.20
AMQP_PORT=5672
NODE_PATH=:/opt/smartdc/agents/lib/node_modules/cabase/node_modules:/opt/smartdc/agents/lib/node_modules/cabase/node_modules/connect/lib:/opt/smartdc/agents/lib/node_modules/cabase/lib/ca:/opt/smartdc/agents/lib/node_modules/cabase/lib/tst
[ Jun 13 15:11:16 Method "start" exited with status 0. ]
The "sys" module is now called "util". It should have a similar interface.
using backends kstat,dtrace,zfs,cainstr,proc
[2015-06-13 15:11:16.324 UTC] INFO   Logging AMQP message to "/opt/smartdc/agents/log/ca/cainstsvc/amqp-2015-06-13.15:11:15.17275"
[2015-06-13 15:11:16.325 UTC] INFO   Instrumenter starting up (instsvc/0.0)
[2015-06-13 15:11:16.325 UTC] INFO   Hostname:    headnode
[2015-06-13 15:11:16.325 UTC] INFO   AMQP broker: {"host":"10.99.99.20","port":"5672"}
[2015-06-13 15:11:16.325 UTC] INFO   Routing key: ca.instrumenter.headnode
[2015-06-13 15:11:16.329 UTC] DBG    loaded metadata file "metadata/profile/operator.json"
[2015-06-13 15:11:16.329 UTC] DBG    loaded metadata file "metadata/profile/customer.json"
[2015-06-13 15:11:16.330 UTC] DBG    loaded metadata file "metadata/metric/metrics.json"
[2015-06-13 15:11:16.344 UTC] INFO   loading modules.
[2015-06-13 15:11:16.356 UTC] INFO   module "kstat" registered cpu.cpus
[2015-06-13 15:11:16.356 UTC] INFO   module "kstat" registered cpu.usage
[2015-06-13 15:11:16.356 UTC] INFO   module "kstat" registered cpu.waittime
[2015-06-13 15:11:16.357 UTC] INFO   module "kstat" registered cpu.loadavg1
[2015-06-13 15:11:16.357 UTC] INFO   module "kstat" registered nic.nics
[2015-06-13 15:11:16.357 UTC] INFO   module "kstat" registered nic.bytes
[2015-06-13 15:11:16.357 UTC] INFO   module "kstat" registered nic.packets
[2015-06-13 15:11:16.357 UTC] INFO   module "kstat" registered nic.vnic_bytes
[2015-06-13 15:11:16.357 UTC] INFO   module "kstat" registered nic.vnic_packets
[2015-06-13 15:11:16.358 UTC] INFO   module "kstat" registered disk.disks
[2015-06-13 15:11:16.358 UTC] INFO   module "kstat" registered disk.physio_ops
[2015-06-13 15:11:16.358 UTC] INFO   module "kstat" registered disk.physio_bytes
[2015-06-13 15:11:16.359 UTC] INFO   module "kstat" registered tcp.segments
[2015-06-13 15:11:16.359 UTC] INFO   module "kstat" registered tcp.errors
[2015-06-13 15:11:16.359 UTC] INFO   module "kstat" registered fs.logical_rwops
[2015-06-13 15:11:16.359 UTC] INFO   module "kstat" registered fs.logical_rwbytes
[2015-06-13 15:11:16.359 UTC] INFO   module "kstat" registered memory.rss
[2015-06-13 15:11:16.359 UTC] INFO   module "kstat" registered memory.rss_limit
[2015-06-13 15:11:16.360 UTC] INFO   module "kstat" registered memory.swap
[2015-06-13 15:11:16.360 UTC] INFO   module "kstat" registered memory.swap_limit
[2015-06-13 15:11:16.360 UTC] INFO   module "kstat" registered memory.reclaimed_bytes
[2015-06-13 15:11:16.360 UTC] INFO   module "kstat" registered memory.pageins
[2015-06-13 15:11:16.361 UTC] INFO   module "kstat" registered vm.exits
[2015-06-13 15:11:16.361 UTC] INFO   module "kstat" registered zfs.arc_ops
[2015-06-13 15:11:16.361 UTC] INFO   loaded module "kstat".
[2015-06-13 15:11:16.393 UTC] INFO   module "dtrace" registered apache.httpd_ops
[2015-06-13 15:11:16.394 UTC] INFO   module "dtrace" registered cpu.thread_executions
[2015-06-13 15:11:16.395 UTC] INFO   module "dtrace" registered cpu.thread_samples
[2015-06-13 15:11:16.396 UTC] INFO   module "dtrace" registered disk.physio_ops
[2015-06-13 15:11:16.398 UTC] INFO   module "dtrace" registered fs.logical_ops
[2015-06-13 15:11:16.399 UTC] INFO   module "dtrace" registered fs.logical_rwops
[2015-06-13 15:11:16.400 UTC] INFO   module "dtrace" registered ldapjs.connections
[2015-06-13 15:11:16.403 UTC] INFO   module "dtrace" registered ldapjs.ops
[2015-06-13 15:11:16.405 UTC] INFO   module "dtrace" registered ldapjs.search_ops
[2015-06-13 15:11:16.406 UTC] INFO   module "dtrace" registered mantaop.jobs_assigned
[2015-06-13 15:11:16.407 UTC] INFO   module "dtrace" registered mantaop.supervisor_auths
[2015-06-13 15:11:16.408 UTC] INFO   module "dtrace" registered mantaop.supervisor_deletes
[2015-06-13 15:11:16.409 UTC] INFO   module "dtrace" registered mantaop.supervisor_errors
[2015-06-13 15:11:16.410 UTC] INFO   module "dtrace" registered mantaop.supervisor_locates
[2015-06-13 15:11:16.411 UTC] INFO   module "dtrace" registered mantaop.tasks_committed
[2015-06-13 15:11:16.412 UTC] INFO   module "dtrace" registered mantaop.tasks_dispatched
[2015-06-13 15:11:16.413 UTC] INFO   module "dtrace" registered mantaop.tasks_executed
[2015-06-13 15:11:16.413 UTC] INFO   module "dtrace" registered mantaop.tasks_killed
[2015-06-13 15:11:16.414 UTC] INFO   module "dtrace" registered mantaop.zone_resets
[2015-06-13 15:11:16.416 UTC] INFO   module "dtrace" registered moray.ops
[2015-06-13 15:11:16.417 UTC] INFO   module "dtrace" registered moray.queries
[2015-06-13 15:11:16.419 UTC] INFO   module "dtrace" registered mysql.commands
[2015-06-13 15:11:16.419 UTC] INFO   module "dtrace" registered mysql.connections
[2015-06-13 15:11:16.420 UTC] INFO   module "dtrace" registered mysql.filesort
[2015-06-13 15:11:16.422 UTC] INFO   module "dtrace" registered mysql.queries
[2015-06-13 15:11:16.423 UTC] INFO   module "dtrace" registered mysql.statements
[2015-06-13 15:11:16.424 UTC] INFO   module "dtrace" registered node.gc_ops
[2015-06-13 15:11:16.426 UTC] INFO   module "dtrace" registered node.httpc_ops
[2015-06-13 15:11:16.427 UTC] INFO   module "dtrace" registered node.httpd_ops
[2015-06-13 15:11:16.428 UTC] INFO   module "dtrace" registered node.socket_ops
[2015-06-13 15:11:16.429 UTC] INFO   module "dtrace" registered postgres.queries
[2015-06-13 15:11:16.430 UTC] INFO   module "dtrace" registered unix.proc_execs
[2015-06-13 15:11:16.431 UTC] INFO   module "dtrace" registered unix.proc_exits
[2015-06-13 15:11:16.432 UTC] INFO   module "dtrace" registered unix.proc_forks
[2015-06-13 15:11:16.433 UTC] INFO   module "dtrace" registered restify.handler_ops
[2015-06-13 15:11:16.434 UTC] INFO   module "dtrace" registered restify.server_ops
[2015-06-13 15:11:16.435 UTC] INFO   module "dtrace" registered syscall.syscalls
[2015-06-13 15:11:16.437 UTC] INFO   module "dtrace" registered tcp.accepts
[2015-06-13 15:11:16.438 UTC] INFO   module "dtrace" registered tcp.connects
[2015-06-13 15:11:16.439 UTC] INFO   module "dtrace" registered unix.thr_creates
[2015-06-13 15:11:16.440 UTC] INFO   module "dtrace" registered vm.irqs
[2015-06-13 15:11:16.441 UTC] INFO   module "dtrace" registered vm.physio_bytes
[2015-06-13 15:11:16.442 UTC] INFO   module "dtrace" registered vm.physio_ops
[2015-06-13 15:11:16.442 UTC] INFO   module "dtrace" registered vm.thread_samples
[2015-06-13 15:11:16.443 UTC] INFO   module "dtrace" registered zfs.arc_ops
[2015-06-13 15:11:16.443 UTC] INFO   loaded module "dtrace".
[2015-06-13 15:11:16.450 UTC] INFO   module "zfs" registered zfs.dataset_unused_quota
[2015-06-13 15:11:16.451 UTC] INFO   module "zfs" registered zfs.dataset_used
[2015-06-13 15:11:16.451 UTC] INFO   module "zfs" registered zfs.dataset_quota
[2015-06-13 15:11:16.451 UTC] INFO   module "zfs" registered zfs.pool_free
[2015-06-13 15:11:16.451 UTC] INFO   module "zfs" registered zfs.pool_used
[2015-06-13 15:11:16.451 UTC] INFO   module "zfs" registered zfs.pool_total
[2015-06-13 15:11:16.451 UTC] INFO   loaded module "zfs".
[2015-06-13 15:11:16.452 UTC] INFO   module "cainstr" registered ca.instr_ticks
[2015-06-13 15:11:16.453 UTC] INFO   module "cainstr" registered ca.instr_beops
[2015-06-13 15:11:16.453 UTC] INFO   module "cainstr" registered ca.instr_enables
[2015-06-13 15:11:16.453 UTC] INFO   module "cainstr" registered ca.instr_disables
[2015-06-13 15:11:16.453 UTC] INFO   loaded module "cainstr".
[2015-06-13 15:11:16.491 UTC] INFO   module "proc" registered unix.processes
[2015-06-13 15:11:16.491 UTC] INFO   loaded module "proc".
[2015-06-13 15:11:16.491 UTC] INFO   finished loading modules.
[2015-06-13 15:11:16.627 UTC] DBG    binding to ca.instrumenter.headnode
[2015-06-13 15:11:16.628 UTC] DBG    binding to ca.broadcast
[2015-06-13 15:11:16.631 UTC] DBG    bind to ca.instrumenter.headnode complete
[2015-06-13 15:11:16.631 UTC] DBG    bind to ca.broadcast complete
[2015-06-13 15:11:16.631 UTC] INFO   AMQP broker connected.
[2015-06-13 15:11:25.684 UTC] CRIT   CA PANIC: panic due to uncaught exception: EXCEPTION: TypeError: TypeError: Object #<Object> has no method 'appendFile'
    at Object.mdGenerateDScript (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-metad.js:859:4)
    at Object.impl (/opt/smartdc/agents/lib/node_modules/cabase/cmd/cainst/modules/dtrace.js:38:28)
    at caInstrService.amqpEnableInstn (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-svc-instr.js:439:22)
    at capAmqpCap.<anonymous> (native)
    at capAmqpCap.emit (events.js:88:20)
    at Object.capDispatch (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp-cap.js:203:14)
    at capAmqpCap.receive (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp-cap.js:502:31)
    at caAmqp.<anonymous> (native)
    at caAmqp.emit (events.js:67:17)
    at caAmqp.receive (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp.js:367:7)
[2015-06-13 15:11:25.685 UTC] CRIT   writing core dump to /opt/smartdc/agents/lib/node_modules/cabase/cacore.17303
[2015-06-13 15:11:25.750 UTC] CRIT   finished writing core dump
[ Jun 13 15:11:25 Stopping because all processes in service exited. ]
[ Jun 13 15:11:25 Executing stop method (:kill). ]
[ Jun 13 15:11:25 Executing start method ("/opt/smartdc/agents/lib/node_modules/cabase/smf/method/canodesvc"). ]
DTRACE_LIBPATH=/opt/smartdc/agents/lib/node_modules/cabase/lib
ignoring amqp-config key amqp_login
ignoring amqp-config key amqp_password
AMQP_HOST=10.99.99.20
AMQP_PORT=5672
NODE_PATH=:/opt/smartdc/agents/lib/node_modules/cabase/node_modules:/opt/smartdc/agents/lib/node_modules/cabase/node_modules/connect/lib:/opt/smartdc/agents/lib/node_modules/cabase/lib/ca:/opt/smartdc/agents/lib/node_modules/cabase/lib/tst
[ Jun 13 15:11:26 Method "start" exited with status 0. ]
The "sys" module is now called "util". It should have a similar interface.
using backends kstat,dtrace,zfs,cainstr,proc
[2015-06-13 15:11:26.306 UTC] INFO   Logging AMQP message to "/opt/smartdc/agents/log/ca/cainstsvc/amqp-2015-06-13.15:11:25.17313"
[2015-06-13 15:11:26.307 UTC] INFO   Instrumenter starting up (instsvc/0.0)
[2015-06-13 15:11:26.307 UTC] INFO   Hostname:    headnode
[2015-06-13 15:11:26.307 UTC] INFO   AMQP broker: {"host":"10.99.99.20","port":"5672"}
[2015-06-13 15:11:26.307 UTC] INFO   Routing key: ca.instrumenter.headnode
[2015-06-13 15:11:26.313 UTC] DBG    loaded metadata file "metadata/profile/operator.json"
[2015-06-13 15:11:26.314 UTC] DBG    loaded metadata file "metadata/profile/customer.json"
[2015-06-13 15:11:26.316 UTC] DBG    loaded metadata file "metadata/metric/metrics.json"
[2015-06-13 15:11:26.329 UTC] INFO   loading modules.
[2015-06-13 15:11:26.339 UTC] INFO   module "kstat" registered cpu.cpus
[2015-06-13 15:11:26.340 UTC] INFO   module "kstat" registered cpu.usage
[2015-06-13 15:11:26.340 UTC] INFO   module "kstat" registered cpu.waittime
[2015-06-13 15:11:26.340 UTC] INFO   module "kstat" registered cpu.loadavg1
[2015-06-13 15:11:26.340 UTC] INFO   module "kstat" registered nic.nics
[2015-06-13 15:11:26.340 UTC] INFO   module "kstat" registered nic.bytes
[2015-06-13 15:11:26.341 UTC] INFO   module "kstat" registered nic.packets
[2015-06-13 15:11:26.341 UTC] INFO   module "kstat" registered nic.vnic_bytes
[2015-06-13 15:11:26.341 UTC] INFO   module "kstat" registered nic.vnic_packets
[2015-06-13 15:11:26.341 UTC] INFO   module "kstat" registered disk.disks
[2015-06-13 15:11:26.341 UTC] INFO   module "kstat" registered disk.physio_ops
[2015-06-13 15:11:26.341 UTC] INFO   module "kstat" registered disk.physio_bytes
[2015-06-13 15:11:26.342 UTC] INFO   module "kstat" registered tcp.segments
[2015-06-13 15:11:26.342 UTC] INFO   module "kstat" registered tcp.errors
[2015-06-13 15:11:26.342 UTC] INFO   module "kstat" registered fs.logical_rwops
[2015-06-13 15:11:26.342 UTC] INFO   module "kstat" registered fs.logical_rwbytes
[2015-06-13 15:11:26.342 UTC] INFO   module "kstat" registered memory.rss
[2015-06-13 15:11:26.342 UTC] INFO   module "kstat" registered memory.rss_limit
[2015-06-13 15:11:26.342 UTC] INFO   module "kstat" registered memory.swap
[2015-06-13 15:11:26.342 UTC] INFO   module "kstat" registered memory.swap_limit
[2015-06-13 15:11:26.343 UTC] INFO   module "kstat" registered memory.reclaimed_bytes
[2015-06-13 15:11:26.343 UTC] INFO   module "kstat" registered memory.pageins
[2015-06-13 15:11:26.343 UTC] INFO   module "kstat" registered vm.exits
[2015-06-13 15:11:26.343 UTC] INFO   module "kstat" registered zfs.arc_ops
[2015-06-13 15:11:26.343 UTC] INFO   loaded module "kstat".
[2015-06-13 15:11:26.373 UTC] INFO   module "dtrace" registered apache.httpd_ops
[2015-06-13 15:11:26.376 UTC] INFO   module "dtrace" registered cpu.thread_executions
[2015-06-13 15:11:26.379 UTC] INFO   module "dtrace" registered cpu.thread_samples
[2015-06-13 15:11:26.380 UTC] INFO   module "dtrace" registered disk.physio_ops
[2015-06-13 15:11:26.382 UTC] INFO   module "dtrace" registered fs.logical_ops
[2015-06-13 15:11:26.383 UTC] INFO   module "dtrace" registered fs.logical_rwops
[2015-06-13 15:11:26.384 UTC] INFO   module "dtrace" registered ldapjs.connections
[2015-06-13 15:11:26.386 UTC] INFO   module "dtrace" registered ldapjs.ops
[2015-06-13 15:11:26.388 UTC] INFO   module "dtrace" registered ldapjs.search_ops
[2015-06-13 15:11:26.388 UTC] INFO   module "dtrace" registered mantaop.jobs_assigned
[2015-06-13 15:11:26.389 UTC] INFO   module "dtrace" registered mantaop.supervisor_auths
[2015-06-13 15:11:26.390 UTC] INFO   module "dtrace" registered mantaop.supervisor_deletes
[2015-06-13 15:11:26.391 UTC] INFO   module "dtrace" registered mantaop.supervisor_errors
[2015-06-13 15:11:26.392 UTC] INFO   module "dtrace" registered mantaop.supervisor_locates
[2015-06-13 15:11:26.393 UTC] INFO   module "dtrace" registered mantaop.tasks_committed
[2015-06-13 15:11:26.393 UTC] INFO   module "dtrace" registered mantaop.tasks_dispatched
[2015-06-13 15:11:26.394 UTC] INFO   module "dtrace" registered mantaop.tasks_executed
[2015-06-13 15:11:26.395 UTC] INFO   module "dtrace" registered mantaop.tasks_killed
[2015-06-13 15:11:26.397 UTC] INFO   module "dtrace" registered mantaop.zone_resets
[2015-06-13 15:11:26.398 UTC] INFO   module "dtrace" registered moray.ops
[2015-06-13 15:11:26.399 UTC] INFO   module "dtrace" registered moray.queries
[2015-06-13 15:11:26.400 UTC] INFO   module "dtrace" registered mysql.commands
[2015-06-13 15:11:26.401 UTC] INFO   module "dtrace" registered mysql.connections
[2015-06-13 15:11:26.402 UTC] INFO   module "dtrace" registered mysql.filesort
[2015-06-13 15:11:26.404 UTC] INFO   module "dtrace" registered mysql.queries
[2015-06-13 15:11:26.405 UTC] INFO   module "dtrace" registered mysql.statements
[2015-06-13 15:11:26.406 UTC] INFO   module "dtrace" registered node.gc_ops
[2015-06-13 15:11:26.407 UTC] INFO   module "dtrace" registered node.httpc_ops
[2015-06-13 15:11:26.409 UTC] INFO   module "dtrace" registered node.httpd_ops
[2015-06-13 15:11:26.410 UTC] INFO   module "dtrace" registered node.socket_ops
[2015-06-13 15:11:26.412 UTC] INFO   module "dtrace" registered postgres.queries
[2015-06-13 15:11:26.413 UTC] INFO   module "dtrace" registered unix.proc_execs
[2015-06-13 15:11:26.414 UTC] INFO   module "dtrace" registered unix.proc_exits
[2015-06-13 15:11:26.415 UTC] INFO   module "dtrace" registered unix.proc_forks
[2015-06-13 15:11:26.416 UTC] INFO   module "dtrace" registered restify.handler_ops
[2015-06-13 15:11:26.417 UTC] INFO   module "dtrace" registered restify.server_ops
[2015-06-13 15:11:26.418 UTC] INFO   module "dtrace" registered syscall.syscalls
[2015-06-13 15:11:26.419 UTC] INFO   module "dtrace" registered tcp.accepts
[2015-06-13 15:11:26.420 UTC] INFO   module "dtrace" registered tcp.connects
[2015-06-13 15:11:26.421 UTC] INFO   module "dtrace" registered unix.thr_creates
[2015-06-13 15:11:26.422 UTC] INFO   module "dtrace" registered vm.irqs
[2015-06-13 15:11:26.423 UTC] INFO   module "dtrace" registered vm.physio_bytes
[2015-06-13 15:11:26.424 UTC] INFO   module "dtrace" registered vm.physio_ops
[2015-06-13 15:11:26.425 UTC] INFO   module "dtrace" registered vm.thread_samples
[2015-06-13 15:11:26.426 UTC] INFO   module "dtrace" registered zfs.arc_ops
[2015-06-13 15:11:26.426 UTC] INFO   loaded module "dtrace".
[2015-06-13 15:11:26.433 UTC] INFO   module "zfs" registered zfs.dataset_unused_quota
[2015-06-13 15:11:26.433 UTC] INFO   module "zfs" registered zfs.dataset_used
[2015-06-13 15:11:26.434 UTC] INFO   module "zfs" registered zfs.dataset_quota
[2015-06-13 15:11:26.434 UTC] INFO   module "zfs" registered zfs.pool_free
[2015-06-13 15:11:26.434 UTC] INFO   module "zfs" registered zfs.pool_used
[2015-06-13 15:11:26.434 UTC] INFO   module "zfs" registered zfs.pool_total
[2015-06-13 15:11:26.434 UTC] INFO   loaded module "zfs".
[2015-06-13 15:11:26.436 UTC] INFO   module "cainstr" registered ca.instr_ticks
[2015-06-13 15:11:26.436 UTC] INFO   module "cainstr" registered ca.instr_beops
[2015-06-13 15:11:26.436 UTC] INFO   module "cainstr" registered ca.instr_enables
[2015-06-13 15:11:26.436 UTC] INFO   module "cainstr" registered ca.instr_disables
[2015-06-13 15:11:26.436 UTC] INFO   loaded module "cainstr".
[2015-06-13 15:11:26.482 UTC] INFO   module "proc" registered unix.processes
[2015-06-13 15:11:26.483 UTC] INFO   loaded module "proc".
[2015-06-13 15:11:26.483 UTC] INFO   finished loading modules.
[2015-06-13 15:11:26.616 UTC] DBG    binding to ca.instrumenter.headnode
[2015-06-13 15:11:26.620 UTC] DBG    binding to ca.broadcast
[2015-06-13 15:11:26.623 UTC] DBG    bind to ca.instrumenter.headnode complete
[2015-06-13 15:11:26.624 UTC] DBG    bind to ca.broadcast complete
[2015-06-13 15:11:26.626 UTC] INFO   AMQP broker connected.
[2015-06-13 15:11:35.681 UTC] CRIT   CA PANIC: panic due to uncaught exception: EXCEPTION: TypeError: TypeError: Object #<Object> has no method 'appendFile'
    at Object.mdGenerateDScript (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-metad.js:859:4)
    at Object.impl (/opt/smartdc/agents/lib/node_modules/cabase/cmd/cainst/modules/dtrace.js:38:28)
    at caInstrService.amqpEnableInstn (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-svc-instr.js:439:22)
    at capAmqpCap.<anonymous> (native)
    at capAmqpCap.emit (events.js:88:20)
    at Object.capDispatch (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp-cap.js:203:14)
    at capAmqpCap.receive (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp-cap.js:502:31)
    at caAmqp.<anonymous> (native)
    at caAmqp.emit (events.js:67:17)
    at caAmqp.receive (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp.js:367:7)
[2015-06-13 15:11:35.681 UTC] CRIT   writing core dump to /opt/smartdc/agents/lib/node_modules/cabase/cacore.17341
[2015-06-13 15:11:35.757 UTC] CRIT   finished writing core dump
[ Jun 13 15:11:35 Stopping because all processes in service exited. ]
[ Jun 13 15:11:35 Executing stop method (:kill). ]
[ Jun 13 15:11:35 Restarting too quickly, changing state to maintenance. ]
[ Jun 13 20:27:37 Enabled. ]
[ Jun 13 20:27:37 Rereading configuration. ]
[ Jun 13 20:27:42 Executing start method ("/opt/smartdc/agents/lib/node_modules/cabase/smf/method/canodesvc"). ]
DTRACE_LIBPATH=/opt/smartdc/agents/lib/node_modules/cabase/lib
ignoring amqp-config key amqp_login
ignoring amqp-config key amqp_password
AMQP_HOST=10.99.99.20
AMQP_PORT=5672
NODE_PATH=:/opt/smartdc/agents/lib/node_modules/cabase/node_modules:/opt/smartdc/agents/lib/node_modules/cabase/node_modules/connect/lib:/opt/smartdc/agents/lib/node_modules/cabase/lib/ca:/opt/smartdc/agents/lib/node_modules/cabase/lib/tst
[ Jun 13 20:27:44 Method "start" exited with status 0. ]
The "sys" module is now called "util". It should have a similar interface.
using backends kstat,dtrace,zfs,cainstr,proc
[2015-06-13 20:27:48.821 UTC] INFO   Logging AMQP message to "/opt/smartdc/agents/log/ca/cainstsvc/amqp-2015-06-13.20:27:42.2735"
[2015-06-13 20:27:48.823 UTC] INFO   Instrumenter starting up (instsvc/0.0)
[2015-06-13 20:27:48.823 UTC] INFO   Hostname:    headnode
[2015-06-13 20:27:48.824 UTC] INFO   AMQP broker: {"host":"10.99.99.20","port":"5672"}
[2015-06-13 20:27:48.824 UTC] INFO   Routing key: ca.instrumenter.headnode
[2015-06-13 20:27:48.839 UTC] DBG    loaded metadata file "metadata/profile/operator.json"
[2015-06-13 20:27:48.841 UTC] DBG    loaded metadata file "metadata/profile/customer.json"
[2015-06-13 20:27:48.976 UTC] DBG    loaded metadata file "metadata/metric/metrics.json"
[2015-06-13 20:27:48.995 UTC] INFO   loading modules.
[2015-06-13 20:27:49.104 UTC] INFO   module "kstat" registered cpu.cpus
[2015-06-13 20:27:49.105 UTC] INFO   module "kstat" registered cpu.usage
[2015-06-13 20:27:49.105 UTC] INFO   module "kstat" registered cpu.waittime
[2015-06-13 20:27:49.106 UTC] INFO   module "kstat" registered cpu.loadavg1
[2015-06-13 20:27:49.107 UTC] INFO   module "kstat" registered nic.nics
[2015-06-13 20:27:49.107 UTC] INFO   module "kstat" registered nic.bytes
[2015-06-13 20:27:49.108 UTC] INFO   module "kstat" registered nic.packets
[2015-06-13 20:27:49.108 UTC] INFO   module "kstat" registered nic.vnic_bytes
[2015-06-13 20:27:49.108 UTC] INFO   module "kstat" registered nic.vnic_packets
[2015-06-13 20:27:49.108 UTC] INFO   module "kstat" registered disk.disks
[2015-06-13 20:27:49.109 UTC] INFO   module "kstat" registered disk.physio_ops
[2015-06-13 20:27:49.109 UTC] INFO   module "kstat" registered disk.physio_bytes
[2015-06-13 20:27:49.109 UTC] INFO   module "kstat" registered tcp.segments
[2015-06-13 20:27:49.109 UTC] INFO   module "kstat" registered tcp.errors
[2015-06-13 20:27:49.110 UTC] INFO   module "kstat" registered fs.logical_rwops
[2015-06-13 20:27:49.110 UTC] INFO   module "kstat" registered fs.logical_rwbytes
[2015-06-13 20:27:49.110 UTC] INFO   module "kstat" registered memory.rss
[2015-06-13 20:27:49.110 UTC] INFO   module "kstat" registered memory.rss_limit
[2015-06-13 20:27:49.111 UTC] INFO   module "kstat" registered memory.swap
[2015-06-13 20:27:49.111 UTC] INFO   module "kstat" registered memory.swap_limit
[2015-06-13 20:27:49.111 UTC] INFO   module "kstat" registered memory.reclaimed_bytes
[2015-06-13 20:27:49.112 UTC] INFO   module "kstat" registered memory.pageins
[2015-06-13 20:27:49.112 UTC] INFO   module "kstat" registered vm.exits
[2015-06-13 20:27:49.112 UTC] INFO   module "kstat" registered zfs.arc_ops
[2015-06-13 20:27:49.112 UTC] INFO   loaded module "kstat".
[2015-06-13 20:27:49.520 UTC] INFO   module "dtrace" registered apache.httpd_ops
[2015-06-13 20:27:49.522 UTC] INFO   module "dtrace" registered cpu.thread_executions
[2015-06-13 20:27:49.525 UTC] INFO   module "dtrace" registered cpu.thread_samples
[2015-06-13 20:27:49.528 UTC] INFO   module "dtrace" registered disk.physio_ops
[2015-06-13 20:27:49.535 UTC] INFO   module "dtrace" registered fs.logical_ops
[2015-06-13 20:27:49.537 UTC] INFO   module "dtrace" registered fs.logical_rwops
[2015-06-13 20:27:49.539 UTC] INFO   module "dtrace" registered ldapjs.connections
[2015-06-13 20:27:49.544 UTC] INFO   module "dtrace" registered ldapjs.ops
[2015-06-13 20:27:49.546 UTC] INFO   module "dtrace" registered ldapjs.search_ops
[2015-06-13 20:27:49.547 UTC] INFO   module "dtrace" registered mantaop.jobs_assigned
[2015-06-13 20:27:49.548 UTC] INFO   module "dtrace" registered mantaop.supervisor_auths
[2015-06-13 20:27:49.550 UTC] INFO   module "dtrace" registered mantaop.supervisor_deletes
[2015-06-13 20:27:49.551 UTC] INFO   module "dtrace" registered mantaop.supervisor_errors
[2015-06-13 20:27:49.552 UTC] INFO   module "dtrace" registered mantaop.supervisor_locates
[2015-06-13 20:27:49.554 UTC] INFO   module "dtrace" registered mantaop.tasks_committed
[2015-06-13 20:27:49.555 UTC] INFO   module "dtrace" registered mantaop.tasks_dispatched
[2015-06-13 20:27:49.556 UTC] INFO   module "dtrace" registered mantaop.tasks_executed
[2015-06-13 20:27:49.558 UTC] INFO   module "dtrace" registered mantaop.tasks_killed
[2015-06-13 20:27:49.560 UTC] INFO   module "dtrace" registered mantaop.zone_resets
[2015-06-13 20:27:49.563 UTC] INFO   module "dtrace" registered moray.ops
[2015-06-13 20:27:49.568 UTC] INFO   module "dtrace" registered moray.queries
[2015-06-13 20:27:49.572 UTC] INFO   module "dtrace" registered mysql.commands
[2015-06-13 20:27:49.574 UTC] INFO   module "dtrace" registered mysql.connections
[2015-06-13 20:27:49.575 UTC] INFO   module "dtrace" registered mysql.filesort
[2015-06-13 20:27:49.578 UTC] INFO   module "dtrace" registered mysql.queries
[2015-06-13 20:27:49.581 UTC] INFO   module "dtrace" registered mysql.statements
[2015-06-13 20:27:49.583 UTC] INFO   module "dtrace" registered node.gc_ops
[2015-06-13 20:27:49.586 UTC] INFO   module "dtrace" registered node.httpc_ops
[2015-06-13 20:27:49.589 UTC] INFO   module "dtrace" registered node.httpd_ops
[2015-06-13 20:27:49.591 UTC] INFO   module "dtrace" registered node.socket_ops
[2015-06-13 20:27:49.593 UTC] INFO   module "dtrace" registered postgres.queries
[2015-06-13 20:27:49.596 UTC] INFO   module "dtrace" registered unix.proc_execs
[2015-06-13 20:27:49.598 UTC] INFO   module "dtrace" registered unix.proc_exits
[2015-06-13 20:27:49.600 UTC] INFO   module "dtrace" registered unix.proc_forks
[2015-06-13 20:27:49.602 UTC] INFO   module "dtrace" registered restify.handler_ops
[2015-06-13 20:27:49.604 UTC] INFO   module "dtrace" registered restify.server_ops
[2015-06-13 20:27:49.606 UTC] INFO   module "dtrace" registered syscall.syscalls
[2015-06-13 20:27:49.609 UTC] INFO   module "dtrace" registered tcp.accepts
[2015-06-13 20:27:49.611 UTC] INFO   module "dtrace" registered tcp.connects
[2015-06-13 20:27:49.613 UTC] INFO   module "dtrace" registered unix.thr_creates
[2015-06-13 20:27:49.615 UTC] INFO   module "dtrace" registered vm.irqs
[2015-06-13 20:27:49.618 UTC] INFO   module "dtrace" registered vm.physio_bytes
[2015-06-13 20:27:49.620 UTC] INFO   module "dtrace" registered vm.physio_ops
[2015-06-13 20:27:49.623 UTC] INFO   module "dtrace" registered vm.thread_samples
[2015-06-13 20:27:49.625 UTC] INFO   module "dtrace" registered zfs.arc_ops
[2015-06-13 20:27:49.625 UTC] INFO   loaded module "dtrace".
[2015-06-13 20:27:49.641 UTC] INFO   module "zfs" registered zfs.dataset_unused_quota
[2015-06-13 20:27:49.642 UTC] INFO   module "zfs" registered zfs.dataset_used
[2015-06-13 20:27:49.642 UTC] INFO   module "zfs" registered zfs.dataset_quota
[2015-06-13 20:27:49.642 UTC] INFO   module "zfs" registered zfs.pool_free
[2015-06-13 20:27:49.642 UTC] INFO   module "zfs" registered zfs.pool_used
[2015-06-13 20:27:49.642 UTC] INFO   module "zfs" registered zfs.pool_total
[2015-06-13 20:27:49.643 UTC] INFO   loaded module "zfs".
[2015-06-13 20:27:49.645 UTC] INFO   module "cainstr" registered ca.instr_ticks
[2015-06-13 20:27:49.646 UTC] INFO   module "cainstr" registered ca.instr_beops
[2015-06-13 20:27:49.646 UTC] INFO   module "cainstr" registered ca.instr_enables
[2015-06-13 20:27:49.646 UTC] INFO   module "cainstr" registered ca.instr_disables
[2015-06-13 20:27:49.646 UTC] INFO   loaded module "cainstr".
[2015-06-13 20:27:50.201 UTC] INFO   module "proc" registered unix.processes
[2015-06-13 20:27:50.201 UTC] INFO   loaded module "proc".
[2015-06-13 20:27:50.201 UTC] INFO   finished loading modules.
[2015-06-13 20:31:01.239 UTC] ERROR  ca-amqp: received connection error: EXCEPTION: Error: Error: connect ETIMEDOUT
    at errnoException (net.js:646:11)
    at Object.afterConnect [as oncomplete] (net.js:637:18)
[2015-06-13 20:31:01.242 UTC] WARN   EXCEPTION: caError: amqp error "ETIMEDOUT": connect ETIMEDOUT
    at capAmqpCap.error (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp-cap.js:390:9)
    at caAmqp.<anonymous> (native)
    at caAmqp.emit (events.js:67:17)
    at caAmqp.connError (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp.js:307:7)
    at Connection.<anonymous> (native)
    at Connection.emit (events.js:67:17)
    at Array.0 (net.js:319:25)
    at EventEmitter._tickCallback (node.js:192:40)
[2015-06-13 20:31:01.242 UTC] DBG    ca-amqp: received close event
[2015-06-13 20:31:01.243 UTC] WARN   ca-amqp: connection closing
[2015-06-13 20:31:01.243 UTC] INFO   ca-amqp: trying to reconnect (attempt 1)
[2015-06-13 20:31:41.218 UTC] ERROR  ca-amqp: received connection error: EXCEPTION: Error: Error: connect ECONNREFUSED
    at errnoException (net.js:646:11)
    at Object.afterConnect [as oncomplete] (net.js:637:18)
[2015-06-13 20:31:41.220 UTC] WARN   EXCEPTION: caError: amqp error "ECONNREFUSED": connect ECONNREFUSED
    at capAmqpCap.error (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp-cap.js:390:9)
    at caAmqp.<anonymous> (native)
    at caAmqp.emit (events.js:67:17)
    at caAmqp.connError (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp.js:307:7)
    at Connection.<anonymous> (native)
    at Connection.emit (events.js:67:17)
    at Array.0 (net.js:319:25)
    at EventEmitter._tickCallback (node.js:192:40)
[2015-06-13 20:31:41.221 UTC] DBG    ca-amqp: received close event
[2015-06-13 20:31:41.221 UTC] WARN   ca-amqp: connection closing
[2015-06-13 20:31:41.221 UTC] INFO   ca-amqp: trying to reconnect (attempt 2)
[2015-06-13 20:31:46.252 UTC] ERROR  ca-amqp: received connection error: EXCEPTION: Error: Error: connect ECONNREFUSED
    at errnoException (net.js:646:11)
    at Object.afterConnect [as oncomplete] (net.js:637:18)
[2015-06-13 20:31:46.254 UTC] WARN   EXCEPTION: caError: amqp error "ECONNREFUSED": connect ECONNREFUSED
    at capAmqpCap.error (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp-cap.js:390:9)
    at caAmqp.<anonymous> (native)
    at caAmqp.emit (events.js:67:17)
    at caAmqp.connError (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp.js:307:7)
    at Connection.<anonymous> (native)
    at Connection.emit (events.js:67:17)
    at Array.0 (net.js:319:25)
    at EventEmitter._tickCallback (node.js:192:40)
[2015-06-13 20:31:46.254 UTC] DBG    ca-amqp: received close event
[2015-06-13 20:31:46.254 UTC] WARN   ca-amqp: connection closing
[2015-06-13 20:31:46.254 UTC] INFO   ca-amqp: trying to reconnect (attempt 3)
[2015-06-13 20:31:51.282 UTC] ERROR  ca-amqp: received connection error: EXCEPTION: Error: Error: connect ECONNREFUSED
    at errnoException (net.js:646:11)
    at Object.afterConnect [as oncomplete] (net.js:637:18)
[2015-06-13 20:31:51.285 UTC] WARN   EXCEPTION: caError: amqp error "ECONNREFUSED": connect ECONNREFUSED
    at capAmqpCap.error (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp-cap.js:390:9)
    at caAmqp.<anonymous> (native)
    at caAmqp.emit (events.js:67:17)
    at caAmqp.connError (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp.js:307:7)
    at Connection.<anonymous> (native)
    at Connection.emit (events.js:67:17)
    at Array.0 (net.js:319:25)
    at EventEmitter._tickCallback (node.js:192:40)
[2015-06-13 20:31:51.286 UTC] DBG    ca-amqp: received close event
[2015-06-13 20:31:51.286 UTC] WARN   ca-amqp: connection closing
[2015-06-13 20:31:51.286 UTC] INFO   ca-amqp: trying to reconnect (attempt 4)
[2015-06-13 20:31:56.311 UTC] ERROR  ca-amqp: received connection error: EXCEPTION: Error: Error: connect ECONNREFUSED
    at errnoException (net.js:646:11)
    at Object.afterConnect [as oncomplete] (net.js:637:18)
[2015-06-13 20:31:56.313 UTC] WARN   EXCEPTION: caError: amqp error "ECONNREFUSED": connect ECONNREFUSED
    at capAmqpCap.error (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp-cap.js:390:9)
    at caAmqp.<anonymous> (native)
    at caAmqp.emit (events.js:67:17)
    at caAmqp.connError (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp.js:307:7)
    at Connection.<anonymous> (native)
    at Connection.emit (events.js:67:17)
    at Array.0 (net.js:319:25)
    at EventEmitter._tickCallback (node.js:192:40)
[2015-06-13 20:31:56.313 UTC] DBG    ca-amqp: received close event
[2015-06-13 20:31:56.314 UTC] WARN   ca-amqp: connection closing
[2015-06-13 20:31:56.314 UTC] INFO   ca-amqp: trying to reconnect (attempt 5)
[2015-06-13 20:32:01.340 UTC] ERROR  ca-amqp: received connection error: EXCEPTION: Error: Error: connect ECONNREFUSED
    at errnoException (net.js:646:11)
    at Object.afterConnect [as oncomplete] (net.js:637:18)
[2015-06-13 20:32:01.342 UTC] WARN   EXCEPTION: caError: amqp error "ECONNREFUSED": connect ECONNREFUSED
    at capAmqpCap.error (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp-cap.js:390:9)
    at caAmqp.<anonymous> (native)
    at caAmqp.emit (events.js:67:17)
    at caAmqp.connError (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp.js:307:7)
    at Connection.<anonymous> (native)
    at Connection.emit (events.js:67:17)
    at Array.0 (net.js:319:25)
    at EventEmitter._tickCallback (node.js:192:40)
[2015-06-13 20:32:01.343 UTC] DBG    ca-amqp: received close event
[2015-06-13 20:32:01.343 UTC] WARN   ca-amqp: connection closing
[2015-06-13 20:32:01.343 UTC] INFO   ca-amqp: trying to reconnect (attempt 6)
[2015-06-13 20:32:06.369 UTC] ERROR  ca-amqp: received connection error: EXCEPTION: Error: Error: connect ECONNREFUSED
    at errnoException (net.js:646:11)
    at Object.afterConnect [as oncomplete] (net.js:637:18)
[2015-06-13 20:32:06.371 UTC] WARN   EXCEPTION: caError: amqp error "ECONNREFUSED": connect ECONNREFUSED
    at capAmqpCap.error (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp-cap.js:390:9)
    at caAmqp.<anonymous> (native)
    at caAmqp.emit (events.js:67:17)
    at caAmqp.connError (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp.js:307:7)
    at Connection.<anonymous> (native)
    at Connection.emit (events.js:67:17)
    at Array.0 (net.js:319:25)
    at EventEmitter._tickCallback (node.js:192:40)
[2015-06-13 20:32:06.371 UTC] DBG    ca-amqp: received close event
[2015-06-13 20:32:06.371 UTC] WARN   ca-amqp: connection closing
[2015-06-13 20:32:06.371 UTC] INFO   ca-amqp: trying to reconnect (attempt 7)
[2015-06-13 20:32:11.398 UTC] ERROR  ca-amqp: received connection error: EXCEPTION: Error: Error: connect ECONNREFUSED
    at errnoException (net.js:646:11)
    at Object.afterConnect [as oncomplete] (net.js:637:18)
[2015-06-13 20:32:11.400 UTC] WARN   EXCEPTION: caError: amqp error "ECONNREFUSED": connect ECONNREFUSED
    at capAmqpCap.error (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp-cap.js:390:9)
    at caAmqp.<anonymous> (native)
    at caAmqp.emit (events.js:67:17)
    at caAmqp.connError (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp.js:307:7)
    at Connection.<anonymous> (native)
    at Connection.emit (events.js:67:17)
    at Array.0 (net.js:319:25)
    at EventEmitter._tickCallback (node.js:192:40)
[2015-06-13 20:32:11.401 UTC] DBG    ca-amqp: received close event
[2015-06-13 20:32:11.401 UTC] WARN   ca-amqp: connection closing
[2015-06-13 20:32:11.401 UTC] INFO   ca-amqp: trying to reconnect (attempt 8)
[2015-06-13 20:32:16.427 UTC] ERROR  ca-amqp: received connection error: EXCEPTION: Error: Error: connect ECONNREFUSED
    at errnoException (net.js:646:11)
    at Object.afterConnect [as oncomplete] (net.js:637:18)
[2015-06-13 20:32:16.428 UTC] WARN   EXCEPTION: caError: amqp error "ECONNREFUSED": connect ECONNREFUSED
    at capAmqpCap.error (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp-cap.js:390:9)
    at caAmqp.<anonymous> (native)
    at caAmqp.emit (events.js:67:17)
    at caAmqp.connError (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp.js:307:7)
    at Connection.<anonymous> (native)
    at Connection.emit (events.js:67:17)
    at Array.0 (net.js:319:25)
    at EventEmitter._tickCallback (node.js:192:40)
[2015-06-13 20:32:16.429 UTC] DBG    ca-amqp: received close event
[2015-06-13 20:32:16.429 UTC] WARN   ca-amqp: connection closing
[2015-06-13 20:32:16.429 UTC] INFO   ca-amqp: trying to reconnect (attempt 9)
[2015-06-13 20:32:21.459 UTC] ERROR  ca-amqp: received connection error: EXCEPTION: Error: Error: connect ECONNREFUSED
    at errnoException (net.js:646:11)
    at Object.afterConnect [as oncomplete] (net.js:637:18)
[2015-06-13 20:32:21.461 UTC] WARN   EXCEPTION: caError: amqp error "ECONNREFUSED": connect ECONNREFUSED
    at capAmqpCap.error (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp-cap.js:390:9)
    at caAmqp.<anonymous> (native)
    at caAmqp.emit (events.js:67:17)
    at caAmqp.connError (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp.js:307:7)
    at Connection.<anonymous> (native)
    at Connection.emit (events.js:67:17)
    at Array.0 (net.js:319:25)
    at EventEmitter._tickCallback (node.js:192:40)
[2015-06-13 20:32:21.461 UTC] DBG    ca-amqp: received close event
[2015-06-13 20:32:21.461 UTC] WARN   ca-amqp: connection closing
[2015-06-13 20:32:21.461 UTC] INFO   ca-amqp: trying to reconnect (attempt 10)
[2015-06-13 20:32:26.490 UTC] ERROR  ca-amqp: received connection error: EXCEPTION: Error: Error: connect ECONNREFUSED
    at errnoException (net.js:646:11)
    at Object.afterConnect [as oncomplete] (net.js:637:18)
[2015-06-13 20:32:26.493 UTC] WARN   EXCEPTION: caError: amqp error "ECONNREFUSED": connect ECONNREFUSED
    at capAmqpCap.error (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp-cap.js:390:9)
    at caAmqp.<anonymous> (native)
    at caAmqp.emit (events.js:67:17)
    at caAmqp.connError (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp.js:307:7)
    at Connection.<anonymous> (native)
    at Connection.emit (events.js:67:17)
    at Array.0 (net.js:319:25)
    at EventEmitter._tickCallback (node.js:192:40)
[2015-06-13 20:32:26.494 UTC] DBG    ca-amqp: received close event
[2015-06-13 20:32:26.494 UTC] WARN   ca-amqp: connection closing
[2015-06-13 20:32:26.494 UTC] INFO   ca-amqp: trying to reconnect (attempt 11)
[2015-06-13 20:32:31.518 UTC] ERROR  ca-amqp: received connection error: EXCEPTION: Error: Error: connect ECONNREFUSED
    at errnoException (net.js:646:11)
    at Object.afterConnect [as oncomplete] (net.js:637:18)
[2015-06-13 20:32:31.520 UTC] WARN   EXCEPTION: caError: amqp error "ECONNREFUSED": connect ECONNREFUSED
    at capAmqpCap.error (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp-cap.js:390:9)
    at caAmqp.<anonymous> (native)
    at caAmqp.emit (events.js:67:17)
    at caAmqp.connError (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp.js:307:7)
    at Connection.<anonymous> (native)
    at Connection.emit (events.js:67:17)
    at Array.0 (net.js:319:25)
    at EventEmitter._tickCallback (node.js:192:40)
[2015-06-13 20:32:31.520 UTC] DBG    ca-amqp: received close event
[2015-06-13 20:32:31.520 UTC] WARN   ca-amqp: connection closing
[2015-06-13 20:32:31.520 UTC] INFO   ca-amqp: trying to reconnect (attempt 12)
[2015-06-13 20:32:36.551 UTC] ERROR  ca-amqp: received connection error: EXCEPTION: Error: Error: connect ECONNREFUSED
    at errnoException (net.js:646:11)
    at Object.afterConnect [as oncomplete] (net.js:637:18)
[2015-06-13 20:32:36.553 UTC] WARN   EXCEPTION: caError: amqp error "ECONNREFUSED": connect ECONNREFUSED
    at capAmqpCap.error (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp-cap.js:390:9)
    at caAmqp.<anonymous> (native)
    at caAmqp.emit (events.js:67:17)
    at caAmqp.connError (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp.js:307:7)
    at Connection.<anonymous> (native)
    at Connection.emit (events.js:67:17)
    at Array.0 (net.js:319:25)
    at EventEmitter._tickCallback (node.js:192:40)
[2015-06-13 20:32:36.556 UTC] DBG    ca-amqp: received close event
[2015-06-13 20:32:36.557 UTC] WARN   ca-amqp: connection closing
[2015-06-13 20:32:36.557 UTC] INFO   ca-amqp: trying to reconnect (attempt 13)
[2015-06-13 20:32:41.583 UTC] ERROR  ca-amqp: received connection error: EXCEPTION: Error: Error: connect ECONNREFUSED
    at errnoException (net.js:646:11)
    at Object.afterConnect [as oncomplete] (net.js:637:18)
[2015-06-13 20:32:41.585 UTC] WARN   EXCEPTION: caError: amqp error "ECONNREFUSED": connect ECONNREFUSED
    at capAmqpCap.error (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp-cap.js:390:9)
    at caAmqp.<anonymous> (native)
    at caAmqp.emit (events.js:67:17)
    at caAmqp.connError (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp.js:307:7)
    at Connection.<anonymous> (native)
    at Connection.emit (events.js:67:17)
    at Array.0 (net.js:319:25)
    at EventEmitter._tickCallback (node.js:192:40)
[2015-06-13 20:32:41.586 UTC] DBG    ca-amqp: received close event
[2015-06-13 20:32:41.586 UTC] WARN   ca-amqp: connection closing
[2015-06-13 20:32:41.586 UTC] INFO   ca-amqp: trying to reconnect (attempt 14)
[2015-06-13 20:32:46.613 UTC] ERROR  ca-amqp: received connection error: EXCEPTION: Error: Error: connect ECONNREFUSED
    at errnoException (net.js:646:11)
    at Object.afterConnect [as oncomplete] (net.js:637:18)
[2015-06-13 20:32:46.615 UTC] WARN   EXCEPTION: caError: amqp error "ECONNREFUSED": connect ECONNREFUSED
    at capAmqpCap.error (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp-cap.js:390:9)
    at caAmqp.<anonymous> (native)
    at caAmqp.emit (events.js:67:17)
    at caAmqp.connError (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp.js:307:7)
    at Connection.<anonymous> (native)
    at Connection.emit (events.js:67:17)
    at Array.0 (net.js:319:25)
    at EventEmitter._tickCallback (node.js:192:40)
[2015-06-13 20:32:46.615 UTC] DBG    ca-amqp: received close event
[2015-06-13 20:32:46.615 UTC] WARN   ca-amqp: connection closing
[2015-06-13 20:32:46.616 UTC] INFO   ca-amqp: trying to reconnect (attempt 15)
[2015-06-13 20:32:51.646 UTC] ERROR  ca-amqp: received connection error: EXCEPTION: Error: Error: connect ECONNREFUSED
    at errnoException (net.js:646:11)
    at Object.afterConnect [as oncomplete] (net.js:637:18)
[2015-06-13 20:32:51.648 UTC] WARN   EXCEPTION: caError: amqp error "ECONNREFUSED": connect ECONNREFUSED
    at capAmqpCap.error (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp-cap.js:390:9)
    at caAmqp.<anonymous> (native)
    at caAmqp.emit (events.js:67:17)
    at caAmqp.connError (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp.js:307:7)
    at Connection.<anonymous> (native)
    at Connection.emit (events.js:67:17)
    at Array.0 (net.js:319:25)
    at EventEmitter._tickCallback (node.js:192:40)
[2015-06-13 20:32:51.649 UTC] DBG    ca-amqp: received close event
[2015-06-13 20:32:51.650 UTC] WARN   ca-amqp: connection closing
[2015-06-13 20:32:51.651 UTC] INFO   ca-amqp: trying to reconnect (attempt 16)
[2015-06-13 20:32:56.687 UTC] ERROR  ca-amqp: received connection error: EXCEPTION: Error: Error: connect ECONNREFUSED
    at errnoException (net.js:646:11)
    at Object.afterConnect [as oncomplete] (net.js:637:18)
[2015-06-13 20:32:56.688 UTC] WARN   EXCEPTION: caError: amqp error "ECONNREFUSED": connect ECONNREFUSED
    at capAmqpCap.error (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp-cap.js:390:9)
    at caAmqp.<anonymous> (native)
    at caAmqp.emit (events.js:67:17)
    at caAmqp.connError (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp.js:307:7)
    at Connection.<anonymous> (native)
    at Connection.emit (events.js:67:17)
    at Array.0 (net.js:319:25)
    at EventEmitter._tickCallback (node.js:192:40)
[2015-06-13 20:32:56.689 UTC] DBG    ca-amqp: received close event
[2015-06-13 20:32:56.689 UTC] WARN   ca-amqp: connection closing
[2015-06-13 20:32:56.689 UTC] INFO   ca-amqp: trying to reconnect (attempt 17)
[2015-06-13 20:33:01.723 UTC] ERROR  ca-amqp: received connection error: EXCEPTION: Error: Error: connect ECONNREFUSED
    at errnoException (net.js:646:11)
    at Object.afterConnect [as oncomplete] (net.js:637:18)
[2015-06-13 20:33:01.725 UTC] WARN   EXCEPTION: caError: amqp error "ECONNREFUSED": connect ECONNREFUSED
    at capAmqpCap.error (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp-cap.js:390:9)
    at caAmqp.<anonymous> (native)
    at caAmqp.emit (events.js:67:17)
    at caAmqp.connError (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp.js:307:7)
    at Connection.<anonymous> (native)
    at Connection.emit (events.js:67:17)
    at Array.0 (net.js:319:25)
    at EventEmitter._tickCallback (node.js:192:40)
[2015-06-13 20:33:01.726 UTC] DBG    ca-amqp: received close event
[2015-06-13 20:33:01.726 UTC] WARN   ca-amqp: connection closing
[2015-06-13 20:33:01.727 UTC] INFO   ca-amqp: trying to reconnect (attempt 18)
[2015-06-13 20:33:06.749 UTC] ERROR  ca-amqp: received connection error: EXCEPTION: Error: Error: connect ECONNREFUSED
    at errnoException (net.js:646:11)
    at Object.afterConnect [as oncomplete] (net.js:637:18)
[2015-06-13 20:33:06.751 UTC] WARN   EXCEPTION: caError: amqp error "ECONNREFUSED": connect ECONNREFUSED
    at capAmqpCap.error (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp-cap.js:390:9)
    at caAmqp.<anonymous> (native)
    at caAmqp.emit (events.js:67:17)
    at caAmqp.connError (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp.js:307:7)
    at Connection.<anonymous> (native)
    at Connection.emit (events.js:67:17)
    at Array.0 (net.js:319:25)
    at EventEmitter._tickCallback (node.js:192:40)
[2015-06-13 20:33:06.751 UTC] DBG    ca-amqp: received close event
[2015-06-13 20:33:06.751 UTC] WARN   ca-amqp: connection closing
[2015-06-13 20:33:06.751 UTC] INFO   ca-amqp: trying to reconnect (attempt 19)
[2015-06-13 20:33:11.793 UTC] ERROR  ca-amqp: received connection error: EXCEPTION: Error: Error: connect ECONNREFUSED
    at errnoException (net.js:646:11)
    at Object.afterConnect [as oncomplete] (net.js:637:18)
[2015-06-13 20:33:11.795 UTC] WARN   EXCEPTION: caError: amqp error "ECONNREFUSED": connect ECONNREFUSED
    at capAmqpCap.error (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp-cap.js:390:9)
    at caAmqp.<anonymous> (native)
    at caAmqp.emit (events.js:67:17)
    at caAmqp.connError (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp.js:307:7)
    at Connection.<anonymous> (native)
    at Connection.emit (events.js:67:17)
    at Array.0 (net.js:319:25)
    at EventEmitter._tickCallback (node.js:192:40)
[2015-06-13 20:33:11.796 UTC] DBG    ca-amqp: received close event
[2015-06-13 20:33:11.796 UTC] WARN   ca-amqp: connection closing
[2015-06-13 20:33:11.796 UTC] INFO   ca-amqp: trying to reconnect (attempt 20)
[2015-06-13 20:33:16.820 UTC] ERROR  ca-amqp: received connection error: EXCEPTION: Error: Error: connect ECONNREFUSED
    at errnoException (net.js:646:11)
    at Object.afterConnect [as oncomplete] (net.js:637:18)
[2015-06-13 20:33:16.821 UTC] WARN   EXCEPTION: caError: amqp error "ECONNREFUSED": connect ECONNREFUSED
    at capAmqpCap.error (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp-cap.js:390:9)
    at caAmqp.<anonymous> (native)
    at caAmqp.emit (events.js:67:17)
    at caAmqp.connError (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp.js:307:7)
    at Connection.<anonymous> (native)
    at Connection.emit (events.js:67:17)
    at Array.0 (net.js:319:25)
    at EventEmitter._tickCallback (node.js:192:40)
[2015-06-13 20:33:16.821 UTC] DBG    ca-amqp: received close event
[2015-06-13 20:33:16.822 UTC] WARN   ca-amqp: connection closing
[2015-06-13 20:33:16.822 UTC] INFO   ca-amqp: trying to reconnect (attempt 21)
[2015-06-13 20:33:21.864 UTC] ERROR  ca-amqp: received connection error: EXCEPTION: Error: Error: connect ECONNREFUSED
    at errnoException (net.js:646:11)
    at Object.afterConnect [as oncomplete] (net.js:637:18)
[2015-06-13 20:33:21.948 UTC] WARN   EXCEPTION: caError: amqp error "ECONNREFUSED": connect ECONNREFUSED
    at capAmqpCap.error (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp-cap.js:390:9)
    at caAmqp.<anonymous> (native)
    at caAmqp.emit (events.js:67:17)
    at caAmqp.connError (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp.js:307:7)
    at Connection.<anonymous> (native)
    at Connection.emit (events.js:67:17)
    at Array.0 (net.js:319:25)
    at EventEmitter._tickCallback (node.js:192:40)
[2015-06-13 20:33:21.950 UTC] DBG    ca-amqp: received close event
[2015-06-13 20:33:21.951 UTC] WARN   ca-amqp: connection closing
[2015-06-13 20:33:21.951 UTC] INFO   ca-amqp: trying to reconnect (attempt 22)
[2015-06-13 20:33:27.147 UTC] ERROR  ca-amqp: received connection error: EXCEPTION: Error: Error: connect ECONNREFUSED
    at errnoException (net.js:646:11)
    at Object.afterConnect [as oncomplete] (net.js:637:18)
[2015-06-13 20:33:27.181 UTC] WARN   EXCEPTION: caError: amqp error "ECONNREFUSED": connect ECONNREFUSED
    at capAmqpCap.error (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp-cap.js:390:9)
    at caAmqp.<anonymous> (native)
    at caAmqp.emit (events.js:67:17)
    at caAmqp.connError (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp.js:307:7)
    at Connection.<anonymous> (native)
    at Connection.emit (events.js:67:17)
    at Array.0 (net.js:319:25)
    at EventEmitter._tickCallback (node.js:192:40)
[2015-06-13 20:33:27.182 UTC] DBG    ca-amqp: received close event
[2015-06-13 20:33:27.182 UTC] WARN   ca-amqp: connection closing
[2015-06-13 20:33:27.184 UTC] INFO   ca-amqp: trying to reconnect (attempt 23)
[2015-06-13 20:33:32.195 UTC] ERROR  ca-amqp: received connection error: EXCEPTION: Error: Error: connect ECONNREFUSED
    at errnoException (net.js:646:11)
    at Object.afterConnect [as oncomplete] (net.js:637:18)
[2015-06-13 20:33:32.197 UTC] WARN   EXCEPTION: caError: amqp error "ECONNREFUSED": connect ECONNREFUSED
    at capAmqpCap.error (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp-cap.js:390:9)
    at caAmqp.<anonymous> (native)
    at caAmqp.emit (events.js:67:17)
    at caAmqp.connError (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp.js:307:7)
    at Connection.<anonymous> (native)
    at Connection.emit (events.js:67:17)
    at Array.0 (net.js:319:25)
    at EventEmitter._tickCallback (node.js:192:40)
[2015-06-13 20:33:32.197 UTC] DBG    ca-amqp: received close event
[2015-06-13 20:33:32.197 UTC] WARN   ca-amqp: connection closing
[2015-06-13 20:33:32.197 UTC] INFO   ca-amqp: trying to reconnect (attempt 24)
[2015-06-13 20:33:37.211 UTC] ERROR  ca-amqp: received connection error: EXCEPTION: Error: Error: connect ECONNREFUSED
    at errnoException (net.js:646:11)
    at Object.afterConnect [as oncomplete] (net.js:637:18)
[2015-06-13 20:33:37.213 UTC] WARN   EXCEPTION: caError: amqp error "ECONNREFUSED": connect ECONNREFUSED
    at capAmqpCap.error (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp-cap.js:390:9)
    at caAmqp.<anonymous> (native)
    at caAmqp.emit (events.js:67:17)
    at caAmqp.connError (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp.js:307:7)
    at Connection.<anonymous> (native)
    at Connection.emit (events.js:67:17)
    at Array.0 (net.js:319:25)
    at EventEmitter._tickCallback (node.js:192:40)
[2015-06-13 20:33:37.213 UTC] DBG    ca-amqp: received close event
[2015-06-13 20:33:37.214 UTC] WARN   ca-amqp: connection closing
[2015-06-13 20:33:37.214 UTC] INFO   ca-amqp: trying to reconnect (attempt 25)
[2015-06-13 20:33:42.218 UTC] ERROR  ca-amqp: received connection error: EXCEPTION: Error: Error: connect ECONNREFUSED
    at errnoException (net.js:646:11)
    at Object.afterConnect [as oncomplete] (net.js:637:18)
[2015-06-13 20:33:42.219 UTC] WARN   EXCEPTION: caError: amqp error "ECONNREFUSED": connect ECONNREFUSED
    at capAmqpCap.error (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp-cap.js:390:9)
    at caAmqp.<anonymous> (native)
    at caAmqp.emit (events.js:67:17)
    at caAmqp.connError (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp.js:307:7)
    at Connection.<anonymous> (native)
    at Connection.emit (events.js:67:17)
    at Array.0 (net.js:319:25)
    at EventEmitter._tickCallback (node.js:192:40)
[2015-06-13 20:33:42.220 UTC] DBG    ca-amqp: received close event
[2015-06-13 20:33:42.220 UTC] WARN   ca-amqp: connection closing
[2015-06-13 20:33:42.220 UTC] INFO   ca-amqp: trying to reconnect (attempt 26)
[2015-06-13 20:33:47.222 UTC] ERROR  ca-amqp: received connection error: EXCEPTION: Error: Error: connect ECONNREFUSED
    at errnoException (net.js:646:11)
    at Object.afterConnect [as oncomplete] (net.js:637:18)
[2015-06-13 20:33:47.224 UTC] WARN   EXCEPTION: caError: amqp error "ECONNREFUSED": connect ECONNREFUSED
    at capAmqpCap.error (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp-cap.js:390:9)
    at caAmqp.<anonymous> (native)
    at caAmqp.emit (events.js:67:17)
    at caAmqp.connError (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp.js:307:7)
    at Connection.<anonymous> (native)
    at Connection.emit (events.js:67:17)
    at Array.0 (net.js:319:25)
    at EventEmitter._tickCallback (node.js:192:40)
[2015-06-13 20:33:47.224 UTC] DBG    ca-amqp: received close event
[2015-06-13 20:33:47.225 UTC] WARN   ca-amqp: connection closing
[2015-06-13 20:33:47.225 UTC] INFO   ca-amqp: trying to reconnect (attempt 27)
[2015-06-13 20:33:52.227 UTC] ERROR  ca-amqp: received connection error: EXCEPTION: Error: Error: connect ECONNREFUSED
    at errnoException (net.js:646:11)
    at Object.afterConnect [as oncomplete] (net.js:637:18)
[2015-06-13 20:33:52.229 UTC] WARN   EXCEPTION: caError: amqp error "ECONNREFUSED": connect ECONNREFUSED
    at capAmqpCap.error (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp-cap.js:390:9)
    at caAmqp.<anonymous> (native)
    at caAmqp.emit (events.js:67:17)
    at caAmqp.connError (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp.js:307:7)
    at Connection.<anonymous> (native)
    at Connection.emit (events.js:67:17)
    at Array.0 (net.js:319:25)
    at EventEmitter._tickCallback (node.js:192:40)
[2015-06-13 20:33:52.229 UTC] DBG    ca-amqp: received close event
[2015-06-13 20:33:52.229 UTC] WARN   ca-amqp: connection closing
[2015-06-13 20:33:52.229 UTC] INFO   ca-amqp: trying to reconnect (attempt 28)
[2015-06-13 20:33:57.229 UTC] ERROR  ca-amqp: received connection error: EXCEPTION: Error: Error: connect ECONNREFUSED
    at errnoException (net.js:646:11)
    at Object.afterConnect [as oncomplete] (net.js:637:18)
[2015-06-13 20:33:57.230 UTC] WARN   EXCEPTION: caError: amqp error "ECONNREFUSED": connect ECONNREFUSED
    at capAmqpCap.error (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp-cap.js:390:9)
    at caAmqp.<anonymous> (native)
    at caAmqp.emit (events.js:67:17)
    at caAmqp.connError (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp.js:307:7)
    at Connection.<anonymous> (native)
    at Connection.emit (events.js:67:17)
    at Array.0 (net.js:319:25)
    at EventEmitter._tickCallback (node.js:192:40)
[2015-06-13 20:33:57.231 UTC] DBG    ca-amqp: received close event
[2015-06-13 20:33:57.231 UTC] WARN   ca-amqp: connection closing
[2015-06-13 20:33:57.231 UTC] INFO   ca-amqp: trying to reconnect (attempt 29)
[2015-06-13 20:34:02.387 UTC] DBG    binding to ca.instrumenter.headnode
[2015-06-13 20:34:02.388 UTC] DBG    binding to ca.broadcast
[2015-06-13 20:34:02.390 UTC] DBG    bind to ca.instrumenter.headnode complete
[2015-06-13 20:34:02.391 UTC] DBG    bind to ca.broadcast complete
[2015-06-13 20:34:02.391 UTC] INFO   AMQP broker connected.
[2015-06-13 20:35:25.525 UTC] INFO   config service restarted
[2015-06-13 20:35:25.801 UTC] CRIT   CA PANIC: panic due to uncaught exception: EXCEPTION: TypeError: TypeError: Object #<Object> has no method 'appendFile'
    at Object.mdGenerateDScript (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-metad.js:859:4)
    at Object.impl (/opt/smartdc/agents/lib/node_modules/cabase/cmd/cainst/modules/dtrace.js:38:28)
    at caInstrService.amqpEnableInstn (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-svc-instr.js:439:22)
    at capAmqpCap.<anonymous> (native)
    at capAmqpCap.emit (events.js:88:20)
    at Object.capDispatch (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp-cap.js:203:14)
    at capAmqpCap.receive (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp-cap.js:502:31)
    at caAmqp.<anonymous> (native)
    at caAmqp.emit (events.js:67:17)
    at caAmqp.receive (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp.js:367:7)
[2015-06-13 20:35:25.801 UTC] CRIT   writing core dump to /opt/smartdc/agents/lib/node_modules/cabase/cacore.3096
[2015-06-13 20:35:25.871 UTC] CRIT   finished writing core dump
[ Jun 13 20:35:25 Stopping because all processes in service exited. ]
[ Jun 13 20:35:25 Executing stop method (:kill). ]
[ Jun 13 20:35:25 Executing start method ("/opt/smartdc/agents/lib/node_modules/cabase/smf/method/canodesvc"). ]
DTRACE_LIBPATH=/opt/smartdc/agents/lib/node_modules/cabase/lib
ignoring amqp-config key amqp_login
ignoring amqp-config key amqp_password
AMQP_HOST=10.99.99.20
AMQP_PORT=5672
NODE_PATH=:/opt/smartdc/agents/lib/node_modules/cabase/node_modules:/opt/smartdc/agents/lib/node_modules/cabase/node_modules/connect/lib:/opt/smartdc/agents/lib/node_modules/cabase/lib/ca:/opt/smartdc/agents/lib/node_modules/cabase/lib/tst
[ Jun 13 20:35:26 Method "start" exited with status 0. ]
The "sys" module is now called "util". It should have a similar interface.
using backends kstat,dtrace,zfs,cainstr,proc
[2015-06-13 20:35:26.615 UTC] INFO   Logging AMQP message to "/opt/smartdc/agents/log/ca/cainstsvc/amqp-2015-06-13.20:35:26.15675"
[2015-06-13 20:35:26.616 UTC] INFO   Instrumenter starting up (instsvc/0.0)
[2015-06-13 20:35:26.617 UTC] INFO   Hostname:    headnode
[2015-06-13 20:35:26.617 UTC] INFO   AMQP broker: {"host":"10.99.99.20","port":"5672"}
[2015-06-13 20:35:26.617 UTC] INFO   Routing key: ca.instrumenter.headnode
[2015-06-13 20:35:26.636 UTC] DBG    loaded metadata file "metadata/profile/operator.json"
[2015-06-13 20:35:26.637 UTC] DBG    loaded metadata file "metadata/profile/customer.json"
[2015-06-13 20:35:26.638 UTC] DBG    loaded metadata file "metadata/metric/metrics.json"
[2015-06-13 20:35:26.654 UTC] INFO   loading modules.
[2015-06-13 20:35:26.694 UTC] INFO   module "kstat" registered cpu.cpus
[2015-06-13 20:35:26.695 UTC] INFO   module "kstat" registered cpu.usage
[2015-06-13 20:35:26.695 UTC] INFO   module "kstat" registered cpu.waittime
[2015-06-13 20:35:26.696 UTC] INFO   module "kstat" registered cpu.loadavg1
[2015-06-13 20:35:26.696 UTC] INFO   module "kstat" registered nic.nics
[2015-06-13 20:35:26.697 UTC] INFO   module "kstat" registered nic.bytes
[2015-06-13 20:35:26.697 UTC] INFO   module "kstat" registered nic.packets
[2015-06-13 20:35:26.697 UTC] INFO   module "kstat" registered nic.vnic_bytes
[2015-06-13 20:35:26.697 UTC] INFO   module "kstat" registered nic.vnic_packets
[2015-06-13 20:35:26.698 UTC] INFO   module "kstat" registered disk.disks
[2015-06-13 20:35:26.698 UTC] INFO   module "kstat" registered disk.physio_ops
[2015-06-13 20:35:26.698 UTC] INFO   module "kstat" registered disk.physio_bytes
[2015-06-13 20:35:26.698 UTC] INFO   module "kstat" registered tcp.segments
[2015-06-13 20:35:26.699 UTC] INFO   module "kstat" registered tcp.errors
[2015-06-13 20:35:26.700 UTC] INFO   module "kstat" registered fs.logical_rwops
[2015-06-13 20:35:26.700 UTC] INFO   module "kstat" registered fs.logical_rwbytes
[2015-06-13 20:35:26.701 UTC] INFO   module "kstat" registered memory.rss
[2015-06-13 20:35:26.701 UTC] INFO   module "kstat" registered memory.rss_limit
[2015-06-13 20:35:26.701 UTC] INFO   module "kstat" registered memory.swap
[2015-06-13 20:35:26.701 UTC] INFO   module "kstat" registered memory.swap_limit
[2015-06-13 20:35:26.702 UTC] INFO   module "kstat" registered memory.reclaimed_bytes
[2015-06-13 20:35:26.702 UTC] INFO   module "kstat" registered memory.pageins
[2015-06-13 20:35:26.702 UTC] INFO   module "kstat" registered vm.exits
[2015-06-13 20:35:26.703 UTC] INFO   module "kstat" registered zfs.arc_ops
[2015-06-13 20:35:26.703 UTC] INFO   loaded module "kstat".
[2015-06-13 20:35:26.786 UTC] INFO   module "dtrace" registered apache.httpd_ops
[2015-06-13 20:35:26.789 UTC] INFO   module "dtrace" registered cpu.thread_executions
[2015-06-13 20:35:26.791 UTC] INFO   module "dtrace" registered cpu.thread_samples
[2015-06-13 20:35:26.793 UTC] INFO   module "dtrace" registered disk.physio_ops
[2015-06-13 20:35:26.798 UTC] INFO   module "dtrace" registered fs.logical_ops
[2015-06-13 20:35:26.801 UTC] INFO   module "dtrace" registered fs.logical_rwops
[2015-06-13 20:35:26.803 UTC] INFO   module "dtrace" registered ldapjs.connections
[2015-06-13 20:35:26.807 UTC] INFO   module "dtrace" registered ldapjs.ops
[2015-06-13 20:35:26.809 UTC] INFO   module "dtrace" registered ldapjs.search_ops
[2015-06-13 20:35:26.811 UTC] INFO   module "dtrace" registered mantaop.jobs_assigned
[2015-06-13 20:35:26.814 UTC] INFO   module "dtrace" registered mantaop.supervisor_auths
[2015-06-13 20:35:26.816 UTC] INFO   module "dtrace" registered mantaop.supervisor_deletes
[2015-06-13 20:35:26.818 UTC] INFO   module "dtrace" registered mantaop.supervisor_errors
[2015-06-13 20:35:26.821 UTC] INFO   module "dtrace" registered mantaop.supervisor_locates
[2015-06-13 20:35:26.822 UTC] INFO   module "dtrace" registered mantaop.tasks_committed
[2015-06-13 20:35:26.825 UTC] INFO   module "dtrace" registered mantaop.tasks_dispatched
[2015-06-13 20:35:26.826 UTC] INFO   module "dtrace" registered mantaop.tasks_executed
[2015-06-13 20:35:26.828 UTC] INFO   module "dtrace" registered mantaop.tasks_killed
[2015-06-13 20:35:26.829 UTC] INFO   module "dtrace" registered mantaop.zone_resets
[2015-06-13 20:35:26.832 UTC] INFO   module "dtrace" registered moray.ops
[2015-06-13 20:35:26.833 UTC] INFO   module "dtrace" registered moray.queries
[2015-06-13 20:35:26.835 UTC] INFO   module "dtrace" registered mysql.commands
[2015-06-13 20:35:26.837 UTC] INFO   module "dtrace" registered mysql.connections
[2015-06-13 20:35:26.839 UTC] INFO   module "dtrace" registered mysql.filesort
[2015-06-13 20:35:26.841 UTC] INFO   module "dtrace" registered mysql.queries
[2015-06-13 20:35:26.844 UTC] INFO   module "dtrace" registered mysql.statements
[2015-06-13 20:35:26.845 UTC] INFO   module "dtrace" registered node.gc_ops
[2015-06-13 20:35:26.847 UTC] INFO   module "dtrace" registered node.httpc_ops
[2015-06-13 20:35:26.851 UTC] INFO   module "dtrace" registered node.httpd_ops
[2015-06-13 20:35:26.854 UTC] INFO   module "dtrace" registered node.socket_ops
[2015-06-13 20:35:26.856 UTC] INFO   module "dtrace" registered postgres.queries
[2015-06-13 20:35:26.857 UTC] INFO   module "dtrace" registered unix.proc_execs
[2015-06-13 20:35:26.860 UTC] INFO   module "dtrace" registered unix.proc_exits
[2015-06-13 20:35:26.862 UTC] INFO   module "dtrace" registered unix.proc_forks
[2015-06-13 20:35:26.864 UTC] INFO   module "dtrace" registered restify.handler_ops
[2015-06-13 20:35:26.867 UTC] INFO   module "dtrace" registered restify.server_ops
[2015-06-13 20:35:26.869 UTC] INFO   module "dtrace" registered syscall.syscalls
[2015-06-13 20:35:26.872 UTC] INFO   module "dtrace" registered tcp.accepts
[2015-06-13 20:35:26.874 UTC] INFO   module "dtrace" registered tcp.connects
[2015-06-13 20:35:26.875 UTC] INFO   module "dtrace" registered unix.thr_creates
[2015-06-13 20:35:26.877 UTC] INFO   module "dtrace" registered vm.irqs
[2015-06-13 20:35:26.878 UTC] INFO   module "dtrace" registered vm.physio_bytes
[2015-06-13 20:35:26.880 UTC] INFO   module "dtrace" registered vm.physio_ops
[2015-06-13 20:35:26.882 UTC] INFO   module "dtrace" registered vm.thread_samples
[2015-06-13 20:35:26.884 UTC] INFO   module "dtrace" registered zfs.arc_ops
[2015-06-13 20:35:26.884 UTC] INFO   loaded module "dtrace".
[2015-06-13 20:35:26.894 UTC] INFO   module "zfs" registered zfs.dataset_unused_quota
[2015-06-13 20:35:26.894 UTC] INFO   module "zfs" registered zfs.dataset_used
[2015-06-13 20:35:26.894 UTC] INFO   module "zfs" registered zfs.dataset_quota
[2015-06-13 20:35:26.895 UTC] INFO   module "zfs" registered zfs.pool_free
[2015-06-13 20:35:26.895 UTC] INFO   module "zfs" registered zfs.pool_used
[2015-06-13 20:35:26.895 UTC] INFO   module "zfs" registered zfs.pool_total
[2015-06-13 20:35:26.895 UTC] INFO   loaded module "zfs".
[2015-06-13 20:35:26.898 UTC] INFO   module "cainstr" registered ca.instr_ticks
[2015-06-13 20:35:26.898 UTC] INFO   module "cainstr" registered ca.instr_beops
[2015-06-13 20:35:26.898 UTC] INFO   module "cainstr" registered ca.instr_enables
[2015-06-13 20:35:26.898 UTC] INFO   module "cainstr" registered ca.instr_disables
[2015-06-13 20:35:26.898 UTC] INFO   loaded module "cainstr".
[2015-06-13 20:35:27.002 UTC] INFO   module "proc" registered unix.processes
[2015-06-13 20:35:27.002 UTC] INFO   loaded module "proc".
[2015-06-13 20:35:27.003 UTC] INFO   finished loading modules.
[2015-06-13 20:35:27.131 UTC] DBG    binding to ca.instrumenter.headnode
[2015-06-13 20:35:27.132 UTC] DBG    binding to ca.broadcast
[2015-06-13 20:35:27.133 UTC] DBG    bind to ca.instrumenter.headnode complete
[2015-06-13 20:35:27.134 UTC] DBG    bind to ca.broadcast complete
[2015-06-13 20:35:27.134 UTC] INFO   AMQP broker connected.
[2015-06-13 20:35:36.369 UTC] CRIT   CA PANIC: panic due to uncaught exception: EXCEPTION: TypeError: TypeError: Object #<Object> has no method 'appendFileSync'
    at Object.mdGenerateDScript (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-metad.js:859:8)
    at Object.impl (/opt/smartdc/agents/lib/node_modules/cabase/cmd/cainst/modules/dtrace.js:38:28)
    at caInstrService.amqpEnableInstn (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-svc-instr.js:439:22)
    at capAmqpCap.<anonymous> (native)
    at capAmqpCap.emit (events.js:88:20)
    at Object.capDispatch (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp-cap.js:203:14)
    at capAmqpCap.receive (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp-cap.js:502:31)
    at caAmqp.<anonymous> (native)
    at caAmqp.emit (events.js:67:17)
    at caAmqp.receive (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp.js:367:7)
[2015-06-13 20:35:36.370 UTC] CRIT   writing core dump to /opt/smartdc/agents/lib/node_modules/cabase/cacore.15704
[2015-06-13 20:35:36.485 UTC] CRIT   finished writing core dump
[ Jun 13 20:35:36 Stopping because all processes in service exited. ]
[ Jun 13 20:35:36 Executing stop method (:kill). ]
[ Jun 13 20:35:36 Executing start method ("/opt/smartdc/agents/lib/node_modules/cabase/smf/method/canodesvc"). ]
DTRACE_LIBPATH=/opt/smartdc/agents/lib/node_modules/cabase/lib
ignoring amqp-config key amqp_login
ignoring amqp-config key amqp_password
AMQP_HOST=10.99.99.20
AMQP_PORT=5672
NODE_PATH=:/opt/smartdc/agents/lib/node_modules/cabase/node_modules:/opt/smartdc/agents/lib/node_modules/cabase/node_modules/connect/lib:/opt/smartdc/agents/lib/node_modules/cabase/lib/ca:/opt/smartdc/agents/lib/node_modules/cabase/lib/tst
[ Jun 13 20:35:38 Method "start" exited with status 0. ]
The "sys" module is now called "util". It should have a similar interface.
using backends kstat,dtrace,zfs,cainstr,proc
[2015-06-13 20:35:39.506 UTC] INFO   Logging AMQP message to "/opt/smartdc/agents/log/ca/cainstsvc/amqp-2015-06-13.20:35:37.15773"
[2015-06-13 20:35:39.508 UTC] INFO   Instrumenter starting up (instsvc/0.0)
[2015-06-13 20:35:39.508 UTC] INFO   Hostname:    headnode
[2015-06-13 20:35:39.508 UTC] INFO   AMQP broker: {"host":"10.99.99.20","port":"5672"}
[2015-06-13 20:35:39.509 UTC] INFO   Routing key: ca.instrumenter.headnode
[2015-06-13 20:35:39.515 UTC] DBG    loaded metadata file "metadata/profile/customer.json"
[2015-06-13 20:35:39.517 UTC] DBG    loaded metadata file "metadata/metric/metrics.json"
[2015-06-13 20:35:39.521 UTC] DBG    loaded metadata file "metadata/profile/operator.json"
[2015-06-13 20:35:39.543 UTC] INFO   loading modules.
[2015-06-13 20:35:39.562 UTC] INFO   module "kstat" registered cpu.cpus
[2015-06-13 20:35:39.563 UTC] INFO   module "kstat" registered cpu.usage
[2015-06-13 20:35:39.563 UTC] INFO   module "kstat" registered cpu.waittime
[2015-06-13 20:35:39.564 UTC] INFO   module "kstat" registered cpu.loadavg1
[2015-06-13 20:35:39.564 UTC] INFO   module "kstat" registered nic.nics
[2015-06-13 20:35:39.564 UTC] INFO   module "kstat" registered nic.bytes
[2015-06-13 20:35:39.564 UTC] INFO   module "kstat" registered nic.packets
[2015-06-13 20:35:39.565 UTC] INFO   module "kstat" registered nic.vnic_bytes
[2015-06-13 20:35:39.565 UTC] INFO   module "kstat" registered nic.vnic_packets
[2015-06-13 20:35:39.565 UTC] INFO   module "kstat" registered disk.disks
[2015-06-13 20:35:39.566 UTC] INFO   module "kstat" registered disk.physio_ops
[2015-06-13 20:35:39.566 UTC] INFO   module "kstat" registered disk.physio_bytes
[2015-06-13 20:35:39.566 UTC] INFO   module "kstat" registered tcp.segments
[2015-06-13 20:35:39.566 UTC] INFO   module "kstat" registered tcp.errors
[2015-06-13 20:35:39.567 UTC] INFO   module "kstat" registered fs.logical_rwops
[2015-06-13 20:35:39.567 UTC] INFO   module "kstat" registered fs.logical_rwbytes
[2015-06-13 20:35:39.567 UTC] INFO   module "kstat" registered memory.rss
[2015-06-13 20:35:39.568 UTC] INFO   module "kstat" registered memory.rss_limit
[2015-06-13 20:35:39.568 UTC] INFO   module "kstat" registered memory.swap
[2015-06-13 20:35:39.568 UTC] INFO   module "kstat" registered memory.swap_limit
[2015-06-13 20:35:39.568 UTC] INFO   module "kstat" registered memory.reclaimed_bytes
[2015-06-13 20:35:39.569 UTC] INFO   module "kstat" registered memory.pageins
[2015-06-13 20:35:39.569 UTC] INFO   module "kstat" registered vm.exits
[2015-06-13 20:35:39.570 UTC] INFO   module "kstat" registered zfs.arc_ops
[2015-06-13 20:35:39.570 UTC] INFO   loaded module "kstat".
[2015-06-13 20:35:39.728 UTC] INFO   module "dtrace" registered apache.httpd_ops
[2015-06-13 20:35:39.730 UTC] INFO   module "dtrace" registered cpu.thread_executions
[2015-06-13 20:35:39.732 UTC] INFO   module "dtrace" registered cpu.thread_samples
[2015-06-13 20:35:39.734 UTC] INFO   module "dtrace" registered disk.physio_ops
[2015-06-13 20:35:39.738 UTC] INFO   module "dtrace" registered fs.logical_ops
[2015-06-13 20:35:39.748 UTC] INFO   module "dtrace" registered fs.logical_rwops
[2015-06-13 20:35:39.750 UTC] INFO   module "dtrace" registered ldapjs.connections
[2015-06-13 20:35:39.756 UTC] INFO   module "dtrace" registered ldapjs.ops
[2015-06-13 20:35:39.758 UTC] INFO   module "dtrace" registered ldapjs.search_ops
[2015-06-13 20:35:39.760 UTC] INFO   module "dtrace" registered mantaop.jobs_assigned
[2015-06-13 20:35:39.766 UTC] INFO   module "dtrace" registered mantaop.supervisor_auths
[2015-06-13 20:35:39.769 UTC] INFO   module "dtrace" registered mantaop.supervisor_deletes
[2015-06-13 20:35:39.789 UTC] INFO   module "dtrace" registered mantaop.supervisor_errors
[2015-06-13 20:35:39.791 UTC] INFO   module "dtrace" registered mantaop.supervisor_locates
[2015-06-13 20:35:39.793 UTC] INFO   module "dtrace" registered mantaop.tasks_committed
[2015-06-13 20:35:39.795 UTC] INFO   module "dtrace" registered mantaop.tasks_dispatched
[2015-06-13 20:35:39.797 UTC] INFO   module "dtrace" registered mantaop.tasks_executed
[2015-06-13 20:35:39.798 UTC] INFO   module "dtrace" registered mantaop.tasks_killed
[2015-06-13 20:35:39.800 UTC] INFO   module "dtrace" registered mantaop.zone_resets
[2015-06-13 20:35:39.803 UTC] INFO   module "dtrace" registered moray.ops
[2015-06-13 20:35:39.805 UTC] INFO   module "dtrace" registered moray.queries
[2015-06-13 20:35:39.807 UTC] INFO   module "dtrace" registered mysql.commands
[2015-06-13 20:35:39.809 UTC] INFO   module "dtrace" registered mysql.connections
[2015-06-13 20:35:39.830 UTC] INFO   module "dtrace" registered mysql.filesort
[2015-06-13 20:35:39.833 UTC] INFO   module "dtrace" registered mysql.queries
[2015-06-13 20:35:39.836 UTC] INFO   module "dtrace" registered mysql.statements
[2015-06-13 20:35:39.838 UTC] INFO   module "dtrace" registered node.gc_ops
[2015-06-13 20:35:39.841 UTC] INFO   module "dtrace" registered node.httpc_ops
[2015-06-13 20:35:39.845 UTC] INFO   module "dtrace" registered node.httpd_ops
[2015-06-13 20:35:39.847 UTC] INFO   module "dtrace" registered node.socket_ops
[2015-06-13 20:35:39.850 UTC] INFO   module "dtrace" registered postgres.queries
[2015-06-13 20:35:39.852 UTC] INFO   module "dtrace" registered unix.proc_execs
[2015-06-13 20:35:39.854 UTC] INFO   module "dtrace" registered unix.proc_exits
[2015-06-13 20:35:39.856 UTC] INFO   module "dtrace" registered unix.proc_forks
[2015-06-13 20:35:39.861 UTC] INFO   module "dtrace" registered restify.handler_ops
[2015-06-13 20:35:39.864 UTC] INFO   module "dtrace" registered restify.server_ops
[2015-06-13 20:35:39.867 UTC] INFO   module "dtrace" registered syscall.syscalls
[2015-06-13 20:35:39.890 UTC] INFO   module "dtrace" registered tcp.accepts
[2015-06-13 20:35:39.893 UTC] INFO   module "dtrace" registered tcp.connects
[2015-06-13 20:35:39.895 UTC] INFO   module "dtrace" registered unix.thr_creates
[2015-06-13 20:35:39.897 UTC] INFO   module "dtrace" registered vm.irqs
[2015-06-13 20:35:39.900 UTC] INFO   module "dtrace" registered vm.physio_bytes
[2015-06-13 20:35:39.902 UTC] INFO   module "dtrace" registered vm.physio_ops
[2015-06-13 20:35:39.905 UTC] INFO   module "dtrace" registered vm.thread_samples
[2015-06-13 20:35:39.907 UTC] INFO   module "dtrace" registered zfs.arc_ops
[2015-06-13 20:35:39.907 UTC] INFO   loaded module "dtrace".
[2015-06-13 20:35:39.919 UTC] INFO   module "zfs" registered zfs.dataset_unused_quota
[2015-06-13 20:35:39.920 UTC] INFO   module "zfs" registered zfs.dataset_used
[2015-06-13 20:35:39.920 UTC] INFO   module "zfs" registered zfs.dataset_quota
[2015-06-13 20:35:39.920 UTC] INFO   module "zfs" registered zfs.pool_free
[2015-06-13 20:35:39.920 UTC] INFO   module "zfs" registered zfs.pool_used
[2015-06-13 20:35:39.920 UTC] INFO   module "zfs" registered zfs.pool_total
[2015-06-13 20:35:39.921 UTC] INFO   loaded module "zfs".
[2015-06-13 20:35:39.930 UTC] INFO   module "cainstr" registered ca.instr_ticks
[2015-06-13 20:35:39.931 UTC] INFO   module "cainstr" registered ca.instr_beops
[2015-06-13 20:35:39.931 UTC] INFO   module "cainstr" registered ca.instr_enables
[2015-06-13 20:35:39.931 UTC] INFO   module "cainstr" registered ca.instr_disables
[2015-06-13 20:35:39.931 UTC] INFO   loaded module "cainstr".
[2015-06-13 20:35:40.030 UTC] INFO   module "proc" registered unix.processes
[2015-06-13 20:35:40.030 UTC] INFO   loaded module "proc".
[2015-06-13 20:35:40.031 UTC] INFO   finished loading modules.
[2015-06-13 20:35:40.195 UTC] DBG    binding to ca.instrumenter.headnode
[2015-06-13 20:35:40.196 UTC] DBG    binding to ca.broadcast
[2015-06-13 20:35:40.201 UTC] DBG    bind to ca.instrumenter.headnode complete
[2015-06-13 20:35:40.202 UTC] DBG    bind to ca.broadcast complete
[2015-06-13 20:35:40.202 UTC] INFO   AMQP broker connected.
[2015-06-13 20:35:46.502 UTC] CRIT   CA PANIC: panic due to uncaught exception: EXCEPTION: TypeError: TypeError: Object #<Object> has no method 'appendFileSync'
    at Object.mdGenerateDScript (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-metad.js:859:8)
    at Object.impl (/opt/smartdc/agents/lib/node_modules/cabase/cmd/cainst/modules/dtrace.js:38:28)
    at caInstrService.amqpEnableInstn (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-svc-instr.js:439:22)
    at capAmqpCap.<anonymous> (native)
    at capAmqpCap.emit (events.js:88:20)
    at Object.capDispatch (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp-cap.js:203:14)
    at capAmqpCap.receive (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp-cap.js:502:31)
    at caAmqp.<anonymous> (native)
    at caAmqp.emit (events.js:67:17)
    at caAmqp.receive (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp.js:367:7)
[2015-06-13 20:35:46.502 UTC] CRIT   writing core dump to /opt/smartdc/agents/lib/node_modules/cabase/cacore.15842
[2015-06-13 20:35:46.616 UTC] CRIT   finished writing core dump
[ Jun 13 20:35:46 Stopping because all processes in service exited. ]
[ Jun 13 20:35:46 Executing stop method (:kill). ]
[ Jun 13 20:35:47 Executing start method ("/opt/smartdc/agents/lib/node_modules/cabase/smf/method/canodesvc"). ]
DTRACE_LIBPATH=/opt/smartdc/agents/lib/node_modules/cabase/lib
ignoring amqp-config key amqp_login
ignoring amqp-config key amqp_password
AMQP_HOST=10.99.99.20
AMQP_PORT=5672
NODE_PATH=:/opt/smartdc/agents/lib/node_modules/cabase/node_modules:/opt/smartdc/agents/lib/node_modules/cabase/node_modules/connect/lib:/opt/smartdc/agents/lib/node_modules/cabase/lib/ca:/opt/smartdc/agents/lib/node_modules/cabase/lib/tst
[ Jun 13 20:35:49 Method "start" exited with status 0. ]
The "sys" module is now called "util". It should have a similar interface.
using backends kstat,dtrace,zfs,cainstr,proc
[2015-06-13 20:35:49.242 UTC] INFO   Logging AMQP message to "/opt/smartdc/agents/log/ca/cainstsvc/amqp-2015-06-13.20:35:47.15930"
[2015-06-13 20:35:49.244 UTC] INFO   Instrumenter starting up (instsvc/0.0)
[2015-06-13 20:35:49.244 UTC] INFO   Hostname:    headnode
[2015-06-13 20:35:49.244 UTC] INFO   AMQP broker: {"host":"10.99.99.20","port":"5672"}
[2015-06-13 20:35:49.245 UTC] INFO   Routing key: ca.instrumenter.headnode
[2015-06-13 20:35:49.248 UTC] DBG    loaded metadata file "metadata/profile/operator.json"
[2015-06-13 20:35:49.249 UTC] DBG    loaded metadata file "metadata/profile/customer.json"
[2015-06-13 20:35:49.250 UTC] DBG    loaded metadata file "metadata/metric/metrics.json"
[2015-06-13 20:35:49.271 UTC] INFO   loading modules.
[2015-06-13 20:35:49.289 UTC] INFO   module "kstat" registered cpu.cpus
[2015-06-13 20:35:49.290 UTC] INFO   module "kstat" registered cpu.usage
[2015-06-13 20:35:49.290 UTC] INFO   module "kstat" registered cpu.waittime
[2015-06-13 20:35:49.290 UTC] INFO   module "kstat" registered cpu.loadavg1
[2015-06-13 20:35:49.290 UTC] INFO   module "kstat" registered nic.nics
[2015-06-13 20:35:49.291 UTC] INFO   module "kstat" registered nic.bytes
[2015-06-13 20:35:49.291 UTC] INFO   module "kstat" registered nic.packets
[2015-06-13 20:35:49.291 UTC] INFO   module "kstat" registered nic.vnic_bytes
[2015-06-13 20:35:49.291 UTC] INFO   module "kstat" registered nic.vnic_packets
[2015-06-13 20:35:49.292 UTC] INFO   module "kstat" registered disk.disks
[2015-06-13 20:35:49.292 UTC] INFO   module "kstat" registered disk.physio_ops
[2015-06-13 20:35:49.293 UTC] INFO   module "kstat" registered disk.physio_bytes
[2015-06-13 20:35:49.293 UTC] INFO   module "kstat" registered tcp.segments
[2015-06-13 20:35:49.293 UTC] INFO   module "kstat" registered tcp.errors
[2015-06-13 20:35:49.293 UTC] INFO   module "kstat" registered fs.logical_rwops
[2015-06-13 20:35:49.294 UTC] INFO   module "kstat" registered fs.logical_rwbytes
[2015-06-13 20:35:49.294 UTC] INFO   module "kstat" registered memory.rss
[2015-06-13 20:35:49.294 UTC] INFO   module "kstat" registered memory.rss_limit
[2015-06-13 20:35:49.294 UTC] INFO   module "kstat" registered memory.swap
[2015-06-13 20:35:49.295 UTC] INFO   module "kstat" registered memory.swap_limit
[2015-06-13 20:35:49.295 UTC] INFO   module "kstat" registered memory.reclaimed_bytes
[2015-06-13 20:35:49.296 UTC] INFO   module "kstat" registered memory.pageins
[2015-06-13 20:35:49.296 UTC] INFO   module "kstat" registered vm.exits
[2015-06-13 20:35:49.297 UTC] INFO   module "kstat" registered zfs.arc_ops
[2015-06-13 20:35:49.297 UTC] INFO   loaded module "kstat".
[2015-06-13 20:35:49.388 UTC] INFO   module "dtrace" registered apache.httpd_ops
[2015-06-13 20:35:49.390 UTC] INFO   module "dtrace" registered cpu.thread_executions
[2015-06-13 20:35:49.392 UTC] INFO   module "dtrace" registered cpu.thread_samples
[2015-06-13 20:35:49.394 UTC] INFO   module "dtrace" registered disk.physio_ops
[2015-06-13 20:35:49.399 UTC] INFO   module "dtrace" registered fs.logical_ops
[2015-06-13 20:35:49.403 UTC] INFO   module "dtrace" registered fs.logical_rwops
[2015-06-13 20:35:49.405 UTC] INFO   module "dtrace" registered ldapjs.connections
[2015-06-13 20:35:49.409 UTC] INFO   module "dtrace" registered ldapjs.ops
[2015-06-13 20:35:49.411 UTC] INFO   module "dtrace" registered ldapjs.search_ops
[2015-06-13 20:35:49.413 UTC] INFO   module "dtrace" registered mantaop.jobs_assigned
[2015-06-13 20:35:49.414 UTC] INFO   module "dtrace" registered mantaop.supervisor_auths
[2015-06-13 20:35:49.416 UTC] INFO   module "dtrace" registered mantaop.supervisor_deletes
[2015-06-13 20:35:49.417 UTC] INFO   module "dtrace" registered mantaop.supervisor_errors
[2015-06-13 20:35:49.420 UTC] INFO   module "dtrace" registered mantaop.supervisor_locates
[2015-06-13 20:35:49.422 UTC] INFO   module "dtrace" registered mantaop.tasks_committed
[2015-06-13 20:35:49.423 UTC] INFO   module "dtrace" registered mantaop.tasks_dispatched
[2015-06-13 20:35:49.425 UTC] INFO   module "dtrace" registered mantaop.tasks_executed
[2015-06-13 20:35:49.426 UTC] INFO   module "dtrace" registered mantaop.tasks_killed
[2015-06-13 20:35:49.428 UTC] INFO   module "dtrace" registered mantaop.zone_resets
[2015-06-13 20:35:49.431 UTC] INFO   module "dtrace" registered moray.ops
[2015-06-13 20:35:49.433 UTC] INFO   module "dtrace" registered moray.queries
[2015-06-13 20:35:49.435 UTC] INFO   module "dtrace" registered mysql.commands
[2015-06-13 20:35:49.437 UTC] INFO   module "dtrace" registered mysql.connections
[2015-06-13 20:35:49.439 UTC] INFO   module "dtrace" registered mysql.filesort
[2015-06-13 20:35:49.442 UTC] INFO   module "dtrace" registered mysql.queries
[2015-06-13 20:35:49.446 UTC] INFO   module "dtrace" registered mysql.statements
[2015-06-13 20:35:49.448 UTC] INFO   module "dtrace" registered node.gc_ops
[2015-06-13 20:35:49.452 UTC] INFO   module "dtrace" registered node.httpc_ops
[2015-06-13 20:35:49.457 UTC] INFO   module "dtrace" registered node.httpd_ops
[2015-06-13 20:35:49.460 UTC] INFO   module "dtrace" registered node.socket_ops
[2015-06-13 20:35:49.462 UTC] INFO   module "dtrace" registered postgres.queries
[2015-06-13 20:35:49.464 UTC] INFO   module "dtrace" registered unix.proc_execs
[2015-06-13 20:35:49.466 UTC] INFO   module "dtrace" registered unix.proc_exits
[2015-06-13 20:35:49.468 UTC] INFO   module "dtrace" registered unix.proc_forks
[2015-06-13 20:35:49.470 UTC] INFO   module "dtrace" registered restify.handler_ops
[2015-06-13 20:35:49.475 UTC] INFO   module "dtrace" registered restify.server_ops
[2015-06-13 20:35:49.477 UTC] INFO   module "dtrace" registered syscall.syscalls
[2015-06-13 20:35:49.479 UTC] INFO   module "dtrace" registered tcp.accepts
[2015-06-13 20:35:49.481 UTC] INFO   module "dtrace" registered tcp.connects
[2015-06-13 20:35:49.483 UTC] INFO   module "dtrace" registered unix.thr_creates
[2015-06-13 20:35:49.486 UTC] INFO   module "dtrace" registered vm.irqs
[2015-06-13 20:35:49.488 UTC] INFO   module "dtrace" registered vm.physio_bytes
[2015-06-13 20:35:49.490 UTC] INFO   module "dtrace" registered vm.physio_ops
[2015-06-13 20:35:49.491 UTC] INFO   module "dtrace" registered vm.thread_samples
[2015-06-13 20:35:49.493 UTC] INFO   module "dtrace" registered zfs.arc_ops
[2015-06-13 20:35:49.493 UTC] INFO   loaded module "dtrace".
[2015-06-13 20:35:49.506 UTC] INFO   module "zfs" registered zfs.dataset_unused_quota
[2015-06-13 20:35:49.506 UTC] INFO   module "zfs" registered zfs.dataset_used
[2015-06-13 20:35:49.507 UTC] INFO   module "zfs" registered zfs.dataset_quota
[2015-06-13 20:35:49.507 UTC] INFO   module "zfs" registered zfs.pool_free
[2015-06-13 20:35:49.507 UTC] INFO   module "zfs" registered zfs.pool_used
[2015-06-13 20:35:49.507 UTC] INFO   module "zfs" registered zfs.pool_total
[2015-06-13 20:35:49.507 UTC] INFO   loaded module "zfs".
[2015-06-13 20:35:49.510 UTC] INFO   module "cainstr" registered ca.instr_ticks
[2015-06-13 20:35:49.510 UTC] INFO   module "cainstr" registered ca.instr_beops
[2015-06-13 20:35:49.510 UTC] INFO   module "cainstr" registered ca.instr_enables
[2015-06-13 20:35:49.511 UTC] INFO   module "cainstr" registered ca.instr_disables
[2015-06-13 20:35:49.511 UTC] INFO   loaded module "cainstr".
[2015-06-13 20:35:49.613 UTC] INFO   module "proc" registered unix.processes
[2015-06-13 20:35:49.614 UTC] INFO   loaded module "proc".
[2015-06-13 20:35:49.614 UTC] INFO   finished loading modules.
[2015-06-13 20:35:49.789 UTC] DBG    binding to ca.instrumenter.headnode
[2015-06-13 20:35:49.791 UTC] DBG    binding to ca.broadcast
[2015-06-13 20:35:49.801 UTC] DBG    bind to ca.instrumenter.headnode complete
[2015-06-13 20:35:49.801 UTC] DBG    bind to ca.broadcast complete
[2015-06-13 20:35:49.802 UTC] INFO   AMQP broker connected.
[2015-06-13 20:35:56.470 UTC] CRIT   CA PANIC: panic due to uncaught exception: EXCEPTION: TypeError: TypeError: Object #<Object> has no method 'appendFileSync'
    at Object.mdGenerateDScript (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-metad.js:859:8)
    at Object.impl (/opt/smartdc/agents/lib/node_modules/cabase/cmd/cainst/modules/dtrace.js:38:28)
    at caInstrService.amqpEnableInstn (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-svc-instr.js:439:22)
    at capAmqpCap.<anonymous> (native)
    at capAmqpCap.emit (events.js:88:20)
    at Object.capDispatch (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp-cap.js:203:14)
    at capAmqpCap.receive (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp-cap.js:502:31)
    at caAmqp.<anonymous> (native)
    at caAmqp.emit (events.js:67:17)
    at caAmqp.receive (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp.js:367:7)
[2015-06-13 20:35:56.470 UTC] CRIT   writing core dump to /opt/smartdc/agents/lib/node_modules/cabase/cacore.15978
[2015-06-13 20:35:56.580 UTC] CRIT   finished writing core dump
[ Jun 13 20:35:56 Stopping because all processes in service exited. ]
[ Jun 13 20:35:56 Executing stop method (:kill). ]
[ Jun 13 20:35:56 Executing start method ("/opt/smartdc/agents/lib/node_modules/cabase/smf/method/canodesvc"). ]
DTRACE_LIBPATH=/opt/smartdc/agents/lib/node_modules/cabase/lib
ignoring amqp-config key amqp_login
ignoring amqp-config key amqp_password
AMQP_HOST=10.99.99.20
AMQP_PORT=5672
NODE_PATH=:/opt/smartdc/agents/lib/node_modules/cabase/node_modules:/opt/smartdc/agents/lib/node_modules/cabase/node_modules/connect/lib:/opt/smartdc/agents/lib/node_modules/cabase/lib/ca:/opt/smartdc/agents/lib/node_modules/cabase/lib/tst
[ Jun 13 20:35:58 Method "start" exited with status 0. ]
The "sys" module is now called "util". It should have a similar interface.
using backends kstat,dtrace,zfs,cainstr,proc
[2015-06-13 20:35:59.172 UTC] INFO   Logging AMQP message to "/opt/smartdc/agents/log/ca/cainstsvc/amqp-2015-06-13.20:35:57.16108"
[2015-06-13 20:35:59.174 UTC] INFO   Instrumenter starting up (instsvc/0.0)
[2015-06-13 20:35:59.174 UTC] INFO   Hostname:    headnode
[2015-06-13 20:35:59.174 UTC] INFO   AMQP broker: {"host":"10.99.99.20","port":"5672"}
[2015-06-13 20:35:59.175 UTC] INFO   Routing key: ca.instrumenter.headnode
[2015-06-13 20:35:59.178 UTC] DBG    loaded metadata file "metadata/profile/operator.json"
[2015-06-13 20:35:59.179 UTC] DBG    loaded metadata file "metadata/profile/customer.json"
[2015-06-13 20:35:59.181 UTC] DBG    loaded metadata file "metadata/metric/metrics.json"
[2015-06-13 20:35:59.204 UTC] INFO   loading modules.
[2015-06-13 20:35:59.224 UTC] INFO   module "kstat" registered cpu.cpus
[2015-06-13 20:35:59.225 UTC] INFO   module "kstat" registered cpu.usage
[2015-06-13 20:35:59.226 UTC] INFO   module "kstat" registered cpu.waittime
[2015-06-13 20:35:59.226 UTC] INFO   module "kstat" registered cpu.loadavg1
[2015-06-13 20:35:59.226 UTC] INFO   module "kstat" registered nic.nics
[2015-06-13 20:35:59.227 UTC] INFO   module "kstat" registered nic.bytes
[2015-06-13 20:35:59.227 UTC] INFO   module "kstat" registered nic.packets
[2015-06-13 20:35:59.227 UTC] INFO   module "kstat" registered nic.vnic_bytes
[2015-06-13 20:35:59.227 UTC] INFO   module "kstat" registered nic.vnic_packets
[2015-06-13 20:35:59.228 UTC] INFO   module "kstat" registered disk.disks
[2015-06-13 20:35:59.229 UTC] INFO   module "kstat" registered disk.physio_ops
[2015-06-13 20:35:59.229 UTC] INFO   module "kstat" registered disk.physio_bytes
[2015-06-13 20:35:59.230 UTC] INFO   module "kstat" registered tcp.segments
[2015-06-13 20:35:59.230 UTC] INFO   module "kstat" registered tcp.errors
[2015-06-13 20:35:59.230 UTC] INFO   module "kstat" registered fs.logical_rwops
[2015-06-13 20:35:59.230 UTC] INFO   module "kstat" registered fs.logical_rwbytes
[2015-06-13 20:35:59.231 UTC] INFO   module "kstat" registered memory.rss
[2015-06-13 20:35:59.231 UTC] INFO   module "kstat" registered memory.rss_limit
[2015-06-13 20:35:59.231 UTC] INFO   module "kstat" registered memory.swap
[2015-06-13 20:35:59.231 UTC] INFO   module "kstat" registered memory.swap_limit
[2015-06-13 20:35:59.232 UTC] INFO   module "kstat" registered memory.reclaimed_bytes
[2015-06-13 20:35:59.232 UTC] INFO   module "kstat" registered memory.pageins
[2015-06-13 20:35:59.232 UTC] INFO   module "kstat" registered vm.exits
[2015-06-13 20:35:59.232 UTC] INFO   module "kstat" registered zfs.arc_ops
[2015-06-13 20:35:59.233 UTC] INFO   loaded module "kstat".
[2015-06-13 20:35:59.314 UTC] INFO   module "dtrace" registered apache.httpd_ops
[2015-06-13 20:35:59.316 UTC] INFO   module "dtrace" registered cpu.thread_executions
[2015-06-13 20:35:59.320 UTC] INFO   module "dtrace" registered cpu.thread_samples
[2015-06-13 20:35:59.322 UTC] INFO   module "dtrace" registered disk.physio_ops
[2015-06-13 20:35:59.326 UTC] INFO   module "dtrace" registered fs.logical_ops
[2015-06-13 20:35:59.329 UTC] INFO   module "dtrace" registered fs.logical_rwops
[2015-06-13 20:35:59.331 UTC] INFO   module "dtrace" registered ldapjs.connections
[2015-06-13 20:35:59.337 UTC] INFO   module "dtrace" registered ldapjs.ops
[2015-06-13 20:35:59.339 UTC] INFO   module "dtrace" registered ldapjs.search_ops
[2015-06-13 20:35:59.341 UTC] INFO   module "dtrace" registered mantaop.jobs_assigned
[2015-06-13 20:35:59.343 UTC] INFO   module "dtrace" registered mantaop.supervisor_auths
[2015-06-13 20:35:59.345 UTC] INFO   module "dtrace" registered mantaop.supervisor_deletes
[2015-06-13 20:35:59.346 UTC] INFO   module "dtrace" registered mantaop.supervisor_errors
[2015-06-13 20:35:59.347 UTC] INFO   module "dtrace" registered mantaop.supervisor_locates
[2015-06-13 20:35:59.349 UTC] INFO   module "dtrace" registered mantaop.tasks_committed
[2015-06-13 20:35:59.350 UTC] INFO   module "dtrace" registered mantaop.tasks_dispatched
[2015-06-13 20:35:59.352 UTC] INFO   module "dtrace" registered mantaop.tasks_executed
[2015-06-13 20:35:59.353 UTC] INFO   module "dtrace" registered mantaop.tasks_killed
[2015-06-13 20:35:59.355 UTC] INFO   module "dtrace" registered mantaop.zone_resets
[2015-06-13 20:35:59.357 UTC] INFO   module "dtrace" registered moray.ops
[2015-06-13 20:35:59.359 UTC] INFO   module "dtrace" registered moray.queries
[2015-06-13 20:35:59.361 UTC] INFO   module "dtrace" registered mysql.commands
[2015-06-13 20:35:59.363 UTC] INFO   module "dtrace" registered mysql.connections
[2015-06-13 20:35:59.365 UTC] INFO   module "dtrace" registered mysql.filesort
[2015-06-13 20:35:59.368 UTC] INFO   module "dtrace" registered mysql.queries
[2015-06-13 20:35:59.371 UTC] INFO   module "dtrace" registered mysql.statements
[2015-06-13 20:35:59.373 UTC] INFO   module "dtrace" registered node.gc_ops
[2015-06-13 20:35:59.376 UTC] INFO   module "dtrace" registered node.httpc_ops
[2015-06-13 20:35:59.380 UTC] INFO   module "dtrace" registered node.httpd_ops
[2015-06-13 20:35:59.382 UTC] INFO   module "dtrace" registered node.socket_ops
[2015-06-13 20:35:59.384 UTC] INFO   module "dtrace" registered postgres.queries
[2015-06-13 20:35:59.387 UTC] INFO   module "dtrace" registered unix.proc_execs
[2015-06-13 20:35:59.391 UTC] INFO   module "dtrace" registered unix.proc_exits
[2015-06-13 20:35:59.392 UTC] INFO   module "dtrace" registered unix.proc_forks
[2015-06-13 20:35:59.394 UTC] INFO   module "dtrace" registered restify.handler_ops
[2015-06-13 20:35:59.396 UTC] INFO   module "dtrace" registered restify.server_ops
[2015-06-13 20:35:59.399 UTC] INFO   module "dtrace" registered syscall.syscalls
[2015-06-13 20:35:59.402 UTC] INFO   module "dtrace" registered tcp.accepts
[2015-06-13 20:35:59.404 UTC] INFO   module "dtrace" registered tcp.connects
[2015-06-13 20:35:59.410 UTC] INFO   module "dtrace" registered unix.thr_creates
[2015-06-13 20:35:59.412 UTC] INFO   module "dtrace" registered vm.irqs
[2015-06-13 20:35:59.414 UTC] INFO   module "dtrace" registered vm.physio_bytes
[2015-06-13 20:35:59.416 UTC] INFO   module "dtrace" registered vm.physio_ops
[2015-06-13 20:35:59.418 UTC] INFO   module "dtrace" registered vm.thread_samples
[2015-06-13 20:35:59.422 UTC] INFO   module "dtrace" registered zfs.arc_ops
[2015-06-13 20:35:59.422 UTC] INFO   loaded module "dtrace".
[2015-06-13 20:35:59.436 UTC] INFO   module "zfs" registered zfs.dataset_unused_quota
[2015-06-13 20:35:59.437 UTC] INFO   module "zfs" registered zfs.dataset_used
[2015-06-13 20:35:59.437 UTC] INFO   module "zfs" registered zfs.dataset_quota
[2015-06-13 20:35:59.437 UTC] INFO   module "zfs" registered zfs.pool_free
[2015-06-13 20:35:59.438 UTC] INFO   module "zfs" registered zfs.pool_used
[2015-06-13 20:35:59.438 UTC] INFO   module "zfs" registered zfs.pool_total
[2015-06-13 20:35:59.438 UTC] INFO   loaded module "zfs".
[2015-06-13 20:35:59.441 UTC] INFO   module "cainstr" registered ca.instr_ticks
[2015-06-13 20:35:59.441 UTC] INFO   module "cainstr" registered ca.instr_beops
[2015-06-13 20:35:59.441 UTC] INFO   module "cainstr" registered ca.instr_enables
[2015-06-13 20:35:59.441 UTC] INFO   module "cainstr" registered ca.instr_disables
[2015-06-13 20:35:59.441 UTC] INFO   loaded module "cainstr".
[2015-06-13 20:35:59.518 UTC] INFO   module "proc" registered unix.processes
[2015-06-13 20:35:59.518 UTC] INFO   loaded module "proc".
[2015-06-13 20:35:59.518 UTC] INFO   finished loading modules.
[2015-06-13 20:35:59.683 UTC] DBG    binding to ca.instrumenter.headnode
[2015-06-13 20:35:59.687 UTC] DBG    binding to ca.broadcast
[2015-06-13 20:35:59.690 UTC] DBG    bind to ca.instrumenter.headnode complete
[2015-06-13 20:35:59.693 UTC] DBG    bind to ca.broadcast complete
[2015-06-13 20:35:59.694 UTC] INFO   AMQP broker connected.
[2015-06-13 20:36:06.470 UTC] CRIT   CA PANIC: panic due to uncaught exception: EXCEPTION: TypeError: TypeError: Object #<Object> has no method 'appendFileSync'
    at Object.mdGenerateDScript (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-metad.js:859:8)
    at Object.impl (/opt/smartdc/agents/lib/node_modules/cabase/cmd/cainst/modules/dtrace.js:38:28)
    at caInstrService.amqpEnableInstn (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-svc-instr.js:439:22)
    at capAmqpCap.<anonymous> (native)
    at capAmqpCap.emit (events.js:88:20)
    at Object.capDispatch (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp-cap.js:203:14)
    at capAmqpCap.receive (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp-cap.js:502:31)
    at caAmqp.<anonymous> (native)
    at caAmqp.emit (events.js:67:17)
    at caAmqp.receive (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp.js:367:7)
[2015-06-13 20:36:06.470 UTC] CRIT   writing core dump to /opt/smartdc/agents/lib/node_modules/cabase/cacore.16153
[2015-06-13 20:36:06.579 UTC] CRIT   finished writing core dump
[ Jun 13 20:36:06 Stopping because all processes in service exited. ]
[ Jun 13 20:36:06 Executing stop method (:kill). ]
[ Jun 13 20:36:06 Executing start method ("/opt/smartdc/agents/lib/node_modules/cabase/smf/method/canodesvc"). ]
DTRACE_LIBPATH=/opt/smartdc/agents/lib/node_modules/cabase/lib
ignoring amqp-config key amqp_login
ignoring amqp-config key amqp_password
AMQP_HOST=10.99.99.20
AMQP_PORT=5672
NODE_PATH=:/opt/smartdc/agents/lib/node_modules/cabase/node_modules:/opt/smartdc/agents/lib/node_modules/cabase/node_modules/connect/lib:/opt/smartdc/agents/lib/node_modules/cabase/lib/ca:/opt/smartdc/agents/lib/node_modules/cabase/lib/tst
[ Jun 13 20:36:08 Method "start" exited with status 0. ]
The "sys" module is now called "util". It should have a similar interface.
using backends kstat,dtrace,zfs,cainstr,proc
[2015-06-13 20:36:08.266 UTC] INFO   Logging AMQP message to "/opt/smartdc/agents/log/ca/cainstsvc/amqp-2015-06-13.20:36:07.16266"
[2015-06-13 20:36:08.267 UTC] INFO   Instrumenter starting up (instsvc/0.0)
[2015-06-13 20:36:08.268 UTC] INFO   Hostname:    headnode
[2015-06-13 20:36:08.268 UTC] INFO   AMQP broker: {"host":"10.99.99.20","port":"5672"}
[2015-06-13 20:36:08.268 UTC] INFO   Routing key: ca.instrumenter.headnode
[2015-06-13 20:36:08.272 UTC] DBG    loaded metadata file "metadata/profile/operator.json"
[2015-06-13 20:36:08.274 UTC] DBG    loaded metadata file "metadata/profile/customer.json"
[2015-06-13 20:36:08.275 UTC] DBG    loaded metadata file "metadata/metric/metrics.json"
[2015-06-13 20:36:08.296 UTC] INFO   loading modules.
[2015-06-13 20:36:08.313 UTC] INFO   module "kstat" registered cpu.cpus
[2015-06-13 20:36:08.313 UTC] INFO   module "kstat" registered cpu.usage
[2015-06-13 20:36:08.314 UTC] INFO   module "kstat" registered cpu.waittime
[2015-06-13 20:36:08.314 UTC] INFO   module "kstat" registered cpu.loadavg1
[2015-06-13 20:36:08.314 UTC] INFO   module "kstat" registered nic.nics
[2015-06-13 20:36:08.315 UTC] INFO   module "kstat" registered nic.bytes
[2015-06-13 20:36:08.315 UTC] INFO   module "kstat" registered nic.packets
[2015-06-13 20:36:08.315 UTC] INFO   module "kstat" registered nic.vnic_bytes
[2015-06-13 20:36:08.315 UTC] INFO   module "kstat" registered nic.vnic_packets
[2015-06-13 20:36:08.316 UTC] INFO   module "kstat" registered disk.disks
[2015-06-13 20:36:08.316 UTC] INFO   module "kstat" registered disk.physio_ops
[2015-06-13 20:36:08.317 UTC] INFO   module "kstat" registered disk.physio_bytes
[2015-06-13 20:36:08.317 UTC] INFO   module "kstat" registered tcp.segments
[2015-06-13 20:36:08.318 UTC] INFO   module "kstat" registered tcp.errors
[2015-06-13 20:36:08.318 UTC] INFO   module "kstat" registered fs.logical_rwops
[2015-06-13 20:36:08.318 UTC] INFO   module "kstat" registered fs.logical_rwbytes
[2015-06-13 20:36:08.318 UTC] INFO   module "kstat" registered memory.rss
[2015-06-13 20:36:08.318 UTC] INFO   module "kstat" registered memory.rss_limit
[2015-06-13 20:36:08.319 UTC] INFO   module "kstat" registered memory.swap
[2015-06-13 20:36:08.319 UTC] INFO   module "kstat" registered memory.swap_limit
[2015-06-13 20:36:08.319 UTC] INFO   module "kstat" registered memory.reclaimed_bytes
[2015-06-13 20:36:08.319 UTC] INFO   module "kstat" registered memory.pageins
[2015-06-13 20:36:08.319 UTC] INFO   module "kstat" registered vm.exits
[2015-06-13 20:36:08.320 UTC] INFO   module "kstat" registered zfs.arc_ops
[2015-06-13 20:36:08.320 UTC] INFO   loaded module "kstat".
[2015-06-13 20:36:08.366 UTC] INFO   module "dtrace" registered apache.httpd_ops
[2015-06-13 20:36:08.367 UTC] INFO   module "dtrace" registered cpu.thread_executions
[2015-06-13 20:36:08.368 UTC] INFO   module "dtrace" registered cpu.thread_samples
[2015-06-13 20:36:08.369 UTC] INFO   module "dtrace" registered disk.physio_ops
[2015-06-13 20:36:08.373 UTC] INFO   module "dtrace" registered fs.logical_ops
[2015-06-13 20:36:08.375 UTC] INFO   module "dtrace" registered fs.logical_rwops
[2015-06-13 20:36:08.376 UTC] INFO   module "dtrace" registered ldapjs.connections
[2015-06-13 20:36:08.380 UTC] INFO   module "dtrace" registered ldapjs.ops
[2015-06-13 20:36:08.382 UTC] INFO   module "dtrace" registered ldapjs.search_ops
[2015-06-13 20:36:08.383 UTC] INFO   module "dtrace" registered mantaop.jobs_assigned
[2015-06-13 20:36:08.384 UTC] INFO   module "dtrace" registered mantaop.supervisor_auths
[2015-06-13 20:36:08.386 UTC] INFO   module "dtrace" registered mantaop.supervisor_deletes
[2015-06-13 20:36:08.387 UTC] INFO   module "dtrace" registered mantaop.supervisor_errors
[2015-06-13 20:36:08.388 UTC] INFO   module "dtrace" registered mantaop.supervisor_locates
[2015-06-13 20:36:08.389 UTC] INFO   module "dtrace" registered mantaop.tasks_committed
[2015-06-13 20:36:08.390 UTC] INFO   module "dtrace" registered mantaop.tasks_dispatched
[2015-06-13 20:36:08.391 UTC] INFO   module "dtrace" registered mantaop.tasks_executed
[2015-06-13 20:36:08.392 UTC] INFO   module "dtrace" registered mantaop.tasks_killed
[2015-06-13 20:36:08.393 UTC] INFO   module "dtrace" registered mantaop.zone_resets
[2015-06-13 20:36:08.395 UTC] INFO   module "dtrace" registered moray.ops
[2015-06-13 20:36:08.397 UTC] INFO   module "dtrace" registered moray.queries
[2015-06-13 20:36:08.398 UTC] INFO   module "dtrace" registered mysql.commands
[2015-06-13 20:36:08.399 UTC] INFO   module "dtrace" registered mysql.connections
[2015-06-13 20:36:08.401 UTC] INFO   module "dtrace" registered mysql.filesort
[2015-06-13 20:36:08.403 UTC] INFO   module "dtrace" registered mysql.queries
[2015-06-13 20:36:08.405 UTC] INFO   module "dtrace" registered mysql.statements
[2015-06-13 20:36:08.406 UTC] INFO   module "dtrace" registered node.gc_ops
[2015-06-13 20:36:08.408 UTC] INFO   module "dtrace" registered node.httpc_ops
[2015-06-13 20:36:08.410 UTC] INFO   module "dtrace" registered node.httpd_ops
[2015-06-13 20:36:08.412 UTC] INFO   module "dtrace" registered node.socket_ops
[2015-06-13 20:36:08.413 UTC] INFO   module "dtrace" registered postgres.queries
[2015-06-13 20:36:08.415 UTC] INFO   module "dtrace" registered unix.proc_execs
[2015-06-13 20:36:08.416 UTC] INFO   module "dtrace" registered unix.proc_exits
[2015-06-13 20:36:08.418 UTC] INFO   module "dtrace" registered unix.proc_forks
[2015-06-13 20:36:08.422 UTC] INFO   module "dtrace" registered restify.handler_ops
[2015-06-13 20:36:08.425 UTC] INFO   module "dtrace" registered restify.server_ops
[2015-06-13 20:36:08.428 UTC] INFO   module "dtrace" registered syscall.syscalls
[2015-06-13 20:36:08.430 UTC] INFO   module "dtrace" registered tcp.accepts
[2015-06-13 20:36:08.432 UTC] INFO   module "dtrace" registered tcp.connects
[2015-06-13 20:36:08.434 UTC] INFO   module "dtrace" registered unix.thr_creates
[2015-06-13 20:36:08.435 UTC] INFO   module "dtrace" registered vm.irqs
[2015-06-13 20:36:08.437 UTC] INFO   module "dtrace" registered vm.physio_bytes
[2015-06-13 20:36:08.438 UTC] INFO   module "dtrace" registered vm.physio_ops
[2015-06-13 20:36:08.440 UTC] INFO   module "dtrace" registered vm.thread_samples
[2015-06-13 20:36:08.441 UTC] INFO   module "dtrace" registered zfs.arc_ops
[2015-06-13 20:36:08.441 UTC] INFO   loaded module "dtrace".
[2015-06-13 20:36:08.453 UTC] INFO   module "zfs" registered zfs.dataset_unused_quota
[2015-06-13 20:36:08.453 UTC] INFO   module "zfs" registered zfs.dataset_used
[2015-06-13 20:36:08.454 UTC] INFO   module "zfs" registered zfs.dataset_quota
[2015-06-13 20:36:08.454 UTC] INFO   module "zfs" registered zfs.pool_free
[2015-06-13 20:36:08.454 UTC] INFO   module "zfs" registered zfs.pool_used
[2015-06-13 20:36:08.454 UTC] INFO   module "zfs" registered zfs.pool_total
[2015-06-13 20:36:08.454 UTC] INFO   loaded module "zfs".
[2015-06-13 20:36:08.457 UTC] INFO   module "cainstr" registered ca.instr_ticks
[2015-06-13 20:36:08.457 UTC] INFO   module "cainstr" registered ca.instr_beops
[2015-06-13 20:36:08.457 UTC] INFO   module "cainstr" registered ca.instr_enables
[2015-06-13 20:36:08.457 UTC] INFO   module "cainstr" registered ca.instr_disables
[2015-06-13 20:36:08.457 UTC] INFO   loaded module "cainstr".
[2015-06-13 20:36:08.523 UTC] INFO   module "proc" registered unix.processes
[2015-06-13 20:36:08.523 UTC] INFO   loaded module "proc".
[2015-06-13 20:36:08.523 UTC] INFO   finished loading modules.
[2015-06-13 20:36:08.668 UTC] DBG    binding to ca.instrumenter.headnode
[2015-06-13 20:36:08.670 UTC] DBG    binding to ca.broadcast
[2015-06-13 20:36:08.672 UTC] DBG    bind to ca.instrumenter.headnode complete
[2015-06-13 20:36:08.673 UTC] DBG    bind to ca.broadcast complete
[2015-06-13 20:36:08.673 UTC] INFO   AMQP broker connected.
[2015-06-13 20:36:16.472 UTC] CRIT   CA PANIC: panic due to uncaught exception: EXCEPTION: TypeError: TypeError: Object #<Object> has no method 'appendFileSync'
    at Object.mdGenerateDScript (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-metad.js:859:8)
    at Object.impl (/opt/smartdc/agents/lib/node_modules/cabase/cmd/cainst/modules/dtrace.js:38:28)
    at caInstrService.amqpEnableInstn (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-svc-instr.js:439:22)
    at capAmqpCap.<anonymous> (native)
    at capAmqpCap.emit (events.js:88:20)
    at Object.capDispatch (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp-cap.js:203:14)
    at capAmqpCap.receive (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp-cap.js:502:31)
    at caAmqp.<anonymous> (native)
    at caAmqp.emit (events.js:67:17)
    at caAmqp.receive (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp.js:367:7)
[2015-06-13 20:36:16.473 UTC] CRIT   writing core dump to /opt/smartdc/agents/lib/node_modules/cabase/cacore.16315
[2015-06-13 20:36:16.587 UTC] CRIT   finished writing core dump
[ Jun 13 20:36:16 Stopping because all processes in service exited. ]
[ Jun 13 20:36:16 Executing stop method (:kill). ]
[ Jun 13 20:36:16 Executing start method ("/opt/smartdc/agents/lib/node_modules/cabase/smf/method/canodesvc"). ]
DTRACE_LIBPATH=/opt/smartdc/agents/lib/node_modules/cabase/lib
ignoring amqp-config key amqp_login
ignoring amqp-config key amqp_password
AMQP_HOST=10.99.99.20
AMQP_PORT=5672
NODE_PATH=:/opt/smartdc/agents/lib/node_modules/cabase/node_modules:/opt/smartdc/agents/lib/node_modules/cabase/node_modules/connect/lib:/opt/smartdc/agents/lib/node_modules/cabase/lib/ca:/opt/smartdc/agents/lib/node_modules/cabase/lib/tst
[ Jun 13 20:36:18 Method "start" exited with status 0. ]
The "sys" module is now called "util". It should have a similar interface.
using backends kstat,dtrace,zfs,cainstr,proc
[2015-06-13 20:36:18.591 UTC] INFO   Logging AMQP message to "/opt/smartdc/agents/log/ca/cainstsvc/amqp-2015-06-13.20:36:17.16380"
[2015-06-13 20:36:18.593 UTC] INFO   Instrumenter starting up (instsvc/0.0)
[2015-06-13 20:36:18.594 UTC] INFO   Hostname:    headnode
[2015-06-13 20:36:18.594 UTC] INFO   AMQP broker: {"host":"10.99.99.20","port":"5672"}
[2015-06-13 20:36:18.594 UTC] INFO   Routing key: ca.instrumenter.headnode
[2015-06-13 20:36:18.598 UTC] DBG    loaded metadata file "metadata/profile/operator.json"
[2015-06-13 20:36:18.598 UTC] DBG    loaded metadata file "metadata/profile/customer.json"
[2015-06-13 20:36:18.599 UTC] DBG    loaded metadata file "metadata/metric/metrics.json"
[2015-06-13 20:36:18.623 UTC] INFO   loading modules.
[2015-06-13 20:36:18.641 UTC] INFO   module "kstat" registered cpu.cpus
[2015-06-13 20:36:18.642 UTC] INFO   module "kstat" registered cpu.usage
[2015-06-13 20:36:18.642 UTC] INFO   module "kstat" registered cpu.waittime
[2015-06-13 20:36:18.642 UTC] INFO   module "kstat" registered cpu.loadavg1
[2015-06-13 20:36:18.643 UTC] INFO   module "kstat" registered nic.nics
[2015-06-13 20:36:18.643 UTC] INFO   module "kstat" registered nic.bytes
[2015-06-13 20:36:18.644 UTC] INFO   module "kstat" registered nic.packets
[2015-06-13 20:36:18.644 UTC] INFO   module "kstat" registered nic.vnic_bytes
[2015-06-13 20:36:18.645 UTC] INFO   module "kstat" registered nic.vnic_packets
[2015-06-13 20:36:18.645 UTC] INFO   module "kstat" registered disk.disks
[2015-06-13 20:36:18.645 UTC] INFO   module "kstat" registered disk.physio_ops
[2015-06-13 20:36:18.645 UTC] INFO   module "kstat" registered disk.physio_bytes
[2015-06-13 20:36:18.646 UTC] INFO   module "kstat" registered tcp.segments
[2015-06-13 20:36:18.646 UTC] INFO   module "kstat" registered tcp.errors
[2015-06-13 20:36:18.647 UTC] INFO   module "kstat" registered fs.logical_rwops
[2015-06-13 20:36:18.647 UTC] INFO   module "kstat" registered fs.logical_rwbytes
[2015-06-13 20:36:18.647 UTC] INFO   module "kstat" registered memory.rss
[2015-06-13 20:36:18.647 UTC] INFO   module "kstat" registered memory.rss_limit
[2015-06-13 20:36:18.648 UTC] INFO   module "kstat" registered memory.swap
[2015-06-13 20:36:18.648 UTC] INFO   module "kstat" registered memory.swap_limit
[2015-06-13 20:36:18.648 UTC] INFO   module "kstat" registered memory.reclaimed_bytes
[2015-06-13 20:36:18.648 UTC] INFO   module "kstat" registered memory.pageins
[2015-06-13 20:36:18.649 UTC] INFO   module "kstat" registered vm.exits
[2015-06-13 20:36:18.649 UTC] INFO   module "kstat" registered zfs.arc_ops
[2015-06-13 20:36:18.649 UTC] INFO   loaded module "kstat".
[2015-06-13 20:36:18.696 UTC] INFO   module "dtrace" registered apache.httpd_ops
[2015-06-13 20:36:18.698 UTC] INFO   module "dtrace" registered cpu.thread_executions
[2015-06-13 20:36:18.702 UTC] INFO   module "dtrace" registered cpu.thread_samples
[2015-06-13 20:36:18.704 UTC] INFO   module "dtrace" registered disk.physio_ops
[2015-06-13 20:36:18.709 UTC] INFO   module "dtrace" registered fs.logical_ops
[2015-06-13 20:36:18.712 UTC] INFO   module "dtrace" registered fs.logical_rwops
[2015-06-13 20:36:18.715 UTC] INFO   module "dtrace" registered ldapjs.connections
[2015-06-13 20:36:18.719 UTC] INFO   module "dtrace" registered ldapjs.ops
[2015-06-13 20:36:18.721 UTC] INFO   module "dtrace" registered ldapjs.search_ops
[2015-06-13 20:36:18.723 UTC] INFO   module "dtrace" registered mantaop.jobs_assigned
[2015-06-13 20:36:18.724 UTC] INFO   module "dtrace" registered mantaop.supervisor_auths
[2015-06-13 20:36:18.726 UTC] INFO   module "dtrace" registered mantaop.supervisor_deletes
[2015-06-13 20:36:18.727 UTC] INFO   module "dtrace" registered mantaop.supervisor_errors
[2015-06-13 20:36:18.729 UTC] INFO   module "dtrace" registered mantaop.supervisor_locates
[2015-06-13 20:36:18.730 UTC] INFO   module "dtrace" registered mantaop.tasks_committed
[2015-06-13 20:36:18.731 UTC] INFO   module "dtrace" registered mantaop.tasks_dispatched
[2015-06-13 20:36:18.732 UTC] INFO   module "dtrace" registered mantaop.tasks_executed
[2015-06-13 20:36:18.735 UTC] INFO   module "dtrace" registered mantaop.tasks_killed
[2015-06-13 20:36:18.737 UTC] INFO   module "dtrace" registered mantaop.zone_resets
[2015-06-13 20:36:18.741 UTC] INFO   module "dtrace" registered moray.ops
[2015-06-13 20:36:18.743 UTC] INFO   module "dtrace" registered moray.queries
[2015-06-13 20:36:18.745 UTC] INFO   module "dtrace" registered mysql.commands
[2015-06-13 20:36:18.747 UTC] INFO   module "dtrace" registered mysql.connections
[2015-06-13 20:36:18.748 UTC] INFO   module "dtrace" registered mysql.filesort
[2015-06-13 20:36:18.751 UTC] INFO   module "dtrace" registered mysql.queries
[2015-06-13 20:36:18.753 UTC] INFO   module "dtrace" registered mysql.statements
[2015-06-13 20:36:18.756 UTC] INFO   module "dtrace" registered node.gc_ops
[2015-06-13 20:36:18.758 UTC] INFO   module "dtrace" registered node.httpc_ops
[2015-06-13 20:36:18.761 UTC] INFO   module "dtrace" registered node.httpd_ops
[2015-06-13 20:36:18.763 UTC] INFO   module "dtrace" registered node.socket_ops
[2015-06-13 20:36:18.765 UTC] INFO   module "dtrace" registered postgres.queries
[2015-06-13 20:36:18.767 UTC] INFO   module "dtrace" registered unix.proc_execs
[2015-06-13 20:36:18.769 UTC] INFO   module "dtrace" registered unix.proc_exits
[2015-06-13 20:36:18.770 UTC] INFO   module "dtrace" registered unix.proc_forks
[2015-06-13 20:36:18.772 UTC] INFO   module "dtrace" registered restify.handler_ops
[2015-06-13 20:36:18.776 UTC] INFO   module "dtrace" registered restify.server_ops
[2015-06-13 20:36:18.778 UTC] INFO   module "dtrace" registered syscall.syscalls
[2015-06-13 20:36:18.782 UTC] INFO   module "dtrace" registered tcp.accepts
[2015-06-13 20:36:18.784 UTC] INFO   module "dtrace" registered tcp.connects
[2015-06-13 20:36:18.786 UTC] INFO   module "dtrace" registered unix.thr_creates
[2015-06-13 20:36:18.788 UTC] INFO   module "dtrace" registered vm.irqs
[2015-06-13 20:36:18.789 UTC] INFO   module "dtrace" registered vm.physio_bytes
[2015-06-13 20:36:18.791 UTC] INFO   module "dtrace" registered vm.physio_ops
[2015-06-13 20:36:18.792 UTC] INFO   module "dtrace" registered vm.thread_samples
[2015-06-13 20:36:18.794 UTC] INFO   module "dtrace" registered zfs.arc_ops
[2015-06-13 20:36:18.794 UTC] INFO   loaded module "dtrace".
[2015-06-13 20:36:18.806 UTC] INFO   module "zfs" registered zfs.dataset_unused_quota
[2015-06-13 20:36:18.806 UTC] INFO   module "zfs" registered zfs.dataset_used
[2015-06-13 20:36:18.806 UTC] INFO   module "zfs" registered zfs.dataset_quota
[2015-06-13 20:36:18.806 UTC] INFO   module "zfs" registered zfs.pool_free
[2015-06-13 20:36:18.807 UTC] INFO   module "zfs" registered zfs.pool_used
[2015-06-13 20:36:18.807 UTC] INFO   module "zfs" registered zfs.pool_total
[2015-06-13 20:36:18.807 UTC] INFO   loaded module "zfs".
[2015-06-13 20:36:18.810 UTC] INFO   module "cainstr" registered ca.instr_ticks
[2015-06-13 20:36:18.810 UTC] INFO   module "cainstr" registered ca.instr_beops
[2015-06-13 20:36:18.810 UTC] INFO   module "cainstr" registered ca.instr_enables
[2015-06-13 20:36:18.810 UTC] INFO   module "cainstr" registered ca.instr_disables
[2015-06-13 20:36:18.811 UTC] INFO   loaded module "cainstr".
[2015-06-13 20:36:18.864 UTC] INFO   module "proc" registered unix.processes
[2015-06-13 20:36:18.865 UTC] INFO   loaded module "proc".
[2015-06-13 20:36:18.865 UTC] INFO   finished loading modules.
[2015-06-13 20:36:19.043 UTC] DBG    binding to ca.instrumenter.headnode
[2015-06-13 20:36:19.044 UTC] DBG    binding to ca.broadcast
[2015-06-13 20:36:19.048 UTC] DBG    bind to ca.instrumenter.headnode complete
[2015-06-13 20:36:19.049 UTC] DBG    bind to ca.broadcast complete
[2015-06-13 20:36:19.049 UTC] INFO   AMQP broker connected.
[2015-06-13 20:36:26.459 UTC] CRIT   CA PANIC: panic due to uncaught exception: EXCEPTION: TypeError: TypeError: Object #<Object> has no method 'appendFileSync'
    at Object.mdGenerateDScript (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-metad.js:859:8)
    at Object.impl (/opt/smartdc/agents/lib/node_modules/cabase/cmd/cainst/modules/dtrace.js:38:28)
    at caInstrService.amqpEnableInstn (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-svc-instr.js:439:22)
    at capAmqpCap.<anonymous> (native)
    at capAmqpCap.emit (events.js:88:20)
    at Object.capDispatch (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp-cap.js:203:14)
    at capAmqpCap.receive (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp-cap.js:502:31)
    at caAmqp.<anonymous> (native)
    at caAmqp.emit (events.js:67:17)
    at caAmqp.receive (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp.js:367:7)
[2015-06-13 20:36:26.460 UTC] CRIT   writing core dump to /opt/smartdc/agents/lib/node_modules/cabase/cacore.16441
[2015-06-13 20:36:26.565 UTC] CRIT   finished writing core dump
[ Jun 13 20:36:26 Stopping because all processes in service exited. ]
[ Jun 13 20:36:26 Executing stop method (:kill). ]
[ Jun 13 20:36:26 Executing start method ("/opt/smartdc/agents/lib/node_modules/cabase/smf/method/canodesvc"). ]
DTRACE_LIBPATH=/opt/smartdc/agents/lib/node_modules/cabase/lib
ignoring amqp-config key amqp_login
ignoring amqp-config key amqp_password
AMQP_HOST=10.99.99.20
AMQP_PORT=5672
NODE_PATH=:/opt/smartdc/agents/lib/node_modules/cabase/node_modules:/opt/smartdc/agents/lib/node_modules/cabase/node_modules/connect/lib:/opt/smartdc/agents/lib/node_modules/cabase/lib/ca:/opt/smartdc/agents/lib/node_modules/cabase/lib/tst
[ Jun 13 20:36:27 Method "start" exited with status 0. ]
The "sys" module is now called "util". It should have a similar interface.
using backends kstat,dtrace,zfs,cainstr,proc
[2015-06-13 20:36:27.279 UTC] INFO   Logging AMQP message to "/opt/smartdc/agents/log/ca/cainstsvc/amqp-2015-06-13.20:36:26.16491"
[2015-06-13 20:36:27.280 UTC] INFO   Instrumenter starting up (instsvc/0.0)
[2015-06-13 20:36:27.280 UTC] INFO   Hostname:    headnode
[2015-06-13 20:36:27.280 UTC] INFO   AMQP broker: {"host":"10.99.99.20","port":"5672"}
[2015-06-13 20:36:27.280 UTC] INFO   Routing key: ca.instrumenter.headnode
[2015-06-13 20:36:27.283 UTC] DBG    loaded metadata file "metadata/profile/operator.json"
[2015-06-13 20:36:27.283 UTC] DBG    loaded metadata file "metadata/profile/customer.json"
[2015-06-13 20:36:27.284 UTC] DBG    loaded metadata file "metadata/metric/metrics.json"
[2015-06-13 20:36:27.297 UTC] INFO   loading modules.
[2015-06-13 20:36:27.307 UTC] INFO   module "kstat" registered cpu.cpus
[2015-06-13 20:36:27.308 UTC] INFO   module "kstat" registered cpu.usage
[2015-06-13 20:36:27.308 UTC] INFO   module "kstat" registered cpu.waittime
[2015-06-13 20:36:27.308 UTC] INFO   module "kstat" registered cpu.loadavg1
[2015-06-13 20:36:27.308 UTC] INFO   module "kstat" registered nic.nics
[2015-06-13 20:36:27.308 UTC] INFO   module "kstat" registered nic.bytes
[2015-06-13 20:36:27.309 UTC] INFO   module "kstat" registered nic.packets
[2015-06-13 20:36:27.309 UTC] INFO   module "kstat" registered nic.vnic_bytes
[2015-06-13 20:36:27.309 UTC] INFO   module "kstat" registered nic.vnic_packets
[2015-06-13 20:36:27.309 UTC] INFO   module "kstat" registered disk.disks
[2015-06-13 20:36:27.309 UTC] INFO   module "kstat" registered disk.physio_ops
[2015-06-13 20:36:27.310 UTC] INFO   module "kstat" registered disk.physio_bytes
[2015-06-13 20:36:27.310 UTC] INFO   module "kstat" registered tcp.segments
[2015-06-13 20:36:27.310 UTC] INFO   module "kstat" registered tcp.errors
[2015-06-13 20:36:27.311 UTC] INFO   module "kstat" registered fs.logical_rwops
[2015-06-13 20:36:27.311 UTC] INFO   module "kstat" registered fs.logical_rwbytes
[2015-06-13 20:36:27.311 UTC] INFO   module "kstat" registered memory.rss
[2015-06-13 20:36:27.311 UTC] INFO   module "kstat" registered memory.rss_limit
[2015-06-13 20:36:27.311 UTC] INFO   module "kstat" registered memory.swap
[2015-06-13 20:36:27.311 UTC] INFO   module "kstat" registered memory.swap_limit
[2015-06-13 20:36:27.311 UTC] INFO   module "kstat" registered memory.reclaimed_bytes
[2015-06-13 20:36:27.311 UTC] INFO   module "kstat" registered memory.pageins
[2015-06-13 20:36:27.312 UTC] INFO   module "kstat" registered vm.exits
[2015-06-13 20:36:27.312 UTC] INFO   module "kstat" registered zfs.arc_ops
[2015-06-13 20:36:27.313 UTC] INFO   loaded module "kstat".
[2015-06-13 20:36:27.344 UTC] INFO   module "dtrace" registered apache.httpd_ops
[2015-06-13 20:36:27.346 UTC] INFO   module "dtrace" registered cpu.thread_executions
[2015-06-13 20:36:27.348 UTC] INFO   module "dtrace" registered cpu.thread_samples
[2015-06-13 20:36:27.350 UTC] INFO   module "dtrace" registered disk.physio_ops
[2015-06-13 20:36:27.353 UTC] INFO   module "dtrace" registered fs.logical_ops
[2015-06-13 20:36:27.354 UTC] INFO   module "dtrace" registered fs.logical_rwops
[2015-06-13 20:36:27.355 UTC] INFO   module "dtrace" registered ldapjs.connections
[2015-06-13 20:36:27.359 UTC] INFO   module "dtrace" registered ldapjs.ops
[2015-06-13 20:36:27.361 UTC] INFO   module "dtrace" registered ldapjs.search_ops
[2015-06-13 20:36:27.362 UTC] INFO   module "dtrace" registered mantaop.jobs_assigned
[2015-06-13 20:36:27.363 UTC] INFO   module "dtrace" registered mantaop.supervisor_auths
[2015-06-13 20:36:27.364 UTC] INFO   module "dtrace" registered mantaop.supervisor_deletes
[2015-06-13 20:36:27.365 UTC] INFO   module "dtrace" registered mantaop.supervisor_errors
[2015-06-13 20:36:27.366 UTC] INFO   module "dtrace" registered mantaop.supervisor_locates
[2015-06-13 20:36:27.366 UTC] INFO   module "dtrace" registered mantaop.tasks_committed
[2015-06-13 20:36:27.367 UTC] INFO   module "dtrace" registered mantaop.tasks_dispatched
[2015-06-13 20:36:27.368 UTC] INFO   module "dtrace" registered mantaop.tasks_executed
[2015-06-13 20:36:27.368 UTC] INFO   module "dtrace" registered mantaop.tasks_killed
[2015-06-13 20:36:27.369 UTC] INFO   module "dtrace" registered mantaop.zone_resets
[2015-06-13 20:36:27.372 UTC] INFO   module "dtrace" registered moray.ops
[2015-06-13 20:36:27.373 UTC] INFO   module "dtrace" registered moray.queries
[2015-06-13 20:36:27.377 UTC] INFO   module "dtrace" registered mysql.commands
[2015-06-13 20:36:27.378 UTC] INFO   module "dtrace" registered mysql.connections
[2015-06-13 20:36:27.381 UTC] INFO   module "dtrace" registered mysql.filesort
[2015-06-13 20:36:27.384 UTC] INFO   module "dtrace" registered mysql.queries
[2015-06-13 20:36:27.387 UTC] INFO   module "dtrace" registered mysql.statements
[2015-06-13 20:36:27.389 UTC] INFO   module "dtrace" registered node.gc_ops
[2015-06-13 20:36:27.394 UTC] INFO   module "dtrace" registered node.httpc_ops
[2015-06-13 20:36:27.397 UTC] INFO   module "dtrace" registered node.httpd_ops
[2015-06-13 20:36:27.399 UTC] INFO   module "dtrace" registered node.socket_ops
[2015-06-13 20:36:27.401 UTC] INFO   module "dtrace" registered postgres.queries
[2015-06-13 20:36:27.403 UTC] INFO   module "dtrace" registered unix.proc_execs
[2015-06-13 20:36:27.405 UTC] INFO   module "dtrace" registered unix.proc_exits
[2015-06-13 20:36:27.406 UTC] INFO   module "dtrace" registered unix.proc_forks
[2015-06-13 20:36:27.410 UTC] INFO   module "dtrace" registered restify.handler_ops
[2015-06-13 20:36:27.412 UTC] INFO   module "dtrace" registered restify.server_ops
[2015-06-13 20:36:27.414 UTC] INFO   module "dtrace" registered syscall.syscalls
[2015-06-13 20:36:27.416 UTC] INFO   module "dtrace" registered tcp.accepts
[2015-06-13 20:36:27.417 UTC] INFO   module "dtrace" registered tcp.connects
[2015-06-13 20:36:27.418 UTC] INFO   module "dtrace" registered unix.thr_creates
[2015-06-13 20:36:27.419 UTC] INFO   module "dtrace" registered vm.irqs
[2015-06-13 20:36:27.421 UTC] INFO   module "dtrace" registered vm.physio_bytes
[2015-06-13 20:36:27.422 UTC] INFO   module "dtrace" registered vm.physio_ops
[2015-06-13 20:36:27.423 UTC] INFO   module "dtrace" registered vm.thread_samples
[2015-06-13 20:36:27.424 UTC] INFO   module "dtrace" registered zfs.arc_ops
[2015-06-13 20:36:27.425 UTC] INFO   loaded module "dtrace".
[2015-06-13 20:36:27.433 UTC] INFO   module "zfs" registered zfs.dataset_unused_quota
[2015-06-13 20:36:27.433 UTC] INFO   module "zfs" registered zfs.dataset_used
[2015-06-13 20:36:27.434 UTC] INFO   module "zfs" registered zfs.dataset_quota
[2015-06-13 20:36:27.434 UTC] INFO   module "zfs" registered zfs.pool_free
[2015-06-13 20:36:27.434 UTC] INFO   module "zfs" registered zfs.pool_used
[2015-06-13 20:36:27.434 UTC] INFO   module "zfs" registered zfs.pool_total
[2015-06-13 20:36:27.434 UTC] INFO   loaded module "zfs".
[2015-06-13 20:36:27.436 UTC] INFO   module "cainstr" registered ca.instr_ticks
[2015-06-13 20:36:27.436 UTC] INFO   module "cainstr" registered ca.instr_beops
[2015-06-13 20:36:27.436 UTC] INFO   module "cainstr" registered ca.instr_enables
[2015-06-13 20:36:27.436 UTC] INFO   module "cainstr" registered ca.instr_disables
[2015-06-13 20:36:27.436 UTC] INFO   loaded module "cainstr".
[2015-06-13 20:36:27.508 UTC] INFO   module "proc" registered unix.processes
[2015-06-13 20:36:27.508 UTC] INFO   loaded module "proc".
[2015-06-13 20:36:27.509 UTC] INFO   finished loading modules.
[2015-06-13 20:36:27.652 UTC] DBG    binding to ca.instrumenter.headnode
[2015-06-13 20:36:27.654 UTC] DBG    binding to ca.broadcast
[2015-06-13 20:36:27.655 UTC] DBG    bind to ca.instrumenter.headnode complete
[2015-06-13 20:36:27.656 UTC] DBG    bind to ca.broadcast complete
[2015-06-13 20:36:27.656 UTC] INFO   AMQP broker connected.
[2015-06-13 20:36:36.475 UTC] CRIT   CA PANIC: panic due to uncaught exception: EXCEPTION: TypeError: TypeError: Object #<Object> has no method 'appendFileSync'
    at Object.mdGenerateDScript (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-metad.js:859:8)
    at Object.impl (/opt/smartdc/agents/lib/node_modules/cabase/cmd/cainst/modules/dtrace.js:38:28)
    at caInstrService.amqpEnableInstn (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-svc-instr.js:439:22)
    at capAmqpCap.<anonymous> (native)
    at capAmqpCap.emit (events.js:88:20)
    at Object.capDispatch (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp-cap.js:203:14)
    at capAmqpCap.receive (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp-cap.js:502:31)
    at caAmqp.<anonymous> (native)
    at caAmqp.emit (events.js:67:17)
    at caAmqp.receive (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp.js:367:7)
[2015-06-13 20:36:36.476 UTC] CRIT   writing core dump to /opt/smartdc/agents/lib/node_modules/cabase/cacore.16520
[2015-06-13 20:36:36.549 UTC] CRIT   finished writing core dump
[ Jun 13 20:36:36 Stopping because all processes in service exited. ]
[ Jun 13 20:36:36 Executing stop method (:kill). ]
[ Jun 13 20:36:36 Executing start method ("/opt/smartdc/agents/lib/node_modules/cabase/smf/method/canodesvc"). ]
DTRACE_LIBPATH=/opt/smartdc/agents/lib/node_modules/cabase/lib
ignoring amqp-config key amqp_login
ignoring amqp-config key amqp_password
AMQP_HOST=10.99.99.20
AMQP_PORT=5672
NODE_PATH=:/opt/smartdc/agents/lib/node_modules/cabase/node_modules:/opt/smartdc/agents/lib/node_modules/cabase/node_modules/connect/lib:/opt/smartdc/agents/lib/node_modules/cabase/lib/ca:/opt/smartdc/agents/lib/node_modules/cabase/lib/tst
[ Jun 13 20:36:37 Method "start" exited with status 0. ]
The "sys" module is now called "util". It should have a similar interface.
using backends kstat,dtrace,zfs,cainstr,proc
[2015-06-13 20:36:37.145 UTC] INFO   Logging AMQP message to "/opt/smartdc/agents/log/ca/cainstsvc/amqp-2015-06-13.20:36:36.16525"
[2015-06-13 20:36:37.147 UTC] INFO   Instrumenter starting up (instsvc/0.0)
[2015-06-13 20:36:37.147 UTC] INFO   Hostname:    headnode
[2015-06-13 20:36:37.147 UTC] INFO   AMQP broker: {"host":"10.99.99.20","port":"5672"}
[2015-06-13 20:36:37.147 UTC] INFO   Routing key: ca.instrumenter.headnode
[2015-06-13 20:36:37.150 UTC] DBG    loaded metadata file "metadata/profile/operator.json"
[2015-06-13 20:36:37.151 UTC] DBG    loaded metadata file "metadata/profile/customer.json"
[2015-06-13 20:36:37.152 UTC] DBG    loaded metadata file "metadata/metric/metrics.json"
[2015-06-13 20:36:37.169 UTC] INFO   loading modules.
[2015-06-13 20:36:37.180 UTC] INFO   module "kstat" registered cpu.cpus
[2015-06-13 20:36:37.180 UTC] INFO   module "kstat" registered cpu.usage
[2015-06-13 20:36:37.181 UTC] INFO   module "kstat" registered cpu.waittime
[2015-06-13 20:36:37.181 UTC] INFO   module "kstat" registered cpu.loadavg1
[2015-06-13 20:36:37.181 UTC] INFO   module "kstat" registered nic.nics
[2015-06-13 20:36:37.181 UTC] INFO   module "kstat" registered nic.bytes
[2015-06-13 20:36:37.181 UTC] INFO   module "kstat" registered nic.packets
[2015-06-13 20:36:37.181 UTC] INFO   module "kstat" registered nic.vnic_bytes
[2015-06-13 20:36:37.182 UTC] INFO   module "kstat" registered nic.vnic_packets
[2015-06-13 20:36:37.182 UTC] INFO   module "kstat" registered disk.disks
[2015-06-13 20:36:37.182 UTC] INFO   module "kstat" registered disk.physio_ops
[2015-06-13 20:36:37.182 UTC] INFO   module "kstat" registered disk.physio_bytes
[2015-06-13 20:36:37.182 UTC] INFO   module "kstat" registered tcp.segments
[2015-06-13 20:36:37.182 UTC] INFO   module "kstat" registered tcp.errors
[2015-06-13 20:36:37.182 UTC] INFO   module "kstat" registered fs.logical_rwops
[2015-06-13 20:36:37.183 UTC] INFO   module "kstat" registered fs.logical_rwbytes
[2015-06-13 20:36:37.183 UTC] INFO   module "kstat" registered memory.rss
[2015-06-13 20:36:37.183 UTC] INFO   module "kstat" registered memory.rss_limit
[2015-06-13 20:36:37.183 UTC] INFO   module "kstat" registered memory.swap
[2015-06-13 20:36:37.183 UTC] INFO   module "kstat" registered memory.swap_limit
[2015-06-13 20:36:37.183 UTC] INFO   module "kstat" registered memory.reclaimed_bytes
[2015-06-13 20:36:37.184 UTC] INFO   module "kstat" registered memory.pageins
[2015-06-13 20:36:37.184 UTC] INFO   module "kstat" registered vm.exits
[2015-06-13 20:36:37.184 UTC] INFO   module "kstat" registered zfs.arc_ops
[2015-06-13 20:36:37.184 UTC] INFO   loaded module "kstat".
[2015-06-13 20:36:37.213 UTC] INFO   module "dtrace" registered apache.httpd_ops
[2015-06-13 20:36:37.215 UTC] INFO   module "dtrace" registered cpu.thread_executions
[2015-06-13 20:36:37.217 UTC] INFO   module "dtrace" registered cpu.thread_samples
[2015-06-13 20:36:37.218 UTC] INFO   module "dtrace" registered disk.physio_ops
[2015-06-13 20:36:37.225 UTC] INFO   module "dtrace" registered fs.logical_ops
[2015-06-13 20:36:37.226 UTC] INFO   module "dtrace" registered fs.logical_rwops
[2015-06-13 20:36:37.227 UTC] INFO   module "dtrace" registered ldapjs.connections
[2015-06-13 20:36:37.230 UTC] INFO   module "dtrace" registered ldapjs.ops
[2015-06-13 20:36:37.231 UTC] INFO   module "dtrace" registered ldapjs.search_ops
[2015-06-13 20:36:37.232 UTC] INFO   module "dtrace" registered mantaop.jobs_assigned
[2015-06-13 20:36:37.233 UTC] INFO   module "dtrace" registered mantaop.supervisor_auths
[2015-06-13 20:36:37.234 UTC] INFO   module "dtrace" registered mantaop.supervisor_deletes
[2015-06-13 20:36:37.235 UTC] INFO   module "dtrace" registered mantaop.supervisor_errors
[2015-06-13 20:36:37.236 UTC] INFO   module "dtrace" registered mantaop.supervisor_locates
[2015-06-13 20:36:37.237 UTC] INFO   module "dtrace" registered mantaop.tasks_committed
[2015-06-13 20:36:37.238 UTC] INFO   module "dtrace" registered mantaop.tasks_dispatched
[2015-06-13 20:36:37.239 UTC] INFO   module "dtrace" registered mantaop.tasks_executed
[2015-06-13 20:36:37.240 UTC] INFO   module "dtrace" registered mantaop.tasks_killed
[2015-06-13 20:36:37.241 UTC] INFO   module "dtrace" registered mantaop.zone_resets
[2015-06-13 20:36:37.242 UTC] INFO   module "dtrace" registered moray.ops
[2015-06-13 20:36:37.243 UTC] INFO   module "dtrace" registered moray.queries
[2015-06-13 20:36:37.244 UTC] INFO   module "dtrace" registered mysql.commands
[2015-06-13 20:36:37.245 UTC] INFO   module "dtrace" registered mysql.connections
[2015-06-13 20:36:37.246 UTC] INFO   module "dtrace" registered mysql.filesort
[2015-06-13 20:36:37.248 UTC] INFO   module "dtrace" registered mysql.queries
[2015-06-13 20:36:37.250 UTC] INFO   module "dtrace" registered mysql.statements
[2015-06-13 20:36:37.251 UTC] INFO   module "dtrace" registered node.gc_ops
[2015-06-13 20:36:37.253 UTC] INFO   module "dtrace" registered node.httpc_ops
[2015-06-13 20:36:37.255 UTC] INFO   module "dtrace" registered node.httpd_ops
[2015-06-13 20:36:37.256 UTC] INFO   module "dtrace" registered node.socket_ops
[2015-06-13 20:36:37.257 UTC] INFO   module "dtrace" registered postgres.queries
[2015-06-13 20:36:37.259 UTC] INFO   module "dtrace" registered unix.proc_execs
[2015-06-13 20:36:37.260 UTC] INFO   module "dtrace" registered unix.proc_exits
[2015-06-13 20:36:37.261 UTC] INFO   module "dtrace" registered unix.proc_forks
[2015-06-13 20:36:37.262 UTC] INFO   module "dtrace" registered restify.handler_ops
[2015-06-13 20:36:37.263 UTC] INFO   module "dtrace" registered restify.server_ops
[2015-06-13 20:36:37.264 UTC] INFO   module "dtrace" registered syscall.syscalls
[2015-06-13 20:36:37.266 UTC] INFO   module "dtrace" registered tcp.accepts
[2015-06-13 20:36:37.267 UTC] INFO   module "dtrace" registered tcp.connects
[2015-06-13 20:36:37.268 UTC] INFO   module "dtrace" registered unix.thr_creates
[2015-06-13 20:36:37.269 UTC] INFO   module "dtrace" registered vm.irqs
[2015-06-13 20:36:37.270 UTC] INFO   module "dtrace" registered vm.physio_bytes
[2015-06-13 20:36:37.271 UTC] INFO   module "dtrace" registered vm.physio_ops
[2015-06-13 20:36:37.272 UTC] INFO   module "dtrace" registered vm.thread_samples
[2015-06-13 20:36:37.273 UTC] INFO   module "dtrace" registered zfs.arc_ops
[2015-06-13 20:36:37.273 UTC] INFO   loaded module "dtrace".
[2015-06-13 20:36:37.280 UTC] INFO   module "zfs" registered zfs.dataset_unused_quota
[2015-06-13 20:36:37.280 UTC] INFO   module "zfs" registered zfs.dataset_used
[2015-06-13 20:36:37.280 UTC] INFO   module "zfs" registered zfs.dataset_quota
[2015-06-13 20:36:37.280 UTC] INFO   module "zfs" registered zfs.pool_free
[2015-06-13 20:36:37.280 UTC] INFO   module "zfs" registered zfs.pool_used
[2015-06-13 20:36:37.281 UTC] INFO   module "zfs" registered zfs.pool_total
[2015-06-13 20:36:37.281 UTC] INFO   loaded module "zfs".
[2015-06-13 20:36:37.282 UTC] INFO   module "cainstr" registered ca.instr_ticks
[2015-06-13 20:36:37.282 UTC] INFO   module "cainstr" registered ca.instr_beops
[2015-06-13 20:36:37.282 UTC] INFO   module "cainstr" registered ca.instr_enables
[2015-06-13 20:36:37.282 UTC] INFO   module "cainstr" registered ca.instr_disables
[2015-06-13 20:36:37.282 UTC] INFO   loaded module "cainstr".
[2015-06-13 20:36:37.321 UTC] INFO   module "proc" registered unix.processes
[2015-06-13 20:36:37.321 UTC] INFO   loaded module "proc".
[2015-06-13 20:36:37.321 UTC] INFO   finished loading modules.
[2015-06-13 20:36:37.468 UTC] DBG    binding to ca.instrumenter.headnode
[2015-06-13 20:36:37.472 UTC] DBG    binding to ca.broadcast
[2015-06-13 20:36:37.473 UTC] DBG    bind to ca.instrumenter.headnode complete
[2015-06-13 20:36:37.473 UTC] DBG    bind to ca.broadcast complete
[2015-06-13 20:36:37.476 UTC] INFO   AMQP broker connected.
[2015-06-13 20:36:56.308 UTC] CRIT   CA PANIC: panic due to uncaught exception: EXCEPTION: TypeError: TypeError: Object #<Object> has no method 'appendFileSync'
    at Object.mdGenerateDScript (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-metad.js:859:8)
    at Object.impl (/opt/smartdc/agents/lib/node_modules/cabase/cmd/cainst/modules/dtrace.js:38:28)
    at caInstrService.amqpEnableInstn (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-svc-instr.js:439:22)
    at capAmqpCap.<anonymous> (native)
    at capAmqpCap.emit (events.js:88:20)
    at Object.capDispatch (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp-cap.js:203:14)
    at capAmqpCap.receive (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp-cap.js:502:31)
    at caAmqp.<anonymous> (native)
    at caAmqp.emit (events.js:67:17)
    at caAmqp.receive (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp.js:367:7)
[2015-06-13 20:36:56.318 UTC] CRIT   writing core dump to /opt/smartdc/agents/lib/node_modules/cabase/cacore.16553
[2015-06-13 20:36:57.946 UTC] CRIT   finished writing core dump
[ Jun 13 20:36:57 Stopping because all processes in service exited. ]
[ Jun 13 20:36:58 Executing stop method (:kill). ]
[ Jun 13 20:36:58 Restarting too quickly, changing state to maintenance. ]
[ Jun 13 20:43:32 Leaving maintenance because clear requested. ]
[ Jun 13 20:43:32 Enabled. ]
[ Jun 13 20:43:32 Executing start method ("/opt/smartdc/agents/lib/node_modules/cabase/smf/method/canodesvc"). ]
DTRACE_LIBPATH=/opt/smartdc/agents/lib/node_modules/cabase/lib
ignoring amqp-config key amqp_login
ignoring amqp-config key amqp_password
AMQP_HOST=10.99.99.20
AMQP_PORT=5672
NODE_PATH=:/opt/smartdc/agents/lib/node_modules/cabase/node_modules:/opt/smartdc/agents/lib/node_modules/cabase/node_modules/connect/lib:/opt/smartdc/agents/lib/node_modules/cabase/lib/ca:/opt/smartdc/agents/lib/node_modules/cabase/lib/tst
[ Jun 13 20:43:32 Method "start" exited with status 0. ]
The "sys" module is now called "util". It should have a similar interface.
using backends kstat,dtrace,zfs,cainstr,proc
[2015-06-13 20:43:33.138 UTC] INFO   Logging AMQP message to "/opt/smartdc/agents/log/ca/cainstsvc/amqp-2015-06-13.20:43:32.16762"
[2015-06-13 20:43:33.140 UTC] INFO   Instrumenter starting up (instsvc/0.0)
[2015-06-13 20:43:33.140 UTC] INFO   Hostname:    headnode
[2015-06-13 20:43:33.140 UTC] INFO   AMQP broker: {"host":"10.99.99.20","port":"5672"}
[2015-06-13 20:43:33.140 UTC] INFO   Routing key: ca.instrumenter.headnode
[2015-06-13 20:43:33.144 UTC] DBG    loaded metadata file "metadata/profile/operator.json"
[2015-06-13 20:43:33.144 UTC] DBG    loaded metadata file "metadata/profile/customer.json"
[2015-06-13 20:43:33.147 UTC] DBG    loaded metadata file "metadata/metric/metrics.json"
[2015-06-13 20:43:33.160 UTC] INFO   loading modules.
[2015-06-13 20:43:33.173 UTC] INFO   module "kstat" registered cpu.cpus
[2015-06-13 20:43:33.173 UTC] INFO   module "kstat" registered cpu.usage
[2015-06-13 20:43:33.173 UTC] INFO   module "kstat" registered cpu.waittime
[2015-06-13 20:43:33.173 UTC] INFO   module "kstat" registered cpu.loadavg1
[2015-06-13 20:43:33.174 UTC] INFO   module "kstat" registered nic.nics
[2015-06-13 20:43:33.174 UTC] INFO   module "kstat" registered nic.bytes
[2015-06-13 20:43:33.174 UTC] INFO   module "kstat" registered nic.packets
[2015-06-13 20:43:33.174 UTC] INFO   module "kstat" registered nic.vnic_bytes
[2015-06-13 20:43:33.174 UTC] INFO   module "kstat" registered nic.vnic_packets
[2015-06-13 20:43:33.174 UTC] INFO   module "kstat" registered disk.disks
[2015-06-13 20:43:33.175 UTC] INFO   module "kstat" registered disk.physio_ops
[2015-06-13 20:43:33.175 UTC] INFO   module "kstat" registered disk.physio_bytes
[2015-06-13 20:43:33.175 UTC] INFO   module "kstat" registered tcp.segments
[2015-06-13 20:43:33.175 UTC] INFO   module "kstat" registered tcp.errors
[2015-06-13 20:43:33.175 UTC] INFO   module "kstat" registered fs.logical_rwops
[2015-06-13 20:43:33.175 UTC] INFO   module "kstat" registered fs.logical_rwbytes
[2015-06-13 20:43:33.176 UTC] INFO   module "kstat" registered memory.rss
[2015-06-13 20:43:33.176 UTC] INFO   module "kstat" registered memory.rss_limit
[2015-06-13 20:43:33.176 UTC] INFO   module "kstat" registered memory.swap
[2015-06-13 20:43:33.176 UTC] INFO   module "kstat" registered memory.swap_limit
[2015-06-13 20:43:33.176 UTC] INFO   module "kstat" registered memory.reclaimed_bytes
[2015-06-13 20:43:33.176 UTC] INFO   module "kstat" registered memory.pageins
[2015-06-13 20:43:33.177 UTC] INFO   module "kstat" registered vm.exits
[2015-06-13 20:43:33.177 UTC] INFO   module "kstat" registered zfs.arc_ops
[2015-06-13 20:43:33.177 UTC] INFO   loaded module "kstat".
[2015-06-13 20:43:33.234 UTC] INFO   module "dtrace" registered apache.httpd_ops
[2015-06-13 20:43:33.237 UTC] INFO   module "dtrace" registered cpu.thread_executions
[2015-06-13 20:43:33.242 UTC] INFO   module "dtrace" registered cpu.thread_samples
[2015-06-13 20:43:33.244 UTC] INFO   module "dtrace" registered disk.physio_ops
[2015-06-13 20:43:33.246 UTC] INFO   module "dtrace" registered fs.logical_ops
[2015-06-13 20:43:33.247 UTC] INFO   module "dtrace" registered fs.logical_rwops
[2015-06-13 20:43:33.248 UTC] INFO   module "dtrace" registered ldapjs.connections
[2015-06-13 20:43:33.251 UTC] INFO   module "dtrace" registered ldapjs.ops
[2015-06-13 20:43:33.252 UTC] INFO   module "dtrace" registered ldapjs.search_ops
[2015-06-13 20:43:33.253 UTC] INFO   module "dtrace" registered mantaop.jobs_assigned
[2015-06-13 20:43:33.253 UTC] INFO   module "dtrace" registered mantaop.supervisor_auths
[2015-06-13 20:43:33.254 UTC] INFO   module "dtrace" registered mantaop.supervisor_deletes
[2015-06-13 20:43:33.255 UTC] INFO   module "dtrace" registered mantaop.supervisor_errors
[2015-06-13 20:43:33.255 UTC] INFO   module "dtrace" registered mantaop.supervisor_locates
[2015-06-13 20:43:33.256 UTC] INFO   module "dtrace" registered mantaop.tasks_committed
[2015-06-13 20:43:33.257 UTC] INFO   module "dtrace" registered mantaop.tasks_dispatched
[2015-06-13 20:43:33.257 UTC] INFO   module "dtrace" registered mantaop.tasks_executed
[2015-06-13 20:43:33.258 UTC] INFO   module "dtrace" registered mantaop.tasks_killed
[2015-06-13 20:43:33.259 UTC] INFO   module "dtrace" registered mantaop.zone_resets
[2015-06-13 20:43:33.260 UTC] INFO   module "dtrace" registered moray.ops
[2015-06-13 20:43:33.261 UTC] INFO   module "dtrace" registered moray.queries
[2015-06-13 20:43:33.262 UTC] INFO   module "dtrace" registered mysql.commands
[2015-06-13 20:43:33.263 UTC] INFO   module "dtrace" registered mysql.connections
[2015-06-13 20:43:33.264 UTC] INFO   module "dtrace" registered mysql.filesort
[2015-06-13 20:43:33.266 UTC] INFO   module "dtrace" registered mysql.queries
[2015-06-13 20:43:33.267 UTC] INFO   module "dtrace" registered mysql.statements
[2015-06-13 20:43:33.268 UTC] INFO   module "dtrace" registered node.gc_ops
[2015-06-13 20:43:33.269 UTC] INFO   module "dtrace" registered node.httpc_ops
[2015-06-13 20:43:33.271 UTC] INFO   module "dtrace" registered node.httpd_ops
[2015-06-13 20:43:33.272 UTC] INFO   module "dtrace" registered node.socket_ops
[2015-06-13 20:43:33.273 UTC] INFO   module "dtrace" registered postgres.queries
[2015-06-13 20:43:33.275 UTC] INFO   module "dtrace" registered unix.proc_execs
[2015-06-13 20:43:33.276 UTC] INFO   module "dtrace" registered unix.proc_exits
[2015-06-13 20:43:33.277 UTC] INFO   module "dtrace" registered unix.proc_forks
[2015-06-13 20:43:33.278 UTC] INFO   module "dtrace" registered restify.handler_ops
[2015-06-13 20:43:33.279 UTC] INFO   module "dtrace" registered restify.server_ops
[2015-06-13 20:43:33.280 UTC] INFO   module "dtrace" registered syscall.syscalls
[2015-06-13 20:43:33.281 UTC] INFO   module "dtrace" registered tcp.accepts
[2015-06-13 20:43:33.283 UTC] INFO   module "dtrace" registered tcp.connects
[2015-06-13 20:43:33.284 UTC] INFO   module "dtrace" registered unix.thr_creates
[2015-06-13 20:43:33.286 UTC] INFO   module "dtrace" registered vm.irqs
[2015-06-13 20:43:33.287 UTC] INFO   module "dtrace" registered vm.physio_bytes
[2015-06-13 20:43:33.288 UTC] INFO   module "dtrace" registered vm.physio_ops
[2015-06-13 20:43:33.289 UTC] INFO   module "dtrace" registered vm.thread_samples
[2015-06-13 20:43:33.290 UTC] INFO   module "dtrace" registered zfs.arc_ops
[2015-06-13 20:43:33.290 UTC] INFO   loaded module "dtrace".
[2015-06-13 20:43:33.298 UTC] INFO   module "zfs" registered zfs.dataset_unused_quota
[2015-06-13 20:43:33.298 UTC] INFO   module "zfs" registered zfs.dataset_used
[2015-06-13 20:43:33.298 UTC] INFO   module "zfs" registered zfs.dataset_quota
[2015-06-13 20:43:33.298 UTC] INFO   module "zfs" registered zfs.pool_free
[2015-06-13 20:43:33.298 UTC] INFO   module "zfs" registered zfs.pool_used
[2015-06-13 20:43:33.298 UTC] INFO   module "zfs" registered zfs.pool_total
[2015-06-13 20:43:33.298 UTC] INFO   loaded module "zfs".
[2015-06-13 20:43:33.300 UTC] INFO   module "cainstr" registered ca.instr_ticks
[2015-06-13 20:43:33.300 UTC] INFO   module "cainstr" registered ca.instr_beops
[2015-06-13 20:43:33.300 UTC] INFO   module "cainstr" registered ca.instr_enables
[2015-06-13 20:43:33.300 UTC] INFO   module "cainstr" registered ca.instr_disables
[2015-06-13 20:43:33.300 UTC] INFO   loaded module "cainstr".
[2015-06-13 20:43:33.369 UTC] INFO   module "proc" registered unix.processes
[2015-06-13 20:43:33.370 UTC] INFO   loaded module "proc".
[2015-06-13 20:43:33.370 UTC] INFO   finished loading modules.
[2015-06-13 20:43:33.523 UTC] DBG    binding to ca.instrumenter.headnode
[2015-06-13 20:43:33.524 UTC] DBG    binding to ca.broadcast
[2015-06-13 20:43:33.526 UTC] DBG    bind to ca.instrumenter.headnode complete
[2015-06-13 20:43:33.527 UTC] DBG    bind to ca.broadcast complete
[2015-06-13 20:43:33.527 UTC] INFO   AMQP broker connected.
[2015-06-13 20:43:33.715 UTC] CRIT   CA PANIC: panic due to uncaught exception: EXCEPTION: TypeError: TypeError: Object #<Object> has no method 'appendFileSync'
    at Object.mdGenerateDScript (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-metad.js:859:9)
    at Object.impl (/opt/smartdc/agents/lib/node_modules/cabase/cmd/cainst/modules/dtrace.js:38:28)
    at caInstrService.amqpEnableInstn (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-svc-instr.js:439:22)
    at capAmqpCap.<anonymous> (native)
    at capAmqpCap.emit (events.js:88:20)
    at Object.capDispatch (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp-cap.js:203:14)
    at capAmqpCap.receive (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp-cap.js:502:31)
    at caAmqp.<anonymous> (native)
    at caAmqp.emit (events.js:67:17)
    at caAmqp.receive (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp.js:367:7)
[2015-06-13 20:43:33.715 UTC] CRIT   writing core dump to /opt/smartdc/agents/lib/node_modules/cabase/cacore.16790
[2015-06-13 20:43:33.784 UTC] CRIT   finished writing core dump
[ Jun 13 20:43:33 Stopping because all processes in service exited. ]
[ Jun 13 20:43:33 Executing stop method (:kill). ]
[ Jun 13 20:43:33 Executing start method ("/opt/smartdc/agents/lib/node_modules/cabase/smf/method/canodesvc"). ]
DTRACE_LIBPATH=/opt/smartdc/agents/lib/node_modules/cabase/lib
ignoring amqp-config key amqp_login
ignoring amqp-config key amqp_password
AMQP_HOST=10.99.99.20
AMQP_PORT=5672
NODE_PATH=:/opt/smartdc/agents/lib/node_modules/cabase/node_modules:/opt/smartdc/agents/lib/node_modules/cabase/node_modules/connect/lib:/opt/smartdc/agents/lib/node_modules/cabase/lib/ca:/opt/smartdc/agents/lib/node_modules/cabase/lib/tst
[ Jun 13 20:43:34 Method "start" exited with status 0. ]
The "sys" module is now called "util". It should have a similar interface.
using backends kstat,dtrace,zfs,cainstr,proc
[2015-06-13 20:43:34.352 UTC] INFO   Logging AMQP message to "/opt/smartdc/agents/log/ca/cainstsvc/amqp-2015-06-13.20:43:33.16793"
[2015-06-13 20:43:34.353 UTC] INFO   Instrumenter starting up (instsvc/0.0)
[2015-06-13 20:43:34.353 UTC] INFO   Hostname:    headnode
[2015-06-13 20:43:34.353 UTC] INFO   AMQP broker: {"host":"10.99.99.20","port":"5672"}
[2015-06-13 20:43:34.353 UTC] INFO   Routing key: ca.instrumenter.headnode
[2015-06-13 20:43:34.357 UTC] DBG    loaded metadata file "metadata/profile/operator.json"
[2015-06-13 20:43:34.357 UTC] DBG    loaded metadata file "metadata/profile/customer.json"
[2015-06-13 20:43:34.358 UTC] DBG    loaded metadata file "metadata/metric/metrics.json"
[2015-06-13 20:43:34.378 UTC] INFO   loading modules.
[2015-06-13 20:43:34.389 UTC] INFO   module "kstat" registered cpu.cpus
[2015-06-13 20:43:34.390 UTC] INFO   module "kstat" registered cpu.usage
[2015-06-13 20:43:34.390 UTC] INFO   module "kstat" registered cpu.waittime
[2015-06-13 20:43:34.390 UTC] INFO   module "kstat" registered cpu.loadavg1
[2015-06-13 20:43:34.390 UTC] INFO   module "kstat" registered nic.nics
[2015-06-13 20:43:34.391 UTC] INFO   module "kstat" registered nic.bytes
[2015-06-13 20:43:34.391 UTC] INFO   module "kstat" registered nic.packets
[2015-06-13 20:43:34.391 UTC] INFO   module "kstat" registered nic.vnic_bytes
[2015-06-13 20:43:34.391 UTC] INFO   module "kstat" registered nic.vnic_packets
[2015-06-13 20:43:34.391 UTC] INFO   module "kstat" registered disk.disks
[2015-06-13 20:43:34.391 UTC] INFO   module "kstat" registered disk.physio_ops
[2015-06-13 20:43:34.392 UTC] INFO   module "kstat" registered disk.physio_bytes
[2015-06-13 20:43:34.392 UTC] INFO   module "kstat" registered tcp.segments
[2015-06-13 20:43:34.392 UTC] INFO   module "kstat" registered tcp.errors
[2015-06-13 20:43:34.392 UTC] INFO   module "kstat" registered fs.logical_rwops
[2015-06-13 20:43:34.392 UTC] INFO   module "kstat" registered fs.logical_rwbytes
[2015-06-13 20:43:34.392 UTC] INFO   module "kstat" registered memory.rss
[2015-06-13 20:43:34.393 UTC] INFO   module "kstat" registered memory.rss_limit
[2015-06-13 20:43:34.393 UTC] INFO   module "kstat" registered memory.swap
[2015-06-13 20:43:34.393 UTC] INFO   module "kstat" registered memory.swap_limit
[2015-06-13 20:43:34.393 UTC] INFO   module "kstat" registered memory.reclaimed_bytes
[2015-06-13 20:43:34.393 UTC] INFO   module "kstat" registered memory.pageins
[2015-06-13 20:43:34.393 UTC] INFO   module "kstat" registered vm.exits
[2015-06-13 20:43:34.394 UTC] INFO   module "kstat" registered zfs.arc_ops
[2015-06-13 20:43:34.395 UTC] INFO   loaded module "kstat".
[2015-06-13 20:43:34.421 UTC] INFO   module "dtrace" registered apache.httpd_ops
[2015-06-13 20:43:34.422 UTC] INFO   module "dtrace" registered cpu.thread_executions
[2015-06-13 20:43:34.423 UTC] INFO   module "dtrace" registered cpu.thread_samples
[2015-06-13 20:43:34.424 UTC] INFO   module "dtrace" registered disk.physio_ops
[2015-06-13 20:43:34.426 UTC] INFO   module "dtrace" registered fs.logical_ops
[2015-06-13 20:43:34.429 UTC] INFO   module "dtrace" registered fs.logical_rwops
[2015-06-13 20:43:34.430 UTC] INFO   module "dtrace" registered ldapjs.connections
[2015-06-13 20:43:34.433 UTC] INFO   module "dtrace" registered ldapjs.ops
[2015-06-13 20:43:34.435 UTC] INFO   module "dtrace" registered ldapjs.search_ops
[2015-06-13 20:43:34.436 UTC] INFO   module "dtrace" registered mantaop.jobs_assigned
[2015-06-13 20:43:34.437 UTC] INFO   module "dtrace" registered mantaop.supervisor_auths
[2015-06-13 20:43:34.439 UTC] INFO   module "dtrace" registered mantaop.supervisor_deletes
[2015-06-13 20:43:34.440 UTC] INFO   module "dtrace" registered mantaop.supervisor_errors
[2015-06-13 20:43:34.441 UTC] INFO   module "dtrace" registered mantaop.supervisor_locates
[2015-06-13 20:43:34.441 UTC] INFO   module "dtrace" registered mantaop.tasks_committed
[2015-06-13 20:43:34.442 UTC] INFO   module "dtrace" registered mantaop.tasks_dispatched
[2015-06-13 20:43:34.443 UTC] INFO   module "dtrace" registered mantaop.tasks_executed
[2015-06-13 20:43:34.444 UTC] INFO   module "dtrace" registered mantaop.tasks_killed
[2015-06-13 20:43:34.445 UTC] INFO   module "dtrace" registered mantaop.zone_resets
[2015-06-13 20:43:34.447 UTC] INFO   module "dtrace" registered moray.ops
[2015-06-13 20:43:34.448 UTC] INFO   module "dtrace" registered moray.queries
[2015-06-13 20:43:34.449 UTC] INFO   module "dtrace" registered mysql.commands
[2015-06-13 20:43:34.450 UTC] INFO   module "dtrace" registered mysql.connections
[2015-06-13 20:43:34.451 UTC] INFO   module "dtrace" registered mysql.filesort
[2015-06-13 20:43:34.453 UTC] INFO   module "dtrace" registered mysql.queries
[2015-06-13 20:43:34.455 UTC] INFO   module "dtrace" registered mysql.statements
[2015-06-13 20:43:34.456 UTC] INFO   module "dtrace" registered node.gc_ops
[2015-06-13 20:43:34.458 UTC] INFO   module "dtrace" registered node.httpc_ops
[2015-06-13 20:43:34.459 UTC] INFO   module "dtrace" registered node.httpd_ops
[2015-06-13 20:43:34.461 UTC] INFO   module "dtrace" registered node.socket_ops
[2015-06-13 20:43:34.462 UTC] INFO   module "dtrace" registered postgres.queries
[2015-06-13 20:43:34.463 UTC] INFO   module "dtrace" registered unix.proc_execs
[2015-06-13 20:43:34.466 UTC] INFO   module "dtrace" registered unix.proc_exits
[2015-06-13 20:43:34.467 UTC] INFO   module "dtrace" registered unix.proc_forks
[2015-06-13 20:43:34.468 UTC] INFO   module "dtrace" registered restify.handler_ops
[2015-06-13 20:43:34.470 UTC] INFO   module "dtrace" registered restify.server_ops
[2015-06-13 20:43:34.472 UTC] INFO   module "dtrace" registered syscall.syscalls
[2015-06-13 20:43:34.473 UTC] INFO   module "dtrace" registered tcp.accepts
[2015-06-13 20:43:34.474 UTC] INFO   module "dtrace" registered tcp.connects
[2015-06-13 20:43:34.475 UTC] INFO   module "dtrace" registered unix.thr_creates
[2015-06-13 20:43:34.476 UTC] INFO   module "dtrace" registered vm.irqs
[2015-06-13 20:43:34.477 UTC] INFO   module "dtrace" registered vm.physio_bytes
[2015-06-13 20:43:34.478 UTC] INFO   module "dtrace" registered vm.physio_ops
[2015-06-13 20:43:34.479 UTC] INFO   module "dtrace" registered vm.thread_samples
[2015-06-13 20:43:34.480 UTC] INFO   module "dtrace" registered zfs.arc_ops
[2015-06-13 20:43:34.480 UTC] INFO   loaded module "dtrace".
[2015-06-13 20:43:34.489 UTC] INFO   module "zfs" registered zfs.dataset_unused_quota
[2015-06-13 20:43:34.489 UTC] INFO   module "zfs" registered zfs.dataset_used
[2015-06-13 20:43:34.489 UTC] INFO   module "zfs" registered zfs.dataset_quota
[2015-06-13 20:43:34.489 UTC] INFO   module "zfs" registered zfs.pool_free
[2015-06-13 20:43:34.489 UTC] INFO   module "zfs" registered zfs.pool_used
[2015-06-13 20:43:34.489 UTC] INFO   module "zfs" registered zfs.pool_total
[2015-06-13 20:43:34.489 UTC] INFO   loaded module "zfs".
[2015-06-13 20:43:34.491 UTC] INFO   module "cainstr" registered ca.instr_ticks
[2015-06-13 20:43:34.491 UTC] INFO   module "cainstr" registered ca.instr_beops
[2015-06-13 20:43:34.491 UTC] INFO   module "cainstr" registered ca.instr_enables
[2015-06-13 20:43:34.491 UTC] INFO   module "cainstr" registered ca.instr_disables
[2015-06-13 20:43:34.491 UTC] INFO   loaded module "cainstr".
[2015-06-13 20:43:34.539 UTC] INFO   module "proc" registered unix.processes
[2015-06-13 20:43:34.539 UTC] INFO   loaded module "proc".
[2015-06-13 20:43:34.540 UTC] INFO   finished loading modules.
[2015-06-13 20:43:34.701 UTC] DBG    binding to ca.instrumenter.headnode
[2015-06-13 20:43:34.703 UTC] DBG    binding to ca.broadcast
[2015-06-13 20:43:34.705 UTC] DBG    bind to ca.instrumenter.headnode complete
[2015-06-13 20:43:34.706 UTC] DBG    bind to ca.broadcast complete
[2015-06-13 20:43:34.706 UTC] INFO   AMQP broker connected.
[2015-06-13 20:43:43.723 UTC] CRIT   CA PANIC: panic due to uncaught exception: EXCEPTION: TypeError: TypeError: Object #<Object> has no method 'appendFileSync'
    at Object.mdGenerateDScript (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-metad.js:859:9)
    at Object.impl (/opt/smartdc/agents/lib/node_modules/cabase/cmd/cainst/modules/dtrace.js:38:28)
    at caInstrService.amqpEnableInstn (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-svc-instr.js:439:22)
    at capAmqpCap.<anonymous> (native)
    at capAmqpCap.emit (events.js:88:20)
    at Object.capDispatch (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp-cap.js:203:14)
    at capAmqpCap.receive (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp-cap.js:502:31)
    at caAmqp.<anonymous> (native)
    at caAmqp.emit (events.js:67:17)
    at caAmqp.receive (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp.js:367:7)
[2015-06-13 20:43:43.724 UTC] CRIT   writing core dump to /opt/smartdc/agents/lib/node_modules/cabase/cacore.16821
[2015-06-13 20:43:43.800 UTC] CRIT   finished writing core dump
[ Jun 13 20:43:43 Stopping because all processes in service exited. ]
[ Jun 13 20:43:43 Executing stop method (:kill). ]
[ Jun 13 20:43:43 Executing start method ("/opt/smartdc/agents/lib/node_modules/cabase/smf/method/canodesvc"). ]
DTRACE_LIBPATH=/opt/smartdc/agents/lib/node_modules/cabase/lib
ignoring amqp-config key amqp_login
ignoring amqp-config key amqp_password
AMQP_HOST=10.99.99.20
AMQP_PORT=5672
NODE_PATH=:/opt/smartdc/agents/lib/node_modules/cabase/node_modules:/opt/smartdc/agents/lib/node_modules/cabase/node_modules/connect/lib:/opt/smartdc/agents/lib/node_modules/cabase/lib/ca:/opt/smartdc/agents/lib/node_modules/cabase/lib/tst
[ Jun 13 20:43:44 Method "start" exited with status 0. ]
The "sys" module is now called "util". It should have a similar interface.
using backends kstat,dtrace,zfs,cainstr,proc
[2015-06-13 20:43:44.392 UTC] INFO   Logging AMQP message to "/opt/smartdc/agents/log/ca/cainstsvc/amqp-2015-06-13.20:43:43.16826"
[2015-06-13 20:43:44.393 UTC] INFO   Instrumenter starting up (instsvc/0.0)
[2015-06-13 20:43:44.393 UTC] INFO   Hostname:    headnode
[2015-06-13 20:43:44.393 UTC] INFO   AMQP broker: {"host":"10.99.99.20","port":"5672"}
[2015-06-13 20:43:44.393 UTC] INFO   Routing key: ca.instrumenter.headnode
[2015-06-13 20:43:44.396 UTC] DBG    loaded metadata file "metadata/profile/operator.json"
[2015-06-13 20:43:44.396 UTC] DBG    loaded metadata file "metadata/profile/customer.json"
[2015-06-13 20:43:44.397 UTC] DBG    loaded metadata file "metadata/metric/metrics.json"
[2015-06-13 20:43:44.416 UTC] INFO   loading modules.
[2015-06-13 20:43:44.426 UTC] INFO   module "kstat" registered cpu.cpus
[2015-06-13 20:43:44.427 UTC] INFO   module "kstat" registered cpu.usage
[2015-06-13 20:43:44.427 UTC] INFO   module "kstat" registered cpu.waittime
[2015-06-13 20:43:44.427 UTC] INFO   module "kstat" registered cpu.loadavg1
[2015-06-13 20:43:44.427 UTC] INFO   module "kstat" registered nic.nics
[2015-06-13 20:43:44.427 UTC] INFO   module "kstat" registered nic.bytes
[2015-06-13 20:43:44.427 UTC] INFO   module "kstat" registered nic.packets
[2015-06-13 20:43:44.427 UTC] INFO   module "kstat" registered nic.vnic_bytes
[2015-06-13 20:43:44.428 UTC] INFO   module "kstat" registered nic.vnic_packets
[2015-06-13 20:43:44.428 UTC] INFO   module "kstat" registered disk.disks
[2015-06-13 20:43:44.428 UTC] INFO   module "kstat" registered disk.physio_ops
[2015-06-13 20:43:44.428 UTC] INFO   module "kstat" registered disk.physio_bytes
[2015-06-13 20:43:44.428 UTC] INFO   module "kstat" registered tcp.segments
[2015-06-13 20:43:44.428 UTC] INFO   module "kstat" registered tcp.errors
[2015-06-13 20:43:44.429 UTC] INFO   module "kstat" registered fs.logical_rwops
[2015-06-13 20:43:44.429 UTC] INFO   module "kstat" registered fs.logical_rwbytes
[2015-06-13 20:43:44.429 UTC] INFO   module "kstat" registered memory.rss
[2015-06-13 20:43:44.429 UTC] INFO   module "kstat" registered memory.rss_limit
[2015-06-13 20:43:44.429 UTC] INFO   module "kstat" registered memory.swap
[2015-06-13 20:43:44.429 UTC] INFO   module "kstat" registered memory.swap_limit
[2015-06-13 20:43:44.429 UTC] INFO   module "kstat" registered memory.reclaimed_bytes
[2015-06-13 20:43:44.430 UTC] INFO   module "kstat" registered memory.pageins
[2015-06-13 20:43:44.430 UTC] INFO   module "kstat" registered vm.exits
[2015-06-13 20:43:44.430 UTC] INFO   module "kstat" registered zfs.arc_ops
[2015-06-13 20:43:44.430 UTC] INFO   loaded module "kstat".
[2015-06-13 20:43:44.458 UTC] INFO   module "dtrace" registered apache.httpd_ops
[2015-06-13 20:43:44.459 UTC] INFO   module "dtrace" registered cpu.thread_executions
[2015-06-13 20:43:44.460 UTC] INFO   module "dtrace" registered cpu.thread_samples
[2015-06-13 20:43:44.461 UTC] INFO   module "dtrace" registered disk.physio_ops
[2015-06-13 20:43:44.463 UTC] INFO   module "dtrace" registered fs.logical_ops
[2015-06-13 20:43:44.467 UTC] INFO   module "dtrace" registered fs.logical_rwops
[2015-06-13 20:43:44.468 UTC] INFO   module "dtrace" registered ldapjs.connections
[2015-06-13 20:43:44.471 UTC] INFO   module "dtrace" registered ldapjs.ops
[2015-06-13 20:43:44.472 UTC] INFO   module "dtrace" registered ldapjs.search_ops
[2015-06-13 20:43:44.473 UTC] INFO   module "dtrace" registered mantaop.jobs_assigned
[2015-06-13 20:43:44.474 UTC] INFO   module "dtrace" registered mantaop.supervisor_auths
[2015-06-13 20:43:44.475 UTC] INFO   module "dtrace" registered mantaop.supervisor_deletes
[2015-06-13 20:43:44.476 UTC] INFO   module "dtrace" registered mantaop.supervisor_errors
[2015-06-13 20:43:44.477 UTC] INFO   module "dtrace" registered mantaop.supervisor_locates
[2015-06-13 20:43:44.478 UTC] INFO   module "dtrace" registered mantaop.tasks_committed
[2015-06-13 20:43:44.478 UTC] INFO   module "dtrace" registered mantaop.tasks_dispatched
[2015-06-13 20:43:44.479 UTC] INFO   module "dtrace" registered mantaop.tasks_executed
[2015-06-13 20:43:44.480 UTC] INFO   module "dtrace" registered mantaop.tasks_killed
[2015-06-13 20:43:44.482 UTC] INFO   module "dtrace" registered mantaop.zone_resets
[2015-06-13 20:43:44.483 UTC] INFO   module "dtrace" registered moray.ops
[2015-06-13 20:43:44.484 UTC] INFO   module "dtrace" registered moray.queries
[2015-06-13 20:43:44.485 UTC] INFO   module "dtrace" registered mysql.commands
[2015-06-13 20:43:44.486 UTC] INFO   module "dtrace" registered mysql.connections
[2015-06-13 20:43:44.487 UTC] INFO   module "dtrace" registered mysql.filesort
[2015-06-13 20:43:44.489 UTC] INFO   module "dtrace" registered mysql.queries
[2015-06-13 20:43:44.490 UTC] INFO   module "dtrace" registered mysql.statements
[2015-06-13 20:43:44.491 UTC] INFO   module "dtrace" registered node.gc_ops
[2015-06-13 20:43:44.493 UTC] INFO   module "dtrace" registered node.httpc_ops
[2015-06-13 20:43:44.494 UTC] INFO   module "dtrace" registered node.httpd_ops
[2015-06-13 20:43:44.496 UTC] INFO   module "dtrace" registered node.socket_ops
[2015-06-13 20:43:44.497 UTC] INFO   module "dtrace" registered postgres.queries
[2015-06-13 20:43:44.498 UTC] INFO   module "dtrace" registered unix.proc_execs
[2015-06-13 20:43:44.499 UTC] INFO   module "dtrace" registered unix.proc_exits
[2015-06-13 20:43:44.499 UTC] INFO   module "dtrace" registered unix.proc_forks
[2015-06-13 20:43:44.501 UTC] INFO   module "dtrace" registered restify.handler_ops
[2015-06-13 20:43:44.502 UTC] INFO   module "dtrace" registered restify.server_ops
[2015-06-13 20:43:44.503 UTC] INFO   module "dtrace" registered syscall.syscalls
[2015-06-13 20:43:44.504 UTC] INFO   module "dtrace" registered tcp.accepts
[2015-06-13 20:43:44.505 UTC] INFO   module "dtrace" registered tcp.connects
[2015-06-13 20:43:44.506 UTC] INFO   module "dtrace" registered unix.thr_creates
[2015-06-13 20:43:44.507 UTC] INFO   module "dtrace" registered vm.irqs
[2015-06-13 20:43:44.508 UTC] INFO   module "dtrace" registered vm.physio_bytes
[2015-06-13 20:43:44.509 UTC] INFO   module "dtrace" registered vm.physio_ops
[2015-06-13 20:43:44.510 UTC] INFO   module "dtrace" registered vm.thread_samples
[2015-06-13 20:43:44.513 UTC] INFO   module "dtrace" registered zfs.arc_ops
[2015-06-13 20:43:44.513 UTC] INFO   loaded module "dtrace".
[2015-06-13 20:43:44.521 UTC] INFO   module "zfs" registered zfs.dataset_unused_quota
[2015-06-13 20:43:44.521 UTC] INFO   module "zfs" registered zfs.dataset_used
[2015-06-13 20:43:44.522 UTC] INFO   module "zfs" registered zfs.dataset_quota
[2015-06-13 20:43:44.522 UTC] INFO   module "zfs" registered zfs.pool_free
[2015-06-13 20:43:44.522 UTC] INFO   module "zfs" registered zfs.pool_used
[2015-06-13 20:43:44.522 UTC] INFO   module "zfs" registered zfs.pool_total
[2015-06-13 20:43:44.522 UTC] INFO   loaded module "zfs".
[2015-06-13 20:43:44.524 UTC] INFO   module "cainstr" registered ca.instr_ticks
[2015-06-13 20:43:44.525 UTC] INFO   module "cainstr" registered ca.instr_beops
[2015-06-13 20:43:44.525 UTC] INFO   module "cainstr" registered ca.instr_enables
[2015-06-13 20:43:44.525 UTC] INFO   module "cainstr" registered ca.instr_disables
[2015-06-13 20:43:44.525 UTC] INFO   loaded module "cainstr".
[2015-06-13 20:43:44.569 UTC] INFO   module "proc" registered unix.processes
[2015-06-13 20:43:44.569 UTC] INFO   loaded module "proc".
[2015-06-13 20:43:44.570 UTC] INFO   finished loading modules.
[2015-06-13 20:43:44.745 UTC] DBG    binding to ca.instrumenter.headnode
[2015-06-13 20:43:44.746 UTC] DBG    binding to ca.broadcast
[2015-06-13 20:43:44.751 UTC] DBG    bind to ca.instrumenter.headnode complete
[2015-06-13 20:43:44.754 UTC] DBG    bind to ca.broadcast complete
[2015-06-13 20:43:44.755 UTC] INFO   AMQP broker connected.
[2015-06-13 20:43:53.717 UTC] CRIT   CA PANIC: panic due to uncaught exception: EXCEPTION: TypeError: TypeError: Object #<Object> has no method 'appendFileSync'
    at Object.mdGenerateDScript (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-metad.js:859:9)
    at Object.impl (/opt/smartdc/agents/lib/node_modules/cabase/cmd/cainst/modules/dtrace.js:38:28)
    at caInstrService.amqpEnableInstn (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-svc-instr.js:439:22)
    at capAmqpCap.<anonymous> (native)
    at capAmqpCap.emit (events.js:88:20)
    at Object.capDispatch (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp-cap.js:203:14)
    at capAmqpCap.receive (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp-cap.js:502:31)
    at caAmqp.<anonymous> (native)
    at caAmqp.emit (events.js:67:17)
    at caAmqp.receive (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp.js:367:7)
[2015-06-13 20:43:53.717 UTC] CRIT   writing core dump to /opt/smartdc/agents/lib/node_modules/cabase/cacore.16854
[2015-06-13 20:43:53.786 UTC] CRIT   finished writing core dump
[ Jun 13 20:43:53 Stopping because all processes in service exited. ]
[ Jun 13 20:43:53 Executing stop method (:kill). ]
[ Jun 13 20:43:53 Executing start method ("/opt/smartdc/agents/lib/node_modules/cabase/smf/method/canodesvc"). ]
DTRACE_LIBPATH=/opt/smartdc/agents/lib/node_modules/cabase/lib
ignoring amqp-config key amqp_login
ignoring amqp-config key amqp_password
AMQP_HOST=10.99.99.20
AMQP_PORT=5672
NODE_PATH=:/opt/smartdc/agents/lib/node_modules/cabase/node_modules:/opt/smartdc/agents/lib/node_modules/cabase/node_modules/connect/lib:/opt/smartdc/agents/lib/node_modules/cabase/lib/ca:/opt/smartdc/agents/lib/node_modules/cabase/lib/tst
[ Jun 13 20:43:54 Method "start" exited with status 0. ]
The "sys" module is now called "util". It should have a similar interface.
using backends kstat,dtrace,zfs,cainstr,proc
[2015-06-13 20:43:54.401 UTC] INFO   Logging AMQP message to "/opt/smartdc/agents/log/ca/cainstsvc/amqp-2015-06-13.20:43:53.16859"
[2015-06-13 20:43:54.402 UTC] INFO   Instrumenter starting up (instsvc/0.0)
[2015-06-13 20:43:54.403 UTC] INFO   Hostname:    headnode
[2015-06-13 20:43:54.403 UTC] INFO   AMQP broker: {"host":"10.99.99.20","port":"5672"}
[2015-06-13 20:43:54.403 UTC] INFO   Routing key: ca.instrumenter.headnode
[2015-06-13 20:43:54.407 UTC] DBG    loaded metadata file "metadata/metric/metrics.json"
[2015-06-13 20:43:54.408 UTC] DBG    loaded metadata file "metadata/profile/operator.json"
[2015-06-13 20:43:54.408 UTC] DBG    loaded metadata file "metadata/profile/customer.json"
[2015-06-13 20:43:54.422 UTC] INFO   loading modules.
[2015-06-13 20:43:54.433 UTC] INFO   module "kstat" registered cpu.cpus
[2015-06-13 20:43:54.434 UTC] INFO   module "kstat" registered cpu.usage
[2015-06-13 20:43:54.434 UTC] INFO   module "kstat" registered cpu.waittime
[2015-06-13 20:43:54.435 UTC] INFO   module "kstat" registered cpu.loadavg1
[2015-06-13 20:43:54.435 UTC] INFO   module "kstat" registered nic.nics
[2015-06-13 20:43:54.436 UTC] INFO   module "kstat" registered nic.bytes
[2015-06-13 20:43:54.436 UTC] INFO   module "kstat" registered nic.packets
[2015-06-13 20:43:54.437 UTC] INFO   module "kstat" registered nic.vnic_bytes
[2015-06-13 20:43:54.437 UTC] INFO   module "kstat" registered nic.vnic_packets
[2015-06-13 20:43:54.438 UTC] INFO   module "kstat" registered disk.disks
[2015-06-13 20:43:54.438 UTC] INFO   module "kstat" registered disk.physio_ops
[2015-06-13 20:43:54.438 UTC] INFO   module "kstat" registered disk.physio_bytes
[2015-06-13 20:43:54.439 UTC] INFO   module "kstat" registered tcp.segments
[2015-06-13 20:43:54.439 UTC] INFO   module "kstat" registered tcp.errors
[2015-06-13 20:43:54.440 UTC] INFO   module "kstat" registered fs.logical_rwops
[2015-06-13 20:43:54.440 UTC] INFO   module "kstat" registered fs.logical_rwbytes
[2015-06-13 20:43:54.440 UTC] INFO   module "kstat" registered memory.rss
[2015-06-13 20:43:54.440 UTC] INFO   module "kstat" registered memory.rss_limit
[2015-06-13 20:43:54.441 UTC] INFO   module "kstat" registered memory.swap
[2015-06-13 20:43:54.441 UTC] INFO   module "kstat" registered memory.swap_limit
[2015-06-13 20:43:54.441 UTC] INFO   module "kstat" registered memory.reclaimed_bytes
[2015-06-13 20:43:54.442 UTC] INFO   module "kstat" registered memory.pageins
[2015-06-13 20:43:54.442 UTC] INFO   module "kstat" registered vm.exits
[2015-06-13 20:43:54.442 UTC] INFO   module "kstat" registered zfs.arc_ops
[2015-06-13 20:43:54.442 UTC] INFO   loaded module "kstat".
[2015-06-13 20:43:54.472 UTC] INFO   module "dtrace" registered apache.httpd_ops
[2015-06-13 20:43:54.473 UTC] INFO   module "dtrace" registered cpu.thread_executions
[2015-06-13 20:43:54.475 UTC] INFO   module "dtrace" registered cpu.thread_samples
[2015-06-13 20:43:54.477 UTC] INFO   module "dtrace" registered disk.physio_ops
[2015-06-13 20:43:54.479 UTC] INFO   module "dtrace" registered fs.logical_ops
[2015-06-13 20:43:54.481 UTC] INFO   module "dtrace" registered fs.logical_rwops
[2015-06-13 20:43:54.483 UTC] INFO   module "dtrace" registered ldapjs.connections
[2015-06-13 20:43:54.486 UTC] INFO   module "dtrace" registered ldapjs.ops
[2015-06-13 20:43:54.487 UTC] INFO   module "dtrace" registered ldapjs.search_ops
[2015-06-13 20:43:54.488 UTC] INFO   module "dtrace" registered mantaop.jobs_assigned
[2015-06-13 20:43:54.489 UTC] INFO   module "dtrace" registered mantaop.supervisor_auths
[2015-06-13 20:43:54.492 UTC] INFO   module "dtrace" registered mantaop.supervisor_deletes
[2015-06-13 20:43:54.493 UTC] INFO   module "dtrace" registered mantaop.supervisor_errors
[2015-06-13 20:43:54.495 UTC] INFO   module "dtrace" registered mantaop.supervisor_locates
[2015-06-13 20:43:54.496 UTC] INFO   module "dtrace" registered mantaop.tasks_committed
[2015-06-13 20:43:54.500 UTC] INFO   module "dtrace" registered mantaop.tasks_dispatched
[2015-06-13 20:43:54.501 UTC] INFO   module "dtrace" registered mantaop.tasks_executed
[2015-06-13 20:43:54.502 UTC] INFO   module "dtrace" registered mantaop.tasks_killed
[2015-06-13 20:43:54.504 UTC] INFO   module "dtrace" registered mantaop.zone_resets
[2015-06-13 20:43:54.506 UTC] INFO   module "dtrace" registered moray.ops
[2015-06-13 20:43:54.508 UTC] INFO   module "dtrace" registered moray.queries
[2015-06-13 20:43:54.510 UTC] INFO   module "dtrace" registered mysql.commands
[2015-06-13 20:43:54.512 UTC] INFO   module "dtrace" registered mysql.connections
[2015-06-13 20:43:54.515 UTC] INFO   module "dtrace" registered mysql.filesort
[2015-06-13 20:43:54.517 UTC] INFO   module "dtrace" registered mysql.queries
[2015-06-13 20:43:54.519 UTC] INFO   module "dtrace" registered mysql.statements
[2015-06-13 20:43:54.520 UTC] INFO   module "dtrace" registered node.gc_ops
[2015-06-13 20:43:54.523 UTC] INFO   module "dtrace" registered node.httpc_ops
[2015-06-13 20:43:54.525 UTC] INFO   module "dtrace" registered node.httpd_ops
[2015-06-13 20:43:54.527 UTC] INFO   module "dtrace" registered node.socket_ops
[2015-06-13 20:43:54.529 UTC] INFO   module "dtrace" registered postgres.queries
[2015-06-13 20:43:54.530 UTC] INFO   module "dtrace" registered unix.proc_execs
[2015-06-13 20:43:54.533 UTC] INFO   module "dtrace" registered unix.proc_exits
[2015-06-13 20:43:54.534 UTC] INFO   module "dtrace" registered unix.proc_forks
[2015-06-13 20:43:54.536 UTC] INFO   module "dtrace" registered restify.handler_ops
[2015-06-13 20:43:54.539 UTC] INFO   module "dtrace" registered restify.server_ops
[2015-06-13 20:43:54.541 UTC] INFO   module "dtrace" registered syscall.syscalls
[2015-06-13 20:43:54.542 UTC] INFO   module "dtrace" registered tcp.accepts
[2015-06-13 20:43:54.544 UTC] INFO   module "dtrace" registered tcp.connects
[2015-06-13 20:43:54.545 UTC] INFO   module "dtrace" registered unix.thr_creates
[2015-06-13 20:43:54.547 UTC] INFO   module "dtrace" registered vm.irqs
[2015-06-13 20:43:54.548 UTC] INFO   module "dtrace" registered vm.physio_bytes
[2015-06-13 20:43:54.549 UTC] INFO   module "dtrace" registered vm.physio_ops
[2015-06-13 20:43:54.550 UTC] INFO   module "dtrace" registered vm.thread_samples
[2015-06-13 20:43:54.552 UTC] INFO   module "dtrace" registered zfs.arc_ops
[2015-06-13 20:43:54.552 UTC] INFO   loaded module "dtrace".
[2015-06-13 20:43:54.563 UTC] INFO   module "zfs" registered zfs.dataset_unused_quota
[2015-06-13 20:43:54.563 UTC] INFO   module "zfs" registered zfs.dataset_used
[2015-06-13 20:43:54.563 UTC] INFO   module "zfs" registered zfs.dataset_quota
[2015-06-13 20:43:54.564 UTC] INFO   module "zfs" registered zfs.pool_free
[2015-06-13 20:43:54.564 UTC] INFO   module "zfs" registered zfs.pool_used
[2015-06-13 20:43:54.564 UTC] INFO   module "zfs" registered zfs.pool_total
[2015-06-13 20:43:54.564 UTC] INFO   loaded module "zfs".
[2015-06-13 20:43:54.566 UTC] INFO   module "cainstr" registered ca.instr_ticks
[2015-06-13 20:43:54.566 UTC] INFO   module "cainstr" registered ca.instr_beops
[2015-06-13 20:43:54.566 UTC] INFO   module "cainstr" registered ca.instr_enables
[2015-06-13 20:43:54.567 UTC] INFO   module "cainstr" registered ca.instr_disables
[2015-06-13 20:43:54.567 UTC] INFO   loaded module "cainstr".
[2015-06-13 20:43:54.614 UTC] INFO   module "proc" registered unix.processes
[2015-06-13 20:43:54.614 UTC] INFO   loaded module "proc".
[2015-06-13 20:43:54.614 UTC] INFO   finished loading modules.
[2015-06-13 20:43:54.760 UTC] DBG    binding to ca.instrumenter.headnode
[2015-06-13 20:43:54.763 UTC] DBG    binding to ca.broadcast
[2015-06-13 20:43:54.765 UTC] DBG    bind to ca.instrumenter.headnode complete
[2015-06-13 20:43:54.766 UTC] DBG    bind to ca.broadcast complete
[2015-06-13 20:43:54.768 UTC] INFO   AMQP broker connected.
[2015-06-13 20:44:03.728 UTC] CRIT   CA PANIC: panic due to uncaught exception: EXCEPTION: TypeError: TypeError: Object #<Object> has no method 'appendFileSync'
    at Object.mdGenerateDScript (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-metad.js:859:9)
    at Object.impl (/opt/smartdc/agents/lib/node_modules/cabase/cmd/cainst/modules/dtrace.js:38:28)
    at caInstrService.amqpEnableInstn (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-svc-instr.js:439:22)
    at capAmqpCap.<anonymous> (native)
    at capAmqpCap.emit (events.js:88:20)
    at Object.capDispatch (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp-cap.js:203:14)
    at capAmqpCap.receive (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp-cap.js:502:31)
    at caAmqp.<anonymous> (native)
    at caAmqp.emit (events.js:67:17)
    at caAmqp.receive (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp.js:367:7)
[2015-06-13 20:44:03.729 UTC] CRIT   writing core dump to /opt/smartdc/agents/lib/node_modules/cabase/cacore.16887
[2015-06-13 20:44:03.794 UTC] CRIT   finished writing core dump
[ Jun 13 20:44:03 Stopping because all processes in service exited. ]
[ Jun 13 20:44:03 Executing stop method (:kill). ]
[ Jun 13 20:44:03 Executing start method ("/opt/smartdc/agents/lib/node_modules/cabase/smf/method/canodesvc"). ]
DTRACE_LIBPATH=/opt/smartdc/agents/lib/node_modules/cabase/lib
ignoring amqp-config key amqp_login
ignoring amqp-config key amqp_password
AMQP_HOST=10.99.99.20
AMQP_PORT=5672
NODE_PATH=:/opt/smartdc/agents/lib/node_modules/cabase/node_modules:/opt/smartdc/agents/lib/node_modules/cabase/node_modules/connect/lib:/opt/smartdc/agents/lib/node_modules/cabase/lib/ca:/opt/smartdc/agents/lib/node_modules/cabase/lib/tst
[ Jun 13 20:44:04 Method "start" exited with status 0. ]
The "sys" module is now called "util". It should have a similar interface.
using backends kstat,dtrace,zfs,cainstr,proc
[2015-06-13 20:44:04.386 UTC] INFO   Logging AMQP message to "/opt/smartdc/agents/log/ca/cainstsvc/amqp-2015-06-13.20:44:03.16903"
[2015-06-13 20:44:04.387 UTC] INFO   Instrumenter starting up (instsvc/0.0)
[2015-06-13 20:44:04.387 UTC] INFO   Hostname:    headnode
[2015-06-13 20:44:04.388 UTC] INFO   AMQP broker: {"host":"10.99.99.20","port":"5672"}
[2015-06-13 20:44:04.389 UTC] INFO   Routing key: ca.instrumenter.headnode
[2015-06-13 20:44:04.391 UTC] DBG    loaded metadata file "metadata/profile/operator.json"
[2015-06-13 20:44:04.392 UTC] DBG    loaded metadata file "metadata/profile/customer.json"
[2015-06-13 20:44:04.393 UTC] DBG    loaded metadata file "metadata/metric/metrics.json"
[2015-06-13 20:44:04.407 UTC] INFO   loading modules.
[2015-06-13 20:44:04.417 UTC] INFO   module "kstat" registered cpu.cpus
[2015-06-13 20:44:04.417 UTC] INFO   module "kstat" registered cpu.usage
[2015-06-13 20:44:04.418 UTC] INFO   module "kstat" registered cpu.waittime
[2015-06-13 20:44:04.418 UTC] INFO   module "kstat" registered cpu.loadavg1
[2015-06-13 20:44:04.418 UTC] INFO   module "kstat" registered nic.nics
[2015-06-13 20:44:04.419 UTC] INFO   module "kstat" registered nic.bytes
[2015-06-13 20:44:04.419 UTC] INFO   module "kstat" registered nic.packets
[2015-06-13 20:44:04.419 UTC] INFO   module "kstat" registered nic.vnic_bytes
[2015-06-13 20:44:04.420 UTC] INFO   module "kstat" registered nic.vnic_packets
[2015-06-13 20:44:04.420 UTC] INFO   module "kstat" registered disk.disks
[2015-06-13 20:44:04.420 UTC] INFO   module "kstat" registered disk.physio_ops
[2015-06-13 20:44:04.420 UTC] INFO   module "kstat" registered disk.physio_bytes
[2015-06-13 20:44:04.421 UTC] INFO   module "kstat" registered tcp.segments
[2015-06-13 20:44:04.421 UTC] INFO   module "kstat" registered tcp.errors
[2015-06-13 20:44:04.421 UTC] INFO   module "kstat" registered fs.logical_rwops
[2015-06-13 20:44:04.422 UTC] INFO   module "kstat" registered fs.logical_rwbytes
[2015-06-13 20:44:04.422 UTC] INFO   module "kstat" registered memory.rss
[2015-06-13 20:44:04.422 UTC] INFO   module "kstat" registered memory.rss_limit
[2015-06-13 20:44:04.422 UTC] INFO   module "kstat" registered memory.swap
[2015-06-13 20:44:04.422 UTC] INFO   module "kstat" registered memory.swap_limit
[2015-06-13 20:44:04.422 UTC] INFO   module "kstat" registered memory.reclaimed_bytes
[2015-06-13 20:44:04.423 UTC] INFO   module "kstat" registered memory.pageins
[2015-06-13 20:44:04.423 UTC] INFO   module "kstat" registered vm.exits
[2015-06-13 20:44:04.423 UTC] INFO   module "kstat" registered zfs.arc_ops
[2015-06-13 20:44:04.423 UTC] INFO   loaded module "kstat".
[2015-06-13 20:44:04.451 UTC] INFO   module "dtrace" registered apache.httpd_ops
[2015-06-13 20:44:04.453 UTC] INFO   module "dtrace" registered cpu.thread_executions
[2015-06-13 20:44:04.454 UTC] INFO   module "dtrace" registered cpu.thread_samples
[2015-06-13 20:44:04.455 UTC] INFO   module "dtrace" registered disk.physio_ops
[2015-06-13 20:44:04.458 UTC] INFO   module "dtrace" registered fs.logical_ops
[2015-06-13 20:44:04.461 UTC] INFO   module "dtrace" registered fs.logical_rwops
[2015-06-13 20:44:04.462 UTC] INFO   module "dtrace" registered ldapjs.connections
[2015-06-13 20:44:04.465 UTC] INFO   module "dtrace" registered ldapjs.ops
[2015-06-13 20:44:04.467 UTC] INFO   module "dtrace" registered ldapjs.search_ops
[2015-06-13 20:44:04.468 UTC] INFO   module "dtrace" registered mantaop.jobs_assigned
[2015-06-13 20:44:04.469 UTC] INFO   module "dtrace" registered mantaop.supervisor_auths
[2015-06-13 20:44:04.470 UTC] INFO   module "dtrace" registered mantaop.supervisor_deletes
[2015-06-13 20:44:04.471 UTC] INFO   module "dtrace" registered mantaop.supervisor_errors
[2015-06-13 20:44:04.473 UTC] INFO   module "dtrace" registered mantaop.supervisor_locates
[2015-06-13 20:44:04.473 UTC] INFO   module "dtrace" registered mantaop.tasks_committed
[2015-06-13 20:44:04.474 UTC] INFO   module "dtrace" registered mantaop.tasks_dispatched
[2015-06-13 20:44:04.475 UTC] INFO   module "dtrace" registered mantaop.tasks_executed
[2015-06-13 20:44:04.476 UTC] INFO   module "dtrace" registered mantaop.tasks_killed
[2015-06-13 20:44:04.477 UTC] INFO   module "dtrace" registered mantaop.zone_resets
[2015-06-13 20:44:04.478 UTC] INFO   module "dtrace" registered moray.ops
[2015-06-13 20:44:04.480 UTC] INFO   module "dtrace" registered moray.queries
[2015-06-13 20:44:04.481 UTC] INFO   module "dtrace" registered mysql.commands
[2015-06-13 20:44:04.482 UTC] INFO   module "dtrace" registered mysql.connections
[2015-06-13 20:44:04.483 UTC] INFO   module "dtrace" registered mysql.filesort
[2015-06-13 20:44:04.485 UTC] INFO   module "dtrace" registered mysql.queries
[2015-06-13 20:44:04.487 UTC] INFO   module "dtrace" registered mysql.statements
[2015-06-13 20:44:04.489 UTC] INFO   module "dtrace" registered node.gc_ops
[2015-06-13 20:44:04.491 UTC] INFO   module "dtrace" registered node.httpc_ops
[2015-06-13 20:44:04.493 UTC] INFO   module "dtrace" registered node.httpd_ops
[2015-06-13 20:44:04.494 UTC] INFO   module "dtrace" registered node.socket_ops
[2015-06-13 20:44:04.495 UTC] INFO   module "dtrace" registered postgres.queries
[2015-06-13 20:44:04.496 UTC] INFO   module "dtrace" registered unix.proc_execs
[2015-06-13 20:44:04.498 UTC] INFO   module "dtrace" registered unix.proc_exits
[2015-06-13 20:44:04.499 UTC] INFO   module "dtrace" registered unix.proc_forks
[2015-06-13 20:44:04.500 UTC] INFO   module "dtrace" registered restify.handler_ops
[2015-06-13 20:44:04.501 UTC] INFO   module "dtrace" registered restify.server_ops
[2015-06-13 20:44:04.504 UTC] INFO   module "dtrace" registered syscall.syscalls
[2015-06-13 20:44:04.505 UTC] INFO   module "dtrace" registered tcp.accepts
[2015-06-13 20:44:04.507 UTC] INFO   module "dtrace" registered tcp.connects
[2015-06-13 20:44:04.508 UTC] INFO   module "dtrace" registered unix.thr_creates
[2015-06-13 20:44:04.509 UTC] INFO   module "dtrace" registered vm.irqs
[2015-06-13 20:44:04.511 UTC] INFO   module "dtrace" registered vm.physio_bytes
[2015-06-13 20:44:04.513 UTC] INFO   module "dtrace" registered vm.physio_ops
[2015-06-13 20:44:04.514 UTC] INFO   module "dtrace" registered vm.thread_samples
[2015-06-13 20:44:04.516 UTC] INFO   module "dtrace" registered zfs.arc_ops
[2015-06-13 20:44:04.516 UTC] INFO   loaded module "dtrace".
[2015-06-13 20:44:04.527 UTC] INFO   module "zfs" registered zfs.dataset_unused_quota
[2015-06-13 20:44:04.527 UTC] INFO   module "zfs" registered zfs.dataset_used
[2015-06-13 20:44:04.527 UTC] INFO   module "zfs" registered zfs.dataset_quota
[2015-06-13 20:44:04.528 UTC] INFO   module "zfs" registered zfs.pool_free
[2015-06-13 20:44:04.528 UTC] INFO   module "zfs" registered zfs.pool_used
[2015-06-13 20:44:04.528 UTC] INFO   module "zfs" registered zfs.pool_total
[2015-06-13 20:44:04.528 UTC] INFO   loaded module "zfs".
[2015-06-13 20:44:04.530 UTC] INFO   module "cainstr" registered ca.instr_ticks
[2015-06-13 20:44:04.530 UTC] INFO   module "cainstr" registered ca.instr_beops
[2015-06-13 20:44:04.531 UTC] INFO   module "cainstr" registered ca.instr_enables
[2015-06-13 20:44:04.531 UTC] INFO   module "cainstr" registered ca.instr_disables
[2015-06-13 20:44:04.531 UTC] INFO   loaded module "cainstr".
[2015-06-13 20:44:04.570 UTC] INFO   module "proc" registered unix.processes
[2015-06-13 20:44:04.570 UTC] INFO   loaded module "proc".
[2015-06-13 20:44:04.570 UTC] INFO   finished loading modules.
[2015-06-13 20:44:04.704 UTC] DBG    binding to ca.instrumenter.headnode
[2015-06-13 20:44:04.705 UTC] DBG    binding to ca.broadcast
[2015-06-13 20:44:04.707 UTC] DBG    bind to ca.instrumenter.headnode complete
[2015-06-13 20:44:04.708 UTC] DBG    bind to ca.broadcast complete
[2015-06-13 20:44:04.708 UTC] INFO   AMQP broker connected.
[2015-06-13 20:44:13.734 UTC] CRIT   CA PANIC: panic due to uncaught exception: EXCEPTION: TypeError: TypeError: Object #<Object> has no method 'appendFileSync'
    at Object.mdGenerateDScript (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-metad.js:859:9)
    at Object.impl (/opt/smartdc/agents/lib/node_modules/cabase/cmd/cainst/modules/dtrace.js:38:28)
    at caInstrService.amqpEnableInstn (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-svc-instr.js:439:22)
    at capAmqpCap.<anonymous> (native)
    at capAmqpCap.emit (events.js:88:20)
    at Object.capDispatch (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp-cap.js:203:14)
    at capAmqpCap.receive (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp-cap.js:502:31)
    at caAmqp.<anonymous> (native)
    at caAmqp.emit (events.js:67:17)
    at caAmqp.receive (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp.js:367:7)
[2015-06-13 20:44:13.735 UTC] CRIT   writing core dump to /opt/smartdc/agents/lib/node_modules/cabase/cacore.16931
[2015-06-13 20:44:13.804 UTC] CRIT   finished writing core dump
[ Jun 13 20:44:13 Stopping because all processes in service exited. ]
[ Jun 13 20:44:13 Executing stop method (:kill). ]
[ Jun 13 20:44:13 Executing start method ("/opt/smartdc/agents/lib/node_modules/cabase/smf/method/canodesvc"). ]
DTRACE_LIBPATH=/opt/smartdc/agents/lib/node_modules/cabase/lib
ignoring amqp-config key amqp_login
ignoring amqp-config key amqp_password
AMQP_HOST=10.99.99.20
AMQP_PORT=5672
NODE_PATH=:/opt/smartdc/agents/lib/node_modules/cabase/node_modules:/opt/smartdc/agents/lib/node_modules/cabase/node_modules/connect/lib:/opt/smartdc/agents/lib/node_modules/cabase/lib/ca:/opt/smartdc/agents/lib/node_modules/cabase/lib/tst
[ Jun 13 20:44:14 Method "start" exited with status 0. ]
The "sys" module is now called "util". It should have a similar interface.
using backends kstat,dtrace,zfs,cainstr,proc
[2015-06-13 20:44:14.435 UTC] INFO   Logging AMQP message to "/opt/smartdc/agents/log/ca/cainstsvc/amqp-2015-06-13.20:44:13.16941"
[2015-06-13 20:44:14.436 UTC] INFO   Instrumenter starting up (instsvc/0.0)
[2015-06-13 20:44:14.437 UTC] INFO   Hostname:    headnode
[2015-06-13 20:44:14.437 UTC] INFO   AMQP broker: {"host":"10.99.99.20","port":"5672"}
[2015-06-13 20:44:14.437 UTC] INFO   Routing key: ca.instrumenter.headnode
[2015-06-13 20:44:14.447 UTC] DBG    loaded metadata file "metadata/profile/customer.json"
[2015-06-13 20:44:14.448 UTC] DBG    loaded metadata file "metadata/metric/metrics.json"
[2015-06-13 20:44:14.450 UTC] DBG    loaded metadata file "metadata/profile/operator.json"
[2015-06-13 20:44:14.463 UTC] INFO   loading modules.
[2015-06-13 20:44:14.474 UTC] INFO   module "kstat" registered cpu.cpus
[2015-06-13 20:44:14.475 UTC] INFO   module "kstat" registered cpu.usage
[2015-06-13 20:44:14.475 UTC] INFO   module "kstat" registered cpu.waittime
[2015-06-13 20:44:14.476 UTC] INFO   module "kstat" registered cpu.loadavg1
[2015-06-13 20:44:14.476 UTC] INFO   module "kstat" registered nic.nics
[2015-06-13 20:44:14.476 UTC] INFO   module "kstat" registered nic.bytes
[2015-06-13 20:44:14.477 UTC] INFO   module "kstat" registered nic.packets
[2015-06-13 20:44:14.477 UTC] INFO   module "kstat" registered nic.vnic_bytes
[2015-06-13 20:44:14.477 UTC] INFO   module "kstat" registered nic.vnic_packets
[2015-06-13 20:44:14.478 UTC] INFO   module "kstat" registered disk.disks
[2015-06-13 20:44:14.478 UTC] INFO   module "kstat" registered disk.physio_ops
[2015-06-13 20:44:14.479 UTC] INFO   module "kstat" registered disk.physio_bytes
[2015-06-13 20:44:14.479 UTC] INFO   module "kstat" registered tcp.segments
[2015-06-13 20:44:14.479 UTC] INFO   module "kstat" registered tcp.errors
[2015-06-13 20:44:14.480 UTC] INFO   module "kstat" registered fs.logical_rwops
[2015-06-13 20:44:14.480 UTC] INFO   module "kstat" registered fs.logical_rwbytes
[2015-06-13 20:44:14.480 UTC] INFO   module "kstat" registered memory.rss
[2015-06-13 20:44:14.481 UTC] INFO   module "kstat" registered memory.rss_limit
[2015-06-13 20:44:14.481 UTC] INFO   module "kstat" registered memory.swap
[2015-06-13 20:44:14.482 UTC] INFO   module "kstat" registered memory.swap_limit
[2015-06-13 20:44:14.482 UTC] INFO   module "kstat" registered memory.reclaimed_bytes
[2015-06-13 20:44:14.483 UTC] INFO   module "kstat" registered memory.pageins
[2015-06-13 20:44:14.483 UTC] INFO   module "kstat" registered vm.exits
[2015-06-13 20:44:14.484 UTC] INFO   module "kstat" registered zfs.arc_ops
[2015-06-13 20:44:14.484 UTC] INFO   loaded module "kstat".
[2015-06-13 20:44:14.512 UTC] INFO   module "dtrace" registered apache.httpd_ops
[2015-06-13 20:44:14.514 UTC] INFO   module "dtrace" registered cpu.thread_executions
[2015-06-13 20:44:14.515 UTC] INFO   module "dtrace" registered cpu.thread_samples
[2015-06-13 20:44:14.516 UTC] INFO   module "dtrace" registered disk.physio_ops
[2015-06-13 20:44:14.519 UTC] INFO   module "dtrace" registered fs.logical_ops
[2015-06-13 20:44:14.521 UTC] INFO   module "dtrace" registered fs.logical_rwops
[2015-06-13 20:44:14.521 UTC] INFO   module "dtrace" registered ldapjs.connections
[2015-06-13 20:44:14.524 UTC] INFO   module "dtrace" registered ldapjs.ops
[2015-06-13 20:44:14.526 UTC] INFO   module "dtrace" registered ldapjs.search_ops
[2015-06-13 20:44:14.527 UTC] INFO   module "dtrace" registered mantaop.jobs_assigned
[2015-06-13 20:44:14.528 UTC] INFO   module "dtrace" registered mantaop.supervisor_auths
[2015-06-13 20:44:14.530 UTC] INFO   module "dtrace" registered mantaop.supervisor_deletes
[2015-06-13 20:44:14.531 UTC] INFO   module "dtrace" registered mantaop.supervisor_errors
[2015-06-13 20:44:14.532 UTC] INFO   module "dtrace" registered mantaop.supervisor_locates
[2015-06-13 20:44:14.533 UTC] INFO   module "dtrace" registered mantaop.tasks_committed
[2015-06-13 20:44:14.534 UTC] INFO   module "dtrace" registered mantaop.tasks_dispatched
[2015-06-13 20:44:14.536 UTC] INFO   module "dtrace" registered mantaop.tasks_executed
[2015-06-13 20:44:14.537 UTC] INFO   module "dtrace" registered mantaop.tasks_killed
[2015-06-13 20:44:14.539 UTC] INFO   module "dtrace" registered mantaop.zone_resets
[2015-06-13 20:44:14.541 UTC] INFO   module "dtrace" registered moray.ops
[2015-06-13 20:44:14.542 UTC] INFO   module "dtrace" registered moray.queries
[2015-06-13 20:44:14.544 UTC] INFO   module "dtrace" registered mysql.commands
[2015-06-13 20:44:14.545 UTC] INFO   module "dtrace" registered mysql.connections
[2015-06-13 20:44:14.546 UTC] INFO   module "dtrace" registered mysql.filesort
[2015-06-13 20:44:14.548 UTC] INFO   module "dtrace" registered mysql.queries
[2015-06-13 20:44:14.550 UTC] INFO   module "dtrace" registered mysql.statements
[2015-06-13 20:44:14.551 UTC] INFO   module "dtrace" registered node.gc_ops
[2015-06-13 20:44:14.553 UTC] INFO   module "dtrace" registered node.httpc_ops
[2015-06-13 20:44:14.555 UTC] INFO   module "dtrace" registered node.httpd_ops
[2015-06-13 20:44:14.557 UTC] INFO   module "dtrace" registered node.socket_ops
[2015-06-13 20:44:14.558 UTC] INFO   module "dtrace" registered postgres.queries
[2015-06-13 20:44:14.559 UTC] INFO   module "dtrace" registered unix.proc_execs
[2015-06-13 20:44:14.560 UTC] INFO   module "dtrace" registered unix.proc_exits
[2015-06-13 20:44:14.562 UTC] INFO   module "dtrace" registered unix.proc_forks
[2015-06-13 20:44:14.563 UTC] INFO   module "dtrace" registered restify.handler_ops
[2015-06-13 20:44:14.565 UTC] INFO   module "dtrace" registered restify.server_ops
[2015-06-13 20:44:14.567 UTC] INFO   module "dtrace" registered syscall.syscalls
[2015-06-13 20:44:14.568 UTC] INFO   module "dtrace" registered tcp.accepts
[2015-06-13 20:44:14.570 UTC] INFO   module "dtrace" registered tcp.connects
[2015-06-13 20:44:14.571 UTC] INFO   module "dtrace" registered unix.thr_creates
[2015-06-13 20:44:14.572 UTC] INFO   module "dtrace" registered vm.irqs
[2015-06-13 20:44:14.573 UTC] INFO   module "dtrace" registered vm.physio_bytes
[2015-06-13 20:44:14.574 UTC] INFO   module "dtrace" registered vm.physio_ops
[2015-06-13 20:44:14.575 UTC] INFO   module "dtrace" registered vm.thread_samples
[2015-06-13 20:44:14.576 UTC] INFO   module "dtrace" registered zfs.arc_ops
[2015-06-13 20:44:14.576 UTC] INFO   loaded module "dtrace".
[2015-06-13 20:44:14.584 UTC] INFO   module "zfs" registered zfs.dataset_unused_quota
[2015-06-13 20:44:14.584 UTC] INFO   module "zfs" registered zfs.dataset_used
[2015-06-13 20:44:14.584 UTC] INFO   module "zfs" registered zfs.dataset_quota
[2015-06-13 20:44:14.584 UTC] INFO   module "zfs" registered zfs.pool_free
[2015-06-13 20:44:14.584 UTC] INFO   module "zfs" registered zfs.pool_used
[2015-06-13 20:44:14.585 UTC] INFO   module "zfs" registered zfs.pool_total
[2015-06-13 20:44:14.585 UTC] INFO   loaded module "zfs".
[2015-06-13 20:44:14.587 UTC] INFO   module "cainstr" registered ca.instr_ticks
[2015-06-13 20:44:14.587 UTC] INFO   module "cainstr" registered ca.instr_beops
[2015-06-13 20:44:14.587 UTC] INFO   module "cainstr" registered ca.instr_enables
[2015-06-13 20:44:14.588 UTC] INFO   module "cainstr" registered ca.instr_disables
[2015-06-13 20:44:14.588 UTC] INFO   loaded module "cainstr".
[2015-06-13 20:44:14.638 UTC] INFO   module "proc" registered unix.processes
[2015-06-13 20:44:14.638 UTC] INFO   loaded module "proc".
[2015-06-13 20:44:14.638 UTC] INFO   finished loading modules.
[2015-06-13 20:44:14.789 UTC] DBG    binding to ca.instrumenter.headnode
[2015-06-13 20:44:14.792 UTC] DBG    binding to ca.broadcast
[2015-06-13 20:44:14.800 UTC] DBG    bind to ca.instrumenter.headnode complete
[2015-06-13 20:44:14.801 UTC] DBG    bind to ca.broadcast complete
[2015-06-13 20:44:14.801 UTC] INFO   AMQP broker connected.
[2015-06-13 20:44:23.744 UTC] CRIT   CA PANIC: panic due to uncaught exception: EXCEPTION: TypeError: TypeError: Object #<Object> has no method 'appendFileSync'
    at Object.mdGenerateDScript (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-metad.js:859:9)
    at Object.impl (/opt/smartdc/agents/lib/node_modules/cabase/cmd/cainst/modules/dtrace.js:38:28)
    at caInstrService.amqpEnableInstn (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-svc-instr.js:439:22)
    at capAmqpCap.<anonymous> (native)
    at capAmqpCap.emit (events.js:88:20)
    at Object.capDispatch (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp-cap.js:203:14)
    at capAmqpCap.receive (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp-cap.js:502:31)
    at caAmqp.<anonymous> (native)
    at caAmqp.emit (events.js:67:17)
    at caAmqp.receive (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp.js:367:7)
[2015-06-13 20:44:23.744 UTC] CRIT   writing core dump to /opt/smartdc/agents/lib/node_modules/cabase/cacore.16969
[2015-06-13 20:44:23.813 UTC] CRIT   finished writing core dump
[ Jun 13 20:44:23 Stopping because all processes in service exited. ]
[ Jun 13 20:44:23 Executing stop method (:kill). ]
[ Jun 13 20:44:23 Executing start method ("/opt/smartdc/agents/lib/node_modules/cabase/smf/method/canodesvc"). ]
DTRACE_LIBPATH=/opt/smartdc/agents/lib/node_modules/cabase/lib
ignoring amqp-config key amqp_login
ignoring amqp-config key amqp_password
AMQP_HOST=10.99.99.20
AMQP_PORT=5672
NODE_PATH=:/opt/smartdc/agents/lib/node_modules/cabase/node_modules:/opt/smartdc/agents/lib/node_modules/cabase/node_modules/connect/lib:/opt/smartdc/agents/lib/node_modules/cabase/lib/ca:/opt/smartdc/agents/lib/node_modules/cabase/lib/tst
[ Jun 13 20:44:24 Method "start" exited with status 0. ]
The "sys" module is now called "util". It should have a similar interface.
using backends kstat,dtrace,zfs,cainstr,proc
[2015-06-13 20:44:24.401 UTC] INFO   Logging AMQP message to "/opt/smartdc/agents/log/ca/cainstsvc/amqp-2015-06-13.20:44:23.16973"
[2015-06-13 20:44:24.402 UTC] INFO   Instrumenter starting up (instsvc/0.0)
[2015-06-13 20:44:24.403 UTC] INFO   Hostname:    headnode
[2015-06-13 20:44:24.403 UTC] INFO   AMQP broker: {"host":"10.99.99.20","port":"5672"}
[2015-06-13 20:44:24.403 UTC] INFO   Routing key: ca.instrumenter.headnode
[2015-06-13 20:44:24.408 UTC] DBG    loaded metadata file "metadata/profile/operator.json"
[2015-06-13 20:44:24.408 UTC] DBG    loaded metadata file "metadata/profile/customer.json"
[2015-06-13 20:44:24.409 UTC] DBG    loaded metadata file "metadata/metric/metrics.json"
[2015-06-13 20:44:24.422 UTC] INFO   loading modules.
[2015-06-13 20:44:24.432 UTC] INFO   module "kstat" registered cpu.cpus
[2015-06-13 20:44:24.432 UTC] INFO   module "kstat" registered cpu.usage
[2015-06-13 20:44:24.433 UTC] INFO   module "kstat" registered cpu.waittime
[2015-06-13 20:44:24.433 UTC] INFO   module "kstat" registered cpu.loadavg1
[2015-06-13 20:44:24.433 UTC] INFO   module "kstat" registered nic.nics
[2015-06-13 20:44:24.433 UTC] INFO   module "kstat" registered nic.bytes
[2015-06-13 20:44:24.433 UTC] INFO   module "kstat" registered nic.packets
[2015-06-13 20:44:24.433 UTC] INFO   module "kstat" registered nic.vnic_bytes
[2015-06-13 20:44:24.434 UTC] INFO   module "kstat" registered nic.vnic_packets
[2015-06-13 20:44:24.434 UTC] INFO   module "kstat" registered disk.disks
[2015-06-13 20:44:24.434 UTC] INFO   module "kstat" registered disk.physio_ops
[2015-06-13 20:44:24.434 UTC] INFO   module "kstat" registered disk.physio_bytes
[2015-06-13 20:44:24.434 UTC] INFO   module "kstat" registered tcp.segments
[2015-06-13 20:44:24.434 UTC] INFO   module "kstat" registered tcp.errors
[2015-06-13 20:44:24.434 UTC] INFO   module "kstat" registered fs.logical_rwops
[2015-06-13 20:44:24.435 UTC] INFO   module "kstat" registered fs.logical_rwbytes
[2015-06-13 20:44:24.435 UTC] INFO   module "kstat" registered memory.rss
[2015-06-13 20:44:24.435 UTC] INFO   module "kstat" registered memory.rss_limit
[2015-06-13 20:44:24.435 UTC] INFO   module "kstat" registered memory.swap
[2015-06-13 20:44:24.435 UTC] INFO   module "kstat" registered memory.swap_limit
[2015-06-13 20:44:24.435 UTC] INFO   module "kstat" registered memory.reclaimed_bytes
[2015-06-13 20:44:24.436 UTC] INFO   module "kstat" registered memory.pageins
[2015-06-13 20:44:24.436 UTC] INFO   module "kstat" registered vm.exits
[2015-06-13 20:44:24.436 UTC] INFO   module "kstat" registered zfs.arc_ops
[2015-06-13 20:44:24.436 UTC] INFO   loaded module "kstat".
[2015-06-13 20:44:24.463 UTC] INFO   module "dtrace" registered apache.httpd_ops
[2015-06-13 20:44:24.464 UTC] INFO   module "dtrace" registered cpu.thread_executions
[2015-06-13 20:44:24.465 UTC] INFO   module "dtrace" registered cpu.thread_samples
[2015-06-13 20:44:24.466 UTC] INFO   module "dtrace" registered disk.physio_ops
[2015-06-13 20:44:24.468 UTC] INFO   module "dtrace" registered fs.logical_ops
[2015-06-13 20:44:24.469 UTC] INFO   module "dtrace" registered fs.logical_rwops
[2015-06-13 20:44:24.470 UTC] INFO   module "dtrace" registered ldapjs.connections
[2015-06-13 20:44:24.472 UTC] INFO   module "dtrace" registered ldapjs.ops
[2015-06-13 20:44:24.474 UTC] INFO   module "dtrace" registered ldapjs.search_ops
[2015-06-13 20:44:24.474 UTC] INFO   module "dtrace" registered mantaop.jobs_assigned
[2015-06-13 20:44:24.475 UTC] INFO   module "dtrace" registered mantaop.supervisor_auths
[2015-06-13 20:44:24.476 UTC] INFO   module "dtrace" registered mantaop.supervisor_deletes
[2015-06-13 20:44:24.476 UTC] INFO   module "dtrace" registered mantaop.supervisor_errors
[2015-06-13 20:44:24.477 UTC] INFO   module "dtrace" registered mantaop.supervisor_locates
[2015-06-13 20:44:24.478 UTC] INFO   module "dtrace" registered mantaop.tasks_committed
[2015-06-13 20:44:24.479 UTC] INFO   module "dtrace" registered mantaop.tasks_dispatched
[2015-06-13 20:44:24.480 UTC] INFO   module "dtrace" registered mantaop.tasks_executed
[2015-06-13 20:44:24.481 UTC] INFO   module "dtrace" registered mantaop.tasks_killed
[2015-06-13 20:44:24.481 UTC] INFO   module "dtrace" registered mantaop.zone_resets
[2015-06-13 20:44:24.483 UTC] INFO   module "dtrace" registered moray.ops
[2015-06-13 20:44:24.484 UTC] INFO   module "dtrace" registered moray.queries
[2015-06-13 20:44:24.485 UTC] INFO   module "dtrace" registered mysql.commands
[2015-06-13 20:44:24.486 UTC] INFO   module "dtrace" registered mysql.connections
[2015-06-13 20:44:24.487 UTC] INFO   module "dtrace" registered mysql.filesort
[2015-06-13 20:44:24.489 UTC] INFO   module "dtrace" registered mysql.queries
[2015-06-13 20:44:24.490 UTC] INFO   module "dtrace" registered mysql.statements
[2015-06-13 20:44:24.492 UTC] INFO   module "dtrace" registered node.gc_ops
[2015-06-13 20:44:24.493 UTC] INFO   module "dtrace" registered node.httpc_ops
[2015-06-13 20:44:24.495 UTC] INFO   module "dtrace" registered node.httpd_ops
[2015-06-13 20:44:24.496 UTC] INFO   module "dtrace" registered node.socket_ops
[2015-06-13 20:44:24.497 UTC] INFO   module "dtrace" registered postgres.queries
[2015-06-13 20:44:24.498 UTC] INFO   module "dtrace" registered unix.proc_execs
[2015-06-13 20:44:24.499 UTC] INFO   module "dtrace" registered unix.proc_exits
[2015-06-13 20:44:24.500 UTC] INFO   module "dtrace" registered unix.proc_forks
[2015-06-13 20:44:24.501 UTC] INFO   module "dtrace" registered restify.handler_ops
[2015-06-13 20:44:24.502 UTC] INFO   module "dtrace" registered restify.server_ops
[2015-06-13 20:44:24.503 UTC] INFO   module "dtrace" registered syscall.syscalls
[2015-06-13 20:44:24.505 UTC] INFO   module "dtrace" registered tcp.accepts
[2015-06-13 20:44:24.506 UTC] INFO   module "dtrace" registered tcp.connects
[2015-06-13 20:44:24.507 UTC] INFO   module "dtrace" registered unix.thr_creates
[2015-06-13 20:44:24.508 UTC] INFO   module "dtrace" registered vm.irqs
[2015-06-13 20:44:24.509 UTC] INFO   module "dtrace" registered vm.physio_bytes
[2015-06-13 20:44:24.510 UTC] INFO   module "dtrace" registered vm.physio_ops
[2015-06-13 20:44:24.511 UTC] INFO   module "dtrace" registered vm.thread_samples
[2015-06-13 20:44:24.512 UTC] INFO   module "dtrace" registered zfs.arc_ops
[2015-06-13 20:44:24.512 UTC] INFO   loaded module "dtrace".
[2015-06-13 20:44:24.520 UTC] INFO   module "zfs" registered zfs.dataset_unused_quota
[2015-06-13 20:44:24.521 UTC] INFO   module "zfs" registered zfs.dataset_used
[2015-06-13 20:44:24.521 UTC] INFO   module "zfs" registered zfs.dataset_quota
[2015-06-13 20:44:24.521 UTC] INFO   module "zfs" registered zfs.pool_free
[2015-06-13 20:44:24.521 UTC] INFO   module "zfs" registered zfs.pool_used
[2015-06-13 20:44:24.521 UTC] INFO   module "zfs" registered zfs.pool_total
[2015-06-13 20:44:24.521 UTC] INFO   loaded module "zfs".
[2015-06-13 20:44:24.522 UTC] INFO   module "cainstr" registered ca.instr_ticks
[2015-06-13 20:44:24.523 UTC] INFO   module "cainstr" registered ca.instr_beops
[2015-06-13 20:44:24.523 UTC] INFO   module "cainstr" registered ca.instr_enables
[2015-06-13 20:44:24.523 UTC] INFO   module "cainstr" registered ca.instr_disables
[2015-06-13 20:44:24.523 UTC] INFO   loaded module "cainstr".
[2015-06-13 20:44:24.562 UTC] INFO   module "proc" registered unix.processes
[2015-06-13 20:44:24.562 UTC] INFO   loaded module "proc".
[2015-06-13 20:44:24.562 UTC] INFO   finished loading modules.
[2015-06-13 20:44:24.697 UTC] DBG    binding to ca.instrumenter.headnode
[2015-06-13 20:44:24.702 UTC] DBG    binding to ca.broadcast
[2015-06-13 20:44:24.705 UTC] DBG    bind to ca.instrumenter.headnode complete
[2015-06-13 20:44:24.705 UTC] DBG    bind to ca.broadcast complete
[2015-06-13 20:44:24.705 UTC] INFO   AMQP broker connected.
[2015-06-13 20:44:33.740 UTC] CRIT   CA PANIC: panic due to uncaught exception: EXCEPTION: TypeError: TypeError: Object #<Object> has no method 'appendFileSync'
    at Object.mdGenerateDScript (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-metad.js:859:9)
    at Object.impl (/opt/smartdc/agents/lib/node_modules/cabase/cmd/cainst/modules/dtrace.js:38:28)
    at caInstrService.amqpEnableInstn (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-svc-instr.js:439:22)
    at capAmqpCap.<anonymous> (native)
    at capAmqpCap.emit (events.js:88:20)
    at Object.capDispatch (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp-cap.js:203:14)
    at capAmqpCap.receive (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp-cap.js:502:31)
    at caAmqp.<anonymous> (native)
    at caAmqp.emit (events.js:67:17)
    at caAmqp.receive (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp.js:367:7)
[2015-06-13 20:44:33.740 UTC] CRIT   writing core dump to /opt/smartdc/agents/lib/node_modules/cabase/cacore.17001
[2015-06-13 20:44:33.808 UTC] CRIT   finished writing core dump
[ Jun 13 20:44:33 Stopping because all processes in service exited. ]
[ Jun 13 20:44:33 Executing stop method (:kill). ]
[ Jun 13 20:44:33 Executing start method ("/opt/smartdc/agents/lib/node_modules/cabase/smf/method/canodesvc"). ]
DTRACE_LIBPATH=/opt/smartdc/agents/lib/node_modules/cabase/lib
ignoring amqp-config key amqp_login
ignoring amqp-config key amqp_password
AMQP_HOST=10.99.99.20
AMQP_PORT=5672
NODE_PATH=:/opt/smartdc/agents/lib/node_modules/cabase/node_modules:/opt/smartdc/agents/lib/node_modules/cabase/node_modules/connect/lib:/opt/smartdc/agents/lib/node_modules/cabase/lib/ca:/opt/smartdc/agents/lib/node_modules/cabase/lib/tst
[ Jun 13 20:44:34 Method "start" exited with status 0. ]
The "sys" module is now called "util". It should have a similar interface.
using backends kstat,dtrace,zfs,cainstr,proc
[2015-06-13 20:44:34.409 UTC] INFO   Logging AMQP message to "/opt/smartdc/agents/log/ca/cainstsvc/amqp-2015-06-13.20:44:33.17005"
[2015-06-13 20:44:34.411 UTC] INFO   Instrumenter starting up (instsvc/0.0)
[2015-06-13 20:44:34.411 UTC] INFO   Hostname:    headnode
[2015-06-13 20:44:34.411 UTC] INFO   AMQP broker: {"host":"10.99.99.20","port":"5672"}
[2015-06-13 20:44:34.411 UTC] INFO   Routing key: ca.instrumenter.headnode
[2015-06-13 20:44:34.418 UTC] DBG    loaded metadata file "metadata/profile/operator.json"
[2015-06-13 20:44:34.419 UTC] DBG    loaded metadata file "metadata/profile/customer.json"
[2015-06-13 20:44:34.421 UTC] DBG    loaded metadata file "metadata/metric/metrics.json"
[2015-06-13 20:44:34.432 UTC] INFO   loading modules.
[2015-06-13 20:44:34.442 UTC] INFO   module "kstat" registered cpu.cpus
[2015-06-13 20:44:34.443 UTC] INFO   module "kstat" registered cpu.usage
[2015-06-13 20:44:34.443 UTC] INFO   module "kstat" registered cpu.waittime
[2015-06-13 20:44:34.443 UTC] INFO   module "kstat" registered cpu.loadavg1
[2015-06-13 20:44:34.443 UTC] INFO   module "kstat" registered nic.nics
[2015-06-13 20:44:34.443 UTC] INFO   module "kstat" registered nic.bytes
[2015-06-13 20:44:34.443 UTC] INFO   module "kstat" registered nic.packets
[2015-06-13 20:44:34.444 UTC] INFO   module "kstat" registered nic.vnic_bytes
[2015-06-13 20:44:34.444 UTC] INFO   module "kstat" registered nic.vnic_packets
[2015-06-13 20:44:34.444 UTC] INFO   module "kstat" registered disk.disks
[2015-06-13 20:44:34.444 UTC] INFO   module "kstat" registered disk.physio_ops
[2015-06-13 20:44:34.444 UTC] INFO   module "kstat" registered disk.physio_bytes
[2015-06-13 20:44:34.444 UTC] INFO   module "kstat" registered tcp.segments
[2015-06-13 20:44:34.445 UTC] INFO   module "kstat" registered tcp.errors
[2015-06-13 20:44:34.445 UTC] INFO   module "kstat" registered fs.logical_rwops
[2015-06-13 20:44:34.445 UTC] INFO   module "kstat" registered fs.logical_rwbytes
[2015-06-13 20:44:34.445 UTC] INFO   module "kstat" registered memory.rss
[2015-06-13 20:44:34.445 UTC] INFO   module "kstat" registered memory.rss_limit
[2015-06-13 20:44:34.445 UTC] INFO   module "kstat" registered memory.swap
[2015-06-13 20:44:34.445 UTC] INFO   module "kstat" registered memory.swap_limit
[2015-06-13 20:44:34.446 UTC] INFO   module "kstat" registered memory.reclaimed_bytes
[2015-06-13 20:44:34.446 UTC] INFO   module "kstat" registered memory.pageins
[2015-06-13 20:44:34.446 UTC] INFO   module "kstat" registered vm.exits
[2015-06-13 20:44:34.446 UTC] INFO   module "kstat" registered zfs.arc_ops
[2015-06-13 20:44:34.446 UTC] INFO   loaded module "kstat".
[2015-06-13 20:44:34.472 UTC] INFO   module "dtrace" registered apache.httpd_ops
[2015-06-13 20:44:34.473 UTC] INFO   module "dtrace" registered cpu.thread_executions
[2015-06-13 20:44:34.474 UTC] INFO   module "dtrace" registered cpu.thread_samples
[2015-06-13 20:44:34.475 UTC] INFO   module "dtrace" registered disk.physio_ops
[2015-06-13 20:44:34.477 UTC] INFO   module "dtrace" registered fs.logical_ops
[2015-06-13 20:44:34.479 UTC] INFO   module "dtrace" registered fs.logical_rwops
[2015-06-13 20:44:34.479 UTC] INFO   module "dtrace" registered ldapjs.connections
[2015-06-13 20:44:34.482 UTC] INFO   module "dtrace" registered ldapjs.ops
[2015-06-13 20:44:34.483 UTC] INFO   module "dtrace" registered ldapjs.search_ops
[2015-06-13 20:44:34.484 UTC] INFO   module "dtrace" registered mantaop.jobs_assigned
[2015-06-13 20:44:34.485 UTC] INFO   module "dtrace" registered mantaop.supervisor_auths
[2015-06-13 20:44:34.485 UTC] INFO   module "dtrace" registered mantaop.supervisor_deletes
[2015-06-13 20:44:34.486 UTC] INFO   module "dtrace" registered mantaop.supervisor_errors
[2015-06-13 20:44:34.487 UTC] INFO   module "dtrace" registered mantaop.supervisor_locates
[2015-06-13 20:44:34.488 UTC] INFO   module "dtrace" registered mantaop.tasks_committed
[2015-06-13 20:44:34.488 UTC] INFO   module "dtrace" registered mantaop.tasks_dispatched
[2015-06-13 20:44:34.489 UTC] INFO   module "dtrace" registered mantaop.tasks_executed
[2015-06-13 20:44:34.490 UTC] INFO   module "dtrace" registered mantaop.tasks_killed
[2015-06-13 20:44:34.490 UTC] INFO   module "dtrace" registered mantaop.zone_resets
[2015-06-13 20:44:34.494 UTC] INFO   module "dtrace" registered moray.ops
[2015-06-13 20:44:34.495 UTC] INFO   module "dtrace" registered moray.queries
[2015-06-13 20:44:34.496 UTC] INFO   module "dtrace" registered mysql.commands
[2015-06-13 20:44:34.497 UTC] INFO   module "dtrace" registered mysql.connections
[2015-06-13 20:44:34.498 UTC] INFO   module "dtrace" registered mysql.filesort
[2015-06-13 20:44:34.500 UTC] INFO   module "dtrace" registered mysql.queries
[2015-06-13 20:44:34.501 UTC] INFO   module "dtrace" registered mysql.statements
[2015-06-13 20:44:34.502 UTC] INFO   module "dtrace" registered node.gc_ops
[2015-06-13 20:44:34.504 UTC] INFO   module "dtrace" registered node.httpc_ops
[2015-06-13 20:44:34.505 UTC] INFO   module "dtrace" registered node.httpd_ops
[2015-06-13 20:44:34.506 UTC] INFO   module "dtrace" registered node.socket_ops
[2015-06-13 20:44:34.507 UTC] INFO   module "dtrace" registered postgres.queries
[2015-06-13 20:44:34.508 UTC] INFO   module "dtrace" registered unix.proc_execs
[2015-06-13 20:44:34.509 UTC] INFO   module "dtrace" registered unix.proc_exits
[2015-06-13 20:44:34.510 UTC] INFO   module "dtrace" registered unix.proc_forks
[2015-06-13 20:44:34.511 UTC] INFO   module "dtrace" registered restify.handler_ops
[2015-06-13 20:44:34.513 UTC] INFO   module "dtrace" registered restify.server_ops
[2015-06-13 20:44:34.515 UTC] INFO   module "dtrace" registered syscall.syscalls
[2015-06-13 20:44:34.517 UTC] INFO   module "dtrace" registered tcp.accepts
[2015-06-13 20:44:34.518 UTC] INFO   module "dtrace" registered tcp.connects
[2015-06-13 20:44:34.519 UTC] INFO   module "dtrace" registered unix.thr_creates
[2015-06-13 20:44:34.520 UTC] INFO   module "dtrace" registered vm.irqs
[2015-06-13 20:44:34.521 UTC] INFO   module "dtrace" registered vm.physio_bytes
[2015-06-13 20:44:34.522 UTC] INFO   module "dtrace" registered vm.physio_ops
[2015-06-13 20:44:34.523 UTC] INFO   module "dtrace" registered vm.thread_samples
[2015-06-13 20:44:34.524 UTC] INFO   module "dtrace" registered zfs.arc_ops
[2015-06-13 20:44:34.524 UTC] INFO   loaded module "dtrace".
[2015-06-13 20:44:34.531 UTC] INFO   module "zfs" registered zfs.dataset_unused_quota
[2015-06-13 20:44:34.531 UTC] INFO   module "zfs" registered zfs.dataset_used
[2015-06-13 20:44:34.532 UTC] INFO   module "zfs" registered zfs.dataset_quota
[2015-06-13 20:44:34.532 UTC] INFO   module "zfs" registered zfs.pool_free
[2015-06-13 20:44:34.532 UTC] INFO   module "zfs" registered zfs.pool_used
[2015-06-13 20:44:34.532 UTC] INFO   module "zfs" registered zfs.pool_total
[2015-06-13 20:44:34.532 UTC] INFO   loaded module "zfs".
[2015-06-13 20:44:34.535 UTC] INFO   module "cainstr" registered ca.instr_ticks
[2015-06-13 20:44:34.535 UTC] INFO   module "cainstr" registered ca.instr_beops
[2015-06-13 20:44:34.535 UTC] INFO   module "cainstr" registered ca.instr_enables
[2015-06-13 20:44:34.535 UTC] INFO   module "cainstr" registered ca.instr_disables
[2015-06-13 20:44:34.535 UTC] INFO   loaded module "cainstr".
[2015-06-13 20:44:34.589 UTC] INFO   module "proc" registered unix.processes
[2015-06-13 20:44:34.589 UTC] INFO   loaded module "proc".
[2015-06-13 20:44:34.589 UTC] INFO   finished loading modules.
[2015-06-13 20:44:34.730 UTC] DBG    binding to ca.instrumenter.headnode
[2015-06-13 20:44:34.734 UTC] DBG    binding to ca.broadcast
[2015-06-13 20:44:34.735 UTC] DBG    bind to ca.instrumenter.headnode complete
[2015-06-13 20:44:34.736 UTC] DBG    bind to ca.broadcast complete
[2015-06-13 20:44:34.737 UTC] INFO   AMQP broker connected.
[2015-06-13 20:44:43.759 UTC] CRIT   CA PANIC: panic due to uncaught exception: EXCEPTION: TypeError: TypeError: Object #<Object> has no method 'appendFileSync'
    at Object.mdGenerateDScript (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-metad.js:859:9)
    at Object.impl (/opt/smartdc/agents/lib/node_modules/cabase/cmd/cainst/modules/dtrace.js:38:28)
    at caInstrService.amqpEnableInstn (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-svc-instr.js:439:22)
    at capAmqpCap.<anonymous> (native)
    at capAmqpCap.emit (events.js:88:20)
    at Object.capDispatch (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp-cap.js:203:14)
    at capAmqpCap.receive (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp-cap.js:502:31)
    at caAmqp.<anonymous> (native)
    at caAmqp.emit (events.js:67:17)
    at caAmqp.receive (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp.js:367:7)
[2015-06-13 20:44:43.760 UTC] CRIT   writing core dump to /opt/smartdc/agents/lib/node_modules/cabase/cacore.17033
[2015-06-13 20:44:43.827 UTC] CRIT   finished writing core dump
[ Jun 13 20:44:43 Stopping because all processes in service exited. ]
[ Jun 13 20:44:43 Executing stop method (:kill). ]
[ Jun 13 20:44:43 Executing start method ("/opt/smartdc/agents/lib/node_modules/cabase/smf/method/canodesvc"). ]
DTRACE_LIBPATH=/opt/smartdc/agents/lib/node_modules/cabase/lib
ignoring amqp-config key amqp_login
ignoring amqp-config key amqp_password
AMQP_HOST=10.99.99.20
AMQP_PORT=5672
NODE_PATH=:/opt/smartdc/agents/lib/node_modules/cabase/node_modules:/opt/smartdc/agents/lib/node_modules/cabase/node_modules/connect/lib:/opt/smartdc/agents/lib/node_modules/cabase/lib/ca:/opt/smartdc/agents/lib/node_modules/cabase/lib/tst
[ Jun 13 20:44:44 Method "start" exited with status 0. ]
The "sys" module is now called "util". It should have a similar interface.
using backends kstat,dtrace,zfs,cainstr,proc
[2015-06-13 20:44:44.405 UTC] INFO   Logging AMQP message to "/opt/smartdc/agents/log/ca/cainstsvc/amqp-2015-06-13.20:44:43.17037"
[2015-06-13 20:44:44.407 UTC] INFO   Instrumenter starting up (instsvc/0.0)
[2015-06-13 20:44:44.407 UTC] INFO   Hostname:    headnode
[2015-06-13 20:44:44.407 UTC] INFO   AMQP broker: {"host":"10.99.99.20","port":"5672"}
[2015-06-13 20:44:44.407 UTC] INFO   Routing key: ca.instrumenter.headnode
[2015-06-13 20:44:44.417 UTC] DBG    loaded metadata file "metadata/metric/metrics.json"
[2015-06-13 20:44:44.418 UTC] DBG    loaded metadata file "metadata/profile/operator.json"
[2015-06-13 20:44:44.418 UTC] DBG    loaded metadata file "metadata/profile/customer.json"
[2015-06-13 20:44:44.429 UTC] INFO   loading modules.
[2015-06-13 20:44:44.439 UTC] INFO   module "kstat" registered cpu.cpus
[2015-06-13 20:44:44.440 UTC] INFO   module "kstat" registered cpu.usage
[2015-06-13 20:44:44.440 UTC] INFO   module "kstat" registered cpu.waittime
[2015-06-13 20:44:44.440 UTC] INFO   module "kstat" registered cpu.loadavg1
[2015-06-13 20:44:44.441 UTC] INFO   module "kstat" registered nic.nics
[2015-06-13 20:44:44.441 UTC] INFO   module "kstat" registered nic.bytes
[2015-06-13 20:44:44.441 UTC] INFO   module "kstat" registered nic.packets
[2015-06-13 20:44:44.441 UTC] INFO   module "kstat" registered nic.vnic_bytes
[2015-06-13 20:44:44.441 UTC] INFO   module "kstat" registered nic.vnic_packets
[2015-06-13 20:44:44.442 UTC] INFO   module "kstat" registered disk.disks
[2015-06-13 20:44:44.442 UTC] INFO   module "kstat" registered disk.physio_ops
[2015-06-13 20:44:44.442 UTC] INFO   module "kstat" registered disk.physio_bytes
[2015-06-13 20:44:44.442 UTC] INFO   module "kstat" registered tcp.segments
[2015-06-13 20:44:44.442 UTC] INFO   module "kstat" registered tcp.errors
[2015-06-13 20:44:44.442 UTC] INFO   module "kstat" registered fs.logical_rwops
[2015-06-13 20:44:44.442 UTC] INFO   module "kstat" registered fs.logical_rwbytes
[2015-06-13 20:44:44.443 UTC] INFO   module "kstat" registered memory.rss
[2015-06-13 20:44:44.443 UTC] INFO   module "kstat" registered memory.rss_limit
[2015-06-13 20:44:44.443 UTC] INFO   module "kstat" registered memory.swap
[2015-06-13 20:44:44.443 UTC] INFO   module "kstat" registered memory.swap_limit
[2015-06-13 20:44:44.443 UTC] INFO   module "kstat" registered memory.reclaimed_bytes
[2015-06-13 20:44:44.444 UTC] INFO   module "kstat" registered memory.pageins
[2015-06-13 20:44:44.444 UTC] INFO   module "kstat" registered vm.exits
[2015-06-13 20:44:44.444 UTC] INFO   module "kstat" registered zfs.arc_ops
[2015-06-13 20:44:44.444 UTC] INFO   loaded module "kstat".
[2015-06-13 20:44:44.473 UTC] INFO   module "dtrace" registered apache.httpd_ops
[2015-06-13 20:44:44.476 UTC] INFO   module "dtrace" registered cpu.thread_executions
[2015-06-13 20:44:44.478 UTC] INFO   module "dtrace" registered cpu.thread_samples
[2015-06-13 20:44:44.479 UTC] INFO   module "dtrace" registered disk.physio_ops
[2015-06-13 20:44:44.481 UTC] INFO   module "dtrace" registered fs.logical_ops
[2015-06-13 20:44:44.482 UTC] INFO   module "dtrace" registered fs.logical_rwops
[2015-06-13 20:44:44.483 UTC] INFO   module "dtrace" registered ldapjs.connections
[2015-06-13 20:44:44.486 UTC] INFO   module "dtrace" registered ldapjs.ops
[2015-06-13 20:44:44.487 UTC] INFO   module "dtrace" registered ldapjs.search_ops
[2015-06-13 20:44:44.488 UTC] INFO   module "dtrace" registered mantaop.jobs_assigned
[2015-06-13 20:44:44.489 UTC] INFO   module "dtrace" registered mantaop.supervisor_auths
[2015-06-13 20:44:44.490 UTC] INFO   module "dtrace" registered mantaop.supervisor_deletes
[2015-06-13 20:44:44.490 UTC] INFO   module "dtrace" registered mantaop.supervisor_errors
[2015-06-13 20:44:44.491 UTC] INFO   module "dtrace" registered mantaop.supervisor_locates
[2015-06-13 20:44:44.491 UTC] INFO   module "dtrace" registered mantaop.tasks_committed
[2015-06-13 20:44:44.492 UTC] INFO   module "dtrace" registered mantaop.tasks_dispatched
[2015-06-13 20:44:44.493 UTC] INFO   module "dtrace" registered mantaop.tasks_executed
[2015-06-13 20:44:44.494 UTC] INFO   module "dtrace" registered mantaop.tasks_killed
[2015-06-13 20:44:44.495 UTC] INFO   module "dtrace" registered mantaop.zone_resets
[2015-06-13 20:44:44.496 UTC] INFO   module "dtrace" registered moray.ops
[2015-06-13 20:44:44.498 UTC] INFO   module "dtrace" registered moray.queries
[2015-06-13 20:44:44.499 UTC] INFO   module "dtrace" registered mysql.commands
[2015-06-13 20:44:44.500 UTC] INFO   module "dtrace" registered mysql.connections
[2015-06-13 20:44:44.501 UTC] INFO   module "dtrace" registered mysql.filesort
[2015-06-13 20:44:44.502 UTC] INFO   module "dtrace" registered mysql.queries
[2015-06-13 20:44:44.504 UTC] INFO   module "dtrace" registered mysql.statements
[2015-06-13 20:44:44.505 UTC] INFO   module "dtrace" registered node.gc_ops
[2015-06-13 20:44:44.506 UTC] INFO   module "dtrace" registered node.httpc_ops
[2015-06-13 20:44:44.508 UTC] INFO   module "dtrace" registered node.httpd_ops
[2015-06-13 20:44:44.509 UTC] INFO   module "dtrace" registered node.socket_ops
[2015-06-13 20:44:44.510 UTC] INFO   module "dtrace" registered postgres.queries
[2015-06-13 20:44:44.511 UTC] INFO   module "dtrace" registered unix.proc_execs
[2015-06-13 20:44:44.512 UTC] INFO   module "dtrace" registered unix.proc_exits
[2015-06-13 20:44:44.513 UTC] INFO   module "dtrace" registered unix.proc_forks
[2015-06-13 20:44:44.515 UTC] INFO   module "dtrace" registered restify.handler_ops
[2015-06-13 20:44:44.516 UTC] INFO   module "dtrace" registered restify.server_ops
[2015-06-13 20:44:44.517 UTC] INFO   module "dtrace" registered syscall.syscalls
[2015-06-13 20:44:44.518 UTC] INFO   module "dtrace" registered tcp.accepts
[2015-06-13 20:44:44.519 UTC] INFO   module "dtrace" registered tcp.connects
[2015-06-13 20:44:44.521 UTC] INFO   module "dtrace" registered unix.thr_creates
[2015-06-13 20:44:44.521 UTC] INFO   module "dtrace" registered vm.irqs
[2015-06-13 20:44:44.522 UTC] INFO   module "dtrace" registered vm.physio_bytes
[2015-06-13 20:44:44.523 UTC] INFO   module "dtrace" registered vm.physio_ops
[2015-06-13 20:44:44.524 UTC] INFO   module "dtrace" registered vm.thread_samples
[2015-06-13 20:44:44.525 UTC] INFO   module "dtrace" registered zfs.arc_ops
[2015-06-13 20:44:44.525 UTC] INFO   loaded module "dtrace".
[2015-06-13 20:44:44.532 UTC] INFO   module "zfs" registered zfs.dataset_unused_quota
[2015-06-13 20:44:44.532 UTC] INFO   module "zfs" registered zfs.dataset_used
[2015-06-13 20:44:44.533 UTC] INFO   module "zfs" registered zfs.dataset_quota
[2015-06-13 20:44:44.533 UTC] INFO   module "zfs" registered zfs.pool_free
[2015-06-13 20:44:44.533 UTC] INFO   module "zfs" registered zfs.pool_used
[2015-06-13 20:44:44.533 UTC] INFO   module "zfs" registered zfs.pool_total
[2015-06-13 20:44:44.533 UTC] INFO   loaded module "zfs".
[2015-06-13 20:44:44.534 UTC] INFO   module "cainstr" registered ca.instr_ticks
[2015-06-13 20:44:44.534 UTC] INFO   module "cainstr" registered ca.instr_beops
[2015-06-13 20:44:44.535 UTC] INFO   module "cainstr" registered ca.instr_enables
[2015-06-13 20:44:44.535 UTC] INFO   module "cainstr" registered ca.instr_disables
[2015-06-13 20:44:44.535 UTC] INFO   loaded module "cainstr".
[2015-06-13 20:44:44.582 UTC] INFO   module "proc" registered unix.processes
[2015-06-13 20:44:44.582 UTC] INFO   loaded module "proc".
[2015-06-13 20:44:44.583 UTC] INFO   finished loading modules.
[2015-06-13 20:44:44.727 UTC] DBG    binding to ca.instrumenter.headnode
[2015-06-13 20:44:44.729 UTC] DBG    binding to ca.broadcast
[2015-06-13 20:44:44.732 UTC] DBG    bind to ca.instrumenter.headnode complete
[2015-06-13 20:44:44.732 UTC] DBG    bind to ca.broadcast complete
[2015-06-13 20:44:44.733 UTC] INFO   AMQP broker connected.
[2015-06-13 20:44:53.758 UTC] CRIT   CA PANIC: panic due to uncaught exception: EXCEPTION: TypeError: TypeError: Object #<Object> has no method 'appendFileSync'
    at Object.mdGenerateDScript (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-metad.js:859:9)
    at Object.impl (/opt/smartdc/agents/lib/node_modules/cabase/cmd/cainst/modules/dtrace.js:38:28)
    at caInstrService.amqpEnableInstn (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-svc-instr.js:439:22)
    at capAmqpCap.<anonymous> (native)
    at capAmqpCap.emit (events.js:88:20)
    at Object.capDispatch (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp-cap.js:203:14)
    at capAmqpCap.receive (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp-cap.js:502:31)
    at caAmqp.<anonymous> (native)
    at caAmqp.emit (events.js:67:17)
    at caAmqp.receive (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp.js:367:7)
[2015-06-13 20:44:53.758 UTC] CRIT   writing core dump to /opt/smartdc/agents/lib/node_modules/cabase/cacore.17065
[2015-06-13 20:44:53.834 UTC] CRIT   finished writing core dump
[ Jun 13 20:44:53 Stopping because all processes in service exited. ]
[ Jun 13 20:44:53 Executing stop method (:kill). ]
[ Jun 13 20:44:53 Restarting too quickly, changing state to maintenance. ]
[ Jun 13 20:47:23 Leaving maintenance because clear requested. ]
[ Jun 13 20:47:23 Enabled. ]
[ Jun 13 20:47:23 Executing start method ("/opt/smartdc/agents/lib/node_modules/cabase/smf/method/canodesvc"). ]
DTRACE_LIBPATH=/opt/smartdc/agents/lib/node_modules/cabase/lib
ignoring amqp-config key amqp_login
ignoring amqp-config key amqp_password
AMQP_HOST=10.99.99.20
AMQP_PORT=5672
NODE_PATH=:/opt/smartdc/agents/lib/node_modules/cabase/node_modules:/opt/smartdc/agents/lib/node_modules/cabase/node_modules/connect/lib:/opt/smartdc/agents/lib/node_modules/cabase/lib/ca:/opt/smartdc/agents/lib/node_modules/cabase/lib/tst
[ Jun 13 20:47:24 Method "start" exited with status 0. ]
The "sys" module is now called "util". It should have a similar interface.
using backends kstat,dtrace,zfs,cainstr,proc
[2015-06-13 20:47:24.308 UTC] INFO   Logging AMQP message to "/opt/smartdc/agents/log/ca/cainstsvc/amqp-2015-06-13.20:47:23.17148"
[2015-06-13 20:47:24.309 UTC] INFO   Instrumenter starting up (instsvc/0.0)
[2015-06-13 20:47:24.309 UTC] INFO   Hostname:    headnode
[2015-06-13 20:47:24.309 UTC] INFO   AMQP broker: {"host":"10.99.99.20","port":"5672"}
[2015-06-13 20:47:24.309 UTC] INFO   Routing key: ca.instrumenter.headnode
[2015-06-13 20:47:24.312 UTC] DBG    loaded metadata file "metadata/profile/operator.json"
[2015-06-13 20:47:24.312 UTC] DBG    loaded metadata file "metadata/profile/customer.json"
[2015-06-13 20:47:24.313 UTC] DBG    loaded metadata file "metadata/metric/metrics.json"
[2015-06-13 20:47:24.328 UTC] INFO   loading modules.
[2015-06-13 20:47:24.338 UTC] INFO   module "kstat" registered cpu.cpus
[2015-06-13 20:47:24.338 UTC] INFO   module "kstat" registered cpu.usage
[2015-06-13 20:47:24.338 UTC] INFO   module "kstat" registered cpu.waittime
[2015-06-13 20:47:24.339 UTC] INFO   module "kstat" registered cpu.loadavg1
[2015-06-13 20:47:24.339 UTC] INFO   module "kstat" registered nic.nics
[2015-06-13 20:47:24.339 UTC] INFO   module "kstat" registered nic.bytes
[2015-06-13 20:47:24.339 UTC] INFO   module "kstat" registered nic.packets
[2015-06-13 20:47:24.339 UTC] INFO   module "kstat" registered nic.vnic_bytes
[2015-06-13 20:47:24.339 UTC] INFO   module "kstat" registered nic.vnic_packets
[2015-06-13 20:47:24.340 UTC] INFO   module "kstat" registered disk.disks
[2015-06-13 20:47:24.340 UTC] INFO   module "kstat" registered disk.physio_ops
[2015-06-13 20:47:24.340 UTC] INFO   module "kstat" registered disk.physio_bytes
[2015-06-13 20:47:24.340 UTC] INFO   module "kstat" registered tcp.segments
[2015-06-13 20:47:24.340 UTC] INFO   module "kstat" registered tcp.errors
[2015-06-13 20:47:24.340 UTC] INFO   module "kstat" registered fs.logical_rwops
[2015-06-13 20:47:24.340 UTC] INFO   module "kstat" registered fs.logical_rwbytes
[2015-06-13 20:47:24.341 UTC] INFO   module "kstat" registered memory.rss
[2015-06-13 20:47:24.341 UTC] INFO   module "kstat" registered memory.rss_limit
[2015-06-13 20:47:24.341 UTC] INFO   module "kstat" registered memory.swap
[2015-06-13 20:47:24.341 UTC] INFO   module "kstat" registered memory.swap_limit
[2015-06-13 20:47:24.341 UTC] INFO   module "kstat" registered memory.reclaimed_bytes
[2015-06-13 20:47:24.341 UTC] INFO   module "kstat" registered memory.pageins
[2015-06-13 20:47:24.341 UTC] INFO   module "kstat" registered vm.exits
[2015-06-13 20:47:24.342 UTC] INFO   module "kstat" registered zfs.arc_ops
[2015-06-13 20:47:24.342 UTC] INFO   loaded module "kstat".
[2015-06-13 20:47:24.366 UTC] INFO   module "dtrace" registered apache.httpd_ops
[2015-06-13 20:47:24.367 UTC] INFO   module "dtrace" registered cpu.thread_executions
[2015-06-13 20:47:24.368 UTC] INFO   module "dtrace" registered cpu.thread_samples
[2015-06-13 20:47:24.369 UTC] INFO   module "dtrace" registered disk.physio_ops
[2015-06-13 20:47:24.371 UTC] INFO   module "dtrace" registered fs.logical_ops
[2015-06-13 20:47:24.372 UTC] INFO   module "dtrace" registered fs.logical_rwops
[2015-06-13 20:47:24.373 UTC] INFO   module "dtrace" registered ldapjs.connections
[2015-06-13 20:47:24.375 UTC] INFO   module "dtrace" registered ldapjs.ops
[2015-06-13 20:47:24.378 UTC] INFO   module "dtrace" registered ldapjs.search_ops
[2015-06-13 20:47:24.378 UTC] INFO   module "dtrace" registered mantaop.jobs_assigned
[2015-06-13 20:47:24.380 UTC] INFO   module "dtrace" registered mantaop.supervisor_auths
[2015-06-13 20:47:24.380 UTC] INFO   module "dtrace" registered mantaop.supervisor_deletes
[2015-06-13 20:47:24.382 UTC] INFO   module "dtrace" registered mantaop.supervisor_errors
[2015-06-13 20:47:24.382 UTC] INFO   module "dtrace" registered mantaop.supervisor_locates
[2015-06-13 20:47:24.383 UTC] INFO   module "dtrace" registered mantaop.tasks_committed
[2015-06-13 20:47:24.384 UTC] INFO   module "dtrace" registered mantaop.tasks_dispatched
[2015-06-13 20:47:24.385 UTC] INFO   module "dtrace" registered mantaop.tasks_executed
[2015-06-13 20:47:24.385 UTC] INFO   module "dtrace" registered mantaop.tasks_killed
[2015-06-13 20:47:24.386 UTC] INFO   module "dtrace" registered mantaop.zone_resets
[2015-06-13 20:47:24.387 UTC] INFO   module "dtrace" registered moray.ops
[2015-06-13 20:47:24.388 UTC] INFO   module "dtrace" registered moray.queries
[2015-06-13 20:47:24.389 UTC] INFO   module "dtrace" registered mysql.commands
[2015-06-13 20:47:24.390 UTC] INFO   module "dtrace" registered mysql.connections
[2015-06-13 20:47:24.391 UTC] INFO   module "dtrace" registered mysql.filesort
[2015-06-13 20:47:24.393 UTC] INFO   module "dtrace" registered mysql.queries
[2015-06-13 20:47:24.394 UTC] INFO   module "dtrace" registered mysql.statements
[2015-06-13 20:47:24.395 UTC] INFO   module "dtrace" registered node.gc_ops
[2015-06-13 20:47:24.397 UTC] INFO   module "dtrace" registered node.httpc_ops
[2015-06-13 20:47:24.398 UTC] INFO   module "dtrace" registered node.httpd_ops
[2015-06-13 20:47:24.399 UTC] INFO   module "dtrace" registered node.socket_ops
[2015-06-13 20:47:24.400 UTC] INFO   module "dtrace" registered postgres.queries
[2015-06-13 20:47:24.401 UTC] INFO   module "dtrace" registered unix.proc_execs
[2015-06-13 20:47:24.402 UTC] INFO   module "dtrace" registered unix.proc_exits
[2015-06-13 20:47:24.403 UTC] INFO   module "dtrace" registered unix.proc_forks
[2015-06-13 20:47:24.404 UTC] INFO   module "dtrace" registered restify.handler_ops
[2015-06-13 20:47:24.406 UTC] INFO   module "dtrace" registered restify.server_ops
[2015-06-13 20:47:24.407 UTC] INFO   module "dtrace" registered syscall.syscalls
[2015-06-13 20:47:24.408 UTC] INFO   module "dtrace" registered tcp.accepts
[2015-06-13 20:47:24.409 UTC] INFO   module "dtrace" registered tcp.connects
[2015-06-13 20:47:24.410 UTC] INFO   module "dtrace" registered unix.thr_creates
[2015-06-13 20:47:24.411 UTC] INFO   module "dtrace" registered vm.irqs
[2015-06-13 20:47:24.412 UTC] INFO   module "dtrace" registered vm.physio_bytes
[2015-06-13 20:47:24.413 UTC] INFO   module "dtrace" registered vm.physio_ops
[2015-06-13 20:47:24.414 UTC] INFO   module "dtrace" registered vm.thread_samples
[2015-06-13 20:47:24.415 UTC] INFO   module "dtrace" registered zfs.arc_ops
[2015-06-13 20:47:24.415 UTC] INFO   loaded module "dtrace".
[2015-06-13 20:47:24.422 UTC] INFO   module "zfs" registered zfs.dataset_unused_quota
[2015-06-13 20:47:24.422 UTC] INFO   module "zfs" registered zfs.dataset_used
[2015-06-13 20:47:24.422 UTC] INFO   module "zfs" registered zfs.dataset_quota
[2015-06-13 20:47:24.422 UTC] INFO   module "zfs" registered zfs.pool_free
[2015-06-13 20:47:24.422 UTC] INFO   module "zfs" registered zfs.pool_used
[2015-06-13 20:47:24.423 UTC] INFO   module "zfs" registered zfs.pool_total
[2015-06-13 20:47:24.423 UTC] INFO   loaded module "zfs".
[2015-06-13 20:47:24.424 UTC] INFO   module "cainstr" registered ca.instr_ticks
[2015-06-13 20:47:24.424 UTC] INFO   module "cainstr" registered ca.instr_beops
[2015-06-13 20:47:24.424 UTC] INFO   module "cainstr" registered ca.instr_enables
[2015-06-13 20:47:24.424 UTC] INFO   module "cainstr" registered ca.instr_disables
[2015-06-13 20:47:24.424 UTC] INFO   loaded module "cainstr".
[2015-06-13 20:47:24.468 UTC] INFO   module "proc" registered unix.processes
[2015-06-13 20:47:24.468 UTC] INFO   loaded module "proc".
[2015-06-13 20:47:24.469 UTC] INFO   finished loading modules.
[2015-06-13 20:47:24.620 UTC] DBG    binding to ca.instrumenter.headnode
[2015-06-13 20:47:24.621 UTC] DBG    binding to ca.broadcast
[2015-06-13 20:47:24.626 UTC] DBG    bind to ca.instrumenter.headnode complete
[2015-06-13 20:47:24.627 UTC] DBG    bind to ca.broadcast complete
[2015-06-13 20:47:24.629 UTC] INFO   AMQP broker connected.
[2015-06-13 20:47:24.785 UTC] CRIT   CA PANIC: panic due to uncaught exception: EXCEPTION: ReferenceError: ReferenceError: util_mod is not defined
    at Object.mdGenerateDScript (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-metad.js:859:13)
    at Object.impl (/opt/smartdc/agents/lib/node_modules/cabase/cmd/cainst/modules/dtrace.js:38:28)
    at caInstrService.amqpEnableInstn (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-svc-instr.js:439:22)
    at capAmqpCap.<anonymous> (native)
    at capAmqpCap.emit (events.js:88:20)
    at Object.capDispatch (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp-cap.js:203:14)
    at capAmqpCap.receive (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp-cap.js:502:31)
    at caAmqp.<anonymous> (native)
    at caAmqp.emit (events.js:67:17)
    at caAmqp.receive (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp.js:367:7)
[2015-06-13 20:47:24.785 UTC] CRIT   writing core dump to /opt/smartdc/agents/lib/node_modules/cabase/cacore.17176
[2015-06-13 20:47:24.857 UTC] CRIT   finished writing core dump
[ Jun 13 20:47:24 Stopping because all processes in service exited. ]
[ Jun 13 20:47:24 Executing stop method (:kill). ]
[ Jun 13 20:47:24 Executing start method ("/opt/smartdc/agents/lib/node_modules/cabase/smf/method/canodesvc"). ]
DTRACE_LIBPATH=/opt/smartdc/agents/lib/node_modules/cabase/lib
ignoring amqp-config key amqp_login
ignoring amqp-config key amqp_password
AMQP_HOST=10.99.99.20
AMQP_PORT=5672
NODE_PATH=:/opt/smartdc/agents/lib/node_modules/cabase/node_modules:/opt/smartdc/agents/lib/node_modules/cabase/node_modules/connect/lib:/opt/smartdc/agents/lib/node_modules/cabase/lib/ca:/opt/smartdc/agents/lib/node_modules/cabase/lib/tst
[ Jun 13 20:47:25 Method "start" exited with status 0. ]
The "sys" module is now called "util". It should have a similar interface.
using backends kstat,dtrace,zfs,cainstr,proc
[2015-06-13 20:47:25.408 UTC] INFO   Logging AMQP message to "/opt/smartdc/agents/log/ca/cainstsvc/amqp-2015-06-13.20:47:25.17179"
[2015-06-13 20:47:25.409 UTC] INFO   Instrumenter starting up (instsvc/0.0)
[2015-06-13 20:47:25.409 UTC] INFO   Hostname:    headnode
[2015-06-13 20:47:25.409 UTC] INFO   AMQP broker: {"host":"10.99.99.20","port":"5672"}
[2015-06-13 20:47:25.409 UTC] INFO   Routing key: ca.instrumenter.headnode
[2015-06-13 20:47:25.413 UTC] DBG    loaded metadata file "metadata/profile/operator.json"
[2015-06-13 20:47:25.414 UTC] DBG    loaded metadata file "metadata/profile/customer.json"
[2015-06-13 20:47:25.416 UTC] DBG    loaded metadata file "metadata/metric/metrics.json"
[2015-06-13 20:47:25.433 UTC] INFO   loading modules.
[2015-06-13 20:47:25.445 UTC] INFO   module "kstat" registered cpu.cpus
[2015-06-13 20:47:25.445 UTC] INFO   module "kstat" registered cpu.usage
[2015-06-13 20:47:25.446 UTC] INFO   module "kstat" registered cpu.waittime
[2015-06-13 20:47:25.446 UTC] INFO   module "kstat" registered cpu.loadavg1
[2015-06-13 20:47:25.447 UTC] INFO   module "kstat" registered nic.nics
[2015-06-13 20:47:25.448 UTC] INFO   module "kstat" registered nic.bytes
[2015-06-13 20:47:25.448 UTC] INFO   module "kstat" registered nic.packets
[2015-06-13 20:47:25.448 UTC] INFO   module "kstat" registered nic.vnic_bytes
[2015-06-13 20:47:25.448 UTC] INFO   module "kstat" registered nic.vnic_packets
[2015-06-13 20:47:25.448 UTC] INFO   module "kstat" registered disk.disks
[2015-06-13 20:47:25.449 UTC] INFO   module "kstat" registered disk.physio_ops
[2015-06-13 20:47:25.449 UTC] INFO   module "kstat" registered disk.physio_bytes
[2015-06-13 20:47:25.449 UTC] INFO   module "kstat" registered tcp.segments
[2015-06-13 20:47:25.449 UTC] INFO   module "kstat" registered tcp.errors
[2015-06-13 20:47:25.449 UTC] INFO   module "kstat" registered fs.logical_rwops
[2015-06-13 20:47:25.449 UTC] INFO   module "kstat" registered fs.logical_rwbytes
[2015-06-13 20:47:25.450 UTC] INFO   module "kstat" registered memory.rss
[2015-06-13 20:47:25.450 UTC] INFO   module "kstat" registered memory.rss_limit
[2015-06-13 20:47:25.450 UTC] INFO   module "kstat" registered memory.swap
[2015-06-13 20:47:25.450 UTC] INFO   module "kstat" registered memory.swap_limit
[2015-06-13 20:47:25.450 UTC] INFO   module "kstat" registered memory.reclaimed_bytes
[2015-06-13 20:47:25.450 UTC] INFO   module "kstat" registered memory.pageins
[2015-06-13 20:47:25.451 UTC] INFO   module "kstat" registered vm.exits
[2015-06-13 20:47:25.451 UTC] INFO   module "kstat" registered zfs.arc_ops
[2015-06-13 20:47:25.451 UTC] INFO   loaded module "kstat".
[2015-06-13 20:47:25.480 UTC] INFO   module "dtrace" registered apache.httpd_ops
[2015-06-13 20:47:25.482 UTC] INFO   module "dtrace" registered cpu.thread_executions
[2015-06-13 20:47:25.483 UTC] INFO   module "dtrace" registered cpu.thread_samples
[2015-06-13 20:47:25.484 UTC] INFO   module "dtrace" registered disk.physio_ops
[2015-06-13 20:47:25.486 UTC] INFO   module "dtrace" registered fs.logical_ops
[2015-06-13 20:47:25.488 UTC] INFO   module "dtrace" registered fs.logical_rwops
[2015-06-13 20:47:25.489 UTC] INFO   module "dtrace" registered ldapjs.connections
[2015-06-13 20:47:25.493 UTC] INFO   module "dtrace" registered ldapjs.ops
[2015-06-13 20:47:25.494 UTC] INFO   module "dtrace" registered ldapjs.search_ops
[2015-06-13 20:47:25.495 UTC] INFO   module "dtrace" registered mantaop.jobs_assigned
[2015-06-13 20:47:25.496 UTC] INFO   module "dtrace" registered mantaop.supervisor_auths
[2015-06-13 20:47:25.497 UTC] INFO   module "dtrace" registered mantaop.supervisor_deletes
[2015-06-13 20:47:25.497 UTC] INFO   module "dtrace" registered mantaop.supervisor_errors
[2015-06-13 20:47:25.498 UTC] INFO   module "dtrace" registered mantaop.supervisor_locates
[2015-06-13 20:47:25.501 UTC] INFO   module "dtrace" registered mantaop.tasks_committed
[2015-06-13 20:47:25.502 UTC] INFO   module "dtrace" registered mantaop.tasks_dispatched
[2015-06-13 20:47:25.503 UTC] INFO   module "dtrace" registered mantaop.tasks_executed
[2015-06-13 20:47:25.504 UTC] INFO   module "dtrace" registered mantaop.tasks_killed
[2015-06-13 20:47:25.505 UTC] INFO   module "dtrace" registered mantaop.zone_resets
[2015-06-13 20:47:25.506 UTC] INFO   module "dtrace" registered moray.ops
[2015-06-13 20:47:25.507 UTC] INFO   module "dtrace" registered moray.queries
[2015-06-13 20:47:25.509 UTC] INFO   module "dtrace" registered mysql.commands
[2015-06-13 20:47:25.510 UTC] INFO   module "dtrace" registered mysql.connections
[2015-06-13 20:47:25.511 UTC] INFO   module "dtrace" registered mysql.filesort
[2015-06-13 20:47:25.513 UTC] INFO   module "dtrace" registered mysql.queries
[2015-06-13 20:47:25.516 UTC] INFO   module "dtrace" registered mysql.statements
[2015-06-13 20:47:25.517 UTC] INFO   module "dtrace" registered node.gc_ops
[2015-06-13 20:47:25.519 UTC] INFO   module "dtrace" registered node.httpc_ops
[2015-06-13 20:47:25.520 UTC] INFO   module "dtrace" registered node.httpd_ops
[2015-06-13 20:47:25.521 UTC] INFO   module "dtrace" registered node.socket_ops
[2015-06-13 20:47:25.523 UTC] INFO   module "dtrace" registered postgres.queries
[2015-06-13 20:47:25.524 UTC] INFO   module "dtrace" registered unix.proc_execs
[2015-06-13 20:47:25.525 UTC] INFO   module "dtrace" registered unix.proc_exits
[2015-06-13 20:47:25.525 UTC] INFO   module "dtrace" registered unix.proc_forks
[2015-06-13 20:47:25.527 UTC] INFO   module "dtrace" registered restify.handler_ops
[2015-06-13 20:47:25.528 UTC] INFO   module "dtrace" registered restify.server_ops
[2015-06-13 20:47:25.529 UTC] INFO   module "dtrace" registered syscall.syscalls
[2015-06-13 20:47:25.531 UTC] INFO   module "dtrace" registered tcp.accepts
[2015-06-13 20:47:25.532 UTC] INFO   module "dtrace" registered tcp.connects
[2015-06-13 20:47:25.533 UTC] INFO   module "dtrace" registered unix.thr_creates
[2015-06-13 20:47:25.534 UTC] INFO   module "dtrace" registered vm.irqs
[2015-06-13 20:47:25.535 UTC] INFO   module "dtrace" registered vm.physio_bytes
[2015-06-13 20:47:25.536 UTC] INFO   module "dtrace" registered vm.physio_ops
[2015-06-13 20:47:25.537 UTC] INFO   module "dtrace" registered vm.thread_samples
[2015-06-13 20:47:25.538 UTC] INFO   module "dtrace" registered zfs.arc_ops
[2015-06-13 20:47:25.538 UTC] INFO   loaded module "dtrace".
[2015-06-13 20:47:25.546 UTC] INFO   module "zfs" registered zfs.dataset_unused_quota
[2015-06-13 20:47:25.546 UTC] INFO   module "zfs" registered zfs.dataset_used
[2015-06-13 20:47:25.546 UTC] INFO   module "zfs" registered zfs.dataset_quota
[2015-06-13 20:47:25.547 UTC] INFO   module "zfs" registered zfs.pool_free
[2015-06-13 20:47:25.547 UTC] INFO   module "zfs" registered zfs.pool_used
[2015-06-13 20:47:25.547 UTC] INFO   module "zfs" registered zfs.pool_total
[2015-06-13 20:47:25.547 UTC] INFO   loaded module "zfs".
[2015-06-13 20:47:25.549 UTC] INFO   module "cainstr" registered ca.instr_ticks
[2015-06-13 20:47:25.549 UTC] INFO   module "cainstr" registered ca.instr_beops
[2015-06-13 20:47:25.549 UTC] INFO   module "cainstr" registered ca.instr_enables
[2015-06-13 20:47:25.549 UTC] INFO   module "cainstr" registered ca.instr_disables
[2015-06-13 20:47:25.549 UTC] INFO   loaded module "cainstr".
[2015-06-13 20:47:25.596 UTC] INFO   module "proc" registered unix.processes
[2015-06-13 20:47:25.596 UTC] INFO   loaded module "proc".
[2015-06-13 20:47:25.597 UTC] INFO   finished loading modules.
[2015-06-13 20:47:25.751 UTC] DBG    binding to ca.instrumenter.headnode
[2015-06-13 20:47:25.754 UTC] DBG    binding to ca.broadcast
[2015-06-13 20:47:25.756 UTC] DBG    bind to ca.instrumenter.headnode complete
[2015-06-13 20:47:25.757 UTC] DBG    bind to ca.broadcast complete
[2015-06-13 20:47:25.757 UTC] INFO   AMQP broker connected.
[2015-06-13 20:47:34.795 UTC] CRIT   CA PANIC: panic due to uncaught exception: EXCEPTION: ReferenceError: ReferenceError: util_mod is not defined
    at Object.mdGenerateDScript (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-metad.js:859:13)
    at Object.impl (/opt/smartdc/agents/lib/node_modules/cabase/cmd/cainst/modules/dtrace.js:38:28)
    at caInstrService.amqpEnableInstn (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-svc-instr.js:439:22)
    at capAmqpCap.<anonymous> (native)
    at capAmqpCap.emit (events.js:88:20)
    at Object.capDispatch (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp-cap.js:203:14)
    at capAmqpCap.receive (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp-cap.js:502:31)
    at caAmqp.<anonymous> (native)
    at caAmqp.emit (events.js:67:17)
    at caAmqp.receive (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp.js:367:7)
[2015-06-13 20:47:34.796 UTC] CRIT   writing core dump to /opt/smartdc/agents/lib/node_modules/cabase/cacore.17207
[2015-06-13 20:47:34.866 UTC] CRIT   finished writing core dump
[ Jun 13 20:47:34 Stopping because all processes in service exited. ]
[ Jun 13 20:47:34 Executing stop method (:kill). ]
[ Jun 13 20:47:34 Executing start method ("/opt/smartdc/agents/lib/node_modules/cabase/smf/method/canodesvc"). ]
DTRACE_LIBPATH=/opt/smartdc/agents/lib/node_modules/cabase/lib
ignoring amqp-config key amqp_login
ignoring amqp-config key amqp_password
AMQP_HOST=10.99.99.20
AMQP_PORT=5672
NODE_PATH=:/opt/smartdc/agents/lib/node_modules/cabase/node_modules:/opt/smartdc/agents/lib/node_modules/cabase/node_modules/connect/lib:/opt/smartdc/agents/lib/node_modules/cabase/lib/ca:/opt/smartdc/agents/lib/node_modules/cabase/lib/tst
[ Jun 13 20:47:35 Method "start" exited with status 0. ]
The "sys" module is now called "util". It should have a similar interface.
using backends kstat,dtrace,zfs,cainstr,proc
[2015-06-13 20:47:35.517 UTC] INFO   Logging AMQP message to "/opt/smartdc/agents/log/ca/cainstsvc/amqp-2015-06-13.20:47:35.17211"
[2015-06-13 20:47:35.518 UTC] INFO   Instrumenter starting up (instsvc/0.0)
[2015-06-13 20:47:35.518 UTC] INFO   Hostname:    headnode
[2015-06-13 20:47:35.518 UTC] INFO   AMQP broker: {"host":"10.99.99.20","port":"5672"}
[2015-06-13 20:47:35.518 UTC] INFO   Routing key: ca.instrumenter.headnode
[2015-06-13 20:47:35.524 UTC] DBG    loaded metadata file "metadata/profile/operator.json"
[2015-06-13 20:47:35.524 UTC] DBG    loaded metadata file "metadata/profile/customer.json"
[2015-06-13 20:47:35.525 UTC] DBG    loaded metadata file "metadata/metric/metrics.json"
[2015-06-13 20:47:35.542 UTC] INFO   loading modules.
[2015-06-13 20:47:35.552 UTC] INFO   module "kstat" registered cpu.cpus
[2015-06-13 20:47:35.552 UTC] INFO   module "kstat" registered cpu.usage
[2015-06-13 20:47:35.553 UTC] INFO   module "kstat" registered cpu.waittime
[2015-06-13 20:47:35.553 UTC] INFO   module "kstat" registered cpu.loadavg1
[2015-06-13 20:47:35.553 UTC] INFO   module "kstat" registered nic.nics
[2015-06-13 20:47:35.553 UTC] INFO   module "kstat" registered nic.bytes
[2015-06-13 20:47:35.553 UTC] INFO   module "kstat" registered nic.packets
[2015-06-13 20:47:35.553 UTC] INFO   module "kstat" registered nic.vnic_bytes
[2015-06-13 20:47:35.554 UTC] INFO   module "kstat" registered nic.vnic_packets
[2015-06-13 20:47:35.554 UTC] INFO   module "kstat" registered disk.disks
[2015-06-13 20:47:35.554 UTC] INFO   module "kstat" registered disk.physio_ops
[2015-06-13 20:47:35.554 UTC] INFO   module "kstat" registered disk.physio_bytes
[2015-06-13 20:47:35.554 UTC] INFO   module "kstat" registered tcp.segments
[2015-06-13 20:47:35.554 UTC] INFO   module "kstat" registered tcp.errors
[2015-06-13 20:47:35.555 UTC] INFO   module "kstat" registered fs.logical_rwops
[2015-06-13 20:47:35.555 UTC] INFO   module "kstat" registered fs.logical_rwbytes
[2015-06-13 20:47:35.555 UTC] INFO   module "kstat" registered memory.rss
[2015-06-13 20:47:35.555 UTC] INFO   module "kstat" registered memory.rss_limit
[2015-06-13 20:47:35.555 UTC] INFO   module "kstat" registered memory.swap
[2015-06-13 20:47:35.555 UTC] INFO   module "kstat" registered memory.swap_limit
[2015-06-13 20:47:35.556 UTC] INFO   module "kstat" registered memory.reclaimed_bytes
[2015-06-13 20:47:35.556 UTC] INFO   module "kstat" registered memory.pageins
[2015-06-13 20:47:35.556 UTC] INFO   module "kstat" registered vm.exits
[2015-06-13 20:47:35.556 UTC] INFO   module "kstat" registered zfs.arc_ops
[2015-06-13 20:47:35.556 UTC] INFO   loaded module "kstat".
[2015-06-13 20:47:35.588 UTC] INFO   module "dtrace" registered apache.httpd_ops
[2015-06-13 20:47:35.592 UTC] INFO   module "dtrace" registered cpu.thread_executions
[2015-06-13 20:47:35.596 UTC] INFO   module "dtrace" registered cpu.thread_samples
[2015-06-13 20:47:35.599 UTC] INFO   module "dtrace" registered disk.physio_ops
[2015-06-13 20:47:35.601 UTC] INFO   module "dtrace" registered fs.logical_ops
[2015-06-13 20:47:35.602 UTC] INFO   module "dtrace" registered fs.logical_rwops
[2015-06-13 20:47:35.603 UTC] INFO   module "dtrace" registered ldapjs.connections
[2015-06-13 20:47:35.606 UTC] INFO   module "dtrace" registered ldapjs.ops
[2015-06-13 20:47:35.607 UTC] INFO   module "dtrace" registered ldapjs.search_ops
[2015-06-13 20:47:35.608 UTC] INFO   module "dtrace" registered mantaop.jobs_assigned
[2015-06-13 20:47:35.609 UTC] INFO   module "dtrace" registered mantaop.supervisor_auths
[2015-06-13 20:47:35.610 UTC] INFO   module "dtrace" registered mantaop.supervisor_deletes
[2015-06-13 20:47:35.611 UTC] INFO   module "dtrace" registered mantaop.supervisor_errors
[2015-06-13 20:47:35.612 UTC] INFO   module "dtrace" registered mantaop.supervisor_locates
[2015-06-13 20:47:35.612 UTC] INFO   module "dtrace" registered mantaop.tasks_committed
[2015-06-13 20:47:35.613 UTC] INFO   module "dtrace" registered mantaop.tasks_dispatched
[2015-06-13 20:47:35.614 UTC] INFO   module "dtrace" registered mantaop.tasks_executed
[2015-06-13 20:47:35.614 UTC] INFO   module "dtrace" registered mantaop.tasks_killed
[2015-06-13 20:47:35.615 UTC] INFO   module "dtrace" registered mantaop.zone_resets
[2015-06-13 20:47:35.616 UTC] INFO   module "dtrace" registered moray.ops
[2015-06-13 20:47:35.618 UTC] INFO   module "dtrace" registered moray.queries
[2015-06-13 20:47:35.620 UTC] INFO   module "dtrace" registered mysql.commands
[2015-06-13 20:47:35.620 UTC] INFO   module "dtrace" registered mysql.connections
[2015-06-13 20:47:35.621 UTC] INFO   module "dtrace" registered mysql.filesort
[2015-06-13 20:47:35.624 UTC] INFO   module "dtrace" registered mysql.queries
[2015-06-13 20:47:35.626 UTC] INFO   module "dtrace" registered mysql.statements
[2015-06-13 20:47:35.627 UTC] INFO   module "dtrace" registered node.gc_ops
[2015-06-13 20:47:35.629 UTC] INFO   module "dtrace" registered node.httpc_ops
[2015-06-13 20:47:35.630 UTC] INFO   module "dtrace" registered node.httpd_ops
[2015-06-13 20:47:35.632 UTC] INFO   module "dtrace" registered node.socket_ops
[2015-06-13 20:47:35.633 UTC] INFO   module "dtrace" registered postgres.queries
[2015-06-13 20:47:35.635 UTC] INFO   module "dtrace" registered unix.proc_execs
[2015-06-13 20:47:35.636 UTC] INFO   module "dtrace" registered unix.proc_exits
[2015-06-13 20:47:35.637 UTC] INFO   module "dtrace" registered unix.proc_forks
[2015-06-13 20:47:35.638 UTC] INFO   module "dtrace" registered restify.handler_ops
[2015-06-13 20:47:35.639 UTC] INFO   module "dtrace" registered restify.server_ops
[2015-06-13 20:47:35.641 UTC] INFO   module "dtrace" registered syscall.syscalls
[2015-06-13 20:47:35.643 UTC] INFO   module "dtrace" registered tcp.accepts
[2015-06-13 20:47:35.644 UTC] INFO   module "dtrace" registered tcp.connects
[2015-06-13 20:47:35.646 UTC] INFO   module "dtrace" registered unix.thr_creates
[2015-06-13 20:47:35.647 UTC] INFO   module "dtrace" registered vm.irqs
[2015-06-13 20:47:35.648 UTC] INFO   module "dtrace" registered vm.physio_bytes
[2015-06-13 20:47:35.649 UTC] INFO   module "dtrace" registered vm.physio_ops
[2015-06-13 20:47:35.649 UTC] INFO   module "dtrace" registered vm.thread_samples
[2015-06-13 20:47:35.650 UTC] INFO   module "dtrace" registered zfs.arc_ops
[2015-06-13 20:47:35.650 UTC] INFO   loaded module "dtrace".
[2015-06-13 20:47:35.659 UTC] INFO   module "zfs" registered zfs.dataset_unused_quota
[2015-06-13 20:47:35.659 UTC] INFO   module "zfs" registered zfs.dataset_used
[2015-06-13 20:47:35.659 UTC] INFO   module "zfs" registered zfs.dataset_quota
[2015-06-13 20:47:35.659 UTC] INFO   module "zfs" registered zfs.pool_free
[2015-06-13 20:47:35.660 UTC] INFO   module "zfs" registered zfs.pool_used
[2015-06-13 20:47:35.660 UTC] INFO   module "zfs" registered zfs.pool_total
[2015-06-13 20:47:35.660 UTC] INFO   loaded module "zfs".
[2015-06-13 20:47:35.662 UTC] INFO   module "cainstr" registered ca.instr_ticks
[2015-06-13 20:47:35.662 UTC] INFO   module "cainstr" registered ca.instr_beops
[2015-06-13 20:47:35.662 UTC] INFO   module "cainstr" registered ca.instr_enables
[2015-06-13 20:47:35.662 UTC] INFO   module "cainstr" registered ca.instr_disables
[2015-06-13 20:47:35.662 UTC] INFO   loaded module "cainstr".
[2015-06-13 20:47:35.706 UTC] INFO   module "proc" registered unix.processes
[2015-06-13 20:47:35.706 UTC] INFO   loaded module "proc".
[2015-06-13 20:47:35.706 UTC] INFO   finished loading modules.
[2015-06-13 20:47:35.851 UTC] DBG    binding to ca.instrumenter.headnode
[2015-06-13 20:47:35.852 UTC] DBG    binding to ca.broadcast
[2015-06-13 20:47:35.856 UTC] DBG    bind to ca.instrumenter.headnode complete
[2015-06-13 20:47:35.861 UTC] DBG    bind to ca.broadcast complete
[2015-06-13 20:47:35.861 UTC] INFO   AMQP broker connected.
[2015-06-13 20:47:44.791 UTC] CRIT   CA PANIC: panic due to uncaught exception: EXCEPTION: ReferenceError: ReferenceError: util_mod is not defined
    at Object.mdGenerateDScript (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-metad.js:859:13)
    at Object.impl (/opt/smartdc/agents/lib/node_modules/cabase/cmd/cainst/modules/dtrace.js:38:28)
    at caInstrService.amqpEnableInstn (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-svc-instr.js:439:22)
    at capAmqpCap.<anonymous> (native)
    at capAmqpCap.emit (events.js:88:20)
    at Object.capDispatch (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp-cap.js:203:14)
    at capAmqpCap.receive (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp-cap.js:502:31)
    at caAmqp.<anonymous> (native)
    at caAmqp.emit (events.js:67:17)
    at caAmqp.receive (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp.js:367:7)
[2015-06-13 20:47:44.791 UTC] CRIT   writing core dump to /opt/smartdc/agents/lib/node_modules/cabase/cacore.17239
[2015-06-13 20:47:44.860 UTC] CRIT   finished writing core dump
[ Jun 13 20:47:44 Stopping because all processes in service exited. ]
[ Jun 13 20:47:44 Executing stop method (:kill). ]
[ Jun 13 20:47:44 Executing start method ("/opt/smartdc/agents/lib/node_modules/cabase/smf/method/canodesvc"). ]
DTRACE_LIBPATH=/opt/smartdc/agents/lib/node_modules/cabase/lib
ignoring amqp-config key amqp_login
ignoring amqp-config key amqp_password
AMQP_HOST=10.99.99.20
AMQP_PORT=5672
NODE_PATH=:/opt/smartdc/agents/lib/node_modules/cabase/node_modules:/opt/smartdc/agents/lib/node_modules/cabase/node_modules/connect/lib:/opt/smartdc/agents/lib/node_modules/cabase/lib/ca:/opt/smartdc/agents/lib/node_modules/cabase/lib/tst
[ Jun 13 20:47:45 Method "start" exited with status 0. ]
The "sys" module is now called "util". It should have a similar interface.
using backends kstat,dtrace,zfs,cainstr,proc
[2015-06-13 20:47:45.512 UTC] INFO   Logging AMQP message to "/opt/smartdc/agents/log/ca/cainstsvc/amqp-2015-06-13.20:47:45.17244"
[2015-06-13 20:47:45.514 UTC] INFO   Instrumenter starting up (instsvc/0.0)
[2015-06-13 20:47:45.514 UTC] INFO   Hostname:    headnode
[2015-06-13 20:47:45.514 UTC] INFO   AMQP broker: {"host":"10.99.99.20","port":"5672"}
[2015-06-13 20:47:45.514 UTC] INFO   Routing key: ca.instrumenter.headnode
[2015-06-13 20:47:45.521 UTC] DBG    loaded metadata file "metadata/profile/operator.json"
[2015-06-13 20:47:45.522 UTC] DBG    loaded metadata file "metadata/profile/customer.json"
[2015-06-13 20:47:45.523 UTC] DBG    loaded metadata file "metadata/metric/metrics.json"
[2015-06-13 20:47:45.540 UTC] INFO   loading modules.
[2015-06-13 20:47:45.552 UTC] INFO   module "kstat" registered cpu.cpus
[2015-06-13 20:47:45.553 UTC] INFO   module "kstat" registered cpu.usage
[2015-06-13 20:47:45.553 UTC] INFO   module "kstat" registered cpu.waittime
[2015-06-13 20:47:45.553 UTC] INFO   module "kstat" registered cpu.loadavg1
[2015-06-13 20:47:45.554 UTC] INFO   module "kstat" registered nic.nics
[2015-06-13 20:47:45.554 UTC] INFO   module "kstat" registered nic.bytes
[2015-06-13 20:47:45.555 UTC] INFO   module "kstat" registered nic.packets
[2015-06-13 20:47:45.555 UTC] INFO   module "kstat" registered nic.vnic_bytes
[2015-06-13 20:47:45.555 UTC] INFO   module "kstat" registered nic.vnic_packets
[2015-06-13 20:47:45.556 UTC] INFO   module "kstat" registered disk.disks
[2015-06-13 20:47:45.556 UTC] INFO   module "kstat" registered disk.physio_ops
[2015-06-13 20:47:45.556 UTC] INFO   module "kstat" registered disk.physio_bytes
[2015-06-13 20:47:45.557 UTC] INFO   module "kstat" registered tcp.segments
[2015-06-13 20:47:45.558 UTC] INFO   module "kstat" registered tcp.errors
[2015-06-13 20:47:45.558 UTC] INFO   module "kstat" registered fs.logical_rwops
[2015-06-13 20:47:45.558 UTC] INFO   module "kstat" registered fs.logical_rwbytes
[2015-06-13 20:47:45.559 UTC] INFO   module "kstat" registered memory.rss
[2015-06-13 20:47:45.559 UTC] INFO   module "kstat" registered memory.rss_limit
[2015-06-13 20:47:45.559 UTC] INFO   module "kstat" registered memory.swap
[2015-06-13 20:47:45.560 UTC] INFO   module "kstat" registered memory.swap_limit
[2015-06-13 20:47:45.560 UTC] INFO   module "kstat" registered memory.reclaimed_bytes
[2015-06-13 20:47:45.561 UTC] INFO   module "kstat" registered memory.pageins
[2015-06-13 20:47:45.562 UTC] INFO   module "kstat" registered vm.exits
[2015-06-13 20:47:45.562 UTC] INFO   module "kstat" registered zfs.arc_ops
[2015-06-13 20:47:45.562 UTC] INFO   loaded module "kstat".
[2015-06-13 20:47:45.590 UTC] INFO   module "dtrace" registered apache.httpd_ops
[2015-06-13 20:47:45.591 UTC] INFO   module "dtrace" registered cpu.thread_executions
[2015-06-13 20:47:45.592 UTC] INFO   module "dtrace" registered cpu.thread_samples
[2015-06-13 20:47:45.593 UTC] INFO   module "dtrace" registered disk.physio_ops
[2015-06-13 20:47:45.596 UTC] INFO   module "dtrace" registered fs.logical_ops
[2015-06-13 20:47:45.598 UTC] INFO   module "dtrace" registered fs.logical_rwops
[2015-06-13 20:47:45.599 UTC] INFO   module "dtrace" registered ldapjs.connections
[2015-06-13 20:47:45.603 UTC] INFO   module "dtrace" registered ldapjs.ops
[2015-06-13 20:47:45.604 UTC] INFO   module "dtrace" registered ldapjs.search_ops
[2015-06-13 20:47:45.608 UTC] INFO   module "dtrace" registered mantaop.jobs_assigned
[2015-06-13 20:47:45.610 UTC] INFO   module "dtrace" registered mantaop.supervisor_auths
[2015-06-13 20:47:45.613 UTC] INFO   module "dtrace" registered mantaop.supervisor_deletes
[2015-06-13 20:47:45.615 UTC] INFO   module "dtrace" registered mantaop.supervisor_errors
[2015-06-13 20:47:45.618 UTC] INFO   module "dtrace" registered mantaop.supervisor_locates
[2015-06-13 20:47:45.620 UTC] INFO   module "dtrace" registered mantaop.tasks_committed
[2015-06-13 20:47:45.621 UTC] INFO   module "dtrace" registered mantaop.tasks_dispatched
[2015-06-13 20:47:45.622 UTC] INFO   module "dtrace" registered mantaop.tasks_executed
[2015-06-13 20:47:45.623 UTC] INFO   module "dtrace" registered mantaop.tasks_killed
[2015-06-13 20:47:45.624 UTC] INFO   module "dtrace" registered mantaop.zone_resets
[2015-06-13 20:47:45.625 UTC] INFO   module "dtrace" registered moray.ops
[2015-06-13 20:47:45.628 UTC] INFO   module "dtrace" registered moray.queries
[2015-06-13 20:47:45.630 UTC] INFO   module "dtrace" registered mysql.commands
[2015-06-13 20:47:45.631 UTC] INFO   module "dtrace" registered mysql.connections
[2015-06-13 20:47:45.633 UTC] INFO   module "dtrace" registered mysql.filesort
[2015-06-13 20:47:45.634 UTC] INFO   module "dtrace" registered mysql.queries
[2015-06-13 20:47:45.636 UTC] INFO   module "dtrace" registered mysql.statements
[2015-06-13 20:47:45.638 UTC] INFO   module "dtrace" registered node.gc_ops
[2015-06-13 20:47:45.640 UTC] INFO   module "dtrace" registered node.httpc_ops
[2015-06-13 20:47:45.642 UTC] INFO   module "dtrace" registered node.httpd_ops
[2015-06-13 20:47:45.644 UTC] INFO   module "dtrace" registered node.socket_ops
[2015-06-13 20:47:45.645 UTC] INFO   module "dtrace" registered postgres.queries
[2015-06-13 20:47:45.646 UTC] INFO   module "dtrace" registered unix.proc_execs
[2015-06-13 20:47:45.647 UTC] INFO   module "dtrace" registered unix.proc_exits
[2015-06-13 20:47:45.648 UTC] INFO   module "dtrace" registered unix.proc_forks
[2015-06-13 20:47:45.650 UTC] INFO   module "dtrace" registered restify.handler_ops
[2015-06-13 20:47:45.651 UTC] INFO   module "dtrace" registered restify.server_ops
[2015-06-13 20:47:45.653 UTC] INFO   module "dtrace" registered syscall.syscalls
[2015-06-13 20:47:45.654 UTC] INFO   module "dtrace" registered tcp.accepts
[2015-06-13 20:47:45.655 UTC] INFO   module "dtrace" registered tcp.connects
[2015-06-13 20:47:45.656 UTC] INFO   module "dtrace" registered unix.thr_creates
[2015-06-13 20:47:45.657 UTC] INFO   module "dtrace" registered vm.irqs
[2015-06-13 20:47:45.658 UTC] INFO   module "dtrace" registered vm.physio_bytes
[2015-06-13 20:47:45.660 UTC] INFO   module "dtrace" registered vm.physio_ops
[2015-06-13 20:47:45.661 UTC] INFO   module "dtrace" registered vm.thread_samples
[2015-06-13 20:47:45.662 UTC] INFO   module "dtrace" registered zfs.arc_ops
[2015-06-13 20:47:45.662 UTC] INFO   loaded module "dtrace".
[2015-06-13 20:47:45.671 UTC] INFO   module "zfs" registered zfs.dataset_unused_quota
[2015-06-13 20:47:45.671 UTC] INFO   module "zfs" registered zfs.dataset_used
[2015-06-13 20:47:45.671 UTC] INFO   module "zfs" registered zfs.dataset_quota
[2015-06-13 20:47:45.672 UTC] INFO   module "zfs" registered zfs.pool_free
[2015-06-13 20:47:45.672 UTC] INFO   module "zfs" registered zfs.pool_used
[2015-06-13 20:47:45.672 UTC] INFO   module "zfs" registered zfs.pool_total
[2015-06-13 20:47:45.672 UTC] INFO   loaded module "zfs".
[2015-06-13 20:47:45.676 UTC] INFO   module "cainstr" registered ca.instr_ticks
[2015-06-13 20:47:45.676 UTC] INFO   module "cainstr" registered ca.instr_beops
[2015-06-13 20:47:45.676 UTC] INFO   module "cainstr" registered ca.instr_enables
[2015-06-13 20:47:45.676 UTC] INFO   module "cainstr" registered ca.instr_disables
[2015-06-13 20:47:45.676 UTC] INFO   loaded module "cainstr".
[2015-06-13 20:47:45.724 UTC] INFO   module "proc" registered unix.processes
[2015-06-13 20:47:45.725 UTC] INFO   loaded module "proc".
[2015-06-13 20:47:45.725 UTC] INFO   finished loading modules.
[2015-06-13 20:47:45.860 UTC] DBG    binding to ca.instrumenter.headnode
[2015-06-13 20:47:45.862 UTC] DBG    binding to ca.broadcast
[2015-06-13 20:47:45.868 UTC] DBG    bind to ca.instrumenter.headnode complete
[2015-06-13 20:47:45.869 UTC] DBG    bind to ca.broadcast complete
[2015-06-13 20:47:45.872 UTC] INFO   AMQP broker connected.
[2015-06-13 20:47:54.790 UTC] CRIT   CA PANIC: panic due to uncaught exception: EXCEPTION: ReferenceError: ReferenceError: util_mod is not defined
    at Object.mdGenerateDScript (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-metad.js:859:13)
    at Object.impl (/opt/smartdc/agents/lib/node_modules/cabase/cmd/cainst/modules/dtrace.js:38:28)
    at caInstrService.amqpEnableInstn (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-svc-instr.js:439:22)
    at capAmqpCap.<anonymous> (native)
    at capAmqpCap.emit (events.js:88:20)
    at Object.capDispatch (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp-cap.js:203:14)
    at capAmqpCap.receive (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp-cap.js:502:31)
    at caAmqp.<anonymous> (native)
    at caAmqp.emit (events.js:67:17)
    at caAmqp.receive (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp.js:367:7)
[2015-06-13 20:47:54.790 UTC] CRIT   writing core dump to /opt/smartdc/agents/lib/node_modules/cabase/cacore.17272
[2015-06-13 20:47:54.858 UTC] CRIT   finished writing core dump
[ Jun 13 20:47:54 Stopping because all processes in service exited. ]
[ Jun 13 20:47:54 Executing stop method (:kill). ]
[ Jun 13 20:47:54 Executing start method ("/opt/smartdc/agents/lib/node_modules/cabase/smf/method/canodesvc"). ]
DTRACE_LIBPATH=/opt/smartdc/agents/lib/node_modules/cabase/lib
ignoring amqp-config key amqp_login
ignoring amqp-config key amqp_password
AMQP_HOST=10.99.99.20
AMQP_PORT=5672
NODE_PATH=:/opt/smartdc/agents/lib/node_modules/cabase/node_modules:/opt/smartdc/agents/lib/node_modules/cabase/node_modules/connect/lib:/opt/smartdc/agents/lib/node_modules/cabase/lib/ca:/opt/smartdc/agents/lib/node_modules/cabase/lib/tst
[ Jun 13 20:47:55 Method "start" exited with status 0. ]
The "sys" module is now called "util". It should have a similar interface.
using backends kstat,dtrace,zfs,cainstr,proc
[2015-06-13 20:47:55.481 UTC] INFO   Logging AMQP message to "/opt/smartdc/agents/log/ca/cainstsvc/amqp-2015-06-13.20:47:55.17276"
[2015-06-13 20:47:55.482 UTC] INFO   Instrumenter starting up (instsvc/0.0)
[2015-06-13 20:47:55.482 UTC] INFO   Hostname:    headnode
[2015-06-13 20:47:55.482 UTC] INFO   AMQP broker: {"host":"10.99.99.20","port":"5672"}
[2015-06-13 20:47:55.483 UTC] INFO   Routing key: ca.instrumenter.headnode
[2015-06-13 20:47:55.488 UTC] DBG    loaded metadata file "metadata/profile/operator.json"
[2015-06-13 20:47:55.488 UTC] DBG    loaded metadata file "metadata/profile/customer.json"
[2015-06-13 20:47:55.495 UTC] DBG    loaded metadata file "metadata/metric/metrics.json"
[2015-06-13 20:47:55.507 UTC] INFO   loading modules.
[2015-06-13 20:47:55.534 UTC] INFO   module "kstat" registered cpu.cpus
[2015-06-13 20:47:55.534 UTC] INFO   module "kstat" registered cpu.usage
[2015-06-13 20:47:55.535 UTC] INFO   module "kstat" registered cpu.waittime
[2015-06-13 20:47:55.535 UTC] INFO   module "kstat" registered cpu.loadavg1
[2015-06-13 20:47:55.535 UTC] INFO   module "kstat" registered nic.nics
[2015-06-13 20:47:55.535 UTC] INFO   module "kstat" registered nic.bytes
[2015-06-13 20:47:55.535 UTC] INFO   module "kstat" registered nic.packets
[2015-06-13 20:47:55.536 UTC] INFO   module "kstat" registered nic.vnic_bytes
[2015-06-13 20:47:55.536 UTC] INFO   module "kstat" registered nic.vnic_packets
[2015-06-13 20:47:55.536 UTC] INFO   module "kstat" registered disk.disks
[2015-06-13 20:47:55.537 UTC] INFO   module "kstat" registered disk.physio_ops
[2015-06-13 20:47:55.537 UTC] INFO   module "kstat" registered disk.physio_bytes
[2015-06-13 20:47:55.537 UTC] INFO   module "kstat" registered tcp.segments
[2015-06-13 20:47:55.538 UTC] INFO   module "kstat" registered tcp.errors
[2015-06-13 20:47:55.538 UTC] INFO   module "kstat" registered fs.logical_rwops
[2015-06-13 20:47:55.538 UTC] INFO   module "kstat" registered fs.logical_rwbytes
[2015-06-13 20:47:55.540 UTC] INFO   module "kstat" registered memory.rss
[2015-06-13 20:47:55.540 UTC] INFO   module "kstat" registered memory.rss_limit
[2015-06-13 20:47:55.540 UTC] INFO   module "kstat" registered memory.swap
[2015-06-13 20:47:55.540 UTC] INFO   module "kstat" registered memory.swap_limit
[2015-06-13 20:47:55.540 UTC] INFO   module "kstat" registered memory.reclaimed_bytes
[2015-06-13 20:47:55.541 UTC] INFO   module "kstat" registered memory.pageins
[2015-06-13 20:47:55.541 UTC] INFO   module "kstat" registered vm.exits
[2015-06-13 20:47:55.541 UTC] INFO   module "kstat" registered zfs.arc_ops
[2015-06-13 20:47:55.541 UTC] INFO   loaded module "kstat".
[2015-06-13 20:47:55.569 UTC] INFO   module "dtrace" registered apache.httpd_ops
[2015-06-13 20:47:55.571 UTC] INFO   module "dtrace" registered cpu.thread_executions
[2015-06-13 20:47:55.572 UTC] INFO   module "dtrace" registered cpu.thread_samples
[2015-06-13 20:47:55.573 UTC] INFO   module "dtrace" registered disk.physio_ops
[2015-06-13 20:47:55.575 UTC] INFO   module "dtrace" registered fs.logical_ops
[2015-06-13 20:47:55.576 UTC] INFO   module "dtrace" registered fs.logical_rwops
[2015-06-13 20:47:55.577 UTC] INFO   module "dtrace" registered ldapjs.connections
[2015-06-13 20:47:55.580 UTC] INFO   module "dtrace" registered ldapjs.ops
[2015-06-13 20:47:55.582 UTC] INFO   module "dtrace" registered ldapjs.search_ops
[2015-06-13 20:47:55.583 UTC] INFO   module "dtrace" registered mantaop.jobs_assigned
[2015-06-13 20:47:55.584 UTC] INFO   module "dtrace" registered mantaop.supervisor_auths
[2015-06-13 20:47:55.585 UTC] INFO   module "dtrace" registered mantaop.supervisor_deletes
[2015-06-13 20:47:55.587 UTC] INFO   module "dtrace" registered mantaop.supervisor_errors
[2015-06-13 20:47:55.588 UTC] INFO   module "dtrace" registered mantaop.supervisor_locates
[2015-06-13 20:47:55.589 UTC] INFO   module "dtrace" registered mantaop.tasks_committed
[2015-06-13 20:47:55.590 UTC] INFO   module "dtrace" registered mantaop.tasks_dispatched
[2015-06-13 20:47:55.591 UTC] INFO   module "dtrace" registered mantaop.tasks_executed
[2015-06-13 20:47:55.593 UTC] INFO   module "dtrace" registered mantaop.tasks_killed
[2015-06-13 20:47:55.594 UTC] INFO   module "dtrace" registered mantaop.zone_resets
[2015-06-13 20:47:55.596 UTC] INFO   module "dtrace" registered moray.ops
[2015-06-13 20:47:55.597 UTC] INFO   module "dtrace" registered moray.queries
[2015-06-13 20:47:55.599 UTC] INFO   module "dtrace" registered mysql.commands
[2015-06-13 20:47:55.601 UTC] INFO   module "dtrace" registered mysql.connections
[2015-06-13 20:47:55.603 UTC] INFO   module "dtrace" registered mysql.filesort
[2015-06-13 20:47:55.605 UTC] INFO   module "dtrace" registered mysql.queries
[2015-06-13 20:47:55.607 UTC] INFO   module "dtrace" registered mysql.statements
[2015-06-13 20:47:55.608 UTC] INFO   module "dtrace" registered node.gc_ops
[2015-06-13 20:47:55.610 UTC] INFO   module "dtrace" registered node.httpc_ops
[2015-06-13 20:47:55.611 UTC] INFO   module "dtrace" registered node.httpd_ops
[2015-06-13 20:47:55.612 UTC] INFO   module "dtrace" registered node.socket_ops
[2015-06-13 20:47:55.614 UTC] INFO   module "dtrace" registered postgres.queries
[2015-06-13 20:47:55.616 UTC] INFO   module "dtrace" registered unix.proc_execs
[2015-06-13 20:47:55.617 UTC] INFO   module "dtrace" registered unix.proc_exits
[2015-06-13 20:47:55.618 UTC] INFO   module "dtrace" registered unix.proc_forks
[2015-06-13 20:47:55.619 UTC] INFO   module "dtrace" registered restify.handler_ops
[2015-06-13 20:47:55.621 UTC] INFO   module "dtrace" registered restify.server_ops
[2015-06-13 20:47:55.622 UTC] INFO   module "dtrace" registered syscall.syscalls
[2015-06-13 20:47:55.623 UTC] INFO   module "dtrace" registered tcp.accepts
[2015-06-13 20:47:55.625 UTC] INFO   module "dtrace" registered tcp.connects
[2015-06-13 20:47:55.626 UTC] INFO   module "dtrace" registered unix.thr_creates
[2015-06-13 20:47:55.627 UTC] INFO   module "dtrace" registered vm.irqs
[2015-06-13 20:47:55.628 UTC] INFO   module "dtrace" registered vm.physio_bytes
[2015-06-13 20:47:55.629 UTC] INFO   module "dtrace" registered vm.physio_ops
[2015-06-13 20:47:55.630 UTC] INFO   module "dtrace" registered vm.thread_samples
[2015-06-13 20:47:55.632 UTC] INFO   module "dtrace" registered zfs.arc_ops
[2015-06-13 20:47:55.632 UTC] INFO   loaded module "dtrace".
[2015-06-13 20:47:55.639 UTC] INFO   module "zfs" registered zfs.dataset_unused_quota
[2015-06-13 20:47:55.639 UTC] INFO   module "zfs" registered zfs.dataset_used
[2015-06-13 20:47:55.640 UTC] INFO   module "zfs" registered zfs.dataset_quota
[2015-06-13 20:47:55.640 UTC] INFO   module "zfs" registered zfs.pool_free
[2015-06-13 20:47:55.640 UTC] INFO   module "zfs" registered zfs.pool_used
[2015-06-13 20:47:55.640 UTC] INFO   module "zfs" registered zfs.pool_total
[2015-06-13 20:47:55.640 UTC] INFO   loaded module "zfs".
[2015-06-13 20:47:55.642 UTC] INFO   module "cainstr" registered ca.instr_ticks
[2015-06-13 20:47:55.642 UTC] INFO   module "cainstr" registered ca.instr_beops
[2015-06-13 20:47:55.642 UTC] INFO   module "cainstr" registered ca.instr_enables
[2015-06-13 20:47:55.642 UTC] INFO   module "cainstr" registered ca.instr_disables
[2015-06-13 20:47:55.643 UTC] INFO   loaded module "cainstr".
[2015-06-13 20:47:55.687 UTC] INFO   module "proc" registered unix.processes
[2015-06-13 20:47:55.688 UTC] INFO   loaded module "proc".
[2015-06-13 20:47:55.688 UTC] INFO   finished loading modules.
[2015-06-13 20:47:55.833 UTC] DBG    binding to ca.instrumenter.headnode
[2015-06-13 20:47:55.839 UTC] DBG    binding to ca.broadcast
[2015-06-13 20:47:55.844 UTC] DBG    bind to ca.instrumenter.headnode complete
[2015-06-13 20:47:55.845 UTC] DBG    bind to ca.broadcast complete
[2015-06-13 20:47:55.847 UTC] INFO   AMQP broker connected.
[2015-06-13 20:48:09.877 UTC] CRIT   CA PANIC: panic due to uncaught exception: EXCEPTION: ReferenceError: ReferenceError: util_mod is not defined
    at Object.mdGenerateDScript (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-metad.js:859:13)
    at Object.impl (/opt/smartdc/agents/lib/node_modules/cabase/cmd/cainst/modules/dtrace.js:38:28)
    at caInstrService.amqpEnableInstn (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-svc-instr.js:439:22)
    at capAmqpCap.<anonymous> (native)
    at capAmqpCap.emit (events.js:88:20)
    at Object.capDispatch (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp-cap.js:203:14)
    at capAmqpCap.receive (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp-cap.js:502:31)
    at caAmqp.<anonymous> (native)
    at caAmqp.emit (events.js:67:17)
    at caAmqp.receive (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp.js:367:7)
[2015-06-13 20:48:09.878 UTC] CRIT   writing core dump to /opt/smartdc/agents/lib/node_modules/cabase/cacore.17304
[2015-06-13 20:48:09.956 UTC] CRIT   finished writing core dump
[ Jun 13 20:48:09 Stopping because all processes in service exited. ]
[ Jun 13 20:48:09 Executing stop method (:kill). ]
[ Jun 13 20:48:10 Executing start method ("/opt/smartdc/agents/lib/node_modules/cabase/smf/method/canodesvc"). ]
DTRACE_LIBPATH=/opt/smartdc/agents/lib/node_modules/cabase/lib
ignoring amqp-config key amqp_login
ignoring amqp-config key amqp_password
AMQP_HOST=10.99.99.20
AMQP_PORT=5672
NODE_PATH=:/opt/smartdc/agents/lib/node_modules/cabase/node_modules:/opt/smartdc/agents/lib/node_modules/cabase/node_modules/connect/lib:/opt/smartdc/agents/lib/node_modules/cabase/lib/ca:/opt/smartdc/agents/lib/node_modules/cabase/lib/tst
[ Jun 13 20:48:10 Method "start" exited with status 0. ]
The "sys" module is now called "util". It should have a similar interface.
using backends kstat,dtrace,zfs,cainstr,proc
[2015-06-13 20:48:10.597 UTC] INFO   Logging AMQP message to "/opt/smartdc/agents/log/ca/cainstsvc/amqp-2015-06-13.20:48:10.17328"
[2015-06-13 20:48:10.598 UTC] INFO   Instrumenter starting up (instsvc/0.0)
[2015-06-13 20:48:10.598 UTC] INFO   Hostname:    headnode
[2015-06-13 20:48:10.599 UTC] INFO   AMQP broker: {"host":"10.99.99.20","port":"5672"}
[2015-06-13 20:48:10.599 UTC] INFO   Routing key: ca.instrumenter.headnode
[2015-06-13 20:48:10.607 UTC] DBG    loaded metadata file "metadata/metric/metrics.json"
[2015-06-13 20:48:10.608 UTC] DBG    loaded metadata file "metadata/profile/operator.json"
[2015-06-13 20:48:10.609 UTC] DBG    loaded metadata file "metadata/profile/customer.json"
[2015-06-13 20:48:10.624 UTC] INFO   loading modules.
[2015-06-13 20:48:10.635 UTC] INFO   module "kstat" registered cpu.cpus
[2015-06-13 20:48:10.635 UTC] INFO   module "kstat" registered cpu.usage
[2015-06-13 20:48:10.636 UTC] INFO   module "kstat" registered cpu.waittime
[2015-06-13 20:48:10.636 UTC] INFO   module "kstat" registered cpu.loadavg1
[2015-06-13 20:48:10.636 UTC] INFO   module "kstat" registered nic.nics
[2015-06-13 20:48:10.637 UTC] INFO   module "kstat" registered nic.bytes
[2015-06-13 20:48:10.637 UTC] INFO   module "kstat" registered nic.packets
[2015-06-13 20:48:10.637 UTC] INFO   module "kstat" registered nic.vnic_bytes
[2015-06-13 20:48:10.637 UTC] INFO   module "kstat" registered nic.vnic_packets
[2015-06-13 20:48:10.637 UTC] INFO   module "kstat" registered disk.disks
[2015-06-13 20:48:10.638 UTC] INFO   module "kstat" registered disk.physio_ops
[2015-06-13 20:48:10.638 UTC] INFO   module "kstat" registered disk.physio_bytes
[2015-06-13 20:48:10.638 UTC] INFO   module "kstat" registered tcp.segments
[2015-06-13 20:48:10.638 UTC] INFO   module "kstat" registered tcp.errors
[2015-06-13 20:48:10.639 UTC] INFO   module "kstat" registered fs.logical_rwops
[2015-06-13 20:48:10.640 UTC] INFO   module "kstat" registered fs.logical_rwbytes
[2015-06-13 20:48:10.641 UTC] INFO   module "kstat" registered memory.rss
[2015-06-13 20:48:10.641 UTC] INFO   module "kstat" registered memory.rss_limit
[2015-06-13 20:48:10.642 UTC] INFO   module "kstat" registered memory.swap
[2015-06-13 20:48:10.643 UTC] INFO   module "kstat" registered memory.swap_limit
[2015-06-13 20:48:10.643 UTC] INFO   module "kstat" registered memory.reclaimed_bytes
[2015-06-13 20:48:10.645 UTC] INFO   module "kstat" registered memory.pageins
[2015-06-13 20:48:10.647 UTC] INFO   module "kstat" registered vm.exits
[2015-06-13 20:48:10.647 UTC] INFO   module "kstat" registered zfs.arc_ops
[2015-06-13 20:48:10.648 UTC] INFO   loaded module "kstat".
[2015-06-13 20:48:10.678 UTC] INFO   module "dtrace" registered apache.httpd_ops
[2015-06-13 20:48:10.680 UTC] INFO   module "dtrace" registered cpu.thread_executions
[2015-06-13 20:48:10.681 UTC] INFO   module "dtrace" registered cpu.thread_samples
[2015-06-13 20:48:10.684 UTC] INFO   module "dtrace" registered disk.physio_ops
[2015-06-13 20:48:10.687 UTC] INFO   module "dtrace" registered fs.logical_ops
[2015-06-13 20:48:10.688 UTC] INFO   module "dtrace" registered fs.logical_rwops
[2015-06-13 20:48:10.690 UTC] INFO   module "dtrace" registered ldapjs.connections
[2015-06-13 20:48:10.694 UTC] INFO   module "dtrace" registered ldapjs.ops
[2015-06-13 20:48:10.696 UTC] INFO   module "dtrace" registered ldapjs.search_ops
[2015-06-13 20:48:10.697 UTC] INFO   module "dtrace" registered mantaop.jobs_assigned
[2015-06-13 20:48:10.698 UTC] INFO   module "dtrace" registered mantaop.supervisor_auths
[2015-06-13 20:48:10.701 UTC] INFO   module "dtrace" registered mantaop.supervisor_deletes
[2015-06-13 20:48:10.702 UTC] INFO   module "dtrace" registered mantaop.supervisor_errors
[2015-06-13 20:48:10.703 UTC] INFO   module "dtrace" registered mantaop.supervisor_locates
[2015-06-13 20:48:10.704 UTC] INFO   module "dtrace" registered mantaop.tasks_committed
[2015-06-13 20:48:10.705 UTC] INFO   module "dtrace" registered mantaop.tasks_dispatched
[2015-06-13 20:48:10.706 UTC] INFO   module "dtrace" registered mantaop.tasks_executed
[2015-06-13 20:48:10.707 UTC] INFO   module "dtrace" registered mantaop.tasks_killed
[2015-06-13 20:48:10.708 UTC] INFO   module "dtrace" registered mantaop.zone_resets
[2015-06-13 20:48:10.710 UTC] INFO   module "dtrace" registered moray.ops
[2015-06-13 20:48:10.712 UTC] INFO   module "dtrace" registered moray.queries
[2015-06-13 20:48:10.713 UTC] INFO   module "dtrace" registered mysql.commands
[2015-06-13 20:48:10.715 UTC] INFO   module "dtrace" registered mysql.connections
[2015-06-13 20:48:10.717 UTC] INFO   module "dtrace" registered mysql.filesort
[2015-06-13 20:48:10.720 UTC] INFO   module "dtrace" registered mysql.queries
[2015-06-13 20:48:10.722 UTC] INFO   module "dtrace" registered mysql.statements
[2015-06-13 20:48:10.723 UTC] INFO   module "dtrace" registered node.gc_ops
[2015-06-13 20:48:10.725 UTC] INFO   module "dtrace" registered node.httpc_ops
[2015-06-13 20:48:10.728 UTC] INFO   module "dtrace" registered node.httpd_ops
[2015-06-13 20:48:10.730 UTC] INFO   module "dtrace" registered node.socket_ops
[2015-06-13 20:48:10.731 UTC] INFO   module "dtrace" registered postgres.queries
[2015-06-13 20:48:10.732 UTC] INFO   module "dtrace" registered unix.proc_execs
[2015-06-13 20:48:10.733 UTC] INFO   module "dtrace" registered unix.proc_exits
[2015-06-13 20:48:10.735 UTC] INFO   module "dtrace" registered unix.proc_forks
[2015-06-13 20:48:10.737 UTC] INFO   module "dtrace" registered restify.handler_ops
[2015-06-13 20:48:10.738 UTC] INFO   module "dtrace" registered restify.server_ops
[2015-06-13 20:48:10.740 UTC] INFO   module "dtrace" registered syscall.syscalls
[2015-06-13 20:48:10.741 UTC] INFO   module "dtrace" registered tcp.accepts
[2015-06-13 20:48:10.743 UTC] INFO   module "dtrace" registered tcp.connects
[2015-06-13 20:48:10.746 UTC] INFO   module "dtrace" registered unix.thr_creates
[2015-06-13 20:48:10.748 UTC] INFO   module "dtrace" registered vm.irqs
[2015-06-13 20:48:10.749 UTC] INFO   module "dtrace" registered vm.physio_bytes
[2015-06-13 20:48:10.751 UTC] INFO   module "dtrace" registered vm.physio_ops
[2015-06-13 20:48:10.752 UTC] INFO   module "dtrace" registered vm.thread_samples
[2015-06-13 20:48:10.754 UTC] INFO   module "dtrace" registered zfs.arc_ops
[2015-06-13 20:48:10.754 UTC] INFO   loaded module "dtrace".
[2015-06-13 20:48:10.762 UTC] INFO   module "zfs" registered zfs.dataset_unused_quota
[2015-06-13 20:48:10.763 UTC] INFO   module "zfs" registered zfs.dataset_used
[2015-06-13 20:48:10.763 UTC] INFO   module "zfs" registered zfs.dataset_quota
[2015-06-13 20:48:10.763 UTC] INFO   module "zfs" registered zfs.pool_free
[2015-06-13 20:48:10.763 UTC] INFO   module "zfs" registered zfs.pool_used
[2015-06-13 20:48:10.764 UTC] INFO   module "zfs" registered zfs.pool_total
[2015-06-13 20:48:10.764 UTC] INFO   loaded module "zfs".
[2015-06-13 20:48:10.767 UTC] INFO   module "cainstr" registered ca.instr_ticks
[2015-06-13 20:48:10.767 UTC] INFO   module "cainstr" registered ca.instr_beops
[2015-06-13 20:48:10.767 UTC] INFO   module "cainstr" registered ca.instr_enables
[2015-06-13 20:48:10.768 UTC] INFO   module "cainstr" registered ca.instr_disables
[2015-06-13 20:48:10.768 UTC] INFO   loaded module "cainstr".
[2015-06-13 20:48:10.812 UTC] INFO   module "proc" registered unix.processes
[2015-06-13 20:48:10.812 UTC] INFO   loaded module "proc".
[2015-06-13 20:48:10.812 UTC] INFO   finished loading modules.
[2015-06-13 20:48:10.955 UTC] DBG    binding to ca.instrumenter.headnode
[2015-06-13 20:48:10.958 UTC] DBG    binding to ca.broadcast
[2015-06-13 20:48:10.962 UTC] DBG    bind to ca.instrumenter.headnode complete
[2015-06-13 20:48:10.963 UTC] DBG    bind to ca.broadcast complete
[2015-06-13 20:48:10.963 UTC] INFO   AMQP broker connected.
[2015-06-13 20:48:19.871 UTC] CRIT   CA PANIC: panic due to uncaught exception: EXCEPTION: ReferenceError: ReferenceError: util_mod is not defined
    at Object.mdGenerateDScript (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-metad.js:859:13)
    at Object.impl (/opt/smartdc/agents/lib/node_modules/cabase/cmd/cainst/modules/dtrace.js:38:28)
    at caInstrService.amqpEnableInstn (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-svc-instr.js:439:22)
    at capAmqpCap.<anonymous> (native)
    at capAmqpCap.emit (events.js:88:20)
    at Object.capDispatch (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp-cap.js:203:14)
    at capAmqpCap.receive (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp-cap.js:502:31)
    at caAmqp.<anonymous> (native)
    at caAmqp.emit (events.js:67:17)
    at caAmqp.receive (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp.js:367:7)
[2015-06-13 20:48:19.871 UTC] CRIT   writing core dump to /opt/smartdc/agents/lib/node_modules/cabase/cacore.17356
[2015-06-13 20:48:19.954 UTC] CRIT   finished writing core dump
[ Jun 13 20:48:19 Stopping because all processes in service exited. ]
[ Jun 13 20:48:19 Executing stop method (:kill). ]
[ Jun 13 20:48:20 Executing start method ("/opt/smartdc/agents/lib/node_modules/cabase/smf/method/canodesvc"). ]
DTRACE_LIBPATH=/opt/smartdc/agents/lib/node_modules/cabase/lib
ignoring amqp-config key amqp_login
ignoring amqp-config key amqp_password
AMQP_HOST=10.99.99.20
AMQP_PORT=5672
NODE_PATH=:/opt/smartdc/agents/lib/node_modules/cabase/node_modules:/opt/smartdc/agents/lib/node_modules/cabase/node_modules/connect/lib:/opt/smartdc/agents/lib/node_modules/cabase/lib/ca:/opt/smartdc/agents/lib/node_modules/cabase/lib/tst
[ Jun 13 20:48:20 Method "start" exited with status 0. ]
The "sys" module is now called "util". It should have a similar interface.
using backends kstat,dtrace,zfs,cainstr,proc
[2015-06-13 20:48:20.541 UTC] INFO   Logging AMQP message to "/opt/smartdc/agents/log/ca/cainstsvc/amqp-2015-06-13.20:48:20.17360"
[2015-06-13 20:48:20.543 UTC] INFO   Instrumenter starting up (instsvc/0.0)
[2015-06-13 20:48:20.543 UTC] INFO   Hostname:    headnode
[2015-06-13 20:48:20.543 UTC] INFO   AMQP broker: {"host":"10.99.99.20","port":"5672"}
[2015-06-13 20:48:20.543 UTC] INFO   Routing key: ca.instrumenter.headnode
[2015-06-13 20:48:20.547 UTC] DBG    loaded metadata file "metadata/profile/operator.json"
[2015-06-13 20:48:20.548 UTC] DBG    loaded metadata file "metadata/profile/customer.json"
[2015-06-13 20:48:20.548 UTC] DBG    loaded metadata file "metadata/metric/metrics.json"
[2015-06-13 20:48:20.564 UTC] INFO   loading modules.
[2015-06-13 20:48:20.575 UTC] INFO   module "kstat" registered cpu.cpus
[2015-06-13 20:48:20.575 UTC] INFO   module "kstat" registered cpu.usage
[2015-06-13 20:48:20.575 UTC] INFO   module "kstat" registered cpu.waittime
[2015-06-13 20:48:20.575 UTC] INFO   module "kstat" registered cpu.loadavg1
[2015-06-13 20:48:20.576 UTC] INFO   module "kstat" registered nic.nics
[2015-06-13 20:48:20.576 UTC] INFO   module "kstat" registered nic.bytes
[2015-06-13 20:48:20.576 UTC] INFO   module "kstat" registered nic.packets
[2015-06-13 20:48:20.576 UTC] INFO   module "kstat" registered nic.vnic_bytes
[2015-06-13 20:48:20.576 UTC] INFO   module "kstat" registered nic.vnic_packets
[2015-06-13 20:48:20.576 UTC] INFO   module "kstat" registered disk.disks
[2015-06-13 20:48:20.577 UTC] INFO   module "kstat" registered disk.physio_ops
[2015-06-13 20:48:20.577 UTC] INFO   module "kstat" registered disk.physio_bytes
[2015-06-13 20:48:20.577 UTC] INFO   module "kstat" registered tcp.segments
[2015-06-13 20:48:20.577 UTC] INFO   module "kstat" registered tcp.errors
[2015-06-13 20:48:20.577 UTC] INFO   module "kstat" registered fs.logical_rwops
[2015-06-13 20:48:20.577 UTC] INFO   module "kstat" registered fs.logical_rwbytes
[2015-06-13 20:48:20.578 UTC] INFO   module "kstat" registered memory.rss
[2015-06-13 20:48:20.578 UTC] INFO   module "kstat" registered memory.rss_limit
[2015-06-13 20:48:20.578 UTC] INFO   module "kstat" registered memory.swap
[2015-06-13 20:48:20.578 UTC] INFO   module "kstat" registered memory.swap_limit
[2015-06-13 20:48:20.578 UTC] INFO   module "kstat" registered memory.reclaimed_bytes
[2015-06-13 20:48:20.578 UTC] INFO   module "kstat" registered memory.pageins
[2015-06-13 20:48:20.579 UTC] INFO   module "kstat" registered vm.exits
[2015-06-13 20:48:20.579 UTC] INFO   module "kstat" registered zfs.arc_ops
[2015-06-13 20:48:20.579 UTC] INFO   loaded module "kstat".
[2015-06-13 20:48:20.607 UTC] INFO   module "dtrace" registered apache.httpd_ops
[2015-06-13 20:48:20.608 UTC] INFO   module "dtrace" registered cpu.thread_executions
[2015-06-13 20:48:20.609 UTC] INFO   module "dtrace" registered cpu.thread_samples
[2015-06-13 20:48:20.610 UTC] INFO   module "dtrace" registered disk.physio_ops
[2015-06-13 20:48:20.612 UTC] INFO   module "dtrace" registered fs.logical_ops
[2015-06-13 20:48:20.614 UTC] INFO   module "dtrace" registered fs.logical_rwops
[2015-06-13 20:48:20.616 UTC] INFO   module "dtrace" registered ldapjs.connections
[2015-06-13 20:48:20.619 UTC] INFO   module "dtrace" registered ldapjs.ops
[2015-06-13 20:48:20.620 UTC] INFO   module "dtrace" registered ldapjs.search_ops
[2015-06-13 20:48:20.620 UTC] INFO   module "dtrace" registered mantaop.jobs_assigned
[2015-06-13 20:48:20.621 UTC] INFO   module "dtrace" registered mantaop.supervisor_auths
[2015-06-13 20:48:20.622 UTC] INFO   module "dtrace" registered mantaop.supervisor_deletes
[2015-06-13 20:48:20.623 UTC] INFO   module "dtrace" registered mantaop.supervisor_errors
[2015-06-13 20:48:20.624 UTC] INFO   module "dtrace" registered mantaop.supervisor_locates
[2015-06-13 20:48:20.625 UTC] INFO   module "dtrace" registered mantaop.tasks_committed
[2015-06-13 20:48:20.625 UTC] INFO   module "dtrace" registered mantaop.tasks_dispatched
[2015-06-13 20:48:20.626 UTC] INFO   module "dtrace" registered mantaop.tasks_executed
[2015-06-13 20:48:20.627 UTC] INFO   module "dtrace" registered mantaop.tasks_killed
[2015-06-13 20:48:20.627 UTC] INFO   module "dtrace" registered mantaop.zone_resets
[2015-06-13 20:48:20.629 UTC] INFO   module "dtrace" registered moray.ops
[2015-06-13 20:48:20.630 UTC] INFO   module "dtrace" registered moray.queries
[2015-06-13 20:48:20.631 UTC] INFO   module "dtrace" registered mysql.commands
[2015-06-13 20:48:20.632 UTC] INFO   module "dtrace" registered mysql.connections
[2015-06-13 20:48:20.633 UTC] INFO   module "dtrace" registered mysql.filesort
[2015-06-13 20:48:20.635 UTC] INFO   module "dtrace" registered mysql.queries
[2015-06-13 20:48:20.636 UTC] INFO   module "dtrace" registered mysql.statements
[2015-06-13 20:48:20.637 UTC] INFO   module "dtrace" registered node.gc_ops
[2015-06-13 20:48:20.638 UTC] INFO   module "dtrace" registered node.httpc_ops
[2015-06-13 20:48:20.640 UTC] INFO   module "dtrace" registered node.httpd_ops
[2015-06-13 20:48:20.641 UTC] INFO   module "dtrace" registered node.socket_ops
[2015-06-13 20:48:20.642 UTC] INFO   module "dtrace" registered postgres.queries
[2015-06-13 20:48:20.643 UTC] INFO   module "dtrace" registered unix.proc_execs
[2015-06-13 20:48:20.643 UTC] INFO   module "dtrace" registered unix.proc_exits
[2015-06-13 20:48:20.644 UTC] INFO   module "dtrace" registered unix.proc_forks
[2015-06-13 20:48:20.645 UTC] INFO   module "dtrace" registered restify.handler_ops
[2015-06-13 20:48:20.647 UTC] INFO   module "dtrace" registered restify.server_ops
[2015-06-13 20:48:20.648 UTC] INFO   module "dtrace" registered syscall.syscalls
[2015-06-13 20:48:20.649 UTC] INFO   module "dtrace" registered tcp.accepts
[2015-06-13 20:48:20.650 UTC] INFO   module "dtrace" registered tcp.connects
[2015-06-13 20:48:20.651 UTC] INFO   module "dtrace" registered unix.thr_creates
[2015-06-13 20:48:20.652 UTC] INFO   module "dtrace" registered vm.irqs
[2015-06-13 20:48:20.653 UTC] INFO   module "dtrace" registered vm.physio_bytes
[2015-06-13 20:48:20.654 UTC] INFO   module "dtrace" registered vm.physio_ops
[2015-06-13 20:48:20.655 UTC] INFO   module "dtrace" registered vm.thread_samples
[2015-06-13 20:48:20.656 UTC] INFO   module "dtrace" registered zfs.arc_ops
[2015-06-13 20:48:20.656 UTC] INFO   loaded module "dtrace".
[2015-06-13 20:48:20.663 UTC] INFO   module "zfs" registered zfs.dataset_unused_quota
[2015-06-13 20:48:20.664 UTC] INFO   module "zfs" registered zfs.dataset_used
[2015-06-13 20:48:20.664 UTC] INFO   module "zfs" registered zfs.dataset_quota
[2015-06-13 20:48:20.664 UTC] INFO   module "zfs" registered zfs.pool_free
[2015-06-13 20:48:20.664 UTC] INFO   module "zfs" registered zfs.pool_used
[2015-06-13 20:48:20.664 UTC] INFO   module "zfs" registered zfs.pool_total
[2015-06-13 20:48:20.664 UTC] INFO   loaded module "zfs".
[2015-06-13 20:48:20.665 UTC] INFO   module "cainstr" registered ca.instr_ticks
[2015-06-13 20:48:20.665 UTC] INFO   module "cainstr" registered ca.instr_beops
[2015-06-13 20:48:20.666 UTC] INFO   module "cainstr" registered ca.instr_enables
[2015-06-13 20:48:20.666 UTC] INFO   module "cainstr" registered ca.instr_disables
[2015-06-13 20:48:20.666 UTC] INFO   loaded module "cainstr".
[2015-06-13 20:48:20.715 UTC] INFO   module "proc" registered unix.processes
[2015-06-13 20:48:20.716 UTC] INFO   loaded module "proc".
[2015-06-13 20:48:20.716 UTC] INFO   finished loading modules.
[2015-06-13 20:48:20.867 UTC] DBG    binding to ca.instrumenter.headnode
[2015-06-13 20:48:20.868 UTC] DBG    binding to ca.broadcast
[2015-06-13 20:48:20.872 UTC] DBG    bind to ca.instrumenter.headnode complete
[2015-06-13 20:48:20.873 UTC] DBG    bind to ca.broadcast complete
[2015-06-13 20:48:20.876 UTC] INFO   AMQP broker connected.
[2015-06-13 20:48:29.873 UTC] CRIT   CA PANIC: panic due to uncaught exception: EXCEPTION: ReferenceError: ReferenceError: util_mod is not defined
    at Object.mdGenerateDScript (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-metad.js:859:13)
    at Object.impl (/opt/smartdc/agents/lib/node_modules/cabase/cmd/cainst/modules/dtrace.js:38:28)
    at caInstrService.amqpEnableInstn (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-svc-instr.js:439:22)
    at capAmqpCap.<anonymous> (native)
    at capAmqpCap.emit (events.js:88:20)
    at Object.capDispatch (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp-cap.js:203:14)
    at capAmqpCap.receive (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp-cap.js:502:31)
    at caAmqp.<anonymous> (native)
    at caAmqp.emit (events.js:67:17)
    at caAmqp.receive (/opt/smartdc/agents/lib/node_modules/cabase/lib/ca/ca-amqp.js:367:7)
[2015-06-13 20:48:29.873 UTC] CRIT   writing core dump to /opt/smartdc/agents/lib/node_modules/cabase/cacore.17388
[2015-06-13 20:48:29.950 UTC] CRIT   finished writing core dump
[ Jun 13 20:48:29 Stopping because all processes in service exited. ]
[ Jun 13 20:48:29 Executing stop method (:kill). ]
[ Jun 13 20:48:30 Executing start method ("/opt/smartdc/agents/lib/node_modules/cabase/smf/method/canodesvc"). ]
DTRACE_LIBPATH=/opt/smartdc/agents/lib/node_modules/cabase/lib
ignoring amqp-config key amqp_login
ignoring amqp-config key amqp_password
AMQP_HOST=10.99.99.20
AMQP_PORT=5672
NODE_PATH=:/opt/smartdc/agents/lib/node_modules/cabase/node_modules:/opt/smartdc/agents/lib/node_modules/cabase/node_modules/connect/lib:/opt/smartdc/agents/lib/node_modules/cabase/lib/ca:/opt/smartdc/agents/lib/node_modules/cabase/lib/tst
[ Jun 13 20:48:30 Method "start" exited with status 0. ]
The "sys" module is now called "util". It should have a similar interface.
using backends kstat,dtrace,zfs,cainstr,proc
[2015-06-13 20:48:30.563 UTC] INFO   Logging AMQP message to "/opt/smartdc/agents/log/ca/cainstsvc/amqp-2015-06-13.20:48:30.17394"
[2015-06-13 20:48:30.564 UTC] INFO   Instrumenter starting up (instsvc/0.0)
[2015-06-13 20:48:30.565 UTC] INFO   Hostname:    headnode
[2015-06-13 20:48:30.565 UTC] INFO   AMQP broker: {"host":"10.99.99.20","port":"5672"}
[2015-06-13 20:48:30.565 UTC] INFO   Routing key: ca.instrumenter.headnode
[2015-06-13 20:48:30.570 UTC] DBG    loaded metadata file "metadata/profile/operator.json"
[2015-06-13 20:48:30.571 UTC] DBG    loaded metadata file "metadata/profile/customer.json"
[2015-06-13 20:48:30.572 UTC] DBG    loaded metadata file "metadata/metric/metrics.json"
[2015-06-13 20:48:30.589 UTC] INFO   loading modules.
[2015-06-13 20:48:30.601 UTC] INFO   module "kstat" registered cpu.cpus
[2015-06-13 20:48:30.601 UTC] INFO   module "kstat" registered cpu.usage
[2015-06-13 20:48:30.602 UTC] INFO   module "kstat" registered cpu.waittime
[2015-06-13 20:48:30.602 UTC] INFO   module "kstat" registered cpu.loadavg1
[2015-06-13 20:48:30.602 UTC] INFO   module "kstat" registered nic.nics
[2015-06-13 20:48:30.603 UTC] INFO   module "kstat" registered nic.bytes
[2015-06-13 20:48:30.603 UTC] INFO   module "kstat" registered nic.packets
[2015-06-13 20:48:30.603 UTC] INFO   module "kstat" registered nic.vnic_bytes
[2015-06-13 20:48:30.603 UTC] INFO   module "kstat" registered nic.vnic_packets
[2015-06-13 20:48:30.604 UTC] INFO   module "kstat" registered disk.disks
[2015-06-13 20:48:30.604 UTC] INFO   module "kstat" registered disk.physio_ops
[2015-06-13 20:48:30.604 UTC] INFO   module "kstat" registered disk.physio_bytes
[2015-06-13 20:48:30.604 UTC] INFO   module "kstat" registered tcp.segments
[2015-06-13 20:48:30.605 UTC] INFO   module "kstat" registered tcp.errors
[2015-06-13 20:48:30.605 UTC] INFO   module "kstat" registered fs.logical_rwops
[2015-06-13 20:48:30.605 UTC] INFO   module "kstat" registered fs.logical_rwbytes
[2015-06-13 20:48:30.605 UTC] INFO   module "kstat" registered memory.rss
[2015-06-13 20:48:30.606 UTC] INFO   module "kstat" registered memory.rss_limit
[2015-06-13 20:48:30.606 UTC] INFO   module "kstat" registered memory.swap
[2015-06-13 20:48:30.606 UTC] INFO   module "kstat" registered memory.swap_limit
[2015-06-13 20:48:30.606 UTC] INFO   module "kstat" registered memory.reclaimed_bytes
[2015-06-13 20:48:30.606 UTC] INFO   module "kstat" registered memory.pageins
[2015-06-13 20:48:30.608 UTC] INFO   module "kstat" registered vm.exits
[2015-06-13 20:48:30.608 UTC] INFO   module "kstat" registered zfs.arc_ops
[2015-06-13 20:48:30.608 UTC] INFO   loaded module "kstat".
[2015-06-13 20:48:30.636 UTC] INFO   module "dtrace" registered apache.httpd_ops
[2015-06-13 20:48:30.637 UTC] INFO   module "dtrace" registered cpu.thread_executions
[2015-06-13 20:48:30.639 UTC] INFO   module "dtrace" registered cpu.thread_samples
[2015-06-13 20:48:30.640 UTC] INFO   module "dtrace" registered disk.physio_ops
[2015-06-13 20:48:30.642 UTC] INFO   module "dtrace" registered fs.logical_ops
[2015-06-13 20:48:30.644 UTC] INFO   module "dtrace" registered fs.logical_rwops
[2015-06-13 20:48:30.645 UTC] INFO   module "dtrace" registered ldapjs.connections
[2015-06-13 20:48:30.648 UTC] INFO   module "dtrace" registered ldapjs.ops
[2015-06-13 20:48:30.649 UTC] INFO   module "dtrace" registered ldapjs.search_ops
[2015-06-13 20:48:30.650 UTC] INFO   module "dtrace" registered mantaop.jobs_assigned
[2015-06-13 20:48:30.651 UTC] INFO   module "dtrace" registered mantaop.supervisor_auths
[2015-06-13 20:48:30.652 UTC] INFO   module "dtrace" registered mantaop.supervisor_deletes
[2015-06-13 20:48:30.653 UTC] INFO   module "dtrace" registered mantaop.supervisor_errors
[2015-06-13 20:48:30.654 UTC] INFO   module "dtrace" registered mantaop.supervisor_locates
[2015-06-13 20:48:30.655 UTC] INFO   module "dtrace" registered mantaop.tasks_committed
[2015-06-13 20:48:30.656 UTC] INFO   module "dtrace" registered mantaop.tasks_dispatched
[2015-06-13 20:48:30.657 UTC] INFO   module "dtrace" registered mantaop.tasks_executed
[2015-06-13 20:48:30.658 UTC] INFO   module "dtrace" registered mantaop.tasks_killed
[2015-06-13 20:48:30.659 UTC] INFO   module "dtrace" registered mantaop.zone_resets
[2015-06-13 20:48:30.661 UTC] INFO   module "dtrace" registered moray.ops
[2015-06-13 20:48:30.663 UTC] INFO   module "dtrace" registered moray.queries
[2015-06-13 20:48:30.664 UTC] INFO   module "dtrace" registered mysql.commands
[2015-06-13 20:48:30.666 UTC] INFO   module "dtrace" registered mysql.connections
[2015-06-13 20:48:30.668 UTC] INFO   module "dtrace" registered mysql.filesort
[2015-06-13 20:48:30.670 UTC] INFO   module "dtrace" registered mysql.queries
[2015-06-13 20:48:30.671 UTC] INFO   module "dtrace" registered mysql.statements
[2015-06-13 20:48:30.673 UTC] INFO   module "dtrace" registered node.gc_ops
[2015-06-13 20:48:30.674 UTC] INFO   module "dtrace" registered node.httpc_ops
[2015-06-13 20:48:30.676 UTC] INFO   module "dtrace" registered node.httpd_ops
[2015-06-13 20:48:30.677 UTC] INFO   module "dtrace" registered node.socket_ops
[2015-06-13 20:48:30.679 UTC] INFO   module "dtrace" registered postgres.queries
[2015-06-13 20:48:30.680 UTC] INFO   module "dtrace" registered unix.proc_execs
[2015-06-13 20:48:30.681 UTC] INFO   module "dtrace" registered unix.proc_exits
[2015-06-13 20:48:30.682 UTC] INFO   module "dtrace" registered unix.proc_forks
[2015-06-13 20:48:30.683 UTC] INFO   module "dtrace" registered restify.handler_ops
[2015-06-13 20:48:30.685 UTC] INFO   module "dtrace" registered restify.server_ops
[2015-06-13 20:48:30.686 UTC] INFO   module "dtrace" registered syscall.syscalls
[2015-06-13 20:48:30.688 UTC] INFO   module "dtrace" registered tcp.accepts
[2015-06-13 20:48:30.689 UTC] INFO   module "dtrace" registered tcp.connects
[2015-06-13 20:48:30.691 UTC] INFO   module "dtrace" registered unix.thr_creates
[2015-06-13 20:48:30.692 UTC] INFO   module "dtrace" registered vm.irqs
[2015-06-13 20:48:30.694 UTC] INFO   module "dtrace" registered vm.physio_bytes
[2015-06-13 20:48:30.696 UTC] INFO   module "dtrace" registered vm.physio_ops
[2015-06-13 20:48:30.699 UTC] INFO   module "dtrace" registered vm.thread_samples
[2015-06-13 20:48:30.700 UTC] INFO   module "dtrace" registered zfs.arc_ops
[2015-06-13 20:48:30.700 UTC] INFO   loaded module "dtrace".
[2015-06-13 20:48:30.708 UTC] INFO   module "zfs" registered zfs.dataset_unused_quota
[2015-06-13 20:48:30.708 UTC] INFO   module "zfs" registered zfs.dataset_used
[2015-06-13 20:48:30.708 UTC] INFO   module "zfs" registered zfs.dataset_quota
[2015-06-13 20:48:30.708 UTC] INFO   module "zfs" registered zfs.pool_free
[2015-06-13 20:48:30.708 UTC] INFO   module "zfs" registered zfs.pool_used
[2015-06-13 20:48:30.709 UTC] INFO   module "zfs" registered zfs.pool_total
[2015-06-13 20:48:30.709 UTC] INFO   loaded module "zfs".
[2015-06-13 20:48:30.710 UTC] INFO   module "cainstr" registered ca.instr_ticks
[2015-06-13 20:48:30.711 UTC] INFO   module "cainstr" registered ca.instr_beops
[2015-06-13 20:48:30.711 UTC] INFO   module "cainstr" registered ca.instr_enables
[2015-06-13 20:48:30.711 UTC] INFO   module "cainstr" registered ca.instr_disables
[2015-06-13 20:48:30.711 UTC] INFO   loaded module "cainstr".
[2015-06-13 20:48:30.763 UTC] INFO   module "proc" registered unix.processes
[2015-06-13 20:48:30.763 UTC] INFO   loaded module "proc".
[2015-06-13 20:48:30.764 UTC] INFO   finished loading modules.
[2015-06-13 20:48:30.910 UTC] DBG    binding to ca.instrumenter.headnode
[2015-06-13 20:48:30.911 UTC] DBG    binding to ca.broadcast
[2015-06-13 20:48:30.914 UTC] DBG    bind to ca.instrumenter.headnode complete
[2015-06-13 20:48:30.914 UTC] DBG    bind to ca.broadcast complete
[2015-06-13 20:48:30.915 UTC] INFO   AMQP broker connected.
{ stat: 'logical_ops',
  fields: 
   [ 'hostname',
     'zonename',
     'pid',
     'execname',
     'psargs',
     'ppid',
     'pexecname',
     'ppsargs',
     'fstype',
     'optype',
     'latency',
     [length]: 11 ],
  fields_internal: [ 'vnode', 'depth', [length]: 2 ],
  metad: 
   { probedesc: [ [Object], [Object], [Object], [Object], [length]: 4 ],
     locals: [ [Object], [length]: 1 ] },
  module: 'fs' }
[2015-06-13 20:48:39.881 UTC] DBG    
----------------------------------------
this string fstype;

fbt::fop_read:entry,
fbt::fop_write:entry,
fbt::fop_ioctl:entry,
fbt::fop_access:entry,
fbt::fop_getattr:entry,
fbt::fop_setattr:entry,
fbt::fop_lookup:entry,
fbt::fop_create:entry,
fbt::fop_remove:entry,
fbt::fop_link:entry,
fbt::fop_rename:entry,
fbt::fop_mkdir:entry,
fbt::fop_rmdir:entry,
fbt::fop_readdir:entry,
fbt::fop_symlink:entry,
fbt::fop_readlink:entry,
fbt::fop_fsync:entry,
fbt::fop_getpage:entry,
fbt::fop_putpage:entry,
fbt::fop_map:entry,
fbt::fop_open:entry
/((self->vnode0 == NULL))/{
	self->vnode0 = arg0;
	self->depth0 = stackdepth;
	self->latency0 = timestamp;
}

fbt::fop_open:return
/((((((self->vnode0) != NULL)))) && (((((self->depth0) != NULL)))) && (((((self->latency0) != NULL)))) && (((((this->fstype = stringof((*((vnode_t**)self->vnode0))->v_op->vnop_name)) != NULL || 1)))) && (self->depth0 == stackdepth && self->vnode0 != NULL && (this->fstype == "ufs" || this->fstype == "zfs" || this->fstype == "dev" || this->fstype == "dev fs" || this->fstype == "proc" || this->fstype == "lofs" || this->fstype == "tmpfs" || this->fstype == "nfs")))/{
	@[((probefunc + 4))] = llquantize((timestamp - self->latency0), 10, 3, 11, 100);
}

fbt::fop_read:return,
fbt::fop_write:return,
fbt::fop_ioctl:return,
fbt::fop_access:return,
fbt::fop_getattr:return,
fbt::fop_setattr:return,
fbt::fop_lookup:return,
fbt::fop_create:return,
fbt::fop_remove:return,
fbt::fop_link:return,
fbt::fop_rename:return,
fbt::fop_mkdir:return,
fbt::fop_rmdir:return,
fbt::fop_readdir:return,
fbt::fop_symlink:return,
fbt::fop_readlink:return,
fbt::fop_fsync:return,
fbt::fop_getpage:return,
fbt::fop_putpage:return,
fbt::fop_map:return
/((((((self->vnode0) != NULL)))) && (((((self->depth0) != NULL)))) && (((((self->latency0) != NULL)))) && (((((this->fstype = stringof(((vnode_t*)self->vnode0)->v_op->vnop_name)) != NULL || 1)))) && (self->depth0 == stackdepth && self->vnode0 != NULL && (this->fstype == "ufs" || this->fstype == "zfs" || this->fstype == "dev" || this->fstype == "dev fs" || this->fstype == "proc" || this->fstype == "lofs" || this->fstype == "tmpfs" || this->fstype == "nfs")))/{
	@[((probefunc + 4))] = llquantize((timestamp - self->latency0), 10, 3, 11, 100);
}

fbt::fop_read:return,
fbt::fop_write:return,
fbt::fop_ioctl:return,
fbt::fop_access:return,
fbt::fop_getattr:return,
fbt::fop_setattr:return,
fbt::fop_lookup:return,
fbt::fop_create:return,
fbt::fop_remove:return,
fbt::fop_link:return,
fbt::fop_rename:return,
fbt::fop_mkdir:return,
fbt::fop_rmdir:return,
fbt::fop_readdir:return,
fbt::fop_symlink:return,
fbt::fop_readlink:return,
fbt::fop_fsync:return,
fbt::fop_getpage:return,
fbt::fop_putpage:return,
fbt::fop_map:return,
fbt::fop_open:entry
/((self->depth0 == stackdepth))/{
	(self->vnode0) = 0;
	(self->depth0) = 0;
	(self->latency0) = 0;
}

----------------------------------------
[2015-06-13 20:48:42.123 UTC] INFO   instrumented global;6 (fs.logical_ops)
[ Jun 13 20:50:58 Stopping because service restarting. ]
[ Jun 13 20:50:58 Executing stop method (:kill). ]
[ Jun 13 20:50:59 Executing start method ("/opt/smartdc/agents/lib/node_modules/cabase/smf/method/canodesvc"). ]
DTRACE_LIBPATH=/opt/smartdc/agents/lib/node_modules/cabase/lib
ignoring amqp-config key amqp_login
ignoring amqp-config key amqp_password
AMQP_HOST=10.99.99.20
AMQP_PORT=5672
NODE_PATH=:/opt/smartdc/agents/lib/node_modules/cabase/node_modules:/opt/smartdc/agents/lib/node_modules/cabase/node_modules/connect/lib:/opt/smartdc/agents/lib/node_modules/cabase/lib/ca:/opt/smartdc/agents/lib/node_modules/cabase/lib/tst
[ Jun 13 20:50:59 Method "start" exited with status 0. ]
The "sys" module is now called "util". It should have a similar interface.
using backends kstat,dtrace,zfs,cainstr,proc
[2015-06-13 20:50:59.842 UTC] INFO   Logging AMQP message to "/opt/smartdc/agents/log/ca/cainstsvc/amqp-2015-06-13.20:50:59.17481"
[2015-06-13 20:50:59.843 UTC] INFO   Instrumenter starting up (instsvc/0.0)
[2015-06-13 20:50:59.843 UTC] INFO   Hostname:    headnode
[2015-06-13 20:50:59.843 UTC] INFO   AMQP broker: {"host":"10.99.99.20","port":"5672"}
[2015-06-13 20:50:59.843 UTC] INFO   Routing key: ca.instrumenter.headnode
[2015-06-13 20:50:59.846 UTC] DBG    loaded metadata file "metadata/profile/operator.json"
[2015-06-13 20:50:59.847 UTC] DBG    loaded metadata file "metadata/profile/customer.json"
[2015-06-13 20:50:59.849 UTC] DBG    loaded metadata file "metadata/metric/metrics.json"
[2015-06-13 20:50:59.867 UTC] INFO   loading modules.
[2015-06-13 20:50:59.877 UTC] INFO   module "kstat" registered cpu.cpus
[2015-06-13 20:50:59.877 UTC] INFO   module "kstat" registered cpu.usage
[2015-06-13 20:50:59.878 UTC] INFO   module "kstat" registered cpu.waittime
[2015-06-13 20:50:59.878 UTC] INFO   module "kstat" registered cpu.loadavg1
[2015-06-13 20:50:59.878 UTC] INFO   module "kstat" registered nic.nics
[2015-06-13 20:50:59.878 UTC] INFO   module "kstat" registered nic.bytes
[2015-06-13 20:50:59.879 UTC] INFO   module "kstat" registered nic.packets
[2015-06-13 20:50:59.879 UTC] INFO   module "kstat" registered nic.vnic_bytes
[2015-06-13 20:50:59.879 UTC] INFO   module "kstat" registered nic.vnic_packets
[2015-06-13 20:50:59.879 UTC] INFO   module "kstat" registered disk.disks
[2015-06-13 20:50:59.879 UTC] INFO   module "kstat" registered disk.physio_ops
[2015-06-13 20:50:59.879 UTC] INFO   module "kstat" registered disk.physio_bytes
[2015-06-13 20:50:59.880 UTC] INFO   module "kstat" registered tcp.segments
[2015-06-13 20:50:59.880 UTC] INFO   module "kstat" registered tcp.errors
[2015-06-13 20:50:59.880 UTC] INFO   module "kstat" registered fs.logical_rwops
[2015-06-13 20:50:59.880 UTC] INFO   module "kstat" registered fs.logical_rwbytes
[2015-06-13 20:50:59.880 UTC] INFO   module "kstat" registered memory.rss
[2015-06-13 20:50:59.881 UTC] INFO   module "kstat" registered memory.rss_limit
[2015-06-13 20:50:59.881 UTC] INFO   module "kstat" registered memory.swap
[2015-06-13 20:50:59.881 UTC] INFO   module "kstat" registered memory.swap_limit
[2015-06-13 20:50:59.881 UTC] INFO   module "kstat" registered memory.reclaimed_bytes
[2015-06-13 20:50:59.881 UTC] INFO   module "kstat" registered memory.pageins
[2015-06-13 20:50:59.881 UTC] INFO   module "kstat" registered vm.exits
[2015-06-13 20:50:59.881 UTC] INFO   module "kstat" registered zfs.arc_ops
[2015-06-13 20:50:59.882 UTC] INFO   loaded module "kstat".
[2015-06-13 20:50:59.925 UTC] INFO   module "dtrace" registered apache.httpd_ops
[2015-06-13 20:50:59.926 UTC] INFO   module "dtrace" registered cpu.thread_executions
[2015-06-13 20:50:59.927 UTC] INFO   module "dtrace" registered cpu.thread_samples
[2015-06-13 20:50:59.928 UTC] INFO   module "dtrace" registered disk.physio_ops
[2015-06-13 20:50:59.930 UTC] INFO   module "dtrace" registered fs.logical_ops
[2015-06-13 20:50:59.932 UTC] INFO   module "dtrace" registered fs.logical_rwops
[2015-06-13 20:50:59.933 UTC] INFO   module "dtrace" registered ldapjs.connections
[2015-06-13 20:50:59.936 UTC] INFO   module "dtrace" registered ldapjs.ops
[2015-06-13 20:50:59.937 UTC] INFO   module "dtrace" registered ldapjs.search_ops
[2015-06-13 20:50:59.938 UTC] INFO   module "dtrace" registered mantaop.jobs_assigned
[2015-06-13 20:50:59.939 UTC] INFO   module "dtrace" registered mantaop.supervisor_auths
[2015-06-13 20:50:59.940 UTC] INFO   module "dtrace" registered mantaop.supervisor_deletes
[2015-06-13 20:50:59.941 UTC] INFO   module "dtrace" registered mantaop.supervisor_errors
[2015-06-13 20:50:59.942 UTC] INFO   module "dtrace" registered mantaop.supervisor_locates
[2015-06-13 20:50:59.942 UTC] INFO   module "dtrace" registered mantaop.tasks_committed
[2015-06-13 20:50:59.943 UTC] INFO   module "dtrace" registered mantaop.tasks_dispatched
[2015-06-13 20:50:59.944 UTC] INFO   module "dtrace" registered mantaop.tasks_executed
[2015-06-13 20:50:59.947 UTC] INFO   module "dtrace" registered mantaop.tasks_killed
[2015-06-13 20:50:59.948 UTC] INFO   module "dtrace" registered mantaop.zone_resets
[2015-06-13 20:50:59.949 UTC] INFO   module "dtrace" registered moray.ops
[2015-06-13 20:50:59.950 UTC] INFO   module "dtrace" registered moray.queries
[2015-06-13 20:50:59.951 UTC] INFO   module "dtrace" registered mysql.commands
[2015-06-13 20:50:59.952 UTC] INFO   module "dtrace" registered mysql.connections
[2015-06-13 20:50:59.953 UTC] INFO   module "dtrace" registered mysql.filesort
[2015-06-13 20:50:59.955 UTC] INFO   module "dtrace" registered mysql.queries
[2015-06-13 20:50:59.956 UTC] INFO   module "dtrace" registered mysql.statements
[2015-06-13 20:50:59.960 UTC] INFO   module "dtrace" registered node.gc_ops
[2015-06-13 20:50:59.961 UTC] INFO   module "dtrace" registered node.httpc_ops
[2015-06-13 20:50:59.963 UTC] INFO   module "dtrace" registered node.httpd_ops
[2015-06-13 20:50:59.964 UTC] INFO   module "dtrace" registered node.socket_ops
[2015-06-13 20:50:59.965 UTC] INFO   module "dtrace" registered postgres.queries
[2015-06-13 20:50:59.966 UTC] INFO   module "dtrace" registered unix.proc_execs
[2015-06-13 20:50:59.968 UTC] INFO   module "dtrace" registered unix.proc_exits
[2015-06-13 20:50:59.969 UTC] INFO   module "dtrace" registered unix.proc_forks
[2015-06-13 20:50:59.970 UTC] INFO   module "dtrace" registered restify.handler_ops
[2015-06-13 20:50:59.971 UTC] INFO   module "dtrace" registered restify.server_ops
[2015-06-13 20:50:59.972 UTC] INFO   module "dtrace" registered syscall.syscalls
[2015-06-13 20:50:59.974 UTC] INFO   module "dtrace" registered tcp.accepts
[2015-06-13 20:50:59.975 UTC] INFO   module "dtrace" registered tcp.connects
[2015-06-13 20:50:59.976 UTC] INFO   module "dtrace" registered unix.thr_creates
[2015-06-13 20:50:59.977 UTC] INFO   module "dtrace" registered vm.irqs
[2015-06-13 20:50:59.978 UTC] INFO   module "dtrace" registered vm.physio_bytes
[2015-06-13 20:50:59.979 UTC] INFO   module "dtrace" registered vm.physio_ops
[2015-06-13 20:50:59.980 UTC] INFO   module "dtrace" registered vm.thread_samples
[2015-06-13 20:50:59.981 UTC] INFO   module "dtrace" registered zfs.arc_ops
[2015-06-13 20:50:59.981 UTC] INFO   loaded module "dtrace".
[2015-06-13 20:50:59.990 UTC] INFO   module "zfs" registered zfs.dataset_unused_quota
[2015-06-13 20:50:59.990 UTC] INFO   module "zfs" registered zfs.dataset_used
[2015-06-13 20:50:59.990 UTC] INFO   module "zfs" registered zfs.dataset_quota
[2015-06-13 20:50:59.990 UTC] INFO   module "zfs" registered zfs.pool_free
[2015-06-13 20:50:59.990 UTC] INFO   module "zfs" registered zfs.pool_used
[2015-06-13 20:50:59.990 UTC] INFO   module "zfs" registered zfs.pool_total
[2015-06-13 20:50:59.990 UTC] INFO   loaded module "zfs".
[2015-06-13 20:50:59.993 UTC] INFO   module "cainstr" registered ca.instr_ticks
[2015-06-13 20:50:59.993 UTC] INFO   module "cainstr" registered ca.instr_beops
[2015-06-13 20:50:59.993 UTC] INFO   module "cainstr" registered ca.instr_enables
[2015-06-13 20:50:59.993 UTC] INFO   module "cainstr" registered ca.instr_disables
[2015-06-13 20:50:59.993 UTC] INFO   loaded module "cainstr".
[2015-06-13 20:51:00.059 UTC] INFO   module "proc" registered unix.processes
[2015-06-13 20:51:00.059 UTC] INFO   loaded module "proc".
[2015-06-13 20:51:00.059 UTC] INFO   finished loading modules.
[2015-06-13 20:51:00.222 UTC] DBG    binding to ca.instrumenter.headnode
[2015-06-13 20:51:00.223 UTC] DBG    binding to ca.broadcast
[2015-06-13 20:51:00.225 UTC] DBG    bind to ca.instrumenter.headnode complete
[2015-06-13 20:51:00.226 UTC] DBG    bind to ca.broadcast complete
[2015-06-13 20:51:00.226 UTC] INFO   AMQP broker connected.
-------DESC BEGIN---------
{ fields_internal: [ 'vnode', 'depth', [length]: 2 ],
  fields: 
   [ 'hostname',
     'zonename',
     'pid',
     'execname',
     'psargs',
     'ppid',
     'pexecname',
     'ppsargs',
     'fstype',
     'optype',
     'latency',
     [length]: 11 ],
  stat: 'logical_ops',
  metad: 
   { probedesc: [ [Object], [Object], [Object], [Object], [length]: 4 ],
     locals: [ [Object], [length]: 1 ] },
  module: 'fs' }
-------DESC   END---------
-------METRIC BEGIN---------
{ is_backend: 'dtrace',
  is_module: 'fs',
  is_predicate: {},
  is_stat: 'logical_ops',
  is_granularity: 5,
  is_decomposition: [ 'optype', 'latency', [length]: 2 ],
  is_fqid: 'global;6' }
-------METRIC   END---------
-------METADATA BEGIN---------
{ cmm_types: 
   { string: { name: 'string', unit: '', arity: 'discrete' },
     number: { name: 'number', unit: '', arity: 'numeric' },
     subsecond: 
      { name: 'subsecond',
        unit: 'seconds',
        abbr: 's',
        base: 10,
        arity: 'numeric',
        power: -3 },
     percent: 
      { name: 'percent',
        unit: 'percent',
        abbr: '%',
        arity: 'numeric',
        minmax: 100 },
     time: 
      { name: 'time',
        unit: 'seconds',
        abbr: 's',
        base: 10,
        arity: 'numeric',
        power: -9 },
     size: 
      { name: 'size',
        unit: 'bytes',
        abbr: 'B',
        base: 2,
        arity: 'numeric' } },
  cmm_fields: 
   { latency: { type: 'time', label: 'latency', name: 'latency' },
     nthreads: { type: 'number', label: 'number of threads', name: 'nthreads' },
     vleavereason: 
      { type: 'string',
        label: 'reason leaving vCPU',
        name: 'vleavereason' },
     cputime: { type: 'time', label: 'CPU time', name: 'cputime' },
     zpool: { label: 'ZFS pool', name: 'zpool' },
     cpumode: { label: 'CPU mode', name: 'cpumode' },
     command: { label: 'command', name: 'command' },
     psargs: { label: 'process arguments', name: 'psargs' },
     pid: { label: 'process identifier', name: 'pid' },
     jobid: { label: 'jobid', name: 'jobid' },
     gctype: { label: 'GC type', name: 'gctype' },
     nic: { label: 'NIC name', name: 'nic' },
     restify_sname: { label: 'restify server name', name: 'restify_sname' },
     walltime: { type: 'time', label: 'process runtime', name: 'walltime' },
     syscall: { label: 'syscall', name: 'syscall' },
     errtype: { label: 'error type', name: 'errtype' },
     iops_read: 
      { type: 'number',
        label: 'read I/O operations',
        name: 'iops_read' },
     iops_write: 
      { type: 'number',
        label: 'write I/O operations',
        name: 'iops_write' },
     rss: { type: 'size', label: 'resident set size', name: 'rss' },
     http_status: { label: 'Status Code', name: 'http_status' },
     cainstnid: { label: 'instrumentation identifier', name: 'cainstnid' },
     packets_out: { type: 'number', label: 'packets sent', name: 'packets_out' },
     subsecond: 
      { type: 'subsecond',
        label: 'subsecond offset',
        name: 'subsecond' },
     http_method: { label: 'method', name: 'http_method' },
     errno: { type: 'string', label: 'error code', name: 'errno' },
     http_path: { label: 'URL path', name: 'http_path' },
     rowsmatched: { type: 'number', label: 'rows matched', name: 'rowsmatched' },
     bytes: { type: 'size', label: 'bytes read and written', name: 'bytes' },
     vmmmuctx: { type: 'string', label: 'VM MMU context', name: 'vmmmuctx' },
     tcpstack: { label: 'TCP instance', name: 'tcpstack' },
     packets_in: { type: 'number', label: 'packets received', name: 'packets_in' },
     irqvector: { type: 'string', label: 'IRQ vector', name: 'irqvector' },
     busytime: { type: 'percent', label: 'non-idle time', name: 'busytime' },
     leavereason: { label: 'reason leaving CPU', name: 'leavereason' },
     bytes_write: { type: 'size', label: 'bytes written', name: 'bytes_write' },
     contract: { label: 'contract identifier', name: 'contract' },
     hostname: { label: 'server hostname', name: 'hostname' },
     zdataset: { label: 'ZFS dataset', name: 'zdataset' },
     iops: { type: 'number', label: 'I/O operations', name: 'iops' },
     user: { label: 'client username', name: 'user' },
     cametric: { label: 'metric name', name: 'cametric' },
     querysubstr: { label: 'query substring', name: 'querysubstr' },
     pmodel: { label: 'process model', name: 'pmodel' },
     pexecname: { label: 'parent application name', name: 'pexecname' },
     raddr: { label: 'remote IP address', name: 'raddr' },
     bytes_read: { type: 'size', label: 'bytes read', name: 'bytes_read' },
     ldapbinddn: { label: 'bind DN', name: 'ldapbinddn' },
     offset: { type: 'size', label: 'offset', name: 'offset' },
     disk: { label: 'device name', name: 'disk' },
     optype: { label: 'operation type', name: 'optype' },
     execname: { label: 'application name', name: 'execname' },
     direction: { label: 'sent/received', name: 'direction' },
     statement: { label: 'statement type', name: 'statement' },
     restify_hname: { label: 'restify handler name', name: 'restify_hname' },
     ldaprequestdn: { label: 'request DN', name: 'ldaprequestdn' },
     ldapscope: { label: 'search scope', name: 'ldapscope' },
     parsed: { label: 'parsed', name: 'parsed' },
     ldapfilter: { label: 'search filter', name: 'ldapfilter' },
     rport: { label: 'remote TCP port', name: 'rport' },
     objname: { label: 'object name', name: 'objname' },
     client: { label: 'client hostname', name: 'client' },
     restify_rname: { label: 'restify route name', name: 'restify_rname' },
     vcpuid: { type: 'string', label: 'vCPU identifier', name: 'vcpuid' },
     size: { type: 'size', label: 'size', name: 'size' },
     status: { label: 'status', name: 'status' },
     ppid: { label: 'parent process identifier', name: 'ppid' },
     cabackend: { label: 'backend module', name: 'cabackend' },
     http_origin: { label: 'reported origin IP', name: 'http_origin' },
     runtime: { type: 'time', label: 'time on CPU', name: 'runtime' },
     table: { label: 'table name', name: 'table' },
     rowschanged: { type: 'number', label: 'rows changed', name: 'rowschanged' },
     utilization: { type: 'percent', label: 'utilization', name: 'utilization' },
     packets: 
      { type: 'number',
        label: 'packets sent and received',
        name: 'packets' },
     database: { label: 'database name', name: 'database' },
     ppsargs: { label: 'parent process arguments', name: 'ppsargs' },
     fstype: { label: 'filesystem type', name: 'fstype' },
     cpu: { label: 'CPU identifier', name: 'cpu' },
     http_url: { label: 'URL', name: 'http_url' },
     errname: { label: 'error name', name: 'errname' },
     zonename: { label: 'zone name', name: 'zonename' },
     buffered: 
      { type: 'size',
        label: 'bytes buffered on socket',
        name: 'buffered' } },
  cmm_metrics: 
   { 'memory.rss_limit': 
      { type: 'size',
        label: 'maximum resident set size',
        module: 'memory',
        stat: 'rss_limit',
        fields: [Object],
        interval: 'point' },
     'mantaop.supervisor_auths': 
      { label: 'supervisor auth requests',
        module: 'mantaop',
        stat: 'supervisor_auths',
        fields: [Object],
        unit: 'requests',
        interval: 'interval' },
     'mantaop.jobs_assigned': 
      { label: 'jobs assigned',
        module: 'mantaop',
        stat: 'jobs_assigned',
        fields: [Object],
        unit: 'jobs',
        interval: 'interval' },
     'cpu.cpus': 
      { label: 'CPUs',
        module: 'cpu',
        stat: 'cpus',
        fields: [Object],
        unit: 'CPUs',
        interval: 'point' },
     'vm.physio_bytes': 
      { type: 'size',
        label: 'disk bytes read and written',
        module: 'vm',
        stat: 'physio_bytes',
        fields: [Object],
        interval: 'interval' },
     'ca.instr_enables': 
      { label: 'instrumenter enable operations',
        module: 'ca',
        stat: 'instr_enables',
        fields: [Object],
        unit: 'operations',
        interval: 'interval' },
     'unix.processes': 
      { label: 'processes',
        module: 'unix',
        stat: 'processes',
        fields: [Object],
        unit: 'processes',
        interval: 'interval' },
     'mysql.commands': 
      { label: 'commands',
        module: 'mysql',
        stat: 'commands',
        fields: [Object],
        unit: 'commands',
        interval: 'interval' },
     'mysql.statements': 
      { label: 'statements',
        module: 'mysql',
        stat: 'statements',
        fields: [Object],
        unit: 'statements',
        interval: 'interval' },
     'cpu.waittime': 
      { type: 'time',
        label: 'aggregated wait time',
        module: 'cpu',
        stat: 'waittime',
        fields: [Object],
        interval: 'interval' },
     'moray.queries': 
      { label: 'SQL queries',
        module: 'moray',
        stat: 'queries',
        fields: [Object],
        unit: 'queries',
        interval: 'interval' },
     'postgres.queries': 
      { label: 'queries',
        module: 'postgres',
        stat: 'queries',
        fields: [Object],
        unit: 'queries',
        interval: 'interval' },
     'mantaop.supervisor_deletes': 
      { label: 'supervisor delete requests',
        module: 'mantaop',
        stat: 'supervisor_deletes',
        fields: [Object],
        unit: 'requests',
        interval: 'interval' },
     'memory.swap_limit': 
      { type: 'size',
        label: 'maximum virtual memory reserved',
        module: 'memory',
        stat: 'swap_limit',
        fields: [Object],
        interval: 'point' },
     'nic.nics': 
      { label: 'NICs',
        module: 'nic',
        stat: 'nics',
        fields: [Object],
        unit: 'NICs',
        interval: 'point' },
     'ca.instr_ticks': 
      { label: 'instrumenter ticks',
        module: 'ca',
        stat: 'instr_ticks',
        fields: [Object],
        unit: 'ticks',
        interval: 'interval' },
     'restify.server_ops': 
      { label: 'server operations',
        module: 'restify',
        stat: 'server_ops',
        fields: [Object],
        unit: 'operations',
        interval: 'interval' },
     'unix.proc_exits': 
      { label: 'process exits',
        module: 'unix',
        stat: 'proc_exits',
        fields: [Object],
        unit: 'processes',
        interval: 'interval' },
     'mantaop.tasks_executed': 
      { label: 'tasks executed',
        module: 'mantaop',
        stat: 'tasks_executed',
        fields: [Object],
        unit: 'tasks',
        interval: 'interval' },
     'mantaop.zone_resets': 
      { label: 'zone resets',
        module: 'mantaop',
        stat: 'zone_resets',
        fields: [Object],
        unit: 'resets',
        interval: 'interval' },
     'disk.physio_bytes': 
      { type: 'size',
        label: 'bytes read and written',
        module: 'disk',
        stat: 'physio_bytes',
        fields: [Object],
        interval: 'interval' },
     'node.socket_ops': 
      { label: 'socket operations',
        module: 'node',
        stat: 'socket_ops',
        fields: [Object],
        unit: 'operations',
        interval: 'interval' },
     'memory.reclaimed_bytes': 
      { type: 'size',
        label: 'excess memory reclaimed',
        module: 'memory',
        stat: 'reclaimed_bytes',
        fields: [Object],
        interval: 'interval' },
     'vm.exits': 
      { label: 'exits',
        module: 'vm',
        stat: 'exits',
        fields: [Object],
        unit: 'exits',
        interval: 'interval' },
     'restify.handler_ops': 
      { label: 'handler operations',
        module: 'restify',
        stat: 'handler_ops',
        fields: [Object],
        unit: 'operations',
        interval: 'interval' },
     'vm.thread_samples': 
      { label: 'thread samples',
        module: 'vm',
        stat: 'thread_samples',
        fields: [Object],
        unit: 'samples',
        interval: 'interval' },
     'syscall.syscalls': 
      { label: 'system calls',
        module: 'syscall',
        stat: 'syscalls',
        fields: [Object],
        unit: 'syscalls',
        interval: 'interval' },
     'cpu.thread_samples': 
      { label: 'thread samples',
        module: 'cpu',
        stat: 'thread_samples',
        fields: [Object],
        unit: 'samples',
        interval: 'interval' },
     'memory.pageins': 
      { label: 'pages paged in',
        module: 'memory',
        stat: 'pageins',
        fields: [Object],
        unit: 'pages',
        interval: 'interval' },
     'mantaop.supervisor_locates': 
      { label: 'supervisor locate requests',
        module: 'mantaop',
        stat: 'supervisor_locates',
        fields: [Object],
        unit: 'requests',
        interval: 'interval' },
     'mysql.filesort': 
      { label: 'filesort',
        module: 'mysql',
        stat: 'filesort',
        fields: [Object],
        unit: 'filesorts',
        interval: 'interval' },
     'mysql.connections': 
      { label: 'connections',
        module: 'mysql',
        stat: 'connections',
        fields: [Object],
        unit: 'connections',
        interval: 'interval' },
     'unix.thr_creates': 
      { label: 'thread creations',
        module: 'unix',
        stat: 'thr_creates',
        fields: [Object],
        unit: 'threads',
        interval: 'interval' },
     'ldapjs.connections': 
      { label: 'connections',
        module: 'ldapjs',
        stat: 'connections',
        fields: [Object],
        unit: 'connections',
        interval: 'interval' },
     'moray.ops': 
      { label: 'operations',
        module: 'moray',
        stat: 'ops',
        fields: [Object],
        unit: 'operations',
        interval: 'interval' },
     'ca.instr_disables': 
      { label: 'instrumenter disable operations',
        module: 'ca',
        stat: 'instr_disables',
        fields: [Object],
        unit: 'operations',
        interval: 'interval' },
     'fs.logical_rwbytes': 
      { type: 'size',
        label: 'logical bytes read/written',
        module: 'fs',
        stat: 'logical_rwbytes',
        fields: [Object],
        interval: 'interval' },
     'memory.swap': 
      { type: 'size',
        label: 'virtual memory reserved',
        module: 'memory',
        stat: 'swap',
        fields: [Object],
        interval: 'point' },
     'unix.proc_forks': 
      { label: 'process forks',
        module: 'unix',
        stat: 'proc_forks',
        fields: [Object],
        unit: 'processes',
        interval: 'interval' },
     'ldapjs.search_ops': 
      { label: 'search operations',
        module: 'ldapjs',
        stat: 'search_ops',
        fields: [Object],
        unit: 'operations',
        interval: 'interval' },
     'vm.physio_ops': 
      { label: 'disk I/O operations',
        module: 'vm',
        stat: 'physio_ops',
        fields: [Object],
        unit: 'operations',
        interval: 'interval' },
     'cpu.loadavg1': 
      { type: 'number',
        label: '1-minute load average',
        module: 'cpu',
        stat: 'loadavg1',
        fields: [Object],
        interval: 'point' },
     'nic.bytes': 
      { type: 'size',
        label: 'bytes sent and received',
        module: 'nic',
        stat: 'bytes',
        fields: [Object],
        interval: 'interval' },
     'zfs.dataset_unused_quota': 
      { type: 'size',
        label: 'unused quota',
        module: 'zfs',
        stat: 'dataset_unused_quota',
        fields: [Object],
        interval: 'point' },
     'memory.rss': 
      { type: 'size',
        label: 'resident set size',
        module: 'memory',
        stat: 'rss',
        fields: [Object],
        interval: 'point' },
     'apache.httpd_ops': 
      { label: 'HTTP requests',
        module: 'apache',
        stat: 'httpd_ops',
        fields: [Object],
        unit: 'requests',
        interval: 'interval' },
     'nic.vnic_bytes': 
      { type: 'size',
        label: 'VNIC bytes sent and received',
        module: 'nic',
        stat: 'vnic_bytes',
        fields: [Object],
        interval: 'interval' },
     'zfs.dataset_used': 
      { type: 'size',
        label: 'used space',
        module: 'zfs',
        stat: 'dataset_used',
        fields: [Object],
        interval: 'point' },
     'tcp.connects': 
      { label: 'connects',
        module: 'tcp',
        stat: 'connects',
        fields: [Object],
        unit: 'connects',
        interval: 'interval' },
     'mantaop.supervisor_errors': 
      { label: 'supervisor errors',
        module: 'mantaop',
        stat: 'supervisor_errors',
        fields: [Object],
        unit: 'errors',
        interval: 'interval' },
     'mantaop.tasks_committed': 
      { label: 'tasks committed',
        module: 'mantaop',
        stat: 'tasks_committed',
        fields: [Object],
        unit: 'tasks',
        interval: 'interval' },
     'mysql.queries': 
      { label: 'queries',
        module: 'mysql',
        stat: 'queries',
        fields: [Object],
        unit: 'queries',
        interval: 'interval' },
     'node.gc_ops': 
      { label: 'garbage collection operations',
        module: 'node',
        stat: 'gc_ops',
        fields: [Object],
        unit: 'operations',
        interval: 'interval' },
     'nic.vnic_packets': 
      { label: 'VNIC packets sent and received',
        module: 'nic',
        stat: 'vnic_packets',
        fields: [Object],
        unit: 'packets',
        interval: 'interval' },
     'zfs.dataset_quota': 
      { type: 'size',
        label: 'quota size',
        module: 'zfs',
        stat: 'dataset_quota',
        fields: [Object],
        interval: 'point' },
     'tcp.errors': 
      { label: 'errors',
        module: 'tcp',
        stat: 'errors',
        fields: [Object],
        unit: 'errors',
        interval: 'interval' },
     'unix.proc_execs': 
      { label: 'process execs',
        module: 'unix',
        stat: 'proc_execs',
        fields: [Object],
        unit: 'processes',
        interval: 'interval' },
     'disk.disks': 
      { label: 'disks',
        module: 'disk',
        stat: 'disks',
        fields: [Object],
        unit: 'disks',
        interval: 'point' },
     'fs.logical_rwops': 
      { label: 'logical read/write operations',
        module: 'fs',
        stat: 'logical_rwops',
        fields: [Object],
        unit: 'operations',
        interval: 'interval' },
     'cpu.usage': 
      { label: 'aggregated CPU usage',
        module: 'cpu',
        stat: 'usage',
        fields: [Object],
        unit: 'percent of 1 CPU',
        interval: 'point' },
     'disk.physio_ops': 
      { label: 'I/O operations',
        module: 'disk',
        stat: 'physio_ops',
        fields: [Object],
        unit: 'operations',
        interval: 'interval' },
     'ldapjs.ops': 
      { label: 'all operations',
        module: 'ldapjs',
        stat: 'ops',
        fields: [Object],
        unit: 'operations',
        interval: 'interval' },
     'tcp.segments': 
      { label: 'segments',
        module: 'tcp',
        stat: 'segments',
        fields: [Object],
        unit: 'segments',
        interval: 'interval' },
     'zfs.arc_ops': 
      { label: 'ARC operations',
        module: 'zfs',
        stat: 'arc_ops',
        fields: [Object],
        unit: 'operations',
        interval: 'interval' },
     'vm.irqs': 
      { label: 'interrupt requests',
        module: 'vm',
        stat: 'irqs',
        fields: [Object],
        unit: 'requests',
        interval: 'interval' },
     'nic.packets': 
      { label: 'packets sent and received',
        module: 'nic',
        stat: 'packets',
        fields: [Object],
        unit: 'packets',
        interval: 'interval' },
     'fs.logical_ops': 
      { label: 'logical filesystem operations',
        module: 'fs',
        stat: 'logical_ops',
        fields: [Object],
        unit: 'operations',
        interval: 'interval' },
     'mantaop.tasks_killed': 
      { label: 'tasks killed',
        module: 'mantaop',
        stat: 'tasks_killed',
        fields: [Object],
        unit: 'tasks',
        interval: 'interval' },
     'node.httpd_ops': 
      { label: 'HTTP server operations',
        module: 'node',
        stat: 'httpd_ops',
        fields: [Object],
        unit: 'operations',
        interval: 'interval' },
     'zfs.pool_total': 
      { type: 'size',
        label: 'total space in pool',
        module: 'zfs',
        stat: 'pool_total',
        fields: [Object],
        interval: 'point' },
     'mantaop.tasks_dispatched': 
      { label: 'tasks dispatched',
        module: 'mantaop',
        stat: 'tasks_dispatched',
        fields: [Object],
        unit: 'tasks',
        interval: 'interval' },
     'ca.instr_beops': 
      { label: 'instrumenter backend requests',
        module: 'ca',
        stat: 'instr_beops',
        fields: [Object],
        unit: 'requests',
        interval: 'interval' },
     'cpu.thread_executions': 
      { label: 'thread executions',
        module: 'cpu',
        stat: 'thread_executions',
        fields: [Object],
        unit: 'operations',
        interval: 'interval' },
     'zfs.pool_free': 
      { type: 'size',
        label: 'free space in pool',
        module: 'zfs',
        stat: 'pool_free',
        fields: [Object],
        interval: 'point' },
     'node.httpc_ops': 
      { label: 'HTTP client operations',
        module: 'node',
        stat: 'httpc_ops',
        fields: [Object],
        unit: 'operations',
        interval: 'interval' },
     'tcp.accepts': 
      { label: 'accepts',
        module: 'tcp',
        stat: 'accepts',
        fields: [Object],
        unit: 'accepts',
        interval: 'interval' },
     'zfs.pool_used': 
      { type: 'size',
        label: 'used space in pool',
        module: 'zfs',
        stat: 'pool_used',
        fields: [Object],
        interval: 'point' } },
  cmm_name: undefined,
  cmm_messages: [ [length]: 0 ],
  cmm_nerrors: 0,
  cmm_modules: 
   { restify: { label: 'Restify', name: 'restify' },
     zfs: { label: 'ZFS', name: 'zfs' },
     ca: { label: 'CA', name: 'ca' },
     node: { label: 'Node.js 0.4.x', name: 'node' },
     mysql: { label: 'MySQL', name: 'mysql' },
     fs: { label: 'Filesystem', name: 'fs' },
     apache: { label: 'Apache', name: 'apache' },
     unix: { label: 'OS', name: 'unix' },
     moray: { label: 'Moray', name: 'moray' },
     mantaop: { label: 'Manta (operator)', name: 'mantaop' },
     disk: { label: 'Disk', name: 'disk' },
     vm: { label: 'Virtual Machine', name: 'vm' },
     tcp: { label: 'TCP', name: 'tcp' },
     memory: { label: 'Memory', name: 'memory' },
     postgres: { label: 'Postgres', name: 'postgres' },
     nic: { label: 'Network interface', name: 'nic' },
     syscall: { label: 'System calls', name: 'syscall' },
     ldapjs: { label: 'ldapjs', name: 'ldapjs' },
     cpu: { label: 'CPU', name: 'cpu' } },
  cmm_nwarnings: 0 }
-------METADATA   END---------
[2015-06-13 20:51:00.394 UTC] DBG    
----------------------------------------
this string fstype;

fbt::fop_read:entry,
fbt::fop_write:entry,
fbt::fop_ioctl:entry,
fbt::fop_access:entry,
fbt::fop_getattr:entry,
fbt::fop_setattr:entry,
fbt::fop_lookup:entry,
fbt::fop_create:entry,
fbt::fop_remove:entry,
fbt::fop_link:entry,
fbt::fop_rename:entry,
fbt::fop_mkdir:entry,
fbt::fop_rmdir:entry,
fbt::fop_readdir:entry,
fbt::fop_symlink:entry,
fbt::fop_readlink:entry,
fbt::fop_fsync:entry,
fbt::fop_getpage:entry,
fbt::fop_putpage:entry,
fbt::fop_map:entry,
fbt::fop_open:entry
/((self->vnode0 == NULL))/{
	self->vnode0 = arg0;
	self->depth0 = stackdepth;
	self->latency0 = timestamp;
}

fbt::fop_open:return
/((((((self->vnode0) != NULL)))) && (((((self->depth0) != NULL)))) && (((((self->latency0) != NULL)))) && (((((this->fstype = stringof((*((vnode_t**)self->vnode0))->v_op->vnop_name)) != NULL || 1)))) && (self->depth0 == stackdepth && self->vnode0 != NULL && (this->fstype == "ufs" || this->fstype == "zfs" || this->fstype == "dev" || this->fstype == "dev fs" || this->fstype == "proc" || this->fstype == "lofs" || this->fstype == "tmpfs" || this->fstype == "nfs")))/{
	@[((probefunc + 4))] = llquantize((timestamp - self->latency0), 10, 3, 11, 100);
}

fbt::fop_read:return,
fbt::fop_write:return,
fbt::fop_ioctl:return,
fbt::fop_access:return,
fbt::fop_getattr:return,
fbt::fop_setattr:return,
fbt::fop_lookup:return,
fbt::fop_create:return,
fbt::fop_remove:return,
fbt::fop_link:return,
fbt::fop_rename:return,
fbt::fop_mkdir:return,
fbt::fop_rmdir:return,
fbt::fop_readdir:return,
fbt::fop_symlink:return,
fbt::fop_readlink:return,
fbt::fop_fsync:return,
fbt::fop_getpage:return,
fbt::fop_putpage:return,
fbt::fop_map:return
/((((((self->vnode0) != NULL)))) && (((((self->depth0) != NULL)))) && (((((self->latency0) != NULL)))) && (((((this->fstype = stringof(((vnode_t*)self->vnode0)->v_op->vnop_name)) != NULL || 1)))) && (self->depth0 == stackdepth && self->vnode0 != NULL && (this->fstype == "ufs" || this->fstype == "zfs" || this->fstype == "dev" || this->fstype == "dev fs" || this->fstype == "proc" || this->fstype == "lofs" || this->fstype == "tmpfs" || this->fstype == "nfs")))/{
	@[((probefunc + 4))] = llquantize((timestamp - self->latency0), 10, 3, 11, 100);
}

fbt::fop_read:return,
fbt::fop_write:return,
fbt::fop_ioctl:return,
fbt::fop_access:return,
fbt::fop_getattr:return,
fbt::fop_setattr:return,
fbt::fop_lookup:return,
fbt::fop_create:return,
fbt::fop_remove:return,
fbt::fop_link:return,
fbt::fop_rename:return,
fbt::fop_mkdir:return,
fbt::fop_rmdir:return,
fbt::fop_readdir:return,
fbt::fop_symlink:return,
fbt::fop_readlink:return,
fbt::fop_fsync:return,
fbt::fop_getpage:return,
fbt::fop_putpage:return,
fbt::fop_map:return,
fbt::fop_open:entry
/((self->depth0 == stackdepth))/{
	(self->vnode0) = 0;
	(self->depth0) = 0;
	(self->latency0) = 0;
}

----------------------------------------
[2015-06-13 20:51:02.104 UTC] INFO   instrumented global;6 (fs.logical_ops)
-------DESC BEGIN---------
{ fields_internal: [ 'vnode', 'depth', [length]: 2 ],
  fields: 
   [ 'hostname',
     'zonename',
     'pid',
     'execname',
     'psargs',
     'ppid',
     'pexecname',
     'ppsargs',
     'fstype',
     'optype',
     'latency',
     [length]: 11 ],
  stat: 'logical_ops',
  metad: 
   { probedesc: [ [Object], [Object], [Object], [Object], [length]: 4 ],
     locals: [ [Object], [length]: 1 ] },
  module: 'fs' }
-------DESC   END---------
-------METRIC BEGIN---------
{ is_backend: 'dtrace',
  is_module: 'fs',
  is_predicate: {},
  is_stat: 'logical_ops',
  is_granularity: 5,
  is_decomposition: [ 'optype', 'latency', [length]: 2 ],
  is_fqid: 'global;7' }
-------METRIC   END---------
-------METADATA BEGIN---------
{ cmm_types: 
   { string: { name: 'string', unit: '', arity: 'discrete' },
     number: { name: 'number', unit: '', arity: 'numeric' },
     subsecond: 
      { name: 'subsecond',
        unit: 'seconds',
        abbr: 's',
        base: 10,
        arity: 'numeric',
        power: -3 },
     percent: 
      { name: 'percent',
        unit: 'percent',
        abbr: '%',
        arity: 'numeric',
        minmax: 100 },
     time: 
      { name: 'time',
        unit: 'seconds',
        abbr: 's',
        base: 10,
        arity: 'numeric',
        power: -9 },
     size: 
      { name: 'size',
        unit: 'bytes',
        abbr: 'B',
        base: 2,
        arity: 'numeric' } },
  cmm_fields: 
   { latency: { type: 'time', label: 'latency', name: 'latency' },
     nthreads: { type: 'number', label: 'number of threads', name: 'nthreads' },
     vleavereason: 
      { type: 'string',
        label: 'reason leaving vCPU',
        name: 'vleavereason' },
     cputime: { type: 'time', label: 'CPU time', name: 'cputime' },
     zpool: { label: 'ZFS pool', name: 'zpool' },
     cpumode: { label: 'CPU mode', name: 'cpumode' },
     command: { label: 'command', name: 'command' },
     psargs: { label: 'process arguments', name: 'psargs' },
     pid: { label: 'process identifier', name: 'pid' },
     jobid: { label: 'jobid', name: 'jobid' },
     gctype: { label: 'GC type', name: 'gctype' },
     nic: { label: 'NIC name', name: 'nic' },
     restify_sname: { label: 'restify server name', name: 'restify_sname' },
     walltime: { type: 'time', label: 'process runtime', name: 'walltime' },
     syscall: { label: 'syscall', name: 'syscall' },
     errtype: { label: 'error type', name: 'errtype' },
     iops_read: 
      { type: 'number',
        label: 'read I/O operations',
        name: 'iops_read' },
     iops_write: 
      { type: 'number',
        label: 'write I/O operations',
        name: 'iops_write' },
     rss: { type: 'size', label: 'resident set size', name: 'rss' },
     http_status: { label: 'Status Code', name: 'http_status' },
     cainstnid: { label: 'instrumentation identifier', name: 'cainstnid' },
     packets_out: { type: 'number', label: 'packets sent', name: 'packets_out' },
     subsecond: 
      { type: 'subsecond',
        label: 'subsecond offset',
        name: 'subsecond' },
     http_method: { label: 'method', name: 'http_method' },
     errno: { type: 'string', label: 'error code', name: 'errno' },
     http_path: { label: 'URL path', name: 'http_path' },
     rowsmatched: { type: 'number', label: 'rows matched', name: 'rowsmatched' },
     bytes: { type: 'size', label: 'bytes read and written', name: 'bytes' },
     vmmmuctx: { type: 'string', label: 'VM MMU context', name: 'vmmmuctx' },
     tcpstack: { label: 'TCP instance', name: 'tcpstack' },
     packets_in: { type: 'number', label: 'packets received', name: 'packets_in' },
     irqvector: { type: 'string', label: 'IRQ vector', name: 'irqvector' },
     busytime: { type: 'percent', label: 'non-idle time', name: 'busytime' },
     leavereason: { label: 'reason leaving CPU', name: 'leavereason' },
     bytes_write: { type: 'size', label: 'bytes written', name: 'bytes_write' },
     contract: { label: 'contract identifier', name: 'contract' },
     hostname: { label: 'server hostname', name: 'hostname' },
     zdataset: { label: 'ZFS dataset', name: 'zdataset' },
     iops: { type: 'number', label: 'I/O operations', name: 'iops' },
     user: { label: 'client username', name: 'user' },
     cametric: { label: 'metric name', name: 'cametric' },
     querysubstr: { label: 'query substring', name: 'querysubstr' },
     pmodel: { label: 'process model', name: 'pmodel' },
     pexecname: { label: 'parent application name', name: 'pexecname' },
     raddr: { label: 'remote IP address', name: 'raddr' },
     bytes_read: { type: 'size', label: 'bytes read', name: 'bytes_read' },
     ldapbinddn: { label: 'bind DN', name: 'ldapbinddn' },
     offset: { type: 'size', label: 'offset', name: 'offset' },
     disk: { label: 'device name', name: 'disk' },
     optype: { label: 'operation type', name: 'optype' },
     execname: { label: 'application name', name: 'execname' },
     direction: { label: 'sent/received', name: 'direction' },
     statement: { label: 'statement type', name: 'statement' },
     restify_hname: { label: 'restify handler name', name: 'restify_hname' },
     ldaprequestdn: { label: 'request DN', name: 'ldaprequestdn' },
     ldapscope: { label: 'search scope', name: 'ldapscope' },
     parsed: { label: 'parsed', name: 'parsed' },
     ldapfilter: { label: 'search filter', name: 'ldapfilter' },
     rport: { label: 'remote TCP port', name: 'rport' },
     objname: { label: 'object name', name: 'objname' },
     client: { label: 'client hostname', name: 'client' },
     restify_rname: { label: 'restify route name', name: 'restify_rname' },
     vcpuid: { type: 'string', label: 'vCPU identifier', name: 'vcpuid' },
     size: { type: 'size', label: 'size', name: 'size' },
     status: { label: 'status', name: 'status' },
     ppid: { label: 'parent process identifier', name: 'ppid' },
     cabackend: { label: 'backend module', name: 'cabackend' },
     http_origin: { label: 'reported origin IP', name: 'http_origin' },
     runtime: { type: 'time', label: 'time on CPU', name: 'runtime' },
     table: { label: 'table name', name: 'table' },
     rowschanged: { type: 'number', label: 'rows changed', name: 'rowschanged' },
     utilization: { type: 'percent', label: 'utilization', name: 'utilization' },
     packets: 
      { type: 'number',
        label: 'packets sent and received',
        name: 'packets' },
     database: { label: 'database name', name: 'database' },
     ppsargs: { label: 'parent process arguments', name: 'ppsargs' },
     fstype: { label: 'filesystem type', name: 'fstype' },
     cpu: { label: 'CPU identifier', name: 'cpu' },
     http_url: { label: 'URL', name: 'http_url' },
     errname: { label: 'error name', name: 'errname' },
     zonename: { label: 'zone name', name: 'zonename' },
     buffered: 
      { type: 'size',
        label: 'bytes buffered on socket',
        name: 'buffered' } },
  cmm_metrics: 
   { 'memory.rss_limit': 
      { type: 'size',
        label: 'maximum resident set size',
        module: 'memory',
        stat: 'rss_limit',
        fields: [Object],
        interval: 'point' },
     'mantaop.supervisor_auths': 
      { label: 'supervisor auth requests',
        module: 'mantaop',
        stat: 'supervisor_auths',
        fields: [Object],
        unit: 'requests',
        interval: 'interval' },
     'mantaop.jobs_assigned': 
      { label: 'jobs assigned',
        module: 'mantaop',
        stat: 'jobs_assigned',
        fields: [Object],
        unit: 'jobs',
        interval: 'interval' },
     'cpu.cpus': 
      { label: 'CPUs',
        module: 'cpu',
        stat: 'cpus',
        fields: [Object],
        unit: 'CPUs',
        interval: 'point' },
     'vm.physio_bytes': 
      { type: 'size',
        label: 'disk bytes read and written',
        module: 'vm',
        stat: 'physio_bytes',
        fields: [Object],
        interval: 'interval' },
     'ca.instr_enables': 
      { label: 'instrumenter enable operations',
        module: 'ca',
        stat: 'instr_enables',
        fields: [Object],
        unit: 'operations',
        interval: 'interval' },
     'unix.processes': 
      { label: 'processes',
        module: 'unix',
        stat: 'processes',
        fields: [Object],
        unit: 'processes',
        interval: 'interval' },
     'mysql.commands': 
      { label: 'commands',
        module: 'mysql',
        stat: 'commands',
        fields: [Object],
        unit: 'commands',
        interval: 'interval' },
     'mysql.statements': 
      { label: 'statements',
        module: 'mysql',
        stat: 'statements',
        fields: [Object],
        unit: 'statements',
        interval: 'interval' },
     'cpu.waittime': 
      { type: 'time',
        label: 'aggregated wait time',
        module: 'cpu',
        stat: 'waittime',
        fields: [Object],
        interval: 'interval' },
     'moray.queries': 
      { label: 'SQL queries',
        module: 'moray',
        stat: 'queries',
        fields: [Object],
        unit: 'queries',
        interval: 'interval' },
     'postgres.queries': 
      { label: 'queries',
        module: 'postgres',
        stat: 'queries',
        fields: [Object],
        unit: 'queries',
        interval: 'interval' },
     'mantaop.supervisor_deletes': 
      { label: 'supervisor delete requests',
        module: 'mantaop',
        stat: 'supervisor_deletes',
        fields: [Object],
        unit: 'requests',
        interval: 'interval' },
     'memory.swap_limit': 
      { type: 'size',
        label: 'maximum virtual memory reserved',
        module: 'memory',
        stat: 'swap_limit',
        fields: [Object],
        interval: 'point' },
     'nic.nics': 
      { label: 'NICs',
        module: 'nic',
        stat: 'nics',
        fields: [Object],
        unit: 'NICs',
        interval: 'point' },
     'ca.instr_ticks': 
      { label: 'instrumenter ticks',
        module: 'ca',
        stat: 'instr_ticks',
        fields: [Object],
        unit: 'ticks',
        interval: 'interval' },
     'restify.server_ops': 
      { label: 'server operations',
        module: 'restify',
        stat: 'server_ops',
        fields: [Object],
        unit: 'operations',
        interval: 'interval' },
     'unix.proc_exits': 
      { label: 'process exits',
        module: 'unix',
        stat: 'proc_exits',
        fields: [Object],
        unit: 'processes',
        interval: 'interval' },
     'mantaop.tasks_executed': 
      { label: 'tasks executed',
        module: 'mantaop',
        stat: 'tasks_executed',
        fields: [Object],
        unit: 'tasks',
        interval: 'interval' },
     'mantaop.zone_resets': 
      { label: 'zone resets',
        module: 'mantaop',
        stat: 'zone_resets',
        fields: [Object],
        unit: 'resets',
        interval: 'interval' },
     'disk.physio_bytes': 
      { type: 'size',
        label: 'bytes read and written',
        module: 'disk',
        stat: 'physio_bytes',
        fields: [Object],
        interval: 'interval' },
     'node.socket_ops': 
      { label: 'socket operations',
        module: 'node',
        stat: 'socket_ops',
        fields: [Object],
        unit: 'operations',
        interval: 'interval' },
     'memory.reclaimed_bytes': 
      { type: 'size',
        label: 'excess memory reclaimed',
        module: 'memory',
        stat: 'reclaimed_bytes',
        fields: [Object],
        interval: 'interval' },
     'vm.exits': 
      { label: 'exits',
        module: 'vm',
        stat: 'exits',
        fields: [Object],
        unit: 'exits',
        interval: 'interval' },
     'restify.handler_ops': 
      { label: 'handler operations',
        module: 'restify',
        stat: 'handler_ops',
        fields: [Object],
        unit: 'operations',
        interval: 'interval' },
     'vm.thread_samples': 
      { label: 'thread samples',
        module: 'vm',
        stat: 'thread_samples',
        fields: [Object],
        unit: 'samples',
        interval: 'interval' },
     'syscall.syscalls': 
      { label: 'system calls',
        module: 'syscall',
        stat: 'syscalls',
        fields: [Object],
        unit: 'syscalls',
        interval: 'interval' },
     'cpu.thread_samples': 
      { label: 'thread samples',
        module: 'cpu',
        stat: 'thread_samples',
        fields: [Object],
        unit: 'samples',
        interval: 'interval' },
     'memory.pageins': 
      { label: 'pages paged in',
        module: 'memory',
        stat: 'pageins',
        fields: [Object],
        unit: 'pages',
        interval: 'interval' },
     'mantaop.supervisor_locates': 
      { label: 'supervisor locate requests',
        module: 'mantaop',
        stat: 'supervisor_locates',
        fields: [Object],
        unit: 'requests',
        interval: 'interval' },
     'mysql.filesort': 
      { label: 'filesort',
        module: 'mysql',
        stat: 'filesort',
        fields: [Object],
        unit: 'filesorts',
        interval: 'interval' },
     'mysql.connections': 
      { label: 'connections',
        module: 'mysql',
        stat: 'connections',
        fields: [Object],
        unit: 'connections',
        interval: 'interval' },
     'unix.thr_creates': 
      { label: 'thread creations',
        module: 'unix',
        stat: 'thr_creates',
        fields: [Object],
        unit: 'threads',
        interval: 'interval' },
     'ldapjs.connections': 
      { label: 'connections',
        module: 'ldapjs',
        stat: 'connections',
        fields: [Object],
        unit: 'connections',
        interval: 'interval' },
     'moray.ops': 
      { label: 'operations',
        module: 'moray',
        stat: 'ops',
        fields: [Object],
        unit: 'operations',
        interval: 'interval' },
     'ca.instr_disables': 
      { label: 'instrumenter disable operations',
        module: 'ca',
        stat: 'instr_disables',
        fields: [Object],
        unit: 'operations',
        interval: 'interval' },
     'fs.logical_rwbytes': 
      { type: 'size',
        label: 'logical bytes read/written',
        module: 'fs',
        stat: 'logical_rwbytes',
        fields: [Object],
        interval: 'interval' },
     'memory.swap': 
      { type: 'size',
        label: 'virtual memory reserved',
        module: 'memory',
        stat: 'swap',
        fields: [Object],
        interval: 'point' },
     'unix.proc_forks': 
      { label: 'process forks',
        module: 'unix',
        stat: 'proc_forks',
        fields: [Object],
        unit: 'processes',
        interval: 'interval' },
     'ldapjs.search_ops': 
      { label: 'search operations',
        module: 'ldapjs',
        stat: 'search_ops',
        fields: [Object],
        unit: 'operations',
        interval: 'interval' },
     'vm.physio_ops': 
      { label: 'disk I/O operations',
        module: 'vm',
        stat: 'physio_ops',
        fields: [Object],
        unit: 'operations',
        interval: 'interval' },
     'cpu.loadavg1': 
      { type: 'number',
        label: '1-minute load average',
        module: 'cpu',
        stat: 'loadavg1',
        fields: [Object],
        interval: 'point' },
     'nic.bytes': 
      { type: 'size',
        label: 'bytes sent and received',
        module: 'nic',
        stat: 'bytes',
        fields: [Object],
        interval: 'interval' },
     'zfs.dataset_unused_quota': 
      { type: 'size',
        label: 'unused quota',
        module: 'zfs',
        stat: 'dataset_unused_quota',
        fields: [Object],
        interval: 'point' },
     'memory.rss': 
      { type: 'size',
        label: 'resident set size',
        module: 'memory',
        stat: 'rss',
        fields: [Object],
        interval: 'point' },
     'apache.httpd_ops': 
      { label: 'HTTP requests',
        module: 'apache',
        stat: 'httpd_ops',
        fields: [Object],
        unit: 'requests',
        interval: 'interval' },
     'nic.vnic_bytes': 
      { type: 'size',
        label: 'VNIC bytes sent and received',
        module: 'nic',
        stat: 'vnic_bytes',
        fields: [Object],
        interval: 'interval' },
     'zfs.dataset_used': 
      { type: 'size',
        label: 'used space',
        module: 'zfs',
        stat: 'dataset_used',
        fields: [Object],
        interval: 'point' },
     'tcp.connects': 
      { label: 'connects',
        module: 'tcp',
        stat: 'connects',
        fields: [Object],
        unit: 'connects',
        interval: 'interval' },
     'mantaop.supervisor_errors': 
      { label: 'supervisor errors',
        module: 'mantaop',
        stat: 'supervisor_errors',
        fields: [Object],
        unit: 'errors',
        interval: 'interval' },
     'mantaop.tasks_committed': 
      { label: 'tasks committed',
        module: 'mantaop',
        stat: 'tasks_committed',
        fields: [Object],
        unit: 'tasks',
        interval: 'interval' },
     'mysql.queries': 
      { label: 'queries',
        module: 'mysql',
        stat: 'queries',
        fields: [Object],
        unit: 'queries',
        interval: 'interval' },
     'node.gc_ops': 
      { label: 'garbage collection operations',
        module: 'node',
        stat: 'gc_ops',
        fields: [Object],
        unit: 'operations',
        interval: 'interval' },
     'nic.vnic_packets': 
      { label: 'VNIC packets sent and received',
        module: 'nic',
        stat: 'vnic_packets',
        fields: [Object],
        unit: 'packets',
        interval: 'interval' },
     'zfs.dataset_quota': 
      { type: 'size',
        label: 'quota size',
        module: 'zfs',
        stat: 'dataset_quota',
        fields: [Object],
        interval: 'point' },
     'tcp.errors': 
      { label: 'errors',
        module: 'tcp',
        stat: 'errors',
        fields: [Object],
        unit: 'errors',
        interval: 'interval' },
     'unix.proc_execs': 
      { label: 'process execs',
        module: 'unix',
        stat: 'proc_execs',
        fields: [Object],
        unit: 'processes',
        interval: 'interval' },
     'disk.disks': 
      { label: 'disks',
        module: 'disk',
        stat: 'disks',
        fields: [Object],
        unit: 'disks',
        interval: 'point' },
     'fs.logical_rwops': 
      { label: 'logical read/write operations',
        module: 'fs',
        stat: 'logical_rwops',
        fields: [Object],
        unit: 'operations',
        interval: 'interval' },
     'cpu.usage': 
      { label: 'aggregated CPU usage',
        module: 'cpu',
        stat: 'usage',
        fields: [Object],
        unit: 'percent of 1 CPU',
        interval: 'point' },
     'disk.physio_ops': 
      { label: 'I/O operations',
        module: 'disk',
        stat: 'physio_ops',
        fields: [Object],
        unit: 'operations',
        interval: 'interval' },
     'ldapjs.ops': 
      { label: 'all operations',
        module: 'ldapjs',
        stat: 'ops',
        fields: [Object],
        unit: 'operations',
        interval: 'interval' },
     'tcp.segments': 
      { label: 'segments',
        module: 'tcp',
        stat: 'segments',
        fields: [Object],
        unit: 'segments',
        interval: 'interval' },
     'zfs.arc_ops': 
      { label: 'ARC operations',
        module: 'zfs',
        stat: 'arc_ops',
        fields: [Object],
        unit: 'operations',
        interval: 'interval' },
     'vm.irqs': 
      { label: 'interrupt requests',
        module: 'vm',
        stat: 'irqs',
        fields: [Object],
        unit: 'requests',
        interval: 'interval' },
     'nic.packets': 
      { label: 'packets sent and received',
        module: 'nic',
        stat: 'packets',
        fields: [Object],
        unit: 'packets',
        interval: 'interval' },
     'fs.logical_ops': 
      { label: 'logical filesystem operations',
        module: 'fs',
        stat: 'logical_ops',
        fields: [Object],
        unit: 'operations',
        interval: 'interval' },
     'mantaop.tasks_killed': 
      { label: 'tasks killed',
        module: 'mantaop',
        stat: 'tasks_killed',
        fields: [Object],
        unit: 'tasks',
        interval: 'interval' },
     'node.httpd_ops': 
      { label: 'HTTP server operations',
        module: 'node',
        stat: 'httpd_ops',
        fields: [Object],
        unit: 'operations',
        interval: 'interval' },
     'zfs.pool_total': 
      { type: 'size',
        label: 'total space in pool',
        module: 'zfs',
        stat: 'pool_total',
        fields: [Object],
        interval: 'point' },
     'mantaop.tasks_dispatched': 
      { label: 'tasks dispatched',
        module: 'mantaop',
        stat: 'tasks_dispatched',
        fields: [Object],
        unit: 'tasks',
        interval: 'interval' },
     'ca.instr_beops': 
      { label: 'instrumenter backend requests',
        module: 'ca',
        stat: 'instr_beops',
        fields: [Object],
        unit: 'requests',
        interval: 'interval' },
     'cpu.thread_executions': 
      { label: 'thread executions',
        module: 'cpu',
        stat: 'thread_executions',
        fields: [Object],
        unit: 'operations',
        interval: 'interval' },
     'zfs.pool_free': 
      { type: 'size',
        label: 'free space in pool',
        module: 'zfs',
        stat: 'pool_free',
        fields: [Object],
        interval: 'point' },
     'node.httpc_ops': 
      { label: 'HTTP client operations',
        module: 'node',
        stat: 'httpc_ops',
        fields: [Object],
        unit: 'operations',
        interval: 'interval' },
     'tcp.accepts': 
      { label: 'accepts',
        module: 'tcp',
        stat: 'accepts',
        fields: [Object],
        unit: 'accepts',
        interval: 'interval' },
     'zfs.pool_used': 
      { type: 'size',
        label: 'used space in pool',
        module: 'zfs',
        stat: 'pool_used',
        fields: [Object],
        interval: 'point' } },
  cmm_name: undefined,
  cmm_messages: [ [length]: 0 ],
  cmm_nerrors: 0,
  cmm_modules: 
   { restify: { label: 'Restify', name: 'restify' },
     zfs: { label: 'ZFS', name: 'zfs' },
     ca: { label: 'CA', name: 'ca' },
     node: { label: 'Node.js 0.4.x', name: 'node' },
     mysql: { label: 'MySQL', name: 'mysql' },
     fs: { label: 'Filesystem', name: 'fs' },
     apache: { label: 'Apache', name: 'apache' },
     unix: { label: 'OS', name: 'unix' },
     moray: { label: 'Moray', name: 'moray' },
     mantaop: { label: 'Manta (operator)', name: 'mantaop' },
     disk: { label: 'Disk', name: 'disk' },
     vm: { label: 'Virtual Machine', name: 'vm' },
     tcp: { label: 'TCP', name: 'tcp' },
     memory: { label: 'Memory', name: 'memory' },
     postgres: { label: 'Postgres', name: 'postgres' },
     nic: { label: 'Network interface', name: 'nic' },
     syscall: { label: 'System calls', name: 'syscall' },
     ldapjs: { label: 'ldapjs', name: 'ldapjs' },
     cpu: { label: 'CPU', name: 'cpu' } },
  cmm_nwarnings: 0 }
-------METADATA   END---------
[2015-06-13 20:52:29.717 UTC] DBG    
----------------------------------------
this string fstype;

fbt::fop_read:entry,
fbt::fop_write:entry,
fbt::fop_ioctl:entry,
fbt::fop_access:entry,
fbt::fop_getattr:entry,
fbt::fop_setattr:entry,
fbt::fop_lookup:entry,
fbt::fop_create:entry,
fbt::fop_remove:entry,
fbt::fop_link:entry,
fbt::fop_rename:entry,
fbt::fop_mkdir:entry,
fbt::fop_rmdir:entry,
fbt::fop_readdir:entry,
fbt::fop_symlink:entry,
fbt::fop_readlink:entry,
fbt::fop_fsync:entry,
fbt::fop_getpage:entry,
fbt::fop_putpage:entry,
fbt::fop_map:entry,
fbt::fop_open:entry
/((self->vnode0 == NULL))/{
	self->vnode0 = arg0;
	self->depth0 = stackdepth;
	self->latency0 = timestamp;
}

fbt::fop_open:return
/((((((self->vnode0) != NULL)))) && (((((self->depth0) != NULL)))) && (((((self->latency0) != NULL)))) && (((((this->fstype = stringof((*((vnode_t**)self->vnode0))->v_op->vnop_name)) != NULL || 1)))) && (self->depth0 == stackdepth && self->vnode0 != NULL && (this->fstype == "ufs" || this->fstype == "zfs" || this->fstype == "dev" || this->fstype == "dev fs" || this->fstype == "proc" || this->fstype == "lofs" || this->fstype == "tmpfs" || this->fstype == "nfs")))/{
	@[((probefunc + 4))] = llquantize((timestamp - self->latency0), 10, 3, 11, 100);
}

fbt::fop_read:return,
fbt::fop_write:return,
fbt::fop_ioctl:return,
fbt::fop_access:return,
fbt::fop_getattr:return,
fbt::fop_setattr:return,
fbt::fop_lookup:return,
fbt::fop_create:return,
fbt::fop_remove:return,
fbt::fop_link:return,
fbt::fop_rename:return,
fbt::fop_mkdir:return,
fbt::fop_rmdir:return,
fbt::fop_readdir:return,
fbt::fop_symlink:return,
fbt::fop_readlink:return,
fbt::fop_fsync:return,
fbt::fop_getpage:return,
fbt::fop_putpage:return,
fbt::fop_map:return
/((((((self->vnode0) != NULL)))) && (((((self->depth0) != NULL)))) && (((((self->latency0) != NULL)))) && (((((this->fstype = stringof(((vnode_t*)self->vnode0)->v_op->vnop_name)) != NULL || 1)))) && (self->depth0 == stackdepth && self->vnode0 != NULL && (this->fstype == "ufs" || this->fstype == "zfs" || this->fstype == "dev" || this->fstype == "dev fs" || this->fstype == "proc" || this->fstype == "lofs" || this->fstype == "tmpfs" || this->fstype == "nfs")))/{
	@[((probefunc + 4))] = llquantize((timestamp - self->latency0), 10, 3, 11, 100);
}

fbt::fop_read:return,
fbt::fop_write:return,
fbt::fop_ioctl:return,
fbt::fop_access:return,
fbt::fop_getattr:return,
fbt::fop_setattr:return,
fbt::fop_lookup:return,
fbt::fop_create:return,
fbt::fop_remove:return,
fbt::fop_link:return,
fbt::fop_rename:return,
fbt::fop_mkdir:return,
fbt::fop_rmdir:return,
fbt::fop_readdir:return,
fbt::fop_symlink:return,
fbt::fop_readlink:return,
fbt::fop_fsync:return,
fbt::fop_getpage:return,
fbt::fop_putpage:return,
fbt::fop_map:return,
fbt::fop_open:entry
/((self->depth0 == stackdepth))/{
	(self->vnode0) = 0;
	(self->depth0) = 0;
	(self->latency0) = 0;
}

----------------------------------------
[2015-06-13 20:52:31.890 UTC] INFO   instrumented global;7 (fs.logical_ops)
[2015-06-13 20:57:03.711 UTC] INFO   kstat: { module: 'cpu', class: 'misc', name: 'sys' }
decomps: [ 'cpu', 'utilization' ]
predicate: {}
[2015-06-13 20:57:03.713 UTC] INFO   instrumented global;8 (cpu.cpus)
[2015-06-13 20:57:21.695 UTC] INFO   kstat: { module: 'zones', class: 'zone_misc' }
decomps: [ 'cpumode' ]
predicate: {}
[2015-06-13 20:57:21.696 UTC] INFO   instrumented global;9 (cpu.usage)
[2015-06-13 20:57:33.677 UTC] INFO   kstat: { module: 'zones', class: 'zone_misc' }
decomps: [ 'hostname' ]
predicate: {}
[2015-06-13 20:57:33.679 UTC] INFO   instrumented global;10 (cpu.waittime)
-------DESC BEGIN---------
{ fields: 
   [ 'hostname',
     'zonename',
     'pid',
     'execname',
     'psargs',
     'ppid',
     'pexecname',
     'ppsargs',
     'subsecond',
     [length]: 9 ],
  stat: 'thread_samples',
  metad: { probedesc: [ [Object], [length]: 1 ] },
  module: 'cpu' }
-------DESC   END---------
-------METRIC BEGIN---------
{ is_backend: 'dtrace',
  is_module: 'cpu',
  is_predicate: {},
  is_stat: 'thread_samples',
  is_granularity: 5,
  is_decomposition: [ 'psargs', 'subsecond', [length]: 2 ],
  is_fqid: 'global;11' }
-------METRIC   END---------
-------METADATA BEGIN---------
{ cmm_types: 
   { string: { name: 'string', unit: '', arity: 'discrete' },
     number: { name: 'number', unit: '', arity: 'numeric' },
     subsecond: 
      { name: 'subsecond',
        unit: 'seconds',
        abbr: 's',
        base: 10,
        arity: 'numeric',
        power: -3 },
     percent: 
      { name: 'percent',
        unit: 'percent',
        abbr: '%',
        arity: 'numeric',
        minmax: 100 },
     time: 
      { name: 'time',
        unit: 'seconds',
        abbr: 's',
        base: 10,
        arity: 'numeric',
        power: -9 },
     size: 
      { name: 'size',
        unit: 'bytes',
        abbr: 'B',
        base: 2,
        arity: 'numeric' } },
  cmm_fields: 
   { latency: { type: 'time', label: 'latency', name: 'latency' },
     nthreads: { type: 'number', label: 'number of threads', name: 'nthreads' },
     vleavereason: 
      { type: 'string',
        label: 'reason leaving vCPU',
        name: 'vleavereason' },
     cputime: { type: 'time', label: 'CPU time', name: 'cputime' },
     zpool: { label: 'ZFS pool', name: 'zpool' },
     cpumode: { label: 'CPU mode', name: 'cpumode' },
     command: { label: 'command', name: 'command' },
     psargs: { label: 'process arguments', name: 'psargs' },
     pid: { label: 'process identifier', name: 'pid' },
     jobid: { label: 'jobid', name: 'jobid' },
     gctype: { label: 'GC type', name: 'gctype' },
     nic: { label: 'NIC name', name: 'nic' },
     restify_sname: { label: 'restify server name', name: 'restify_sname' },
     walltime: { type: 'time', label: 'process runtime', name: 'walltime' },
     syscall: { label: 'syscall', name: 'syscall' },
     errtype: { label: 'error type', name: 'errtype' },
     iops_read: 
      { type: 'number',
        label: 'read I/O operations',
        name: 'iops_read' },
     iops_write: 
      { type: 'number',
        label: 'write I/O operations',
        name: 'iops_write' },
     rss: { type: 'size', label: 'resident set size', name: 'rss' },
     http_status: { label: 'Status Code', name: 'http_status' },
     cainstnid: { label: 'instrumentation identifier', name: 'cainstnid' },
     packets_out: { type: 'number', label: 'packets sent', name: 'packets_out' },
     subsecond: 
      { type: 'subsecond',
        label: 'subsecond offset',
        name: 'subsecond' },
     http_method: { label: 'method', name: 'http_method' },
     errno: { type: 'string', label: 'error code', name: 'errno' },
     http_path: { label: 'URL path', name: 'http_path' },
     rowsmatched: { type: 'number', label: 'rows matched', name: 'rowsmatched' },
     bytes: { type: 'size', label: 'bytes read and written', name: 'bytes' },
     vmmmuctx: { type: 'string', label: 'VM MMU context', name: 'vmmmuctx' },
     tcpstack: { label: 'TCP instance', name: 'tcpstack' },
     packets_in: { type: 'number', label: 'packets received', name: 'packets_in' },
     irqvector: { type: 'string', label: 'IRQ vector', name: 'irqvector' },
     busytime: { type: 'percent', label: 'non-idle time', name: 'busytime' },
     leavereason: { label: 'reason leaving CPU', name: 'leavereason' },
     bytes_write: { type: 'size', label: 'bytes written', name: 'bytes_write' },
     contract: { label: 'contract identifier', name: 'contract' },
     hostname: { label: 'server hostname', name: 'hostname' },
     zdataset: { label: 'ZFS dataset', name: 'zdataset' },
     iops: { type: 'number', label: 'I/O operations', name: 'iops' },
     user: { label: 'client username', name: 'user' },
     cametric: { label: 'metric name', name: 'cametric' },
     querysubstr: { label: 'query substring', name: 'querysubstr' },
     pmodel: { label: 'process model', name: 'pmodel' },
     pexecname: { label: 'parent application name', name: 'pexecname' },
     raddr: { label: 'remote IP address', name: 'raddr' },
     bytes_read: { type: 'size', label: 'bytes read', name: 'bytes_read' },
     ldapbinddn: { label: 'bind DN', name: 'ldapbinddn' },
     offset: { type: 'size', label: 'offset', name: 'offset' },
     disk: { label: 'device name', name: 'disk' },
     optype: { label: 'operation type', name: 'optype' },
     execname: { label: 'application name', name: 'execname' },
     direction: { label: 'sent/received', name: 'direction' },
     statement: { label: 'statement type', name: 'statement' },
     restify_hname: { label: 'restify handler name', name: 'restify_hname' },
     ldaprequestdn: { label: 'request DN', name: 'ldaprequestdn' },
     ldapscope: { label: 'search scope', name: 'ldapscope' },
     parsed: { label: 'parsed', name: 'parsed' },
     ldapfilter: { label: 'search filter', name: 'ldapfilter' },
     rport: { label: 'remote TCP port', name: 'rport' },
     objname: { label: 'object name', name: 'objname' },
     client: { label: 'client hostname', name: 'client' },
     restify_rname: { label: 'restify route name', name: 'restify_rname' },
     vcpuid: { type: 'string', label: 'vCPU identifier', name: 'vcpuid' },
     size: { type: 'size', label: 'size', name: 'size' },
     status: { label: 'status', name: 'status' },
     ppid: { label: 'parent process identifier', name: 'ppid' },
     cabackend: { label: 'backend module', name: 'cabackend' },
     http_origin: { label: 'reported origin IP', name: 'http_origin' },
     runtime: { type: 'time', label: 'time on CPU', name: 'runtime' },
     table: { label: 'table name', name: 'table' },
     rowschanged: { type: 'number', label: 'rows changed', name: 'rowschanged' },
     utilization: { type: 'percent', label: 'utilization', name: 'utilization' },
     packets: 
      { type: 'number',
        label: 'packets sent and received',
        name: 'packets' },
     database: { label: 'database name', name: 'database' },
     ppsargs: { label: 'parent process arguments', name: 'ppsargs' },
     fstype: { label: 'filesystem type', name: 'fstype' },
     cpu: { label: 'CPU identifier', name: 'cpu' },
     http_url: { label: 'URL', name: 'http_url' },
     errname: { label: 'error name', name: 'errname' },
     zonename: { label: 'zone name', name: 'zonename' },
     buffered: 
      { type: 'size',
        label: 'bytes buffered on socket',
        name: 'buffered' } },
  cmm_metrics: 
   { 'memory.rss_limit': 
      { type: 'size',
        label: 'maximum resident set size',
        module: 'memory',
        stat: 'rss_limit',
        fields: [Object],
        interval: 'point' },
     'mantaop.supervisor_auths': 
      { label: 'supervisor auth requests',
        module: 'mantaop',
        stat: 'supervisor_auths',
        fields: [Object],
        unit: 'requests',
        interval: 'interval' },
     'mantaop.jobs_assigned': 
      { label: 'jobs assigned',
        module: 'mantaop',
        stat: 'jobs_assigned',
        fields: [Object],
        unit: 'jobs',
        interval: 'interval' },
     'cpu.cpus': 
      { label: 'CPUs',
        module: 'cpu',
        stat: 'cpus',
        fields: [Object],
        unit: 'CPUs',
        interval: 'point' },
     'vm.physio_bytes': 
      { type: 'size',
        label: 'disk bytes read and written',
        module: 'vm',
        stat: 'physio_bytes',
        fields: [Object],
        interval: 'interval' },
     'ca.instr_enables': 
      { label: 'instrumenter enable operations',
        module: 'ca',
        stat: 'instr_enables',
        fields: [Object],
        unit: 'operations',
        interval: 'interval' },
     'unix.processes': 
      { label: 'processes',
        module: 'unix',
        stat: 'processes',
        fields: [Object],
        unit: 'processes',
        interval: 'interval' },
     'mysql.commands': 
      { label: 'commands',
        module: 'mysql',
        stat: 'commands',
        fields: [Object],
        unit: 'commands',
        interval: 'interval' },
     'mysql.statements': 
      { label: 'statements',
        module: 'mysql',
        stat: 'statements',
        fields: [Object],
        unit: 'statements',
        interval: 'interval' },
     'cpu.waittime': 
      { type: 'time',
        label: 'aggregated wait time',
        module: 'cpu',
        stat: 'waittime',
        fields: [Object],
        interval: 'interval' },
     'moray.queries': 
      { label: 'SQL queries',
        module: 'moray',
        stat: 'queries',
        fields: [Object],
        unit: 'queries',
        interval: 'interval' },
     'postgres.queries': 
      { label: 'queries',
        module: 'postgres',
        stat: 'queries',
        fields: [Object],
        unit: 'queries',
        interval: 'interval' },
     'mantaop.supervisor_deletes': 
      { label: 'supervisor delete requests',
        module: 'mantaop',
        stat: 'supervisor_deletes',
        fields: [Object],
        unit: 'requests',
        interval: 'interval' },
     'memory.swap_limit': 
      { type: 'size',
        label: 'maximum virtual memory reserved',
        module: 'memory',
        stat: 'swap_limit',
        fields: [Object],
        interval: 'point' },
     'nic.nics': 
      { label: 'NICs',
        module: 'nic',
        stat: 'nics',
        fields: [Object],
        unit: 'NICs',
        interval: 'point' },
     'ca.instr_ticks': 
      { label: 'instrumenter ticks',
        module: 'ca',
        stat: 'instr_ticks',
        fields: [Object],
        unit: 'ticks',
        interval: 'interval' },
     'restify.server_ops': 
      { label: 'server operations',
        module: 'restify',
        stat: 'server_ops',
        fields: [Object],
        unit: 'operations',
        interval: 'interval' },
     'unix.proc_exits': 
      { label: 'process exits',
        module: 'unix',
        stat: 'proc_exits',
        fields: [Object],
        unit: 'processes',
        interval: 'interval' },
     'mantaop.tasks_executed': 
      { label: 'tasks executed',
        module: 'mantaop',
        stat: 'tasks_executed',
        fields: [Object],
        unit: 'tasks',
        interval: 'interval' },
     'mantaop.zone_resets': 
      { label: 'zone resets',
        module: 'mantaop',
        stat: 'zone_resets',
        fields: [Object],
        unit: 'resets',
        interval: 'interval' },
     'disk.physio_bytes': 
      { type: 'size',
        label: 'bytes read and written',
        module: 'disk',
        stat: 'physio_bytes',
        fields: [Object],
        interval: 'interval' },
     'node.socket_ops': 
      { label: 'socket operations',
        module: 'node',
        stat: 'socket_ops',
        fields: [Object],
        unit: 'operations',
        interval: 'interval' },
     'memory.reclaimed_bytes': 
      { type: 'size',
        label: 'excess memory reclaimed',
        module: 'memory',
        stat: 'reclaimed_bytes',
        fields: [Object],
        interval: 'interval' },
     'vm.exits': 
      { label: 'exits',
        module: 'vm',
        stat: 'exits',
        fields: [Object],
        unit: 'exits',
        interval: 'interval' },
     'restify.handler_ops': 
      { label: 'handler operations',
        module: 'restify',
        stat: 'handler_ops',
        fields: [Object],
        unit: 'operations',
        interval: 'interval' },
     'vm.thread_samples': 
      { label: 'thread samples',
        module: 'vm',
        stat: 'thread_samples',
        fields: [Object],
        unit: 'samples',
        interval: 'interval' },
     'syscall.syscalls': 
      { label: 'system calls',
        module: 'syscall',
        stat: 'syscalls',
        fields: [Object],
        unit: 'syscalls',
        interval: 'interval' },
     'cpu.thread_samples': 
      { label: 'thread samples',
        module: 'cpu',
        stat: 'thread_samples',
        fields: [Object],
        unit: 'samples',
        interval: 'interval' },
     'memory.pageins': 
      { label: 'pages paged in',
        module: 'memory',
        stat: 'pageins',
        fields: [Object],
        unit: 'pages',
        interval: 'interval' },
     'mantaop.supervisor_locates': 
      { label: 'supervisor locate requests',
        module: 'mantaop',
        stat: 'supervisor_locates',
        fields: [Object],
        unit: 'requests',
        interval: 'interval' },
     'mysql.filesort': 
      { label: 'filesort',
        module: 'mysql',
        stat: 'filesort',
        fields: [Object],
        unit: 'filesorts',
        interval: 'interval' },
     'mysql.connections': 
      { label: 'connections',
        module: 'mysql',
        stat: 'connections',
        fields: [Object],
        unit: 'connections',
        interval: 'interval' },
     'unix.thr_creates': 
      { label: 'thread creations',
        module: 'unix',
        stat: 'thr_creates',
        fields: [Object],
        unit: 'threads',
        interval: 'interval' },
     'ldapjs.connections': 
      { label: 'connections',
        module: 'ldapjs',
        stat: 'connections',
        fields: [Object],
        unit: 'connections',
        interval: 'interval' },
     'moray.ops': 
      { label: 'operations',
        module: 'moray',
        stat: 'ops',
        fields: [Object],
        unit: 'operations',
        interval: 'interval' },
     'ca.instr_disables': 
      { label: 'instrumenter disable operations',
        module: 'ca',
        stat: 'instr_disables',
        fields: [Object],
        unit: 'operations',
        interval: 'interval' },
     'fs.logical_rwbytes': 
      { type: 'size',
        label: 'logical bytes read/written',
        module: 'fs',
        stat: 'logical_rwbytes',
        fields: [Object],
        interval: 'interval' },
     'memory.swap': 
      { type: 'size',
        label: 'virtual memory reserved',
        module: 'memory',
        stat: 'swap',
        fields: [Object],
        interval: 'point' },
     'unix.proc_forks': 
      { label: 'process forks',
        module: 'unix',
        stat: 'proc_forks',
        fields: [Object],
        unit: 'processes',
        interval: 'interval' },
     'ldapjs.search_ops': 
      { label: 'search operations',
        module: 'ldapjs',
        stat: 'search_ops',
        fields: [Object],
        unit: 'operations',
        interval: 'interval' },
     'vm.physio_ops': 
      { label: 'disk I/O operations',
        module: 'vm',
        stat: 'physio_ops',
        fields: [Object],
        unit: 'operations',
        interval: 'interval' },
     'cpu.loadavg1': 
      { type: 'number',
        label: '1-minute load average',
        module: 'cpu',
        stat: 'loadavg1',
        fields: [Object],
        interval: 'point' },
     'nic.bytes': 
      { type: 'size',
        label: 'bytes sent and received',
        module: 'nic',
        stat: 'bytes',
        fields: [Object],
        interval: 'interval' },
     'zfs.dataset_unused_quota': 
      { type: 'size',
        label: 'unused quota',
        module: 'zfs',
        stat: 'dataset_unused_quota',
        fields: [Object],
        interval: 'point' },
     'memory.rss': 
      { type: 'size',
        label: 'resident set size',
        module: 'memory',
        stat: 'rss',
        fields: [Object],
        interval: 'point' },
     'apache.httpd_ops': 
      { label: 'HTTP requests',
        module: 'apache',
        stat: 'httpd_ops',
        fields: [Object],
        unit: 'requests',
        interval: 'interval' },
     'nic.vnic_bytes': 
      { type: 'size',
        label: 'VNIC bytes sent and received',
        module: 'nic',
        stat: 'vnic_bytes',
        fields: [Object],
        interval: 'interval' },
     'zfs.dataset_used': 
      { type: 'size',
        label: 'used space',
        module: 'zfs',
        stat: 'dataset_used',
        fields: [Object],
        interval: 'point' },
     'tcp.connects': 
      { label: 'connects',
        module: 'tcp',
        stat: 'connects',
        fields: [Object],
        unit: 'connects',
        interval: 'interval' },
     'mantaop.supervisor_errors': 
      { label: 'supervisor errors',
        module: 'mantaop',
        stat: 'supervisor_errors',
        fields: [Object],
        unit: 'errors',
        interval: 'interval' },
     'mantaop.tasks_committed': 
      { label: 'tasks committed',
        module: 'mantaop',
        stat: 'tasks_committed',
        fields: [Object],
        unit: 'tasks',
        interval: 'interval' },
     'mysql.queries': 
      { label: 'queries',
        module: 'mysql',
        stat: 'queries',
        fields: [Object],
        unit: 'queries',
        interval: 'interval' },
     'node.gc_ops': 
      { label: 'garbage collection operations',
        module: 'node',
        stat: 'gc_ops',
        fields: [Object],
        unit: 'operations',
        interval: 'interval' },
     'nic.vnic_packets': 
      { label: 'VNIC packets sent and received',
        module: 'nic',
        stat: 'vnic_packets',
        fields: [Object],
        unit: 'packets',
        interval: 'interval' },
     'zfs.dataset_quota': 
      { type: 'size',
        label: 'quota size',
        module: 'zfs',
        stat: 'dataset_quota',
        fields: [Object],
        interval: 'point' },
     'tcp.errors': 
      { label: 'errors',
        module: 'tcp',
        stat: 'errors',
        fields: [Object],
        unit: 'errors',
        interval: 'interval' },
     'unix.proc_execs': 
      { label: 'process execs',
        module: 'unix',
        stat: 'proc_execs',
        fields: [Object],
        unit: 'processes',
        interval: 'interval' },
     'disk.disks': 
      { label: 'disks',
        module: 'disk',
        stat: 'disks',
        fields: [Object],
        unit: 'disks',
        interval: 'point' },
     'fs.logical_rwops': 
      { label: 'logical read/write operations',
        module: 'fs',
        stat: 'logical_rwops',
        fields: [Object],
        unit: 'operations',
        interval: 'interval' },
     'cpu.usage': 
      { label: 'aggregated CPU usage',
        module: 'cpu',
        stat: 'usage',
        fields: [Object],
        unit: 'percent of 1 CPU',
        interval: 'point' },
     'disk.physio_ops': 
      { label: 'I/O operations',
        module: 'disk',
        stat: 'physio_ops',
        fields: [Object],
        unit: 'operations',
        interval: 'interval' },
     'ldapjs.ops': 
      { label: 'all operations',
        module: 'ldapjs',
        stat: 'ops',
        fields: [Object],
        unit: 'operations',
        interval: 'interval' },
     'tcp.segments': 
      { label: 'segments',
        module: 'tcp',
        stat: 'segments',
        fields: [Object],
        unit: 'segments',
        interval: 'interval' },
     'zfs.arc_ops': 
      { label: 'ARC operations',
        module: 'zfs',
        stat: 'arc_ops',
        fields: [Object],
        unit: 'operations',
        interval: 'interval' },
     'vm.irqs': 
      { label: 'interrupt requests',
        module: 'vm',
        stat: 'irqs',
        fields: [Object],
        unit: 'requests',
        interval: 'interval' },
     'nic.packets': 
      { label: 'packets sent and received',
        module: 'nic',
        stat: 'packets',
        fields: [Object],
        unit: 'packets',
        interval: 'interval' },
     'fs.logical_ops': 
      { label: 'logical filesystem operations',
        module: 'fs',
        stat: 'logical_ops',
        fields: [Object],
        unit: 'operations',
        interval: 'interval' },
     'mantaop.tasks_killed': 
      { label: 'tasks killed',
        module: 'mantaop',
        stat: 'tasks_killed',
        fields: [Object],
        unit: 'tasks',
        interval: 'interval' },
     'node.httpd_ops': 
      { label: 'HTTP server operations',
        module: 'node',
        stat: 'httpd_ops',
        fields: [Object],
        unit: 'operations',
        interval: 'interval' },
     'zfs.pool_total': 
      { type: 'size',
        label: 'total space in pool',
        module: 'zfs',
        stat: 'pool_total',
        fields: [Object],
        interval: 'point' },
     'mantaop.tasks_dispatched': 
      { label: 'tasks dispatched',
        module: 'mantaop',
        stat: 'tasks_dispatched',
        fields: [Object],
        unit: 'tasks',
        interval: 'interval' },
     'ca.instr_beops': 
      { label: 'instrumenter backend requests',
        module: 'ca',
        stat: 'instr_beops',
        fields: [Object],
        unit: 'requests',
        interval: 'interval' },
     'cpu.thread_executions': 
      { label: 'thread executions',
        module: 'cpu',
        stat: 'thread_executions',
        fields: [Object],
        unit: 'operations',
        interval: 'interval' },
     'zfs.pool_free': 
      { type: 'size',
        label: 'free space in pool',
        module: 'zfs',
        stat: 'pool_free',
        fields: [Object],
        interval: 'point' },
     'node.httpc_ops': 
      { label: 'HTTP client operations',
        module: 'node',
        stat: 'httpc_ops',
        fields: [Object],
        unit: 'operations',
        interval: 'interval' },
     'tcp.accepts': 
      { label: 'accepts',
        module: 'tcp',
        stat: 'accepts',
        fields: [Object],
        unit: 'accepts',
        interval: 'interval' },
     'zfs.pool_used': 
      { type: 'size',
        label: 'used space in pool',
        module: 'zfs',
        stat: 'pool_used',
        fields: [Object],
        interval: 'point' } },
  cmm_name: undefined,
  cmm_messages: [ [length]: 0 ],
  cmm_nerrors: 0,
  cmm_modules: 
   { restify: { label: 'Restify', name: 'restify' },
     zfs: { label: 'ZFS', name: 'zfs' },
     ca: { label: 'CA', name: 'ca' },
     node: { label: 'Node.js 0.4.x', name: 'node' },
     mysql: { label: 'MySQL', name: 'mysql' },
     fs: { label: 'Filesystem', name: 'fs' },
     apache: { label: 'Apache', name: 'apache' },
     unix: { label: 'OS', name: 'unix' },
     moray: { label: 'Moray', name: 'moray' },
     mantaop: { label: 'Manta (operator)', name: 'mantaop' },
     disk: { label: 'Disk', name: 'disk' },
     vm: { label: 'Virtual Machine', name: 'vm' },
     tcp: { label: 'TCP', name: 'tcp' },
     memory: { label: 'Memory', name: 'memory' },
     postgres: { label: 'Postgres', name: 'postgres' },
     nic: { label: 'Network interface', name: 'nic' },
     syscall: { label: 'System calls', name: 'syscall' },
     ldapjs: { label: 'ldapjs', name: 'ldapjs' },
     cpu: { label: 'CPU', name: 'cpu' } },
  cmm_nwarnings: 0 }
-------METADATA   END---------
[2015-06-13 20:58:22.563 UTC] DBG    
----------------------------------------
profile:::profile-99hz
/((curthread->t_pri != -1))/{
	@[(curpsinfo->pr_psargs)] = lquantize(((timestamp) % 1000000000) / 1000000, 0, 1000, 10);
}

----------------------------------------
[2015-06-13 20:58:23.713 UTC] INFO   instrumented global;11 (cpu.thread_samples)
-------DESC BEGIN---------
{ fields: 
   [ 'hostname',
     'zonename',
     'pid',
     'execname',
     'psargs',
     'ppid',
     'pexecname',
     'ppsargs',
     'leavereason',
     'runtime',
     'subsecond',
     [length]: 11 ],
  stat: 'thread_executions',
  metad: 
   { probedesc: [ [Object], [Object], [Object], [length]: 3 ],
     locals: [ [Object], [length]: 1 ] },
  module: 'cpu' }
-------DESC   END---------
-------METRIC BEGIN---------
{ is_backend: 'dtrace',
  is_module: 'cpu',
  is_predicate: {},
  is_stat: 'thread_executions',
  is_granularity: 5,
  is_decomposition: [ 'leavereason', 'runtime', [length]: 2 ],
  is_fqid: 'global;12' }
-------METRIC   END---------
-------METADATA BEGIN---------
{ cmm_types: 
   { string: { name: 'string', unit: '', arity: 'discrete' },
     number: { name: 'number', unit: '', arity: 'numeric' },
     subsecond: 
      { name: 'subsecond',
        unit: 'seconds',
        abbr: 's',
        base: 10,
        arity: 'numeric',
        power: -3 },
     percent: 
      { name: 'percent',
        unit: 'percent',
        abbr: '%',
        arity: 'numeric',
        minmax: 100 },
     time: 
      { name: 'time',
        unit: 'seconds',
        abbr: 's',
        base: 10,
        arity: 'numeric',
        power: -9 },
     size: 
      { name: 'size',
        unit: 'bytes',
        abbr: 'B',
        base: 2,
        arity: 'numeric' } },
  cmm_fields: 
   { latency: { type: 'time', label: 'latency', name: 'latency' },
     nthreads: { type: 'number', label: 'number of threads', name: 'nthreads' },
     vleavereason: 
      { type: 'string',
        label: 'reason leaving vCPU',
        name: 'vleavereason' },
     cputime: { type: 'time', label: 'CPU time', name: 'cputime' },
     zpool: { label: 'ZFS pool', name: 'zpool' },
     cpumode: { label: 'CPU mode', name: 'cpumode' },
     command: { label: 'command', name: 'command' },
     psargs: { label: 'process arguments', name: 'psargs' },
     pid: { label: 'process identifier', name: 'pid' },
     jobid: { label: 'jobid', name: 'jobid' },
     gctype: { label: 'GC type', name: 'gctype' },
     nic: { label: 'NIC name', name: 'nic' },
     restify_sname: { label: 'restify server name', name: 'restify_sname' },
     walltime: { type: 'time', label: 'process runtime', name: 'walltime' },
     syscall: { label: 'syscall', name: 'syscall' },
     errtype: { label: 'error type', name: 'errtype' },
     iops_read: 
      { type: 'number',
        label: 'read I/O operations',
        name: 'iops_read' },
     iops_write: 
      { type: 'number',
        label: 'write I/O operations',
        name: 'iops_write' },
     rss: { type: 'size', label: 'resident set size', name: 'rss' },
     http_status: { label: 'Status Code', name: 'http_status' },
     cainstnid: { label: 'instrumentation identifier', name: 'cainstnid' },
     packets_out: { type: 'number', label: 'packets sent', name: 'packets_out' },
     subsecond: 
      { type: 'subsecond',
        label: 'subsecond offset',
        name: 'subsecond' },
     http_method: { label: 'method', name: 'http_method' },
     errno: { type: 'string', label: 'error code', name: 'errno' },
     http_path: { label: 'URL path', name: 'http_path' },
     rowsmatched: { type: 'number', label: 'rows matched', name: 'rowsmatched' },
     bytes: { type: 'size', label: 'bytes read and written', name: 'bytes' },
     vmmmuctx: { type: 'string', label: 'VM MMU context', name: 'vmmmuctx' },
     tcpstack: { label: 'TCP instance', name: 'tcpstack' },
     packets_in: { type: 'number', label: 'packets received', name: 'packets_in' },
     irqvector: { type: 'string', label: 'IRQ vector', name: 'irqvector' },
     busytime: { type: 'percent', label: 'non-idle time', name: 'busytime' },
     leavereason: { label: 'reason leaving CPU', name: 'leavereason' },
     bytes_write: { type: 'size', label: 'bytes written', name: 'bytes_write' },
     contract: { label: 'contract identifier', name: 'contract' },
     hostname: { label: 'server hostname', name: 'hostname' },
     zdataset: { label: 'ZFS dataset', name: 'zdataset' },
     iops: { type: 'number', label: 'I/O operations', name: 'iops' },
     user: { label: 'client username', name: 'user' },
     cametric: { label: 'metric name', name: 'cametric' },
     querysubstr: { label: 'query substring', name: 'querysubstr' },
     pmodel: { label: 'process model', name: 'pmodel' },
     pexecname: { label: 'parent application name', name: 'pexecname' },
     raddr: { label: 'remote IP address', name: 'raddr' },
     bytes_read: { type: 'size', label: 'bytes read', name: 'bytes_read' },
     ldapbinddn: { label: 'bind DN', name: 'ldapbinddn' },
     offset: { type: 'size', label: 'offset', name: 'offset' },
     disk: { label: 'device name', name: 'disk' },
     optype: { label: 'operation type', name: 'optype' },
     execname: { label: 'application name', name: 'execname' },
     direction: { label: 'sent/received', name: 'direction' },
     statement: { label: 'statement type', name: 'statement' },
     restify_hname: { label: 'restify handler name', name: 'restify_hname' },
     ldaprequestdn: { label: 'request DN', name: 'ldaprequestdn' },
     ldapscope: { label: 'search scope', name: 'ldapscope' },
     parsed: { label: 'parsed', name: 'parsed' },
     ldapfilter: { label: 'search filter', name: 'ldapfilter' },
     rport: { label: 'remote TCP port', name: 'rport' },
     objname: { label: 'object name', name: 'objname' },
     client: { label: 'client hostname', name: 'client' },
     restify_rname: { label: 'restify route name', name: 'restify_rname' },
     vcpuid: { type: 'string', label: 'vCPU identifier', name: 'vcpuid' },
     size: { type: 'size', label: 'size', name: 'size' },
     status: { label: 'status', name: 'status' },
     ppid: { label: 'parent process identifier', name: 'ppid' },
     cabackend: { label: 'backend module', name: 'cabackend' },
     http_origin: { label: 'reported origin IP', name: 'http_origin' },
     runtime: { type: 'time', label: 'time on CPU', name: 'runtime' },
     table: { label: 'table name', name: 'table' },
     rowschanged: { type: 'number', label: 'rows changed', name: 'rowschanged' },
     utilization: { type: 'percent', label: 'utilization', name: 'utilization' },
     packets: 
      { type: 'number',
        label: 'packets sent and received',
        name: 'packets' },
     database: { label: 'database name', name: 'database' },
     ppsargs: { label: 'parent process arguments', name: 'ppsargs' },
     fstype: { label: 'filesystem type', name: 'fstype' },
     cpu: { label: 'CPU identifier', name: 'cpu' },
     http_url: { label: 'URL', name: 'http_url' },
     errname: { label: 'error name', name: 'errname' },
     zonename: { label: 'zone name', name: 'zonename' },
     buffered: 
      { type: 'size',
        label: 'bytes buffered on socket',
        name: 'buffered' } },
  cmm_metrics: 
   { 'memory.rss_limit': 
      { type: 'size',
        label: 'maximum resident set size',
        module: 'memory',
        stat: 'rss_limit',
        fields: [Object],
        interval: 'point' },
     'mantaop.supervisor_auths': 
      { label: 'supervisor auth requests',
        module: 'mantaop',
        stat: 'supervisor_auths',
        fields: [Object],
        unit: 'requests',
        interval: 'interval' },
     'mantaop.jobs_assigned': 
      { label: 'jobs assigned',
        module: 'mantaop',
        stat: 'jobs_assigned',
        fields: [Object],
        unit: 'jobs',
        interval: 'interval' },
     'cpu.cpus': 
      { label: 'CPUs',
        module: 'cpu',
        stat: 'cpus',
        fields: [Object],
        unit: 'CPUs',
        interval: 'point' },
     'vm.physio_bytes': 
      { type: 'size',
        label: 'disk bytes read and written',
        module: 'vm',
        stat: 'physio_bytes',
        fields: [Object],
        interval: 'interval' },
     'ca.instr_enables': 
      { label: 'instrumenter enable operations',
        module: 'ca',
        stat: 'instr_enables',
        fields: [Object],
        unit: 'operations',
        interval: 'interval' },
     'unix.processes': 
      { label: 'processes',
        module: 'unix',
        stat: 'processes',
        fields: [Object],
        unit: 'processes',
        interval: 'interval' },
     'mysql.commands': 
      { label: 'commands',
        module: 'mysql',
        stat: 'commands',
        fields: [Object],
        unit: 'commands',
        interval: 'interval' },
     'mysql.statements': 
      { label: 'statements',
        module: 'mysql',
        stat: 'statements',
        fields: [Object],
        unit: 'statements',
        interval: 'interval' },
     'cpu.waittime': 
      { type: 'time',
        label: 'aggregated wait time',
        module: 'cpu',
        stat: 'waittime',
        fields: [Object],
        interval: 'interval' },
     'moray.queries': 
      { label: 'SQL queries',
        module: 'moray',
        stat: 'queries',
        fields: [Object],
        unit: 'queries',
        interval: 'interval' },
     'postgres.queries': 
      { label: 'queries',
        module: 'postgres',
        stat: 'queries',
        fields: [Object],
        unit: 'queries',
        interval: 'interval' },
     'mantaop.supervisor_deletes': 
      { label: 'supervisor delete requests',
        module: 'mantaop',
        stat: 'supervisor_deletes',
        fields: [Object],
        unit: 'requests',
        interval: 'interval' },
     'memory.swap_limit': 
      { type: 'size',
        label: 'maximum virtual memory reserved',
        module: 'memory',
        stat: 'swap_limit',
        fields: [Object],
        interval: 'point' },
     'nic.nics': 
      { label: 'NICs',
        module: 'nic',
        stat: 'nics',
        fields: [Object],
        unit: 'NICs',
        interval: 'point' },
     'ca.instr_ticks': 
      { label: 'instrumenter ticks',
        module: 'ca',
        stat: 'instr_ticks',
        fields: [Object],
        unit: 'ticks',
        interval: 'interval' },
     'restify.server_ops': 
      { label: 'server operations',
        module: 'restify',
        stat: 'server_ops',
        fields: [Object],
        unit: 'operations',
        interval: 'interval' },
     'unix.proc_exits': 
      { label: 'process exits',
        module: 'unix',
        stat: 'proc_exits',
        fields: [Object],
        unit: 'processes',
        interval: 'interval' },
     'mantaop.tasks_executed': 
      { label: 'tasks executed',
        module: 'mantaop',
        stat: 'tasks_executed',
        fields: [Object],
        unit: 'tasks',
        interval: 'interval' },
     'mantaop.zone_resets': 
      { label: 'zone resets',
        module: 'mantaop',
        stat: 'zone_resets',
        fields: [Object],
        unit: 'resets',
        interval: 'interval' },
     'disk.physio_bytes': 
      { type: 'size',
        label: 'bytes read and written',
        module: 'disk',
        stat: 'physio_bytes',
        fields: [Object],
        interval: 'interval' },
     'node.socket_ops': 
      { label: 'socket operations',
        module: 'node',
        stat: 'socket_ops',
        fields: [Object],
        unit: 'operations',
        interval: 'interval' },
     'memory.reclaimed_bytes': 
      { type: 'size',
        label: 'excess memory reclaimed',
        module: 'memory',
        stat: 'reclaimed_bytes',
        fields: [Object],
        interval: 'interval' },
     'vm.exits': 
      { label: 'exits',
        module: 'vm',
        stat: 'exits',
        fields: [Object],
        unit: 'exits',
        interval: 'interval' },
     'restify.handler_ops': 
      { label: 'handler operations',
        module: 'restify',
        stat: 'handler_ops',
        fields: [Object],
        unit: 'operations',
        interval: 'interval' },
     'vm.thread_samples': 
      { label: 'thread samples',
        module: 'vm',
        stat: 'thread_samples',
        fields: [Object],
        unit: 'samples',
        interval: 'interval' },
     'syscall.syscalls': 
      { label: 'system calls',
        module: 'syscall',
        stat: 'syscalls',
        fields: [Object],
        unit: 'syscalls',
        interval: 'interval' },
     'cpu.thread_samples': 
      { label: 'thread samples',
        module: 'cpu',
        stat: 'thread_samples',
        fields: [Object],
        unit: 'samples',
        interval: 'interval' },
     'memory.pageins': 
      { label: 'pages paged in',
        module: 'memory',
        stat: 'pageins',
        fields: [Object],
        unit: 'pages',
        interval: 'interval' },
     'mantaop.supervisor_locates': 
      { label: 'supervisor locate requests',
        module: 'mantaop',
        stat: 'supervisor_locates',
        fields: [Object],
        unit: 'requests',
        interval: 'interval' },
     'mysql.filesort': 
      { label: 'filesort',
        module: 'mysql',
        stat: 'filesort',
        fields: [Object],
        unit: 'filesorts',
        interval: 'interval' },
     'mysql.connections': 
      { label: 'connections',
        module: 'mysql',
        stat: 'connections',
        fields: [Object],
        unit: 'connections',
        interval: 'interval' },
     'unix.thr_creates': 
      { label: 'thread creations',
        module: 'unix',
        stat: 'thr_creates',
        fields: [Object],
        unit: 'threads',
        interval: 'interval' },
     'ldapjs.connections': 
      { label: 'connections',
        module: 'ldapjs',
        stat: 'connections',
        fields: [Object],
        unit: 'connections',
        interval: 'interval' },
     'moray.ops': 
      { label: 'operations',
        module: 'moray',
        stat: 'ops',
        fields: [Object],
        unit: 'operations',
        interval: 'interval' },
     'ca.instr_disables': 
      { label: 'instrumenter disable operations',
        module: 'ca',
        stat: 'instr_disables',
        fields: [Object],
        unit: 'operations',
        interval: 'interval' },
     'fs.logical_rwbytes': 
      { type: 'size',
        label: 'logical bytes read/written',
        module: 'fs',
        stat: 'logical_rwbytes',
        fields: [Object],
        interval: 'interval' },
     'memory.swap': 
      { type: 'size',
        label: 'virtual memory reserved',
        module: 'memory',
        stat: 'swap',
        fields: [Object],
        interval: 'point' },
     'unix.proc_forks': 
      { label: 'process forks',
        module: 'unix',
        stat: 'proc_forks',
        fields: [Object],
        unit: 'processes',
        interval: 'interval' },
     'ldapjs.search_ops': 
      { label: 'search operations',
        module: 'ldapjs',
        stat: 'search_ops',
        fields: [Object],
        unit: 'operations',
        interval: 'interval' },
     'vm.physio_ops': 
      { label: 'disk I/O operations',
        module: 'vm',
        stat: 'physio_ops',
        fields: [Object],
        unit: 'operations',
        interval: 'interval' },
     'cpu.loadavg1': 
      { type: 'number',
        label: '1-minute load average',
        module: 'cpu',
        stat: 'loadavg1',
        fields: [Object],
        interval: 'point' },
     'nic.bytes': 
      { type: 'size',
        label: 'bytes sent and received',
        module: 'nic',
        stat: 'bytes',
        fields: [Object],
        interval: 'interval' },
     'zfs.dataset_unused_quota': 
      { type: 'size',
        label: 'unused quota',
        module: 'zfs',
        stat: 'dataset_unused_quota',
        fields: [Object],
        interval: 'point' },
     'memory.rss': 
      { type: 'size',
        label: 'resident set size',
        module: 'memory',
        stat: 'rss',
        fields: [Object],
        interval: 'point' },
     'apache.httpd_ops': 
      { label: 'HTTP requests',
        module: 'apache',
        stat: 'httpd_ops',
        fields: [Object],
        unit: 'requests',
        interval: 'interval' },
     'nic.vnic_bytes': 
      { type: 'size',
        label: 'VNIC bytes sent and received',
        module: 'nic',
        stat: 'vnic_bytes',
        fields: [Object],
        interval: 'interval' },
     'zfs.dataset_used': 
      { type: 'size',
        label: 'used space',
        module: 'zfs',
        stat: 'dataset_used',
        fields: [Object],
        interval: 'point' },
     'tcp.connects': 
      { label: 'connects',
        module: 'tcp',
        stat: 'connects',
        fields: [Object],
        unit: 'connects',
        interval: 'interval' },
     'mantaop.supervisor_errors': 
      { label: 'supervisor errors',
        module: 'mantaop',
        stat: 'supervisor_errors',
        fields: [Object],
        unit: 'errors',
        interval: 'interval' },
     'mantaop.tasks_committed': 
      { label: 'tasks committed',
        module: 'mantaop',
        stat: 'tasks_committed',
        fields: [Object],
        unit: 'tasks',
        interval: 'interval' },
     'mysql.queries': 
      { label: 'queries',
        module: 'mysql',
        stat: 'queries',
        fields: [Object],
        unit: 'queries',
        interval: 'interval' },
     'node.gc_ops': 
      { label: 'garbage collection operations',
        module: 'node',
        stat: 'gc_ops',
        fields: [Object],
        unit: 'operations',
        interval: 'interval' },
     'nic.vnic_packets': 
      { label: 'VNIC packets sent and received',
        module: 'nic',
        stat: 'vnic_packets',
        fields: [Object],
        unit: 'packets',
        interval: 'interval' },
     'zfs.dataset_quota': 
      { type: 'size',
        label: 'quota size',
        module: 'zfs',
        stat: 'dataset_quota',
        fields: [Object],
        interval: 'point' },
     'tcp.errors': 
      { label: 'errors',
        module: 'tcp',
        stat: 'errors',
        fields: [Object],
        unit: 'errors',
        interval: 'interval' },
     'unix.proc_execs': 
      { label: 'process execs',
        module: 'unix',
        stat: 'proc_execs',
        fields: [Object],
        unit: 'processes',
        interval: 'interval' },
     'disk.disks': 
      { label: 'disks',
        module: 'disk',
        stat: 'disks',
        fields: [Object],
        unit: 'disks',
        interval: 'point' },
     'fs.logical_rwops': 
      { label: 'logical read/write operations',
        module: 'fs',
        stat: 'logical_rwops',
        fields: [Object],
        unit: 'operations',
        interval: 'interval' },
     'cpu.usage': 
      { label: 'aggregated CPU usage',
        module: 'cpu',
        stat: 'usage',
        fields: [Object],
        unit: 'percent of 1 CPU',
        interval: 'point' },
     'disk.physio_ops': 
      { label: 'I/O operations',
        module: 'disk',
        stat: 'physio_ops',
        fields: [Object],
        unit: 'operations',
        interval: 'interval' },
     'ldapjs.ops': 
      { label: 'all operations',
        module: 'ldapjs',
        stat: 'ops',
        fields: [Object],
        unit: 'operations',
        interval: 'interval' },
     'tcp.segments': 
      { label: 'segments',
        module: 'tcp',
        stat: 'segments',
        fields: [Object],
        unit: 'segments',
        interval: 'interval' },
     'zfs.arc_ops': 
      { label: 'ARC operations',
        module: 'zfs',
        stat: 'arc_ops',
        fields: [Object],
        unit: 'operations',
        interval: 'interval' },
     'vm.irqs': 
      { label: 'interrupt requests',
        module: 'vm',
        stat: 'irqs',
        fields: [Object],
        unit: 'requests',
        interval: 'interval' },
     'nic.packets': 
      { label: 'packets sent and received',
        module: 'nic',
        stat: 'packets',
        fields: [Object],
        unit: 'packets',
        interval: 'interval' },
     'fs.logical_ops': 
      { label: 'logical filesystem operations',
        module: 'fs',
        stat: 'logical_ops',
        fields: [Object],
        unit: 'operations',
        interval: 'interval' },
     'mantaop.tasks_killed': 
      { label: 'tasks killed',
        module: 'mantaop',
        stat: 'tasks_killed',
        fields: [Object],
        unit: 'tasks',
        interval: 'interval' },
     'node.httpd_ops': 
      { label: 'HTTP server operations',
        module: 'node',
        stat: 'httpd_ops',
        fields: [Object],
        unit: 'operations',
        interval: 'interval' },
     'zfs.pool_total': 
      { type: 'size',
        label: 'total space in pool',
        module: 'zfs',
        stat: 'pool_total',
        fields: [Object],
        interval: 'point' },
     'mantaop.tasks_dispatched': 
      { label: 'tasks dispatched',
        module: 'mantaop',
        stat: 'tasks_dispatched',
        fields: [Object],
        unit: 'tasks',
        interval: 'interval' },
     'ca.instr_beops': 
      { label: 'instrumenter backend requests',
        module: 'ca',
        stat: 'instr_beops',
        fields: [Object],
        unit: 'requests',
        interval: 'interval' },
     'cpu.thread_executions': 
      { label: 'thread executions',
        module: 'cpu',
        stat: 'thread_executions',
        fields: [Object],
        unit: 'operations',
        interval: 'interval' },
     'zfs.pool_free': 
      { type: 'size',
        label: 'free space in pool',
        module: 'zfs',
        stat: 'pool_free',
        fields: [Object],
        interval: 'point' },
     'node.httpc_ops': 
      { label: 'HTTP client operations',
        module: 'node',
        stat: 'httpc_ops',
        fields: [Object],
        unit: 'operations',
        interval: 'interval' },
     'tcp.accepts': 
      { label: 'accepts',
        module: 'tcp',
        stat: 'accepts',
        fields: [Object],
        unit: 'accepts',
        interval: 'interval' },
     'zfs.pool_used': 
      { type: 'size',
        label: 'used space in pool',
        module: 'zfs',
        stat: 'pool_used',
        fields: [Object],
        interval: 'point' } },
  cmm_name: undefined,
  cmm_messages: [ [length]: 0 ],
  cmm_nerrors: 0,
  cmm_modules: 
   { restify: { label: 'Restify', name: 'restify' },
     zfs: { label: 'ZFS', name: 'zfs' },
     ca: { label: 'CA', name: 'ca' },
     node: { label: 'Node.js 0.4.x', name: 'node' },
     mysql: { label: 'MySQL', name: 'mysql' },
     fs: { label: 'Filesystem', name: 'fs' },
     apache: { label: 'Apache', name: 'apache' },
     unix: { label: 'OS', name: 'unix' },
     moray: { label: 'Moray', name: 'moray' },
     mantaop: { label: 'Manta (operator)', name: 'mantaop' },
     disk: { label: 'Disk', name: 'disk' },
     vm: { label: 'Virtual Machine', name: 'vm' },
     tcp: { label: 'TCP', name: 'tcp' },
     memory: { label: 'Memory', name: 'memory' },
     postgres: { label: 'Postgres', name: 'postgres' },
     nic: { label: 'Network interface', name: 'nic' },
     syscall: { label: 'System calls', name: 'syscall' },
     ldapjs: { label: 'ldapjs', name: 'ldapjs' },
     cpu: { label: 'CPU', name: 'cpu' } },
  cmm_nwarnings: 0 }
-------METADATA   END---------
[2015-06-13 21:00:42.127 UTC] DBG    
----------------------------------------
this int state;

sched:::on-cpu
/((curthread->t_pri != -1))/{
	self->runtime0 = timestamp;
}

sched:::off-cpu
/((((((self->runtime0) != NULL)))) && (((((this->state = curlwpsinfo->pr_state) != NULL || 1)))) && (curthread->t_pri != -1))/{
	@[((this->state == SRUN ? "runnable" : this->state == SZOMB ? "exited" : this->state == SSTOP ? "stopped" : this->state == SIDL ? "in proc creation" : this->state == SONPROC ? "on-cpu" : this->state == SWAIT ? "waiting to be runnable" :this->state == SSLEEP ? "sleeping" : "unknown"))] = llquantize((timestamp - self->runtime0), 10, 3, 11, 100);
}

sched:::off-cpu
/((curthread->t_pri != -1))/{
	(self->runtime0) = 0;
}

----------------------------------------
[2015-06-13 21:00:44.051 UTC] INFO   instrumented global;12 (cpu.thread_executions)
[2015-06-13 21:01:12.615 UTC] INFO   deinstrumented global;11
[2015-06-13 21:01:17.455 UTC] INFO   deinstrumented global;10
[2015-06-13 21:01:18.693 UTC] INFO   deinstrumented global;9
[ Jun 13 21:07:54 Stopping because service disabled. ]
[ Jun 13 21:07:54 Executing stop method (:kill). ]
[ Jun 13 21:10:07 Enabled. ]
[ Jun 13 21:10:07 Executing start method ("/opt/smartdc/agents/lib/node_modules/cabase/smf/method/canodesvc"). ]
DTRACE_LIBPATH=/opt/smartdc/agents/lib/node_modules/cabase/lib
ignoring amqp-config key amqp_login
ignoring amqp-config key amqp_password
AMQP_HOST=10.99.99.20
AMQP_PORT=5672
NODE_PATH=:/opt/smartdc/agents/lib/node_modules/cabase/node_modules:/opt/smartdc/agents/lib/node_modules/cabase/node_modules/connect/lib:/opt/smartdc/agents/lib/node_modules/cabase/lib/ca:/opt/smartdc/agents/lib/node_modules/cabase/lib/tst
[ Jun 13 21:10:08 Method "start" exited with status 0. ]
The "sys" module is now called "util". It should have a similar interface.
using backends kstat,dtrace,zfs,cainstr,proc
[2015-06-13 21:10:08.671 UTC] INFO   Logging AMQP message to "/opt/smartdc/agents/log/ca/cainstsvc/amqp-2015-06-13.21:10:08.19786"
[2015-06-13 21:10:08.672 UTC] INFO   Instrumenter starting up (instsvc/0.0)
[2015-06-13 21:10:08.672 UTC] INFO   Hostname:    headnode
[2015-06-13 21:10:08.673 UTC] INFO   AMQP broker: {"host":"10.99.99.20","port":"5672"}
[2015-06-13 21:10:08.673 UTC] INFO   Routing key: ca.instrumenter.headnode
[2015-06-13 21:10:08.677 UTC] DBG    loaded metadata file "metadata/profile/operator.json"
[2015-06-13 21:10:08.678 UTC] DBG    loaded metadata file "metadata/metric/metrics.json"
[2015-06-13 21:10:08.679 UTC] DBG    loaded metadata file "metadata/profile/customer.json"
[2015-06-13 21:10:08.695 UTC] INFO   loading modules.
[2015-06-13 21:10:08.709 UTC] INFO   module "kstat" registered cpu.cpus
[2015-06-13 21:10:08.710 UTC] INFO   module "kstat" registered cpu.usage
[2015-06-13 21:10:08.710 UTC] INFO   module "kstat" registered cpu.waittime
[2015-06-13 21:10:08.710 UTC] INFO   module "kstat" registered cpu.loadavg1
[2015-06-13 21:10:08.710 UTC] INFO   module "kstat" registered nic.nics
[2015-06-13 21:10:08.711 UTC] INFO   module "kstat" registered nic.bytes
[2015-06-13 21:10:08.711 UTC] INFO   module "kstat" registered nic.packets
[2015-06-13 21:10:08.711 UTC] INFO   module "kstat" registered nic.vnic_bytes
[2015-06-13 21:10:08.711 UTC] INFO   module "kstat" registered nic.vnic_packets
[2015-06-13 21:10:08.711 UTC] INFO   module "kstat" registered disk.disks
[2015-06-13 21:10:08.711 UTC] INFO   module "kstat" registered disk.physio_ops
[2015-06-13 21:10:08.711 UTC] INFO   module "kstat" registered disk.physio_bytes
[2015-06-13 21:10:08.712 UTC] INFO   module "kstat" registered tcp.segments
[2015-06-13 21:10:08.712 UTC] INFO   module "kstat" registered tcp.errors
[2015-06-13 21:10:08.712 UTC] INFO   module "kstat" registered fs.logical_rwops
[2015-06-13 21:10:08.712 UTC] INFO   module "kstat" registered fs.logical_rwbytes
[2015-06-13 21:10:08.712 UTC] INFO   module "kstat" registered memory.rss
[2015-06-13 21:10:08.712 UTC] INFO   module "kstat" registered memory.rss_limit
[2015-06-13 21:10:08.713 UTC] INFO   module "kstat" registered memory.swap
[2015-06-13 21:10:08.713 UTC] INFO   module "kstat" registered memory.swap_limit
[2015-06-13 21:10:08.713 UTC] INFO   module "kstat" registered memory.reclaimed_bytes
[2015-06-13 21:10:08.714 UTC] INFO   module "kstat" registered memory.pageins
[2015-06-13 21:10:08.714 UTC] INFO   module "kstat" registered vm.exits
[2015-06-13 21:10:08.714 UTC] INFO   module "kstat" registered zfs.arc_ops
[2015-06-13 21:10:08.714 UTC] INFO   loaded module "kstat".
[2015-06-13 21:10:08.753 UTC] INFO   module "dtrace" registered apache.httpd_ops
[2015-06-13 21:10:08.757 UTC] INFO   module "dtrace" registered cpu.thread_executions
[2015-06-13 21:10:08.759 UTC] INFO   module "dtrace" registered cpu.thread_samples
[2015-06-13 21:10:08.760 UTC] INFO   module "dtrace" registered disk.physio_ops
[2015-06-13 21:10:08.762 UTC] INFO   module "dtrace" registered fs.logical_ops
[2015-06-13 21:10:08.764 UTC] INFO   module "dtrace" registered fs.logical_rwops
[2015-06-13 21:10:08.765 UTC] INFO   module "dtrace" registered ldapjs.connections
[2015-06-13 21:10:08.768 UTC] INFO   module "dtrace" registered ldapjs.ops
[2015-06-13 21:10:08.769 UTC] INFO   module "dtrace" registered ldapjs.search_ops
[2015-06-13 21:10:08.770 UTC] INFO   module "dtrace" registered mantaop.jobs_assigned
[2015-06-13 21:10:08.771 UTC] INFO   module "dtrace" registered mantaop.supervisor_auths
[2015-06-13 21:10:08.772 UTC] INFO   module "dtrace" registered mantaop.supervisor_deletes
[2015-06-13 21:10:08.773 UTC] INFO   module "dtrace" registered mantaop.supervisor_errors
[2015-06-13 21:10:08.774 UTC] INFO   module "dtrace" registered mantaop.supervisor_locates
[2015-06-13 21:10:08.775 UTC] INFO   module "dtrace" registered mantaop.tasks_committed
[2015-06-13 21:10:08.776 UTC] INFO   module "dtrace" registered mantaop.tasks_dispatched
[2015-06-13 21:10:08.777 UTC] INFO   module "dtrace" registered mantaop.tasks_executed
[2015-06-13 21:10:08.777 UTC] INFO   module "dtrace" registered mantaop.tasks_killed
[2015-06-13 21:10:08.778 UTC] INFO   module "dtrace" registered mantaop.zone_resets
[2015-06-13 21:10:08.780 UTC] INFO   module "dtrace" registered moray.ops
[2015-06-13 21:10:08.781 UTC] INFO   module "dtrace" registered moray.queries
[2015-06-13 21:10:08.782 UTC] INFO   module "dtrace" registered mysql.commands
[2015-06-13 21:10:08.783 UTC] INFO   module "dtrace" registered mysql.connections
[2015-06-13 21:10:08.784 UTC] INFO   module "dtrace" registered mysql.filesort
[2015-06-13 21:10:08.786 UTC] INFO   module "dtrace" registered mysql.queries
[2015-06-13 21:10:08.788 UTC] INFO   module "dtrace" registered mysql.statements
[2015-06-13 21:10:08.789 UTC] INFO   module "dtrace" registered node.gc_ops
[2015-06-13 21:10:08.791 UTC] INFO   module "dtrace" registered node.httpc_ops
[2015-06-13 21:10:08.792 UTC] INFO   module "dtrace" registered node.httpd_ops
[2015-06-13 21:10:08.795 UTC] INFO   module "dtrace" registered node.socket_ops
[2015-06-13 21:10:08.796 UTC] INFO   module "dtrace" registered postgres.queries
[2015-06-13 21:10:08.797 UTC] INFO   module "dtrace" registered unix.proc_execs
[2015-06-13 21:10:08.798 UTC] INFO   module "dtrace" registered unix.proc_exits
[2015-06-13 21:10:08.799 UTC] INFO   module "dtrace" registered unix.proc_forks
[2015-06-13 21:10:08.801 UTC] INFO   module "dtrace" registered restify.handler_ops
[2015-06-13 21:10:08.802 UTC] INFO   module "dtrace" registered restify.server_ops
[2015-06-13 21:10:08.803 UTC] INFO   module "dtrace" registered syscall.syscalls
[2015-06-13 21:10:08.805 UTC] INFO   module "dtrace" registered tcp.accepts
[2015-06-13 21:10:08.806 UTC] INFO   module "dtrace" registered tcp.connects
[2015-06-13 21:10:08.807 UTC] INFO   module "dtrace" registered unix.thr_creates
[2015-06-13 21:10:08.808 UTC] INFO   module "dtrace" registered vm.irqs
[2015-06-13 21:10:08.809 UTC] INFO   module "dtrace" registered vm.physio_bytes
[2015-06-13 21:10:08.810 UTC] INFO   module "dtrace" registered vm.physio_ops
[2015-06-13 21:10:08.811 UTC] INFO   module "dtrace" registered vm.thread_samples
[2015-06-13 21:10:08.812 UTC] INFO   module "dtrace" registered zfs.arc_ops
[2015-06-13 21:10:08.812 UTC] INFO   loaded module "dtrace".
[2015-06-13 21:10:08.822 UTC] INFO   module "zfs" registered zfs.dataset_unused_quota
[2015-06-13 21:10:08.823 UTC] INFO   module "zfs" registered zfs.dataset_used
[2015-06-13 21:10:08.823 UTC] INFO   module "zfs" registered zfs.dataset_quota
[2015-06-13 21:10:08.823 UTC] INFO   module "zfs" registered zfs.pool_free
[2015-06-13 21:10:08.823 UTC] INFO   module "zfs" registered zfs.pool_used
[2015-06-13 21:10:08.823 UTC] INFO   module "zfs" registered zfs.pool_total
[2015-06-13 21:10:08.823 UTC] INFO   loaded module "zfs".
[2015-06-13 21:10:08.825 UTC] INFO   module "cainstr" registered ca.instr_ticks
[2015-06-13 21:10:08.825 UTC] INFO   module "cainstr" registered ca.instr_beops
[2015-06-13 21:10:08.825 UTC] INFO   module "cainstr" registered ca.instr_enables
[2015-06-13 21:10:08.825 UTC] INFO   module "cainstr" registered ca.instr_disables
[2015-06-13 21:10:08.825 UTC] INFO   loaded module "cainstr".
[2015-06-13 21:10:08.894 UTC] INFO   module "proc" registered unix.processes
[2015-06-13 21:10:08.894 UTC] INFO   loaded module "proc".
[2015-06-13 21:10:08.895 UTC] INFO   finished loading modules.
[2015-06-13 21:10:09.033 UTC] DBG    binding to ca.instrumenter.headnode
[2015-06-13 21:10:09.037 UTC] DBG    binding to ca.broadcast
[2015-06-13 21:10:09.038 UTC] DBG    bind to ca.instrumenter.headnode complete
[2015-06-13 21:10:09.039 UTC] DBG    bind to ca.broadcast complete
[2015-06-13 21:10:09.039 UTC] INFO   AMQP broker connected.
-------DESC BEGIN---------
{ fields: 
   [ 'hostname',
     'zonename',
     'pid',
     'execname',
     'psargs',
     'ppid',
     'pexecname',
     'ppsargs',
     'fstype',
     'optype',
     'latency',
     [length]: 11 ],
  fields_internal: [ 'vnode', 'depth', [length]: 2 ],
  stat: 'logical_ops',
  module: 'fs',
  metad: 
   { locals: [ [Object], [length]: 1 ],
     probedesc: [ [Object], [Object], [Object], [Object], [length]: 4 ] } }
-------DESC   END---------
-------METRIC BEGIN---------
{ is_backend: 'dtrace',
  is_fqid: 'global;6',
  is_module: 'fs',
  is_decomposition: [ 'optype', 'latency', [length]: 2 ],
  is_predicate: {},
  is_stat: 'logical_ops',
  is_granularity: 5 }
-------METRIC   END---------
-------METADATA BEGIN---------
{ cmm_modules: 
   { zfs: { name: 'zfs', label: 'ZFS' },
     mantaop: { name: 'mantaop', label: 'Manta (operator)' },
     nic: { name: 'nic', label: 'Network interface' },
     cpu: { name: 'cpu', label: 'CPU' },
     syscall: { name: 'syscall', label: 'System calls' },
     ca: { name: 'ca', label: 'CA' },
     memory: { name: 'memory', label: 'Memory' },
     restify: { name: 'restify', label: 'Restify' },
     ldapjs: { name: 'ldapjs', label: 'ldapjs' },
     node: { name: 'node', label: 'Node.js 0.4.x' },
     unix: { name: 'unix', label: 'OS' },
     fs: { name: 'fs', label: 'Filesystem' },
     mysql: { name: 'mysql', label: 'MySQL' },
     postgres: { name: 'postgres', label: 'Postgres' },
     apache: { name: 'apache', label: 'Apache' },
     moray: { name: 'moray', label: 'Moray' },
     disk: { name: 'disk', label: 'Disk' },
     tcp: { name: 'tcp', label: 'TCP' },
     vm: { name: 'vm', label: 'Virtual Machine' } },
  cmm_types: 
   { number: { name: 'number', arity: 'numeric', unit: '' },
     time: 
      { abbr: 's',
        base: 10,
        name: 'time',
        power: -9,
        arity: 'numeric',
        unit: 'seconds' },
     percent: 
      { abbr: '%',
        name: 'percent',
        arity: 'numeric',
        unit: 'percent',
        minmax: 100 },
     subsecond: 
      { abbr: 's',
        base: 10,
        name: 'subsecond',
        power: -3,
        arity: 'numeric',
        unit: 'seconds' },
     size: 
      { abbr: 'B',
        base: 2,
        name: 'size',
        arity: 'numeric',
        unit: 'bytes' },
     string: { name: 'string', arity: 'discrete', unit: '' } },
  cmm_name: undefined,
  cmm_nerrors: 0,
  cmm_fields: 
   { nic: { name: 'nic', label: 'NIC name' },
     ldaprequestdn: { name: 'ldaprequestdn', label: 'request DN' },
     ldapscope: { name: 'ldapscope', label: 'search scope' },
     execname: { name: 'execname', label: 'application name' },
     syscall: { name: 'syscall', label: 'syscall' },
     bytes_read: { type: 'size', name: 'bytes_read', label: 'bytes read' },
     errname: { name: 'errname', label: 'error name' },
     bytes: { type: 'size', name: 'bytes', label: 'bytes read and written' },
     hostname: { name: 'hostname', label: 'server hostname' },
     http_url: { name: 'http_url', label: 'URL' },
     buffered: 
      { type: 'size',
        name: 'buffered',
        label: 'bytes buffered on socket' },
     cabackend: { name: 'cabackend', label: 'backend module' },
     ppid: { name: 'ppid', label: 'parent process identifier' },
     cpumode: { name: 'cpumode', label: 'CPU mode' },
     rport: { name: 'rport', label: 'remote TCP port' },
     psargs: { name: 'psargs', label: 'process arguments' },
     packets: 
      { type: 'number',
        name: 'packets',
        label: 'packets sent and received' },
     ldapfilter: { name: 'ldapfilter', label: 'search filter' },
     irqvector: { type: 'string', name: 'irqvector', label: 'IRQ vector' },
     vleavereason: 
      { type: 'string',
        name: 'vleavereason',
        label: 'reason leaving vCPU' },
     cputime: { type: 'time', name: 'cputime', label: 'CPU time' },
     utilization: { type: 'percent', name: 'utilization', label: 'utilization' },
     restify_rname: { name: 'restify_rname', label: 'restify route name' },
     status: { name: 'status', label: 'status' },
     vcpuid: { type: 'string', name: 'vcpuid', label: 'vCPU identifier' },
     disk: { name: 'disk', label: 'device name' },
     table: { name: 'table', label: 'table name' },
     runtime: { type: 'time', name: 'runtime', label: 'time on CPU' },
     iops_read: 
      { type: 'number',
        name: 'iops_read',
        label: 'read I/O operations' },
     statement: { name: 'statement', label: 'statement type' },
     zonename: { name: 'zonename', label: 'zone name' },
     jobid: { name: 'jobid', label: 'jobid' },
     ppsargs: { name: 'ppsargs', label: 'parent process arguments' },
     pid: { name: 'pid', label: 'process identifier' },
     pexecname: { name: 'pexecname', label: 'parent application name' },
     size: { type: 'size', name: 'size', label: 'size' },
     database: { name: 'database', label: 'database name' },
     fstype: { name: 'fstype', label: 'filesystem type' },
     querysubstr: { name: 'querysubstr', label: 'query substring' },
     busytime: { type: 'percent', name: 'busytime', label: 'non-idle time' },
     packets_in: { type: 'number', name: 'packets_in', label: 'packets received' },
     latency: { type: 'time', name: 'latency', label: 'latency' },
     command: { name: 'command', label: 'command' },
     cametric: { name: 'cametric', label: 'metric name' },
     iops_write: 
      { type: 'number',
        name: 'iops_write',
        label: 'write I/O operations' },
     offset: { type: 'size', name: 'offset', label: 'offset' },
     subsecond: 
      { type: 'subsecond',
        name: 'subsecond',
        label: 'subsecond offset' },
     parsed: { name: 'parsed', label: 'parsed' },
     rss: { type: 'size', name: 'rss', label: 'resident set size' },
     restify_hname: { name: 'restify_hname', label: 'restify handler name' },
     iops: { type: 'number', name: 'iops', label: 'I/O operations' },
     errtype: { name: 'errtype', label: 'error type' },
     contract: { name: 'contract', label: 'contract identifier' },
     leavereason: { name: 'leavereason', label: 'reason leaving CPU' },
     objname: { name: 'objname', label: 'object name' },
     rowsmatched: { type: 'number', name: 'rowsmatched', label: 'rows matched' },
     vmmmuctx: { type: 'string', name: 'vmmmuctx', label: 'VM MMU context' },
     http_status: { name: 'http_status', label: 'Status Code' },
     cainstnid: { name: 'cainstnid', label: 'instrumentation identifier' },
     http_path: { name: 'http_path', label: 'URL path' },
     raddr: { name: 'raddr', label: 'remote IP address' },
     bytes_write: { type: 'size', name: 'bytes_write', label: 'bytes written' },
     packets_out: { type: 'number', name: 'packets_out', label: 'packets sent' },
     zdataset: { name: 'zdataset', label: 'ZFS dataset' },
     restify_sname: { name: 'restify_sname', label: 'restify server name' },
     errno: { type: 'string', name: 'errno', label: 'error code' },
     client: { name: 'client', label: 'client hostname' },
     rowschanged: { type: 'number', name: 'rowschanged', label: 'rows changed' },
     user: { name: 'user', label: 'client username' },
     cpu: { name: 'cpu', label: 'CPU identifier' },
     nthreads: { type: 'number', name: 'nthreads', label: 'number of threads' },
     walltime: { type: 'time', name: 'walltime', label: 'process runtime' },
     zpool: { name: 'zpool', label: 'ZFS pool' },
     optype: { name: 'optype', label: 'operation type' },
     http_origin: { name: 'http_origin', label: 'reported origin IP' },
     tcpstack: { name: 'tcpstack', label: 'TCP instance' },
     pmodel: { name: 'pmodel', label: 'process model' },
     ldapbinddn: { name: 'ldapbinddn', label: 'bind DN' },
     http_method: { name: 'http_method', label: 'method' },
     gctype: { name: 'gctype', label: 'GC type' },
     direction: { name: 'direction', label: 'sent/received' } },
  cmm_messages: [ [length]: 0 ],
  cmm_metrics: 
   { 'nic.packets': 
      { interval: 'interval',
        label: 'packets sent and received',
        module: 'nic',
        stat: 'packets',
        unit: 'packets',
        fields: [Object] },
     'postgres.queries': 
      { interval: 'interval',
        label: 'queries',
        module: 'postgres',
        stat: 'queries',
        unit: 'queries',
        fields: [Object] },
     'cpu.usage': 
      { interval: 'point',
        label: 'aggregated CPU usage',
        module: 'cpu',
        stat: 'usage',
        unit: 'percent of 1 CPU',
        fields: [Object] },
     'memory.swap': 
      { type: 'size',
        interval: 'point',
        label: 'virtual memory reserved',
        module: 'memory',
        stat: 'swap',
        fields: [Object] },
     'memory.pageins': 
      { interval: 'interval',
        label: 'pages paged in',
        module: 'memory',
        stat: 'pageins',
        unit: 'pages',
        fields: [Object] },
     'disk.physio_ops': 
      { interval: 'interval',
        label: 'I/O operations',
        module: 'disk',
        stat: 'physio_ops',
        unit: 'operations',
        fields: [Object] },
     'cpu.loadavg1': 
      { type: 'number',
        interval: 'point',
        label: '1-minute load average',
        module: 'cpu',
        stat: 'loadavg1',
        fields: [Object] },
     'mantaop.supervisor_errors': 
      { interval: 'interval',
        label: 'supervisor errors',
        module: 'mantaop',
        stat: 'supervisor_errors',
        unit: 'errors',
        fields: [Object] },
     'cpu.waittime': 
      { type: 'time',
        interval: 'interval',
        label: 'aggregated wait time',
        module: 'cpu',
        stat: 'waittime',
        fields: [Object] },
     'mantaop.supervisor_deletes': 
      { interval: 'interval',
        label: 'supervisor delete requests',
        module: 'mantaop',
        stat: 'supervisor_deletes',
        unit: 'requests',
        fields: [Object] },
     'cpu.thread_executions': 
      { interval: 'interval',
        label: 'thread executions',
        module: 'cpu',
        stat: 'thread_executions',
        unit: 'operations',
        fields: [Object] },
     'zfs.dataset_unused_quota': 
      { type: 'size',
        interval: 'point',
        label: 'unused quota',
        module: 'zfs',
        stat: 'dataset_unused_quota',
        fields: [Object] },
     'mysql.statements': 
      { interval: 'interval',
        label: 'statements',
        module: 'mysql',
        stat: 'statements',
        unit: 'statements',
        fields: [Object] },
     'zfs.dataset_used': 
      { type: 'size',
        interval: 'point',
        label: 'used space',
        module: 'zfs',
        stat: 'dataset_used',
        fields: [Object] },
     'nic.vnic_packets': 
      { interval: 'interval',
        label: 'VNIC packets sent and received',
        module: 'nic',
        stat: 'vnic_packets',
        unit: 'packets',
        fields: [Object] },
     'mysql.filesort': 
      { interval: 'interval',
        label: 'filesort',
        module: 'mysql',
        stat: 'filesort',
        unit: 'filesorts',
        fields: [Object] },
     'tcp.connects': 
      { interval: 'interval',
        label: 'connects',
        module: 'tcp',
        stat: 'connects',
        unit: 'connects',
        fields: [Object] },
     'restify.server_ops': 
      { interval: 'interval',
        label: 'server operations',
        module: 'restify',
        stat: 'server_ops',
        unit: 'operations',
        fields: [Object] },
     'disk.disks': 
      { interval: 'point',
        label: 'disks',
        module: 'disk',
        stat: 'disks',
        unit: 'disks',
        fields: [Object] },
     'vm.irqs': 
      { interval: 'interval',
        label: 'interrupt requests',
        module: 'vm',
        stat: 'irqs',
        unit: 'requests',
        fields: [Object] },
     'mantaop.tasks_committed': 
      { interval: 'interval',
        label: 'tasks committed',
        module: 'mantaop',
        stat: 'tasks_committed',
        unit: 'tasks',
        fields: [Object] },
     'mysql.queries': 
      { interval: 'interval',
        label: 'queries',
        module: 'mysql',
        stat: 'queries',
        unit: 'queries',
        fields: [Object] },
     'nic.bytes': 
      { type: 'size',
        interval: 'interval',
        label: 'bytes sent and received',
        module: 'nic',
        stat: 'bytes',
        fields: [Object] },
     'restify.handler_ops': 
      { interval: 'interval',
        label: 'handler operations',
        module: 'restify',
        stat: 'handler_ops',
        unit: 'operations',
        fields: [Object] },
     'tcp.accepts': 
      { interval: 'interval',
        label: 'accepts',
        module: 'tcp',
        stat: 'accepts',
        unit: 'accepts',
        fields: [Object] },
     'unix.proc_forks': 
      { interval: 'interval',
        label: 'process forks',
        module: 'unix',
        stat: 'proc_forks',
        unit: 'processes',
        fields: [Object] },
     'ca.instr_enables': 
      { interval: 'interval',
        label: 'instrumenter enable operations',
        module: 'ca',
        stat: 'instr_enables',
        unit: 'operations',
        fields: [Object] },
     'zfs.dataset_quota': 
      { type: 'size',
        interval: 'point',
        label: 'quota size',
        module: 'zfs',
        stat: 'dataset_quota',
        fields: [Object] },
     'vm.physio_ops': 
      { interval: 'interval',
        label: 'disk I/O operations',
        module: 'vm',
        stat: 'physio_ops',
        unit: 'operations',
        fields: [Object] },
     'memory.rss_limit': 
      { type: 'size',
        interval: 'point',
        label: 'maximum resident set size',
        module: 'memory',
        stat: 'rss_limit',
        fields: [Object] },
     'vm.physio_bytes': 
      { type: 'size',
        interval: 'interval',
        label: 'disk bytes read and written',
        module: 'vm',
        stat: 'physio_bytes',
        fields: [Object] },
     'node.httpc_ops': 
      { interval: 'interval',
        label: 'HTTP client operations',
        module: 'node',
        stat: 'httpc_ops',
        unit: 'operations',
        fields: [Object] },
     'fs.logical_rwops': 
      { interval: 'interval',
        label: 'logical read/write operations',
        module: 'fs',
        stat: 'logical_rwops',
        unit: 'operations',
        fields: [Object] },
     'vm.thread_samples': 
      { interval: 'interval',
        label: 'thread samples',
        module: 'vm',
        stat: 'thread_samples',
        unit: 'samples',
        fields: [Object] },
     'mysql.connections': 
      { interval: 'interval',
        label: 'connections',
        module: 'mysql',
        stat: 'connections',
        unit: 'connections',
        fields: [Object] },
     'moray.ops': 
      { interval: 'interval',
        label: 'operations',
        module: 'moray',
        stat: 'ops',
        unit: 'operations',
        fields: [Object] },
     'cpu.cpus': 
      { interval: 'point',
        label: 'CPUs',
        module: 'cpu',
        stat: 'cpus',
        unit: 'CPUs',
        fields: [Object] },
     'ldapjs.connections': 
      { interval: 'interval',
        label: 'connections',
        module: 'ldapjs',
        stat: 'connections',
        unit: 'connections',
        fields: [Object] },
     'mantaop.tasks_dispatched': 
      { interval: 'interval',
        label: 'tasks dispatched',
        module: 'mantaop',
        stat: 'tasks_dispatched',
        unit: 'tasks',
        fields: [Object] },
     'mysql.commands': 
      { interval: 'interval',
        label: 'commands',
        module: 'mysql',
        stat: 'commands',
        unit: 'commands',
        fields: [Object] },
     'nic.vnic_bytes': 
      { type: 'size',
        interval: 'interval',
        label: 'VNIC bytes sent and received',
        module: 'nic',
        stat: 'vnic_bytes',
        fields: [Object] },
     'ca.instr_beops': 
      { interval: 'interval',
        label: 'instrumenter backend requests',
        module: 'ca',
        stat: 'instr_beops',
        unit: 'requests',
        fields: [Object] },
     'memory.rss': 
      { type: 'size',
        interval: 'point',
        label: 'resident set size',
        module: 'memory',
        stat: 'rss',
        fields: [Object] },
     'tcp.errors': 
      { interval: 'interval',
        label: 'errors',
        module: 'tcp',
        stat: 'errors',
        unit: 'errors',
        fields: [Object] },
     'mantaop.tasks_executed': 
      { interval: 'interval',
        label: 'tasks executed',
        module: 'mantaop',
        stat: 'tasks_executed',
        unit: 'tasks',
        fields: [Object] },
     'zfs.pool_total': 
      { type: 'size',
        interval: 'point',
        label: 'total space in pool',
        module: 'zfs',
        stat: 'pool_total',
        fields: [Object] },
     'disk.physio_bytes': 
      { type: 'size',
        interval: 'interval',
        label: 'bytes read and written',
        module: 'disk',
        stat: 'physio_bytes',
        fields: [Object] },
     'fs.logical_rwbytes': 
      { type: 'size',
        interval: 'interval',
        label: 'logical bytes read/written',
        module: 'fs',
        stat: 'logical_rwbytes',
        fields: [Object] },
     'mantaop.supervisor_auths': 
      { interval: 'interval',
        label: 'supervisor auth requests',
        module: 'mantaop',
        stat: 'supervisor_auths',
        unit: 'requests',
        fields: [Object] },
     'memory.reclaimed_bytes': 
      { type: 'size',
        interval: 'interval',
        label: 'excess memory reclaimed',
        module: 'memory',
        stat: 'reclaimed_bytes',
        fields: [Object] },
     'node.httpd_ops': 
      { interval: 'interval',
        label: 'HTTP server operations',
        module: 'node',
        stat: 'httpd_ops',
        unit: 'operations',
        fields: [Object] },
     'cpu.thread_samples': 
      { interval: 'interval',
        label: 'thread samples',
        module: 'cpu',
        stat: 'thread_samples',
        unit: 'samples',
        fields: [Object] },
     'node.socket_ops': 
      { interval: 'interval',
        label: 'socket operations',
        module: 'node',
        stat: 'socket_ops',
        unit: 'operations',
        fields: [Object] },
     'syscall.syscalls': 
      { interval: 'interval',
        label: 'system calls',
        module: 'syscall',
        stat: 'syscalls',
        unit: 'syscalls',
        fields: [Object] },
     'zfs.pool_used': 
      { type: 'size',
        interval: 'point',
        label: 'used space in pool',
        module: 'zfs',
        stat: 'pool_used',
        fields: [Object] },
     'mantaop.jobs_assigned': 
      { interval: 'interval',
        label: 'jobs assigned',
        module: 'mantaop',
        stat: 'jobs_assigned',
        unit: 'jobs',
        fields: [Object] },
     'node.gc_ops': 
      { interval: 'interval',
        label: 'garbage collection operations',
        module: 'node',
        stat: 'gc_ops',
        unit: 'operations',
        fields: [Object] },
     'mantaop.zone_resets': 
      { interval: 'interval',
        label: 'zone resets',
        module: 'mantaop',
        stat: 'zone_resets',
        unit: 'resets',
        fields: [Object] },
     'nic.nics': 
      { interval: 'point',
        label: 'NICs',
        module: 'nic',
        stat: 'nics',
        unit: 'NICs',
        fields: [Object] },
     'vm.exits': 
      { interval: 'interval',
        label: 'exits',
        module: 'vm',
        stat: 'exits',
        unit: 'exits',
        fields: [Object] },
     'mantaop.supervisor_locates': 
      { interval: 'interval',
        label: 'supervisor locate requests',
        module: 'mantaop',
        stat: 'supervisor_locates',
        unit: 'requests',
        fields: [Object] },
     'moray.queries': 
      { interval: 'interval',
        label: 'SQL queries',
        module: 'moray',
        stat: 'queries',
        unit: 'queries',
        fields: [Object] },
     'zfs.arc_ops': 
      { interval: 'interval',
        label: 'ARC operations',
        module: 'zfs',
        stat: 'arc_ops',
        unit: 'operations',
        fields: [Object] },
     'unix.processes': 
      { interval: 'interval',
        label: 'processes',
        module: 'unix',
        stat: 'processes',
        unit: 'processes',
        fields: [Object] },
     'unix.thr_creates': 
      { interval: 'interval',
        label: 'thread creations',
        module: 'unix',
        stat: 'thr_creates',
        unit: 'threads',
        fields: [Object] },
     'zfs.pool_free': 
      { type: 'size',
        interval: 'point',
        label: 'free space in pool',
        module: 'zfs',
        stat: 'pool_free',
        fields: [Object] },
     'mantaop.tasks_killed': 
      { interval: 'interval',
        label: 'tasks killed',
        module: 'mantaop',
        stat: 'tasks_killed',
        unit: 'tasks',
        fields: [Object] },
     'ldapjs.ops': 
      { interval: 'interval',
        label: 'all operations',
        module: 'ldapjs',
        stat: 'ops',
        unit: 'operations',
        fields: [Object] },
     'ca.instr_ticks': 
      { interval: 'interval',
        label: 'instrumenter ticks',
        module: 'ca',
        stat: 'instr_ticks',
        unit: 'ticks',
        fields: [Object] },
     'fs.logical_ops': 
      { interval: 'interval',
        label: 'logical filesystem operations',
        module: 'fs',
        stat: 'logical_ops',
        unit: 'operations',
        fields: [Object] },
     'tcp.segments': 
      { interval: 'interval',
        label: 'segments',
        module: 'tcp',
        stat: 'segments',
        unit: 'segments',
        fields: [Object] },
     'ca.instr_disables': 
      { interval: 'interval',
        label: 'instrumenter disable operations',
        module: 'ca',
        stat: 'instr_disables',
        unit: 'operations',
        fields: [Object] },
     'ldapjs.search_ops': 
      { interval: 'interval',
        label: 'search operations',
        module: 'ldapjs',
        stat: 'search_ops',
        unit: 'operations',
        fields: [Object] },
     'memory.swap_limit': 
      { type: 'size',
        interval: 'point',
        label: 'maximum virtual memory reserved',
        module: 'memory',
        stat: 'swap_limit',
        fields: [Object] },
     'unix.proc_execs': 
      { interval: 'interval',
        label: 'process execs',
        module: 'unix',
        stat: 'proc_execs',
        unit: 'processes',
        fields: [Object] },
     'unix.proc_exits': 
      { interval: 'interval',
        label: 'process exits',
        module: 'unix',
        stat: 'proc_exits',
        unit: 'processes',
        fields: [Object] },
     'apache.httpd_ops': 
      { interval: 'interval',
        label: 'HTTP requests',
        module: 'apache',
        stat: 'httpd_ops',
        unit: 'requests',
        fields: [Object] } },
  cmm_nwarnings: 0 }
-------METADATA   END---------
[2015-06-13 21:10:09.343 UTC] DBG    
----------------------------------------
this string fstype;

fbt::fop_read:entry,
fbt::fop_write:entry,
fbt::fop_ioctl:entry,
fbt::fop_access:entry,
fbt::fop_getattr:entry,
fbt::fop_setattr:entry,
fbt::fop_lookup:entry,
fbt::fop_create:entry,
fbt::fop_remove:entry,
fbt::fop_link:entry,
fbt::fop_rename:entry,
fbt::fop_mkdir:entry,
fbt::fop_rmdir:entry,
fbt::fop_readdir:entry,
fbt::fop_symlink:entry,
fbt::fop_readlink:entry,
fbt::fop_fsync:entry,
fbt::fop_getpage:entry,
fbt::fop_putpage:entry,
fbt::fop_map:entry,
fbt::fop_open:entry
/((self->vnode0 == NULL))/{
	self->vnode0 = arg0;
	self->depth0 = stackdepth;
	self->latency0 = timestamp;
}

fbt::fop_open:return
/((((((self->vnode0) != NULL)))) && (((((self->depth0) != NULL)))) && (((((self->latency0) != NULL)))) && (((((this->fstype = stringof((*((vnode_t**)self->vnode0))->v_op->vnop_name)) != NULL || 1)))) && (self->depth0 == stackdepth && self->vnode0 != NULL && (this->fstype == "ufs" || this->fstype == "zfs" || this->fstype == "dev" || this->fstype == "dev fs" || this->fstype == "proc" || this->fstype == "lofs" || this->fstype == "tmpfs" || this->fstype == "nfs")))/{
	@[((probefunc + 4))] = llquantize((timestamp - self->latency0), 10, 3, 11, 100);
}

fbt::fop_read:return,
fbt::fop_write:return,
fbt::fop_ioctl:return,
fbt::fop_access:return,
fbt::fop_getattr:return,
fbt::fop_setattr:return,
fbt::fop_lookup:return,
fbt::fop_create:return,
fbt::fop_remove:return,
fbt::fop_link:return,
fbt::fop_rename:return,
fbt::fop_mkdir:return,
fbt::fop_rmdir:return,
fbt::fop_readdir:return,
fbt::fop_symlink:return,
fbt::fop_readlink:return,
fbt::fop_fsync:return,
fbt::fop_getpage:return,
fbt::fop_putpage:return,
fbt::fop_map:return
/((((((self->vnode0) != NULL)))) && (((((self->depth0) != NULL)))) && (((((self->latency0) != NULL)))) && (((((this->fstype = stringof(((vnode_t*)self->vnode0)->v_op->vnop_name)) != NULL || 1)))) && (self->depth0 == stackdepth && self->vnode0 != NULL && (this->fstype == "ufs" || this->fstype == "zfs" || this->fstype == "dev" || this->fstype == "dev fs" || this->fstype == "proc" || this->fstype == "lofs" || this->fstype == "tmpfs" || this->fstype == "nfs")))/{
	@[((probefunc + 4))] = llquantize((timestamp - self->latency0), 10, 3, 11, 100);
}

fbt::fop_read:return,
fbt::fop_write:return,
fbt::fop_ioctl:return,
fbt::fop_access:return,
fbt::fop_getattr:return,
fbt::fop_setattr:return,
fbt::fop_lookup:return,
fbt::fop_create:return,
fbt::fop_remove:return,
fbt::fop_link:return,
fbt::fop_rename:return,
fbt::fop_mkdir:return,
fbt::fop_rmdir:return,
fbt::fop_readdir:return,
fbt::fop_symlink:return,
fbt::fop_readlink:return,
fbt::fop_fsync:return,
fbt::fop_getpage:return,
fbt::fop_putpage:return,
fbt::fop_map:return,
fbt::fop_open:entry
/((self->depth0 == stackdepth))/{
	(self->vnode0) = 0;
	(self->depth0) = 0;
	(self->latency0) = 0;
}

----------------------------------------
[2015-06-13 21:10:11.042 UTC] INFO   instrumented global;6 (fs.logical_ops)
-------DESC BEGIN---------
{ fields: 
   [ 'hostname',
     'zonename',
     'pid',
     'execname',
     'psargs',
     'ppid',
     'pexecname',
     'ppsargs',
     'leavereason',
     'runtime',
     'subsecond',
     [length]: 11 ],
  stat: 'thread_executions',
  module: 'cpu',
  metad: 
   { locals: [ [Object], [length]: 1 ],
     probedesc: [ [Object], [Object], [Object], [length]: 3 ] } }
-------DESC   END---------
-------METRIC BEGIN---------
{ is_backend: 'dtrace',
  is_fqid: 'global;12',
  is_module: 'cpu',
  is_decomposition: [ 'leavereason', 'runtime', [length]: 2 ],
  is_predicate: {},
  is_stat: 'thread_executions',
  is_granularity: 5 }
-------METRIC   END---------
-------METADATA BEGIN---------
{ cmm_modules: 
   { zfs: { name: 'zfs', label: 'ZFS' },
     mantaop: { name: 'mantaop', label: 'Manta (operator)' },
     nic: { name: 'nic', label: 'Network interface' },
     cpu: { name: 'cpu', label: 'CPU' },
     syscall: { name: 'syscall', label: 'System calls' },
     ca: { name: 'ca', label: 'CA' },
     memory: { name: 'memory', label: 'Memory' },
     restify: { name: 'restify', label: 'Restify' },
     ldapjs: { name: 'ldapjs', label: 'ldapjs' },
     node: { name: 'node', label: 'Node.js 0.4.x' },
     unix: { name: 'unix', label: 'OS' },
     fs: { name: 'fs', label: 'Filesystem' },
     mysql: { name: 'mysql', label: 'MySQL' },
     postgres: { name: 'postgres', label: 'Postgres' },
     apache: { name: 'apache', label: 'Apache' },
     moray: { name: 'moray', label: 'Moray' },
     disk: { name: 'disk', label: 'Disk' },
     tcp: { name: 'tcp', label: 'TCP' },
     vm: { name: 'vm', label: 'Virtual Machine' } },
  cmm_types: 
   { number: { name: 'number', arity: 'numeric', unit: '' },
     time: 
      { abbr: 's',
        base: 10,
        name: 'time',
        power: -9,
        arity: 'numeric',
        unit: 'seconds' },
     percent: 
      { abbr: '%',
        name: 'percent',
        arity: 'numeric',
        unit: 'percent',
        minmax: 100 },
     subsecond: 
      { abbr: 's',
        base: 10,
        name: 'subsecond',
        power: -3,
        arity: 'numeric',
        unit: 'seconds' },
     size: 
      { abbr: 'B',
        base: 2,
        name: 'size',
        arity: 'numeric',
        unit: 'bytes' },
     string: { name: 'string', arity: 'discrete', unit: '' } },
  cmm_name: undefined,
  cmm_nerrors: 0,
  cmm_fields: 
   { nic: { name: 'nic', label: 'NIC name' },
     ldaprequestdn: { name: 'ldaprequestdn', label: 'request DN' },
     ldapscope: { name: 'ldapscope', label: 'search scope' },
     execname: { name: 'execname', label: 'application name' },
     syscall: { name: 'syscall', label: 'syscall' },
     bytes_read: { type: 'size', name: 'bytes_read', label: 'bytes read' },
     errname: { name: 'errname', label: 'error name' },
     bytes: { type: 'size', name: 'bytes', label: 'bytes read and written' },
     hostname: { name: 'hostname', label: 'server hostname' },
     http_url: { name: 'http_url', label: 'URL' },
     buffered: 
      { type: 'size',
        name: 'buffered',
        label: 'bytes buffered on socket' },
     cabackend: { name: 'cabackend', label: 'backend module' },
     ppid: { name: 'ppid', label: 'parent process identifier' },
     cpumode: { name: 'cpumode', label: 'CPU mode' },
     rport: { name: 'rport', label: 'remote TCP port' },
     psargs: { name: 'psargs', label: 'process arguments' },
     packets: 
      { type: 'number',
        name: 'packets',
        label: 'packets sent and received' },
     ldapfilter: { name: 'ldapfilter', label: 'search filter' },
     irqvector: { type: 'string', name: 'irqvector', label: 'IRQ vector' },
     vleavereason: 
      { type: 'string',
        name: 'vleavereason',
        label: 'reason leaving vCPU' },
     cputime: { type: 'time', name: 'cputime', label: 'CPU time' },
     utilization: { type: 'percent', name: 'utilization', label: 'utilization' },
     restify_rname: { name: 'restify_rname', label: 'restify route name' },
     status: { name: 'status', label: 'status' },
     vcpuid: { type: 'string', name: 'vcpuid', label: 'vCPU identifier' },
     disk: { name: 'disk', label: 'device name' },
     table: { name: 'table', label: 'table name' },
     runtime: { type: 'time', name: 'runtime', label: 'time on CPU' },
     iops_read: 
      { type: 'number',
        name: 'iops_read',
        label: 'read I/O operations' },
     statement: { name: 'statement', label: 'statement type' },
     zonename: { name: 'zonename', label: 'zone name' },
     jobid: { name: 'jobid', label: 'jobid' },
     ppsargs: { name: 'ppsargs', label: 'parent process arguments' },
     pid: { name: 'pid', label: 'process identifier' },
     pexecname: { name: 'pexecname', label: 'parent application name' },
     size: { type: 'size', name: 'size', label: 'size' },
     database: { name: 'database', label: 'database name' },
     fstype: { name: 'fstype', label: 'filesystem type' },
     querysubstr: { name: 'querysubstr', label: 'query substring' },
     busytime: { type: 'percent', name: 'busytime', label: 'non-idle time' },
     packets_in: { type: 'number', name: 'packets_in', label: 'packets received' },
     latency: { type: 'time', name: 'latency', label: 'latency' },
     command: { name: 'command', label: 'command' },
     cametric: { name: 'cametric', label: 'metric name' },
     iops_write: 
      { type: 'number',
        name: 'iops_write',
        label: 'write I/O operations' },
     offset: { type: 'size', name: 'offset', label: 'offset' },
     subsecond: 
      { type: 'subsecond',
        name: 'subsecond',
        label: 'subsecond offset' },
     parsed: { name: 'parsed', label: 'parsed' },
     rss: { type: 'size', name: 'rss', label: 'resident set size' },
     restify_hname: { name: 'restify_hname', label: 'restify handler name' },
     iops: { type: 'number', name: 'iops', label: 'I/O operations' },
     errtype: { name: 'errtype', label: 'error type' },
     contract: { name: 'contract', label: 'contract identifier' },
     leavereason: { name: 'leavereason', label: 'reason leaving CPU' },
     objname: { name: 'objname', label: 'object name' },
     rowsmatched: { type: 'number', name: 'rowsmatched', label: 'rows matched' },
     vmmmuctx: { type: 'string', name: 'vmmmuctx', label: 'VM MMU context' },
     http_status: { name: 'http_status', label: 'Status Code' },
     cainstnid: { name: 'cainstnid', label: 'instrumentation identifier' },
     http_path: { name: 'http_path', label: 'URL path' },
     raddr: { name: 'raddr', label: 'remote IP address' },
     bytes_write: { type: 'size', name: 'bytes_write', label: 'bytes written' },
     packets_out: { type: 'number', name: 'packets_out', label: 'packets sent' },
     zdataset: { name: 'zdataset', label: 'ZFS dataset' },
     restify_sname: { name: 'restify_sname', label: 'restify server name' },
     errno: { type: 'string', name: 'errno', label: 'error code' },
     client: { name: 'client', label: 'client hostname' },
     rowschanged: { type: 'number', name: 'rowschanged', label: 'rows changed' },
     user: { name: 'user', label: 'client username' },
     cpu: { name: 'cpu', label: 'CPU identifier' },
     nthreads: { type: 'number', name: 'nthreads', label: 'number of threads' },
     walltime: { type: 'time', name: 'walltime', label: 'process runtime' },
     zpool: { name: 'zpool', label: 'ZFS pool' },
     optype: { name: 'optype', label: 'operation type' },
     http_origin: { name: 'http_origin', label: 'reported origin IP' },
     tcpstack: { name: 'tcpstack', label: 'TCP instance' },
     pmodel: { name: 'pmodel', label: 'process model' },
     ldapbinddn: { name: 'ldapbinddn', label: 'bind DN' },
     http_method: { name: 'http_method', label: 'method' },
     gctype: { name: 'gctype', label: 'GC type' },
     direction: { name: 'direction', label: 'sent/received' } },
  cmm_messages: [ [length]: 0 ],
  cmm_metrics: 
   { 'nic.packets': 
      { interval: 'interval',
        label: 'packets sent and received',
        module: 'nic',
        stat: 'packets',
        unit: 'packets',
        fields: [Object] },
     'postgres.queries': 
      { interval: 'interval',
        label: 'queries',
        module: 'postgres',
        stat: 'queries',
        unit: 'queries',
        fields: [Object] },
     'cpu.usage': 
      { interval: 'point',
        label: 'aggregated CPU usage',
        module: 'cpu',
        stat: 'usage',
        unit: 'percent of 1 CPU',
        fields: [Object] },
     'memory.swap': 
      { type: 'size',
        interval: 'point',
        label: 'virtual memory reserved',
        module: 'memory',
        stat: 'swap',
        fields: [Object] },
     'memory.pageins': 
      { interval: 'interval',
        label: 'pages paged in',
        module: 'memory',
        stat: 'pageins',
        unit: 'pages',
        fields: [Object] },
     'disk.physio_ops': 
      { interval: 'interval',
        label: 'I/O operations',
        module: 'disk',
        stat: 'physio_ops',
        unit: 'operations',
        fields: [Object] },
     'cpu.loadavg1': 
      { type: 'number',
        interval: 'point',
        label: '1-minute load average',
        module: 'cpu',
        stat: 'loadavg1',
        fields: [Object] },
     'mantaop.supervisor_errors': 
      { interval: 'interval',
        label: 'supervisor errors',
        module: 'mantaop',
        stat: 'supervisor_errors',
        unit: 'errors',
        fields: [Object] },
     'cpu.waittime': 
      { type: 'time',
        interval: 'interval',
        label: 'aggregated wait time',
        module: 'cpu',
        stat: 'waittime',
        fields: [Object] },
     'mantaop.supervisor_deletes': 
      { interval: 'interval',
        label: 'supervisor delete requests',
        module: 'mantaop',
        stat: 'supervisor_deletes',
        unit: 'requests',
        fields: [Object] },
     'cpu.thread_executions': 
      { interval: 'interval',
        label: 'thread executions',
        module: 'cpu',
        stat: 'thread_executions',
        unit: 'operations',
        fields: [Object] },
     'zfs.dataset_unused_quota': 
      { type: 'size',
        interval: 'point',
        label: 'unused quota',
        module: 'zfs',
        stat: 'dataset_unused_quota',
        fields: [Object] },
     'mysql.statements': 
      { interval: 'interval',
        label: 'statements',
        module: 'mysql',
        stat: 'statements',
        unit: 'statements',
        fields: [Object] },
     'zfs.dataset_used': 
      { type: 'size',
        interval: 'point',
        label: 'used space',
        module: 'zfs',
        stat: 'dataset_used',
        fields: [Object] },
     'nic.vnic_packets': 
      { interval: 'interval',
        label: 'VNIC packets sent and received',
        module: 'nic',
        stat: 'vnic_packets',
        unit: 'packets',
        fields: [Object] },
     'mysql.filesort': 
      { interval: 'interval',
        label: 'filesort',
        module: 'mysql',
        stat: 'filesort',
        unit: 'filesorts',
        fields: [Object] },
     'tcp.connects': 
      { interval: 'interval',
        label: 'connects',
        module: 'tcp',
        stat: 'connects',
        unit: 'connects',
        fields: [Object] },
     'restify.server_ops': 
      { interval: 'interval',
        label: 'server operations',
        module: 'restify',
        stat: 'server_ops',
        unit: 'operations',
        fields: [Object] },
     'disk.disks': 
      { interval: 'point',
        label: 'disks',
        module: 'disk',
        stat: 'disks',
        unit: 'disks',
        fields: [Object] },
     'vm.irqs': 
      { interval: 'interval',
        label: 'interrupt requests',
        module: 'vm',
        stat: 'irqs',
        unit: 'requests',
        fields: [Object] },
     'mantaop.tasks_committed': 
      { interval: 'interval',
        label: 'tasks committed',
        module: 'mantaop',
        stat: 'tasks_committed',
        unit: 'tasks',
        fields: [Object] },
     'mysql.queries': 
      { interval: 'interval',
        label: 'queries',
        module: 'mysql',
        stat: 'queries',
        unit: 'queries',
        fields: [Object] },
     'nic.bytes': 
      { type: 'size',
        interval: 'interval',
        label: 'bytes sent and received',
        module: 'nic',
        stat: 'bytes',
        fields: [Object] },
     'restify.handler_ops': 
      { interval: 'interval',
        label: 'handler operations',
        module: 'restify',
        stat: 'handler_ops',
        unit: 'operations',
        fields: [Object] },
     'tcp.accepts': 
      { interval: 'interval',
        label: 'accepts',
        module: 'tcp',
        stat: 'accepts',
        unit: 'accepts',
        fields: [Object] },
     'unix.proc_forks': 
      { interval: 'interval',
        label: 'process forks',
        module: 'unix',
        stat: 'proc_forks',
        unit: 'processes',
        fields: [Object] },
     'ca.instr_enables': 
      { interval: 'interval',
        label: 'instrumenter enable operations',
        module: 'ca',
        stat: 'instr_enables',
        unit: 'operations',
        fields: [Object] },
     'zfs.dataset_quota': 
      { type: 'size',
        interval: 'point',
        label: 'quota size',
        module: 'zfs',
        stat: 'dataset_quota',
        fields: [Object] },
     'vm.physio_ops': 
      { interval: 'interval',
        label: 'disk I/O operations',
        module: 'vm',
        stat: 'physio_ops',
        unit: 'operations',
        fields: [Object] },
     'memory.rss_limit': 
      { type: 'size',
        interval: 'point',
        label: 'maximum resident set size',
        module: 'memory',
        stat: 'rss_limit',
        fields: [Object] },
     'vm.physio_bytes': 
      { type: 'size',
        interval: 'interval',
        label: 'disk bytes read and written',
        module: 'vm',
        stat: 'physio_bytes',
        fields: [Object] },
     'node.httpc_ops': 
      { interval: 'interval',
        label: 'HTTP client operations',
        module: 'node',
        stat: 'httpc_ops',
        unit: 'operations',
        fields: [Object] },
     'fs.logical_rwops': 
      { interval: 'interval',
        label: 'logical read/write operations',
        module: 'fs',
        stat: 'logical_rwops',
        unit: 'operations',
        fields: [Object] },
     'vm.thread_samples': 
      { interval: 'interval',
        label: 'thread samples',
        module: 'vm',
        stat: 'thread_samples',
        unit: 'samples',
        fields: [Object] },
     'mysql.connections': 
      { interval: 'interval',
        label: 'connections',
        module: 'mysql',
        stat: 'connections',
        unit: 'connections',
        fields: [Object] },
     'moray.ops': 
      { interval: 'interval',
        label: 'operations',
        module: 'moray',
        stat: 'ops',
        unit: 'operations',
        fields: [Object] },
     'cpu.cpus': 
      { interval: 'point',
        label: 'CPUs',
        module: 'cpu',
        stat: 'cpus',
        unit: 'CPUs',
        fields: [Object] },
     'ldapjs.connections': 
      { interval: 'interval',
        label: 'connections',
        module: 'ldapjs',
        stat: 'connections',
        unit: 'connections',
        fields: [Object] },
     'mantaop.tasks_dispatched': 
      { interval: 'interval',
        label: 'tasks dispatched',
        module: 'mantaop',
        stat: 'tasks_dispatched',
        unit: 'tasks',
        fields: [Object] },
     'mysql.commands': 
      { interval: 'interval',
        label: 'commands',
        module: 'mysql',
        stat: 'commands',
        unit: 'commands',
        fields: [Object] },
     'nic.vnic_bytes': 
      { type: 'size',
        interval: 'interval',
        label: 'VNIC bytes sent and received',
        module: 'nic',
        stat: 'vnic_bytes',
        fields: [Object] },
     'ca.instr_beops': 
      { interval: 'interval',
        label: 'instrumenter backend requests',
        module: 'ca',
        stat: 'instr_beops',
        unit: 'requests',
        fields: [Object] },
     'memory.rss': 
      { type: 'size',
        interval: 'point',
        label: 'resident set size',
        module: 'memory',
        stat: 'rss',
        fields: [Object] },
     'tcp.errors': 
      { interval: 'interval',
        label: 'errors',
        module: 'tcp',
        stat: 'errors',
        unit: 'errors',
        fields: [Object] },
     'mantaop.tasks_executed': 
      { interval: 'interval',
        label: 'tasks executed',
        module: 'mantaop',
        stat: 'tasks_executed',
        unit: 'tasks',
        fields: [Object] },
     'zfs.pool_total': 
      { type: 'size',
        interval: 'point',
        label: 'total space in pool',
        module: 'zfs',
        stat: 'pool_total',
        fields: [Object] },
     'disk.physio_bytes': 
      { type: 'size',
        interval: 'interval',
        label: 'bytes read and written',
        module: 'disk',
        stat: 'physio_bytes',
        fields: [Object] },
     'fs.logical_rwbytes': 
      { type: 'size',
        interval: 'interval',
        label: 'logical bytes read/written',
        module: 'fs',
        stat: 'logical_rwbytes',
        fields: [Object] },
     'mantaop.supervisor_auths': 
      { interval: 'interval',
        label: 'supervisor auth requests',
        module: 'mantaop',
        stat: 'supervisor_auths',
        unit: 'requests',
        fields: [Object] },
     'memory.reclaimed_bytes': 
      { type: 'size',
        interval: 'interval',
        label: 'excess memory reclaimed',
        module: 'memory',
        stat: 'reclaimed_bytes',
        fields: [Object] },
     'node.httpd_ops': 
      { interval: 'interval',
        label: 'HTTP server operations',
        module: 'node',
        stat: 'httpd_ops',
        unit: 'operations',
        fields: [Object] },
     'cpu.thread_samples': 
      { interval: 'interval',
        label: 'thread samples',
        module: 'cpu',
        stat: 'thread_samples',
        unit: 'samples',
        fields: [Object] },
     'node.socket_ops': 
      { interval: 'interval',
        label: 'socket operations',
        module: 'node',
        stat: 'socket_ops',
        unit: 'operations',
        fields: [Object] },
     'syscall.syscalls': 
      { interval: 'interval',
        label: 'system calls',
        module: 'syscall',
        stat: 'syscalls',
        unit: 'syscalls',
        fields: [Object] },
     'zfs.pool_used': 
      { type: 'size',
        interval: 'point',
        label: 'used space in pool',
        module: 'zfs',
        stat: 'pool_used',
        fields: [Object] },
     'mantaop.jobs_assigned': 
      { interval: 'interval',
        label: 'jobs assigned',
        module: 'mantaop',
        stat: 'jobs_assigned',
        unit: 'jobs',
        fields: [Object] },
     'node.gc_ops': 
      { interval: 'interval',
        label: 'garbage collection operations',
        module: 'node',
        stat: 'gc_ops',
        unit: 'operations',
        fields: [Object] },
     'mantaop.zone_resets': 
      { interval: 'interval',
        label: 'zone resets',
        module: 'mantaop',
        stat: 'zone_resets',
        unit: 'resets',
        fields: [Object] },
     'nic.nics': 
      { interval: 'point',
        label: 'NICs',
        module: 'nic',
        stat: 'nics',
        unit: 'NICs',
        fields: [Object] },
     'vm.exits': 
      { interval: 'interval',
        label: 'exits',
        module: 'vm',
        stat: 'exits',
        unit: 'exits',
        fields: [Object] },
     'mantaop.supervisor_locates': 
      { interval: 'interval',
        label: 'supervisor locate requests',
        module: 'mantaop',
        stat: 'supervisor_locates',
        unit: 'requests',
        fields: [Object] },
     'moray.queries': 
      { interval: 'interval',
        label: 'SQL queries',
        module: 'moray',
        stat: 'queries',
        unit: 'queries',
        fields: [Object] },
     'zfs.arc_ops': 
      { interval: 'interval',
        label: 'ARC operations',
        module: 'zfs',
        stat: 'arc_ops',
        unit: 'operations',
        fields: [Object] },
     'unix.processes': 
      { interval: 'interval',
        label: 'processes',
        module: 'unix',
        stat: 'processes',
        unit: 'processes',
        fields: [Object] },
     'unix.thr_creates': 
      { interval: 'interval',
        label: 'thread creations',
        module: 'unix',
        stat: 'thr_creates',
        unit: 'threads',
        fields: [Object] },
     'zfs.pool_free': 
      { type: 'size',
        interval: 'point',
        label: 'free space in pool',
        module: 'zfs',
        stat: 'pool_free',
        fields: [Object] },
     'mantaop.tasks_killed': 
      { interval: 'interval',
        label: 'tasks killed',
        module: 'mantaop',
        stat: 'tasks_killed',
        unit: 'tasks',
        fields: [Object] },
     'ldapjs.ops': 
      { interval: 'interval',
        label: 'all operations',
        module: 'ldapjs',
        stat: 'ops',
        unit: 'operations',
        fields: [Object] },
     'ca.instr_ticks': 
      { interval: 'interval',
        label: 'instrumenter ticks',
        module: 'ca',
        stat: 'instr_ticks',
        unit: 'ticks',
        fields: [Object] },
     'fs.logical_ops': 
      { interval: 'interval',
        label: 'logical filesystem operations',
        module: 'fs',
        stat: 'logical_ops',
        unit: 'operations',
        fields: [Object] },
     'tcp.segments': 
      { interval: 'interval',
        label: 'segments',
        module: 'tcp',
        stat: 'segments',
        unit: 'segments',
        fields: [Object] },
     'ca.instr_disables': 
      { interval: 'interval',
        label: 'instrumenter disable operations',
        module: 'ca',
        stat: 'instr_disables',
        unit: 'operations',
        fields: [Object] },
     'ldapjs.search_ops': 
      { interval: 'interval',
        label: 'search operations',
        module: 'ldapjs',
        stat: 'search_ops',
        unit: 'operations',
        fields: [Object] },
     'memory.swap_limit': 
      { type: 'size',
        interval: 'point',
        label: 'maximum virtual memory reserved',
        module: 'memory',
        stat: 'swap_limit',
        fields: [Object] },
     'unix.proc_execs': 
      { interval: 'interval',
        label: 'process execs',
        module: 'unix',
        stat: 'proc_execs',
        unit: 'processes',
        fields: [Object] },
     'unix.proc_exits': 
      { interval: 'interval',
        label: 'process exits',
        module: 'unix',
        stat: 'proc_exits',
        unit: 'processes',
        fields: [Object] },
     'apache.httpd_ops': 
      { interval: 'interval',
        label: 'HTTP requests',
        module: 'apache',
        stat: 'httpd_ops',
        unit: 'requests',
        fields: [Object] } },
  cmm_nwarnings: 0 }
-------METADATA   END---------
[2015-06-13 21:10:11.077 UTC] DBG    
----------------------------------------
this int state;

sched:::on-cpu
/((curthread->t_pri != -1))/{
	self->runtime0 = timestamp;
}

sched:::off-cpu
/((((((self->runtime0) != NULL)))) && (((((this->state = curlwpsinfo->pr_state) != NULL || 1)))) && (curthread->t_pri != -1))/{
	@[((this->state == SRUN ? "runnable" : this->state == SZOMB ? "exited" : this->state == SSTOP ? "stopped" : this->state == SIDL ? "in proc creation" : this->state == SONPROC ? "on-cpu" : this->state == SWAIT ? "waiting to be runnable" :this->state == SSLEEP ? "sleeping" : "unknown"))] = llquantize((timestamp - self->runtime0), 10, 3, 11, 100);
}

sched:::off-cpu
/((curthread->t_pri != -1))/{
	(self->runtime0) = 0;
}

----------------------------------------
[2015-06-13 21:10:12.099 UTC] INFO   instrumented global;12 (cpu.thread_executions)
[2015-06-13 21:10:12.109 UTC] INFO   kstat: { module: 'cpu', class: 'misc', name: 'sys' }
decomps: [ 'cpu', 'utilization' ]
predicate: {}
[2015-06-13 21:10:12.109 UTC] INFO   instrumented global;8 (cpu.cpus)
-------DESC BEGIN---------
{ fields: 
   [ 'hostname',
     'zonename',
     'pid',
     'execname',
     'psargs',
     'ppid',
     'pexecname',
     'ppsargs',
     'fstype',
     'optype',
     'latency',
     [length]: 11 ],
  fields_internal: [ 'vnode', 'depth', [length]: 2 ],
  stat: 'logical_ops',
  module: 'fs',
  metad: 
   { locals: [ [Object], [length]: 1 ],
     probedesc: [ [Object], [Object], [Object], [Object], [length]: 4 ] } }
-------DESC   END---------
-------METRIC BEGIN---------
{ is_backend: 'dtrace',
  is_fqid: 'global;7',
  is_module: 'fs',
  is_decomposition: [ 'optype', 'latency', [length]: 2 ],
  is_predicate: {},
  is_stat: 'logical_ops',
  is_granularity: 5 }
-------METRIC   END---------
-------METADATA BEGIN---------
{ cmm_modules: 
   { zfs: { name: 'zfs', label: 'ZFS' },
     mantaop: { name: 'mantaop', label: 'Manta (operator)' },
     nic: { name: 'nic', label: 'Network interface' },
     cpu: { name: 'cpu', label: 'CPU' },
     syscall: { name: 'syscall', label: 'System calls' },
     ca: { name: 'ca', label: 'CA' },
     memory: { name: 'memory', label: 'Memory' },
     restify: { name: 'restify', label: 'Restify' },
     ldapjs: { name: 'ldapjs', label: 'ldapjs' },
     node: { name: 'node', label: 'Node.js 0.4.x' },
     unix: { name: 'unix', label: 'OS' },
     fs: { name: 'fs', label: 'Filesystem' },
     mysql: { name: 'mysql', label: 'MySQL' },
     postgres: { name: 'postgres', label: 'Postgres' },
     apache: { name: 'apache', label: 'Apache' },
     moray: { name: 'moray', label: 'Moray' },
     disk: { name: 'disk', label: 'Disk' },
     tcp: { name: 'tcp', label: 'TCP' },
     vm: { name: 'vm', label: 'Virtual Machine' } },
  cmm_types: 
   { number: { name: 'number', arity: 'numeric', unit: '' },
     time: 
      { abbr: 's',
        base: 10,
        name: 'time',
        power: -9,
        arity: 'numeric',
        unit: 'seconds' },
     percent: 
      { abbr: '%',
        name: 'percent',
        arity: 'numeric',
        unit: 'percent',
        minmax: 100 },
     subsecond: 
      { abbr: 's',
        base: 10,
        name: 'subsecond',
        power: -3,
        arity: 'numeric',
        unit: 'seconds' },
     size: 
      { abbr: 'B',
        base: 2,
        name: 'size',
        arity: 'numeric',
        unit: 'bytes' },
     string: { name: 'string', arity: 'discrete', unit: '' } },
  cmm_name: undefined,
  cmm_nerrors: 0,
  cmm_fields: 
   { nic: { name: 'nic', label: 'NIC name' },
     ldaprequestdn: { name: 'ldaprequestdn', label: 'request DN' },
     ldapscope: { name: 'ldapscope', label: 'search scope' },
     execname: { name: 'execname', label: 'application name' },
     syscall: { name: 'syscall', label: 'syscall' },
     bytes_read: { type: 'size', name: 'bytes_read', label: 'bytes read' },
     errname: { name: 'errname', label: 'error name' },
     bytes: { type: 'size', name: 'bytes', label: 'bytes read and written' },
     hostname: { name: 'hostname', label: 'server hostname' },
     http_url: { name: 'http_url', label: 'URL' },
     buffered: 
      { type: 'size',
        name: 'buffered',
        label: 'bytes buffered on socket' },
     cabackend: { name: 'cabackend', label: 'backend module' },
     ppid: { name: 'ppid', label: 'parent process identifier' },
     cpumode: { name: 'cpumode', label: 'CPU mode' },
     rport: { name: 'rport', label: 'remote TCP port' },
     psargs: { name: 'psargs', label: 'process arguments' },
     packets: 
      { type: 'number',
        name: 'packets',
        label: 'packets sent and received' },
     ldapfilter: { name: 'ldapfilter', label: 'search filter' },
     irqvector: { type: 'string', name: 'irqvector', label: 'IRQ vector' },
     vleavereason: 
      { type: 'string',
        name: 'vleavereason',
        label: 'reason leaving vCPU' },
     cputime: { type: 'time', name: 'cputime', label: 'CPU time' },
     utilization: { type: 'percent', name: 'utilization', label: 'utilization' },
     restify_rname: { name: 'restify_rname', label: 'restify route name' },
     status: { name: 'status', label: 'status' },
     vcpuid: { type: 'string', name: 'vcpuid', label: 'vCPU identifier' },
     disk: { name: 'disk', label: 'device name' },
     table: { name: 'table', label: 'table name' },
     runtime: { type: 'time', name: 'runtime', label: 'time on CPU' },
     iops_read: 
      { type: 'number',
        name: 'iops_read',
        label: 'read I/O operations' },
     statement: { name: 'statement', label: 'statement type' },
     zonename: { name: 'zonename', label: 'zone name' },
     jobid: { name: 'jobid', label: 'jobid' },
     ppsargs: { name: 'ppsargs', label: 'parent process arguments' },
     pid: { name: 'pid', label: 'process identifier' },
     pexecname: { name: 'pexecname', label: 'parent application name' },
     size: { type: 'size', name: 'size', label: 'size' },
     database: { name: 'database', label: 'database name' },
     fstype: { name: 'fstype', label: 'filesystem type' },
     querysubstr: { name: 'querysubstr', label: 'query substring' },
     busytime: { type: 'percent', name: 'busytime', label: 'non-idle time' },
     packets_in: { type: 'number', name: 'packets_in', label: 'packets received' },
     latency: { type: 'time', name: 'latency', label: 'latency' },
     command: { name: 'command', label: 'command' },
     cametric: { name: 'cametric', label: 'metric name' },
     iops_write: 
      { type: 'number',
        name: 'iops_write',
        label: 'write I/O operations' },
     offset: { type: 'size', name: 'offset', label: 'offset' },
     subsecond: 
      { type: 'subsecond',
        name: 'subsecond',
        label: 'subsecond offset' },
     parsed: { name: 'parsed', label: 'parsed' },
     rss: { type: 'size', name: 'rss', label: 'resident set size' },
     restify_hname: { name: 'restify_hname', label: 'restify handler name' },
     iops: { type: 'number', name: 'iops', label: 'I/O operations' },
     errtype: { name: 'errtype', label: 'error type' },
     contract: { name: 'contract', label: 'contract identifier' },
     leavereason: { name: 'leavereason', label: 'reason leaving CPU' },
     objname: { name: 'objname', label: 'object name' },
     rowsmatched: { type: 'number', name: 'rowsmatched', label: 'rows matched' },
     vmmmuctx: { type: 'string', name: 'vmmmuctx', label: 'VM MMU context' },
     http_status: { name: 'http_status', label: 'Status Code' },
     cainstnid: { name: 'cainstnid', label: 'instrumentation identifier' },
     http_path: { name: 'http_path', label: 'URL path' },
     raddr: { name: 'raddr', label: 'remote IP address' },
     bytes_write: { type: 'size', name: 'bytes_write', label: 'bytes written' },
     packets_out: { type: 'number', name: 'packets_out', label: 'packets sent' },
     zdataset: { name: 'zdataset', label: 'ZFS dataset' },
     restify_sname: { name: 'restify_sname', label: 'restify server name' },
     errno: { type: 'string', name: 'errno', label: 'error code' },
     client: { name: 'client', label: 'client hostname' },
     rowschanged: { type: 'number', name: 'rowschanged', label: 'rows changed' },
     user: { name: 'user', label: 'client username' },
     cpu: { name: 'cpu', label: 'CPU identifier' },
     nthreads: { type: 'number', name: 'nthreads', label: 'number of threads' },
     walltime: { type: 'time', name: 'walltime', label: 'process runtime' },
     zpool: { name: 'zpool', label: 'ZFS pool' },
     optype: { name: 'optype', label: 'operation type' },
     http_origin: { name: 'http_origin', label: 'reported origin IP' },
     tcpstack: { name: 'tcpstack', label: 'TCP instance' },
     pmodel: { name: 'pmodel', label: 'process model' },
     ldapbinddn: { name: 'ldapbinddn', label: 'bind DN' },
     http_method: { name: 'http_method', label: 'method' },
     gctype: { name: 'gctype', label: 'GC type' },
     direction: { name: 'direction', label: 'sent/received' } },
  cmm_messages: [ [length]: 0 ],
  cmm_metrics: 
   { 'nic.packets': 
      { interval: 'interval',
        label: 'packets sent and received',
        module: 'nic',
        stat: 'packets',
        unit: 'packets',
        fields: [Object] },
     'postgres.queries': 
      { interval: 'interval',
        label: 'queries',
        module: 'postgres',
        stat: 'queries',
        unit: 'queries',
        fields: [Object] },
     'cpu.usage': 
      { interval: 'point',
        label: 'aggregated CPU usage',
        module: 'cpu',
        stat: 'usage',
        unit: 'percent of 1 CPU',
        fields: [Object] },
     'memory.swap': 
      { type: 'size',
        interval: 'point',
        label: 'virtual memory reserved',
        module: 'memory',
        stat: 'swap',
        fields: [Object] },
     'memory.pageins': 
      { interval: 'interval',
        label: 'pages paged in',
        module: 'memory',
        stat: 'pageins',
        unit: 'pages',
        fields: [Object] },
     'disk.physio_ops': 
      { interval: 'interval',
        label: 'I/O operations',
        module: 'disk',
        stat: 'physio_ops',
        unit: 'operations',
        fields: [Object] },
     'cpu.loadavg1': 
      { type: 'number',
        interval: 'point',
        label: '1-minute load average',
        module: 'cpu',
        stat: 'loadavg1',
        fields: [Object] },
     'mantaop.supervisor_errors': 
      { interval: 'interval',
        label: 'supervisor errors',
        module: 'mantaop',
        stat: 'supervisor_errors',
        unit: 'errors',
        fields: [Object] },
     'cpu.waittime': 
      { type: 'time',
        interval: 'interval',
        label: 'aggregated wait time',
        module: 'cpu',
        stat: 'waittime',
        fields: [Object] },
     'mantaop.supervisor_deletes': 
      { interval: 'interval',
        label: 'supervisor delete requests',
        module: 'mantaop',
        stat: 'supervisor_deletes',
        unit: 'requests',
        fields: [Object] },
     'cpu.thread_executions': 
      { interval: 'interval',
        label: 'thread executions',
        module: 'cpu',
        stat: 'thread_executions',
        unit: 'operations',
        fields: [Object] },
     'zfs.dataset_unused_quota': 
      { type: 'size',
        interval: 'point',
        label: 'unused quota',
        module: 'zfs',
        stat: 'dataset_unused_quota',
        fields: [Object] },
     'mysql.statements': 
      { interval: 'interval',
        label: 'statements',
        module: 'mysql',
        stat: 'statements',
        unit: 'statements',
        fields: [Object] },
     'zfs.dataset_used': 
      { type: 'size',
        interval: 'point',
        label: 'used space',
        module: 'zfs',
        stat: 'dataset_used',
        fields: [Object] },
     'nic.vnic_packets': 
      { interval: 'interval',
        label: 'VNIC packets sent and received',
        module: 'nic',
        stat: 'vnic_packets',
        unit: 'packets',
        fields: [Object] },
     'mysql.filesort': 
      { interval: 'interval',
        label: 'filesort',
        module: 'mysql',
        stat: 'filesort',
        unit: 'filesorts',
        fields: [Object] },
     'tcp.connects': 
      { interval: 'interval',
        label: 'connects',
        module: 'tcp',
        stat: 'connects',
        unit: 'connects',
        fields: [Object] },
     'restify.server_ops': 
      { interval: 'interval',
        label: 'server operations',
        module: 'restify',
        stat: 'server_ops',
        unit: 'operations',
        fields: [Object] },
     'disk.disks': 
      { interval: 'point',
        label: 'disks',
        module: 'disk',
        stat: 'disks',
        unit: 'disks',
        fields: [Object] },
     'vm.irqs': 
      { interval: 'interval',
        label: 'interrupt requests',
        module: 'vm',
        stat: 'irqs',
        unit: 'requests',
        fields: [Object] },
     'mantaop.tasks_committed': 
      { interval: 'interval',
        label: 'tasks committed',
        module: 'mantaop',
        stat: 'tasks_committed',
        unit: 'tasks',
        fields: [Object] },
     'mysql.queries': 
      { interval: 'interval',
        label: 'queries',
        module: 'mysql',
        stat: 'queries',
        unit: 'queries',
        fields: [Object] },
     'nic.bytes': 
      { type: 'size',
        interval: 'interval',
        label: 'bytes sent and received',
        module: 'nic',
        stat: 'bytes',
        fields: [Object] },
     'restify.handler_ops': 
      { interval: 'interval',
        label: 'handler operations',
        module: 'restify',
        stat: 'handler_ops',
        unit: 'operations',
        fields: [Object] },
     'tcp.accepts': 
      { interval: 'interval',
        label: 'accepts',
        module: 'tcp',
        stat: 'accepts',
        unit: 'accepts',
        fields: [Object] },
     'unix.proc_forks': 
      { interval: 'interval',
        label: 'process forks',
        module: 'unix',
        stat: 'proc_forks',
        unit: 'processes',
        fields: [Object] },
     'ca.instr_enables': 
      { interval: 'interval',
        label: 'instrumenter enable operations',
        module: 'ca',
        stat: 'instr_enables',
        unit: 'operations',
        fields: [Object] },
     'zfs.dataset_quota': 
      { type: 'size',
        interval: 'point',
        label: 'quota size',
        module: 'zfs',
        stat: 'dataset_quota',
        fields: [Object] },
     'vm.physio_ops': 
      { interval: 'interval',
        label: 'disk I/O operations',
        module: 'vm',
        stat: 'physio_ops',
        unit: 'operations',
        fields: [Object] },
     'memory.rss_limit': 
      { type: 'size',
        interval: 'point',
        label: 'maximum resident set size',
        module: 'memory',
        stat: 'rss_limit',
        fields: [Object] },
     'vm.physio_bytes': 
      { type: 'size',
        interval: 'interval',
        label: 'disk bytes read and written',
        module: 'vm',
        stat: 'physio_bytes',
        fields: [Object] },
     'node.httpc_ops': 
      { interval: 'interval',
        label: 'HTTP client operations',
        module: 'node',
        stat: 'httpc_ops',
        unit: 'operations',
        fields: [Object] },
     'fs.logical_rwops': 
      { interval: 'interval',
        label: 'logical read/write operations',
        module: 'fs',
        stat: 'logical_rwops',
        unit: 'operations',
        fields: [Object] },
     'vm.thread_samples': 
      { interval: 'interval',
        label: 'thread samples',
        module: 'vm',
        stat: 'thread_samples',
        unit: 'samples',
        fields: [Object] },
     'mysql.connections': 
      { interval: 'interval',
        label: 'connections',
        module: 'mysql',
        stat: 'connections',
        unit: 'connections',
        fields: [Object] },
     'moray.ops': 
      { interval: 'interval',
        label: 'operations',
        module: 'moray',
        stat: 'ops',
        unit: 'operations',
        fields: [Object] },
     'cpu.cpus': 
      { interval: 'point',
        label: 'CPUs',
        module: 'cpu',
        stat: 'cpus',
        unit: 'CPUs',
        fields: [Object] },
     'ldapjs.connections': 
      { interval: 'interval',
        label: 'connections',
        module: 'ldapjs',
        stat: 'connections',
        unit: 'connections',
        fields: [Object] },
     'mantaop.tasks_dispatched': 
      { interval: 'interval',
        label: 'tasks dispatched',
        module: 'mantaop',
        stat: 'tasks_dispatched',
        unit: 'tasks',
        fields: [Object] },
     'mysql.commands': 
      { interval: 'interval',
        label: 'commands',
        module: 'mysql',
        stat: 'commands',
        unit: 'commands',
        fields: [Object] },
     'nic.vnic_bytes': 
      { type: 'size',
        interval: 'interval',
        label: 'VNIC bytes sent and received',
        module: 'nic',
        stat: 'vnic_bytes',
        fields: [Object] },
     'ca.instr_beops': 
      { interval: 'interval',
        label: 'instrumenter backend requests',
        module: 'ca',
        stat: 'instr_beops',
        unit: 'requests',
        fields: [Object] },
     'memory.rss': 
      { type: 'size',
        interval: 'point',
        label: 'resident set size',
        module: 'memory',
        stat: 'rss',
        fields: [Object] },
     'tcp.errors': 
      { interval: 'interval',
        label: 'errors',
        module: 'tcp',
        stat: 'errors',
        unit: 'errors',
        fields: [Object] },
     'mantaop.tasks_executed': 
      { interval: 'interval',
        label: 'tasks executed',
        module: 'mantaop',
        stat: 'tasks_executed',
        unit: 'tasks',
        fields: [Object] },
     'zfs.pool_total': 
      { type: 'size',
        interval: 'point',
        label: 'total space in pool',
        module: 'zfs',
        stat: 'pool_total',
        fields: [Object] },
     'disk.physio_bytes': 
      { type: 'size',
        interval: 'interval',
        label: 'bytes read and written',
        module: 'disk',
        stat: 'physio_bytes',
        fields: [Object] },
     'fs.logical_rwbytes': 
      { type: 'size',
        interval: 'interval',
        label: 'logical bytes read/written',
        module: 'fs',
        stat: 'logical_rwbytes',
        fields: [Object] },
     'mantaop.supervisor_auths': 
      { interval: 'interval',
        label: 'supervisor auth requests',
        module: 'mantaop',
        stat: 'supervisor_auths',
        unit: 'requests',
        fields: [Object] },
     'memory.reclaimed_bytes': 
      { type: 'size',
        interval: 'interval',
        label: 'excess memory reclaimed',
        module: 'memory',
        stat: 'reclaimed_bytes',
        fields: [Object] },
     'node.httpd_ops': 
      { interval: 'interval',
        label: 'HTTP server operations',
        module: 'node',
        stat: 'httpd_ops',
        unit: 'operations',
        fields: [Object] },
     'cpu.thread_samples': 
      { interval: 'interval',
        label: 'thread samples',
        module: 'cpu',
        stat: 'thread_samples',
        unit: 'samples',
        fields: [Object] },
     'node.socket_ops': 
      { interval: 'interval',
        label: 'socket operations',
        module: 'node',
        stat: 'socket_ops',
        unit: 'operations',
        fields: [Object] },
     'syscall.syscalls': 
      { interval: 'interval',
        label: 'system calls',
        module: 'syscall',
        stat: 'syscalls',
        unit: 'syscalls',
        fields: [Object] },
     'zfs.pool_used': 
      { type: 'size',
        interval: 'point',
        label: 'used space in pool',
        module: 'zfs',
        stat: 'pool_used',
        fields: [Object] },
     'mantaop.jobs_assigned': 
      { interval: 'interval',
        label: 'jobs assigned',
        module: 'mantaop',
        stat: 'jobs_assigned',
        unit: 'jobs',
        fields: [Object] },
     'node.gc_ops': 
      { interval: 'interval',
        label: 'garbage collection operations',
        module: 'node',
        stat: 'gc_ops',
        unit: 'operations',
        fields: [Object] },
     'mantaop.zone_resets': 
      { interval: 'interval',
        label: 'zone resets',
        module: 'mantaop',
        stat: 'zone_resets',
        unit: 'resets',
        fields: [Object] },
     'nic.nics': 
      { interval: 'point',
        label: 'NICs',
        module: 'nic',
        stat: 'nics',
        unit: 'NICs',
        fields: [Object] },
     'vm.exits': 
      { interval: 'interval',
        label: 'exits',
        module: 'vm',
        stat: 'exits',
        unit: 'exits',
        fields: [Object] },
     'mantaop.supervisor_locates': 
      { interval: 'interval',
        label: 'supervisor locate requests',
        module: 'mantaop',
        stat: 'supervisor_locates',
        unit: 'requests',
        fields: [Object] },
     'moray.queries': 
      { interval: 'interval',
        label: 'SQL queries',
        module: 'moray',
        stat: 'queries',
        unit: 'queries',
        fields: [Object] },
     'zfs.arc_ops': 
      { interval: 'interval',
        label: 'ARC operations',
        module: 'zfs',
        stat: 'arc_ops',
        unit: 'operations',
        fields: [Object] },
     'unix.processes': 
      { interval: 'interval',
        label: 'processes',
        module: 'unix',
        stat: 'processes',
        unit: 'processes',
        fields: [Object] },
     'unix.thr_creates': 
      { interval: 'interval',
        label: 'thread creations',
        module: 'unix',
        stat: 'thr_creates',
        unit: 'threads',
        fields: [Object] },
     'zfs.pool_free': 
      { type: 'size',
        interval: 'point',
        label: 'free space in pool',
        module: 'zfs',
        stat: 'pool_free',
        fields: [Object] },
     'mantaop.tasks_killed': 
      { interval: 'interval',
        label: 'tasks killed',
        module: 'mantaop',
        stat: 'tasks_killed',
        unit: 'tasks',
        fields: [Object] },
     'ldapjs.ops': 
      { interval: 'interval',
        label: 'all operations',
        module: 'ldapjs',
        stat: 'ops',
        unit: 'operations',
        fields: [Object] },
     'ca.instr_ticks': 
      { interval: 'interval',
        label: 'instrumenter ticks',
        module: 'ca',
        stat: 'instr_ticks',
        unit: 'ticks',
        fields: [Object] },
     'fs.logical_ops': 
      { interval: 'interval',
        label: 'logical filesystem operations',
        module: 'fs',
        stat: 'logical_ops',
        unit: 'operations',
        fields: [Object] },
     'tcp.segments': 
      { interval: 'interval',
        label: 'segments',
        module: 'tcp',
        stat: 'segments',
        unit: 'segments',
        fields: [Object] },
     'ca.instr_disables': 
      { interval: 'interval',
        label: 'instrumenter disable operations',
        module: 'ca',
        stat: 'instr_disables',
        unit: 'operations',
        fields: [Object] },
     'ldapjs.search_ops': 
      { interval: 'interval',
        label: 'search operations',
        module: 'ldapjs',
        stat: 'search_ops',
        unit: 'operations',
        fields: [Object] },
     'memory.swap_limit': 
      { type: 'size',
        interval: 'point',
        label: 'maximum virtual memory reserved',
        module: 'memory',
        stat: 'swap_limit',
        fields: [Object] },
     'unix.proc_execs': 
      { interval: 'interval',
        label: 'process execs',
        module: 'unix',
        stat: 'proc_execs',
        unit: 'processes',
        fields: [Object] },
     'unix.proc_exits': 
      { interval: 'interval',
        label: 'process exits',
        module: 'unix',
        stat: 'proc_exits',
        unit: 'processes',
        fields: [Object] },
     'apache.httpd_ops': 
      { interval: 'interval',
        label: 'HTTP requests',
        module: 'apache',
        stat: 'httpd_ops',
        unit: 'requests',
        fields: [Object] } },
  cmm_nwarnings: 0 }
-------METADATA   END---------
[2015-06-13 21:10:12.121 UTC] DBG    
----------------------------------------
this string fstype;

fbt::fop_read:entry,
fbt::fop_write:entry,
fbt::fop_ioctl:entry,
fbt::fop_access:entry,
fbt::fop_getattr:entry,
fbt::fop_setattr:entry,
fbt::fop_lookup:entry,
fbt::fop_create:entry,
fbt::fop_remove:entry,
fbt::fop_link:entry,
fbt::fop_rename:entry,
fbt::fop_mkdir:entry,
fbt::fop_rmdir:entry,
fbt::fop_readdir:entry,
fbt::fop_symlink:entry,
fbt::fop_readlink:entry,
fbt::fop_fsync:entry,
fbt::fop_getpage:entry,
fbt::fop_putpage:entry,
fbt::fop_map:entry,
fbt::fop_open:entry
/((self->vnode0 == NULL))/{
	self->vnode0 = arg0;
	self->depth0 = stackdepth;
	self->latency0 = timestamp;
}

fbt::fop_open:return
/((((((self->vnode0) != NULL)))) && (((((self->depth0) != NULL)))) && (((((self->latency0) != NULL)))) && (((((this->fstype = stringof((*((vnode_t**)self->vnode0))->v_op->vnop_name)) != NULL || 1)))) && (self->depth0 == stackdepth && self->vnode0 != NULL && (this->fstype == "ufs" || this->fstype == "zfs" || this->fstype == "dev" || this->fstype == "dev fs" || this->fstype == "proc" || this->fstype == "lofs" || this->fstype == "tmpfs" || this->fstype == "nfs")))/{
	@[((probefunc + 4))] = llquantize((timestamp - self->latency0), 10, 3, 11, 100);
}

fbt::fop_read:return,
fbt::fop_write:return,
fbt::fop_ioctl:return,
fbt::fop_access:return,
fbt::fop_getattr:return,
fbt::fop_setattr:return,
fbt::fop_lookup:return,
fbt::fop_create:return,
fbt::fop_remove:return,
fbt::fop_link:return,
fbt::fop_rename:return,
fbt::fop_mkdir:return,
fbt::fop_rmdir:return,
fbt::fop_readdir:return,
fbt::fop_symlink:return,
fbt::fop_readlink:return,
fbt::fop_fsync:return,
fbt::fop_getpage:return,
fbt::fop_putpage:return,
fbt::fop_map:return
/((((((self->vnode0) != NULL)))) && (((((self->depth0) != NULL)))) && (((((self->latency0) != NULL)))) && (((((this->fstype = stringof(((vnode_t*)self->vnode0)->v_op->vnop_name)) != NULL || 1)))) && (self->depth0 == stackdepth && self->vnode0 != NULL && (this->fstype == "ufs" || this->fstype == "zfs" || this->fstype == "dev" || this->fstype == "dev fs" || this->fstype == "proc" || this->fstype == "lofs" || this->fstype == "tmpfs" || this->fstype == "nfs")))/{
	@[((probefunc + 4))] = llquantize((timestamp - self->latency0), 10, 3, 11, 100);
}

fbt::fop_read:return,
fbt::fop_write:return,
fbt::fop_ioctl:return,
fbt::fop_access:return,
fbt::fop_getattr:return,
fbt::fop_setattr:return,
fbt::fop_lookup:return,
fbt::fop_create:return,
fbt::fop_remove:return,
fbt::fop_link:return,
fbt::fop_rename:return,
fbt::fop_mkdir:return,
fbt::fop_rmdir:return,
fbt::fop_readdir:return,
fbt::fop_symlink:return,
fbt::fop_readlink:return,
fbt::fop_fsync:return,
fbt::fop_getpage:return,
fbt::fop_putpage:return,
fbt::fop_map:return,
fbt::fop_open:entry
/((self->depth0 == stackdepth))/{
	(self->vnode0) = 0;
	(self->depth0) = 0;
	(self->latency0) = 0;
}

----------------------------------------
[2015-06-13 21:10:13.983 UTC] INFO   instrumented global;7 (fs.logical_ops)
-------DESC BEGIN---------
{ fields: 
   [ 'hostname',
     'zonename',
     'pid',
     'execname',
     'psargs',
     'ppid',
     'pexecname',
     'ppsargs',
     'leavereason',
     'runtime',
     'subsecond',
     [length]: 11 ],
  fields_internal: [ [length]: 0 ],
  stat: 'thread_executions',
  module: 'cpu',
  metad: 
   { locals: [ [Object], [length]: 1 ],
     probedesc: [ [Object], [Object], [Object], [length]: 3 ] } }
-------DESC   END---------
-------METRIC BEGIN---------
{ is_backend: 'dtrace',
  is_fqid: 'global;13',
  is_module: 'cpu',
  is_decomposition: [ 'execname', 'runtime', [length]: 2 ],
  is_predicate: {},
  is_stat: 'thread_executions',
  is_granularity: 5 }
-------METRIC   END---------
-------METADATA BEGIN---------
{ cmm_modules: 
   { zfs: { name: 'zfs', label: 'ZFS' },
     mantaop: { name: 'mantaop', label: 'Manta (operator)' },
     nic: { name: 'nic', label: 'Network interface' },
     cpu: { name: 'cpu', label: 'CPU' },
     syscall: { name: 'syscall', label: 'System calls' },
     ca: { name: 'ca', label: 'CA' },
     memory: { name: 'memory', label: 'Memory' },
     restify: { name: 'restify', label: 'Restify' },
     ldapjs: { name: 'ldapjs', label: 'ldapjs' },
     node: { name: 'node', label: 'Node.js 0.4.x' },
     unix: { name: 'unix', label: 'OS' },
     fs: { name: 'fs', label: 'Filesystem' },
     mysql: { name: 'mysql', label: 'MySQL' },
     postgres: { name: 'postgres', label: 'Postgres' },
     apache: { name: 'apache', label: 'Apache' },
     moray: { name: 'moray', label: 'Moray' },
     disk: { name: 'disk', label: 'Disk' },
     tcp: { name: 'tcp', label: 'TCP' },
     vm: { name: 'vm', label: 'Virtual Machine' } },
  cmm_types: 
   { number: { name: 'number', arity: 'numeric', unit: '' },
     time: 
      { abbr: 's',
        base: 10,
        name: 'time',
        power: -9,
        arity: 'numeric',
        unit: 'seconds' },
     percent: 
      { abbr: '%',
        name: 'percent',
        arity: 'numeric',
        unit: 'percent',
        minmax: 100 },
     subsecond: 
      { abbr: 's',
        base: 10,
        name: 'subsecond',
        power: -3,
        arity: 'numeric',
        unit: 'seconds' },
     size: 
      { abbr: 'B',
        base: 2,
        name: 'size',
        arity: 'numeric',
        unit: 'bytes' },
     string: { name: 'string', arity: 'discrete', unit: '' } },
  cmm_name: undefined,
  cmm_nerrors: 0,
  cmm_fields: 
   { nic: { name: 'nic', label: 'NIC name' },
     ldaprequestdn: { name: 'ldaprequestdn', label: 'request DN' },
     ldapscope: { name: 'ldapscope', label: 'search scope' },
     execname: { name: 'execname', label: 'application name' },
     syscall: { name: 'syscall', label: 'syscall' },
     bytes_read: { type: 'size', name: 'bytes_read', label: 'bytes read' },
     errname: { name: 'errname', label: 'error name' },
     bytes: { type: 'size', name: 'bytes', label: 'bytes read and written' },
     hostname: { name: 'hostname', label: 'server hostname' },
     http_url: { name: 'http_url', label: 'URL' },
     buffered: 
      { type: 'size',
        name: 'buffered',
        label: 'bytes buffered on socket' },
     cabackend: { name: 'cabackend', label: 'backend module' },
     ppid: { name: 'ppid', label: 'parent process identifier' },
     cpumode: { name: 'cpumode', label: 'CPU mode' },
     rport: { name: 'rport', label: 'remote TCP port' },
     psargs: { name: 'psargs', label: 'process arguments' },
     packets: 
      { type: 'number',
        name: 'packets',
        label: 'packets sent and received' },
     ldapfilter: { name: 'ldapfilter', label: 'search filter' },
     irqvector: { type: 'string', name: 'irqvector', label: 'IRQ vector' },
     vleavereason: 
      { type: 'string',
        name: 'vleavereason',
        label: 'reason leaving vCPU' },
     cputime: { type: 'time', name: 'cputime', label: 'CPU time' },
     utilization: { type: 'percent', name: 'utilization', label: 'utilization' },
     restify_rname: { name: 'restify_rname', label: 'restify route name' },
     status: { name: 'status', label: 'status' },
     vcpuid: { type: 'string', name: 'vcpuid', label: 'vCPU identifier' },
     disk: { name: 'disk', label: 'device name' },
     table: { name: 'table', label: 'table name' },
     runtime: { type: 'time', name: 'runtime', label: 'time on CPU' },
     iops_read: 
      { type: 'number',
        name: 'iops_read',
        label: 'read I/O operations' },
     statement: { name: 'statement', label: 'statement type' },
     zonename: { name: 'zonename', label: 'zone name' },
     jobid: { name: 'jobid', label: 'jobid' },
     ppsargs: { name: 'ppsargs', label: 'parent process arguments' },
     pid: { name: 'pid', label: 'process identifier' },
     pexecname: { name: 'pexecname', label: 'parent application name' },
     size: { type: 'size', name: 'size', label: 'size' },
     database: { name: 'database', label: 'database name' },
     fstype: { name: 'fstype', label: 'filesystem type' },
     querysubstr: { name: 'querysubstr', label: 'query substring' },
     busytime: { type: 'percent', name: 'busytime', label: 'non-idle time' },
     packets_in: { type: 'number', name: 'packets_in', label: 'packets received' },
     latency: { type: 'time', name: 'latency', label: 'latency' },
     command: { name: 'command', label: 'command' },
     cametric: { name: 'cametric', label: 'metric name' },
     iops_write: 
      { type: 'number',
        name: 'iops_write',
        label: 'write I/O operations' },
     offset: { type: 'size', name: 'offset', label: 'offset' },
     subsecond: 
      { type: 'subsecond',
        name: 'subsecond',
        label: 'subsecond offset' },
     parsed: { name: 'parsed', label: 'parsed' },
     rss: { type: 'size', name: 'rss', label: 'resident set size' },
     restify_hname: { name: 'restify_hname', label: 'restify handler name' },
     iops: { type: 'number', name: 'iops', label: 'I/O operations' },
     errtype: { name: 'errtype', label: 'error type' },
     contract: { name: 'contract', label: 'contract identifier' },
     leavereason: { name: 'leavereason', label: 'reason leaving CPU' },
     objname: { name: 'objname', label: 'object name' },
     rowsmatched: { type: 'number', name: 'rowsmatched', label: 'rows matched' },
     vmmmuctx: { type: 'string', name: 'vmmmuctx', label: 'VM MMU context' },
     http_status: { name: 'http_status', label: 'Status Code' },
     cainstnid: { name: 'cainstnid', label: 'instrumentation identifier' },
     http_path: { name: 'http_path', label: 'URL path' },
     raddr: { name: 'raddr', label: 'remote IP address' },
     bytes_write: { type: 'size', name: 'bytes_write', label: 'bytes written' },
     packets_out: { type: 'number', name: 'packets_out', label: 'packets sent' },
     zdataset: { name: 'zdataset', label: 'ZFS dataset' },
     restify_sname: { name: 'restify_sname', label: 'restify server name' },
     errno: { type: 'string', name: 'errno', label: 'error code' },
     client: { name: 'client', label: 'client hostname' },
     rowschanged: { type: 'number', name: 'rowschanged', label: 'rows changed' },
     user: { name: 'user', label: 'client username' },
     cpu: { name: 'cpu', label: 'CPU identifier' },
     nthreads: { type: 'number', name: 'nthreads', label: 'number of threads' },
     walltime: { type: 'time', name: 'walltime', label: 'process runtime' },
     zpool: { name: 'zpool', label: 'ZFS pool' },
     optype: { name: 'optype', label: 'operation type' },
     http_origin: { name: 'http_origin', label: 'reported origin IP' },
     tcpstack: { name: 'tcpstack', label: 'TCP instance' },
     pmodel: { name: 'pmodel', label: 'process model' },
     ldapbinddn: { name: 'ldapbinddn', label: 'bind DN' },
     http_method: { name: 'http_method', label: 'method' },
     gctype: { name: 'gctype', label: 'GC type' },
     direction: { name: 'direction', label: 'sent/received' } },
  cmm_messages: [ [length]: 0 ],
  cmm_metrics: 
   { 'nic.packets': 
      { interval: 'interval',
        label: 'packets sent and received',
        module: 'nic',
        stat: 'packets',
        unit: 'packets',
        fields: [Object] },
     'postgres.queries': 
      { interval: 'interval',
        label: 'queries',
        module: 'postgres',
        stat: 'queries',
        unit: 'queries',
        fields: [Object] },
     'cpu.usage': 
      { interval: 'point',
        label: 'aggregated CPU usage',
        module: 'cpu',
        stat: 'usage',
        unit: 'percent of 1 CPU',
        fields: [Object] },
     'memory.swap': 
      { type: 'size',
        interval: 'point',
        label: 'virtual memory reserved',
        module: 'memory',
        stat: 'swap',
        fields: [Object] },
     'memory.pageins': 
      { interval: 'interval',
        label: 'pages paged in',
        module: 'memory',
        stat: 'pageins',
        unit: 'pages',
        fields: [Object] },
     'disk.physio_ops': 
      { interval: 'interval',
        label: 'I/O operations',
        module: 'disk',
        stat: 'physio_ops',
        unit: 'operations',
        fields: [Object] },
     'cpu.loadavg1': 
      { type: 'number',
        interval: 'point',
        label: '1-minute load average',
        module: 'cpu',
        stat: 'loadavg1',
        fields: [Object] },
     'mantaop.supervisor_errors': 
      { interval: 'interval',
        label: 'supervisor errors',
        module: 'mantaop',
        stat: 'supervisor_errors',
        unit: 'errors',
        fields: [Object] },
     'cpu.waittime': 
      { type: 'time',
        interval: 'interval',
        label: 'aggregated wait time',
        module: 'cpu',
        stat: 'waittime',
        fields: [Object] },
     'mantaop.supervisor_deletes': 
      { interval: 'interval',
        label: 'supervisor delete requests',
        module: 'mantaop',
        stat: 'supervisor_deletes',
        unit: 'requests',
        fields: [Object] },
     'cpu.thread_executions': 
      { interval: 'interval',
        label: 'thread executions',
        module: 'cpu',
        stat: 'thread_executions',
        unit: 'operations',
        fields: [Object] },
     'zfs.dataset_unused_quota': 
      { type: 'size',
        interval: 'point',
        label: 'unused quota',
        module: 'zfs',
        stat: 'dataset_unused_quota',
        fields: [Object] },
     'mysql.statements': 
      { interval: 'interval',
        label: 'statements',
        module: 'mysql',
        stat: 'statements',
        unit: 'statements',
        fields: [Object] },
     'zfs.dataset_used': 
      { type: 'size',
        interval: 'point',
        label: 'used space',
        module: 'zfs',
        stat: 'dataset_used',
        fields: [Object] },
     'nic.vnic_packets': 
      { interval: 'interval',
        label: 'VNIC packets sent and received',
        module: 'nic',
        stat: 'vnic_packets',
        unit: 'packets',
        fields: [Object] },
     'mysql.filesort': 
      { interval: 'interval',
        label: 'filesort',
        module: 'mysql',
        stat: 'filesort',
        unit: 'filesorts',
        fields: [Object] },
     'tcp.connects': 
      { interval: 'interval',
        label: 'connects',
        module: 'tcp',
        stat: 'connects',
        unit: 'connects',
        fields: [Object] },
     'restify.server_ops': 
      { interval: 'interval',
        label: 'server operations',
        module: 'restify',
        stat: 'server_ops',
        unit: 'operations',
        fields: [Object] },
     'disk.disks': 
      { interval: 'point',
        label: 'disks',
        module: 'disk',
        stat: 'disks',
        unit: 'disks',
        fields: [Object] },
     'vm.irqs': 
      { interval: 'interval',
        label: 'interrupt requests',
        module: 'vm',
        stat: 'irqs',
        unit: 'requests',
        fields: [Object] },
     'mantaop.tasks_committed': 
      { interval: 'interval',
        label: 'tasks committed',
        module: 'mantaop',
        stat: 'tasks_committed',
        unit: 'tasks',
        fields: [Object] },
     'mysql.queries': 
      { interval: 'interval',
        label: 'queries',
        module: 'mysql',
        stat: 'queries',
        unit: 'queries',
        fields: [Object] },
     'nic.bytes': 
      { type: 'size',
        interval: 'interval',
        label: 'bytes sent and received',
        module: 'nic',
        stat: 'bytes',
        fields: [Object] },
     'restify.handler_ops': 
      { interval: 'interval',
        label: 'handler operations',
        module: 'restify',
        stat: 'handler_ops',
        unit: 'operations',
        fields: [Object] },
     'tcp.accepts': 
      { interval: 'interval',
        label: 'accepts',
        module: 'tcp',
        stat: 'accepts',
        unit: 'accepts',
        fields: [Object] },
     'unix.proc_forks': 
      { interval: 'interval',
        label: 'process forks',
        module: 'unix',
        stat: 'proc_forks',
        unit: 'processes',
        fields: [Object] },
     'ca.instr_enables': 
      { interval: 'interval',
        label: 'instrumenter enable operations',
        module: 'ca',
        stat: 'instr_enables',
        unit: 'operations',
        fields: [Object] },
     'zfs.dataset_quota': 
      { type: 'size',
        interval: 'point',
        label: 'quota size',
        module: 'zfs',
        stat: 'dataset_quota',
        fields: [Object] },
     'vm.physio_ops': 
      { interval: 'interval',
        label: 'disk I/O operations',
        module: 'vm',
        stat: 'physio_ops',
        unit: 'operations',
        fields: [Object] },
     'memory.rss_limit': 
      { type: 'size',
        interval: 'point',
        label: 'maximum resident set size',
        module: 'memory',
        stat: 'rss_limit',
        fields: [Object] },
     'vm.physio_bytes': 
      { type: 'size',
        interval: 'interval',
        label: 'disk bytes read and written',
        module: 'vm',
        stat: 'physio_bytes',
        fields: [Object] },
     'node.httpc_ops': 
      { interval: 'interval',
        label: 'HTTP client operations',
        module: 'node',
        stat: 'httpc_ops',
        unit: 'operations',
        fields: [Object] },
     'fs.logical_rwops': 
      { interval: 'interval',
        label: 'logical read/write operations',
        module: 'fs',
        stat: 'logical_rwops',
        unit: 'operations',
        fields: [Object] },
     'vm.thread_samples': 
      { interval: 'interval',
        label: 'thread samples',
        module: 'vm',
        stat: 'thread_samples',
        unit: 'samples',
        fields: [Object] },
     'mysql.connections': 
      { interval: 'interval',
        label: 'connections',
        module: 'mysql',
        stat: 'connections',
        unit: 'connections',
        fields: [Object] },
     'moray.ops': 
      { interval: 'interval',
        label: 'operations',
        module: 'moray',
        stat: 'ops',
        unit: 'operations',
        fields: [Object] },
     'cpu.cpus': 
      { interval: 'point',
        label: 'CPUs',
        module: 'cpu',
        stat: 'cpus',
        unit: 'CPUs',
        fields: [Object] },
     'ldapjs.connections': 
      { interval: 'interval',
        label: 'connections',
        module: 'ldapjs',
        stat: 'connections',
        unit: 'connections',
        fields: [Object] },
     'mantaop.tasks_dispatched': 
      { interval: 'interval',
        label: 'tasks dispatched',
        module: 'mantaop',
        stat: 'tasks_dispatched',
        unit: 'tasks',
        fields: [Object] },
     'mysql.commands': 
      { interval: 'interval',
        label: 'commands',
        module: 'mysql',
        stat: 'commands',
        unit: 'commands',
        fields: [Object] },
     'nic.vnic_bytes': 
      { type: 'size',
        interval: 'interval',
        label: 'VNIC bytes sent and received',
        module: 'nic',
        stat: 'vnic_bytes',
        fields: [Object] },
     'ca.instr_beops': 
      { interval: 'interval',
        label: 'instrumenter backend requests',
        module: 'ca',
        stat: 'instr_beops',
        unit: 'requests',
        fields: [Object] },
     'memory.rss': 
      { type: 'size',
        interval: 'point',
        label: 'resident set size',
        module: 'memory',
        stat: 'rss',
        fields: [Object] },
     'tcp.errors': 
      { interval: 'interval',
        label: 'errors',
        module: 'tcp',
        stat: 'errors',
        unit: 'errors',
        fields: [Object] },
     'mantaop.tasks_executed': 
      { interval: 'interval',
        label: 'tasks executed',
        module: 'mantaop',
        stat: 'tasks_executed',
        unit: 'tasks',
        fields: [Object] },
     'zfs.pool_total': 
      { type: 'size',
        interval: 'point',
        label: 'total space in pool',
        module: 'zfs',
        stat: 'pool_total',
        fields: [Object] },
     'disk.physio_bytes': 
      { type: 'size',
        interval: 'interval',
        label: 'bytes read and written',
        module: 'disk',
        stat: 'physio_bytes',
        fields: [Object] },
     'fs.logical_rwbytes': 
      { type: 'size',
        interval: 'interval',
        label: 'logical bytes read/written',
        module: 'fs',
        stat: 'logical_rwbytes',
        fields: [Object] },
     'mantaop.supervisor_auths': 
      { interval: 'interval',
        label: 'supervisor auth requests',
        module: 'mantaop',
        stat: 'supervisor_auths',
        unit: 'requests',
        fields: [Object] },
     'memory.reclaimed_bytes': 
      { type: 'size',
        interval: 'interval',
        label: 'excess memory reclaimed',
        module: 'memory',
        stat: 'reclaimed_bytes',
        fields: [Object] },
     'node.httpd_ops': 
      { interval: 'interval',
        label: 'HTTP server operations',
        module: 'node',
        stat: 'httpd_ops',
        unit: 'operations',
        fields: [Object] },
     'cpu.thread_samples': 
      { interval: 'interval',
        label: 'thread samples',
        module: 'cpu',
        stat: 'thread_samples',
        unit: 'samples',
        fields: [Object] },
     'node.socket_ops': 
      { interval: 'interval',
        label: 'socket operations',
        module: 'node',
        stat: 'socket_ops',
        unit: 'operations',
        fields: [Object] },
     'syscall.syscalls': 
      { interval: 'interval',
        label: 'system calls',
        module: 'syscall',
        stat: 'syscalls',
        unit: 'syscalls',
        fields: [Object] },
     'zfs.pool_used': 
      { type: 'size',
        interval: 'point',
        label: 'used space in pool',
        module: 'zfs',
        stat: 'pool_used',
        fields: [Object] },
     'mantaop.jobs_assigned': 
      { interval: 'interval',
        label: 'jobs assigned',
        module: 'mantaop',
        stat: 'jobs_assigned',
        unit: 'jobs',
        fields: [Object] },
     'node.gc_ops': 
      { interval: 'interval',
        label: 'garbage collection operations',
        module: 'node',
        stat: 'gc_ops',
        unit: 'operations',
        fields: [Object] },
     'mantaop.zone_resets': 
      { interval: 'interval',
        label: 'zone resets',
        module: 'mantaop',
        stat: 'zone_resets',
        unit: 'resets',
        fields: [Object] },
     'nic.nics': 
      { interval: 'point',
        label: 'NICs',
        module: 'nic',
        stat: 'nics',
        unit: 'NICs',
        fields: [Object] },
     'vm.exits': 
      { interval: 'interval',
        label: 'exits',
        module: 'vm',
        stat: 'exits',
        unit: 'exits',
        fields: [Object] },
     'mantaop.supervisor_locates': 
      { interval: 'interval',
        label: 'supervisor locate requests',
        module: 'mantaop',
        stat: 'supervisor_locates',
        unit: 'requests',
        fields: [Object] },
     'moray.queries': 
      { interval: 'interval',
        label: 'SQL queries',
        module: 'moray',
        stat: 'queries',
        unit: 'queries',
        fields: [Object] },
     'zfs.arc_ops': 
      { interval: 'interval',
        label: 'ARC operations',
        module: 'zfs',
        stat: 'arc_ops',
        unit: 'operations',
        fields: [Object] },
     'unix.processes': 
      { interval: 'interval',
        label: 'processes',
        module: 'unix',
        stat: 'processes',
        unit: 'processes',
        fields: [Object] },
     'unix.thr_creates': 
      { interval: 'interval',
        label: 'thread creations',
        module: 'unix',
        stat: 'thr_creates',
        unit: 'threads',
        fields: [Object] },
     'zfs.pool_free': 
      { type: 'size',
        interval: 'point',
        label: 'free space in pool',
        module: 'zfs',
        stat: 'pool_free',
        fields: [Object] },
     'mantaop.tasks_killed': 
      { interval: 'interval',
        label: 'tasks killed',
        module: 'mantaop',
        stat: 'tasks_killed',
        unit: 'tasks',
        fields: [Object] },
     'ldapjs.ops': 
      { interval: 'interval',
        label: 'all operations',
        module: 'ldapjs',
        stat: 'ops',
        unit: 'operations',
        fields: [Object] },
     'ca.instr_ticks': 
      { interval: 'interval',
        label: 'instrumenter ticks',
        module: 'ca',
        stat: 'instr_ticks',
        unit: 'ticks',
        fields: [Object] },
     'fs.logical_ops': 
      { interval: 'interval',
        label: 'logical filesystem operations',
        module: 'fs',
        stat: 'logical_ops',
        unit: 'operations',
        fields: [Object] },
     'tcp.segments': 
      { interval: 'interval',
        label: 'segments',
        module: 'tcp',
        stat: 'segments',
        unit: 'segments',
        fields: [Object] },
     'ca.instr_disables': 
      { interval: 'interval',
        label: 'instrumenter disable operations',
        module: 'ca',
        stat: 'instr_disables',
        unit: 'operations',
        fields: [Object] },
     'ldapjs.search_ops': 
      { interval: 'interval',
        label: 'search operations',
        module: 'ldapjs',
        stat: 'search_ops',
        unit: 'operations',
        fields: [Object] },
     'memory.swap_limit': 
      { type: 'size',
        interval: 'point',
        label: 'maximum virtual memory reserved',
        module: 'memory',
        stat: 'swap_limit',
        fields: [Object] },
     'unix.proc_execs': 
      { interval: 'interval',
        label: 'process execs',
        module: 'unix',
        stat: 'proc_execs',
        unit: 'processes',
        fields: [Object] },
     'unix.proc_exits': 
      { interval: 'interval',
        label: 'process exits',
        module: 'unix',
        stat: 'proc_exits',
        unit: 'processes',
        fields: [Object] },
     'apache.httpd_ops': 
      { interval: 'interval',
        label: 'HTTP requests',
        module: 'apache',
        stat: 'httpd_ops',
        unit: 'requests',
        fields: [Object] } },
  cmm_nwarnings: 0 }
-------METADATA   END---------
[2015-06-13 21:14:23.271 UTC] DBG    
----------------------------------------
this int state;

sched:::on-cpu
/((curthread->t_pri != -1))/{
	self->runtime0 = timestamp;
}

sched:::off-cpu
/((((((self->runtime0) != NULL)))) && (((((this->state = curlwpsinfo->pr_state) != NULL || 1)))) && (curthread->t_pri != -1))/{
	@[(execname)] = llquantize((timestamp - self->runtime0), 10, 3, 11, 100);
}

sched:::off-cpu
/((curthread->t_pri != -1))/{
	(self->runtime0) = 0;
}

----------------------------------------
[2015-06-13 21:14:24.885 UTC] INFO   instrumented global;13 (cpu.thread_executions)
